---
layout: persian
classes: wide rtl-layout
dir: rtl
title: " ูุนูุงุฑ RAG ููโุงูุฒุงุงูู "
permalink: /teaching/studenteffort/patterneffort/synergistic-rag
author_profile: true
header:
  overlay_image: "/assets/images/background.jpg"
  overlay_filter: 0.3
  overlay_color: "#5e616c"
  caption: "Photo credit: [Unsplash](https://unsplash.com)"
---


# ฺฏุฒุงุฑุด ูพุงุฏู ุณุงุฒ ูุนูุงุฑ ุงุฑุงุฆู ุดุฏู ููุงูู :
# A synergistic multi-stage RAG architecture for boosting context relevance in data science literature


---
<div style="display: flex; justify-content: start; align-items: center; gap: 10px;">
    <img src="/assets/patterneffort/synergistic-rag/media/logo1.jpg" width="169" height="217" alt="FUM-logo" style="object-fit: contain;">
</div>

<div style="display: flex; justify-content: start; align-items: center; gap: 10px;">
    <img src="/assets/patterneffort/synergistic-rag/media/logo2.jpg" width="169" height="217" alt="FUM-logo" style="object-fit: contain;">
</div>

**ุฏุงูุดฺฏุงู ูุฑุฏูุณ ูุดูุฏ**

**ุฏุงูุดฺฉุฏู ูููุฏุณ**

**ฺฏุฑูู ฺฉุงููพูุชุฑ**

**ุฏุฑุณ ุดูุงุณุง ุขูุงุฑ ุงูฺฏู**

**ุงุณุชุงุฏ : ุฏฺฉุชุฑ ุตุฏูู ุฒุฏ**

**ฺฏุฒุงุฑุด ูพุฑูฺู**

**ููุณูุฏู**: ุฏุงูุงู ุขูุงุฎุงู ุฒุงุฏู  โ ุฏุงูุดุฌู ฺฉุงุฑุดูุงุณโุงุฑุดุฏ ููุด ูุตููุน

**ุงูู :** [DanialAghakhanizadeh@gmail.com](mailto:@gmail.com)

---

## ููุฑุณุช ูุทุงูุจ

<br>

- [ููุฏูู](#ููุฏูู)
  - [ูุนูุงุฑ RAG](#ูุนูุงุฑ-rag)
    - [ูุฒุงุง ู ฺุงูุด ูุง RAG](#ูุฒุงุง-ู-ฺุงูุด-ูุง-rag)
  - [ุฑูฺฉุฑุฏ ูู ุงูุฒุงุงูู](#ุฑูฺฉุฑุฏ-ูู-ุงูุฒุงุงูู)
  - [ูุนูุงุฑ ูพุดููุงุฏ ุดุฏู](#ูุนูุงุฑ-ูพุดููุงุฏ)

<br>

- [ูพุงุฏู ุณุงุฒ: ุขูุงุฏู ุณุงุฒ ุฏุงุฏู ูุง](#ูพุงุฏู-ุณุงุฒ-ุขูุงุฏู-ุณุงุฒ-ุฏุงุฏู-ูุง)
  - [ุฏุฑุงูุช ููุงูุงุช](#ุฏุฑุงูุช-ููุงูุงุช)
  - [ูพุดโูพุฑุฏุงุฒุด](#ุฌูุน-ุขูุฑ-ุงุทูุงุนุงุช-ู-ูพุด-ูพุฑุฏุงุฒุด)
  - [ูุนุฑู GROBID](#ุงูุง-grobid-ฺุณุช-ู-ฺู-ูุฒุงุง-ู-ุจุฑุชุฑูุง-ูุณุจุช-ุจู-ุณุงุฑ-ุงุจุฒุงุฑูุง-ูุดุงุจู-ุฏุงุฑุฏ)
    - [ูุตุจ GROBID](#ูุตุจ-grobid)

<br>

- [ูพุงุฏู ุณุงุฒ: ูุฏูโูุง ุฌุงููุง](#ูพุงุฏู-ุณุงุฒ-ูุฏู-ูุง-ุฌุงููุง)
  - [ุขูุงุฏู ุณุงุฒ ุฏุงุฏู ูุง ุขููุฒุด](#ุขูุงุฏู-ุณุงุฒ-ุฏุงุฏู-ูุง-ุขููุฒุด)
  - [ูพุฑุฏุงุฒุด ูุชู ฺฉุชุงุจ ูุง](#ูพุฑุฏุงุฒุด-ูุชู-ฺฉุชุงุจ-ูุง)
  - [ุฑุฒุชูุธู ูุฏู ุฌุงููุง](#ุฑุฒุชูุธู-ูุฏู-ุฌุงููุง)
    - [ูพฺฉุฑุจูุฏ SNS](#ุฑุฒุชูุธู-ุจุง-sns)

<br>

- [ูพุงุฏู ุณุงุฒ: ูุทุนูโุจูุฏ ูุนูุง](#ูพุงุฏู-ุณุงุฒ-ูุทุนู-ุจูุฏ-ูุนูุง)
  - [ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู](#ูุทุนู-ุจูุฏ-ูุนูุง-ุฏุฑ-ุฑูฺฉุฑุฏ-abstract-first)
    - [ูุทุนู ุจูุฏ ูุนูุง ฺฺฉุฏู](#ฺฉุฏ-ุจุฎุด-ุงูู-ุงุณุชุฎุฑุงุฌ-ู-ุงูุฏุณ-ฺฏุฐุงุฑ-ฺฺฉุฏู-ูุง)
    - [ูุทุนู ุจูุฏ ูุนูุง ุจุฏูู](#ฺฉุฏ-ุจุฎุด-ุฏูู-ูุทุนู-ุจูุฏ-ูุนูุง-ุจุฏูู-ููุงูุงุช)

<br>

- [ูพุงุฏู ุณุงุฒ:  Retrieval-augmented generation](#ูพุงุฏู-ุณุงุฒ-retrieval-augmented-generation)
  - [ุฑูฺฉุฑุฏ ูพุงู RAG](#ูุนูุงุฑ-rag-ุณุงุฏู)
  - [ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู RAG](#ูุนูุงุฑ-rag-ุฑูฺฉุฑุฏ-abstract-first)

<br>

- [ุงุฑุฒุงุจ](#ุงุฑุฒุงุจ)
  - [ฺฉุชุงุจุฎุงูู RAGAS](#ฺฉุชุงุจุฎุงูู-ragas)
    - [ูุนุงุฑ Faithfulness](#ฑ-ููุงุฏุงุฑ-ุจู-ูุชู-faithfulness)
    - [ูุนุงุฑ Answer Relevance](#ฒ-ุงุฑุชุจุงุท-ูพุงุณุฎ-answer-relevance)
    - [ูุนุงุฑ Context Relevancy](#ณ-ุงุฑุชุจุงุท-ุฒููู-context-relevance)
  - [ูพุงุฏู ุณุงุฒ ุนูู ูุนุงุฑ ูุง ุงุฑุฒุงุจ](#ูพุงุฏูุณุงุฒ-ุนูู-ูุนุงุฑูุง-ุงุฑุฒุงุจ)

<br>

- [ูุชุงุฌ](#ูุชุงฺ)
  - [ุขุฒูุงุด ุดูุงุฑู ฑ: ููุงุณู  ุนููฺฉุฑุฏ ูุฏู ูุง ุฒุจุงู ูุญู](#ุขุฒูุงุด-ุดูุงุฑู-ฑ-ููุงุณู--ุนููฺฉุฑุฏ-ูุฏู-ูุง-ุฒุจุงู-ูุญู)
    - [ุขุฒููู ุขูุงุฑ ANOVA](#ุขุฒููู-ุขูุงุฑ-anova)
    - [ุขุฒููู HSD Tukey](#ุขุฒููู-ุชูฺฉ-hsd-tukey)
  - [ุขุฒูุงุด ุดูุงุฑู ฒ: ููุงุณู ุนููฺฉุฑุฏ ูุฏู ุฌุงููุง ุจุฑ ุงุณุงุณ ูพฺฉุฑุจูุฏ ููุงุจุน ุขููุฒุด ูุฎุชูู ุฏุฑ ููุงูู](#ุขุฒูุงุด-ุดูุงุฑู-ฒ-ููุงุณู-ุนููฺฉุฑุฏ-ูุฏู-ุฌุงููุง-ุจุฑ-ุงุณุงุณ-ูพฺฉุฑุจูุฏ-ููุงุจุน-ุขููุฒุด-ูุฎุชูู-ุฏุฑ-ููุงูู)
  - [ุขุฒูุงุด ุดูุงุฑู ณ: ููุงุณู ุนููฺฉุฑุฏ ูุฏู ูุง ุฌุงููุง](#ุขุฒูุงุด-ุดูุงุฑู-ณ-ููุงุณู-ุนููฺฉุฑุฏ-ูุฏู-ูุง-ุฌุงููุง)
  - [ุขุฒูุงุด ุดูุงุฑู ด: ููุงุณู ุนููฺฉุฑุฏ ุฏุณุชูุฑุงุช ูุฎุชูู](#ุขุฒูุงุด-ุดูุงุฑู-ด-ููุงุณู-ุนููฺฉุฑุฏ-ูพุฑุงููพุช-ูุง-ูุฎุชูู)
  - [ุขุฒูุงุด ุดูุงุฑู ต: ููุงุณู ุนููฺฉุฑุฏ ูุฏู ูุง ุฒุจุงู ุฏุฑ ุงุฑุฒุงุจ ูุชุงุฌ](#ุขุฒูุงุด-ุดูุงุฑู-ต-ููุงุณู--ุนููฺฉุฑุฏ-ูุฏู-ูุง-ุฒุจุงู-ุฏุฑ-ุงุฑุฒุงุจ-ูุชุงุฌ)

<br>

- [ุงุฏู ูุง ูพุดููุงุฏ](#ุงุฏู-ูุง-ูพุดููุงุฏ)
  - [ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู ุจู ููุฑุงู ุฌุฏุงุณุงุฒ ฺฏุฑู ูุนูุง](#ุฑูฺฉุฑุฏ-abstract-first--semantic-node-splitter)
  - [ูุทุนูโุจูุฏ ูุนูุง](#ูุทุนูุจูุฏ-ูุนูุง-ุฏุฑ-ุฑูฺฉุฑุฏ-abstract-first--sns)
  - [ูพุงุฏู ุณุงุฒ RAG](#ูุนูุงุฑ-rag-ุจุง-ุฑูฺฉุฑุฏ-abstract-first--sns)
- [ูุชุงุฌ](#ูุชุงุฌ)
- [ุฌูุนโุจูุฏ](#ุฌูุน-ุจูุฏ)
- [ุณุงุฑ ุฑุงู ูุง ุจูุจูุฏ ุนููฺฉุฑุฏ ูุนูุงุฑ](#ุฑุงูฺฉุงุฑูุง-ุชฺฉูู-ุจุฑุง-ุจูุจูุฏ-ุนููฺฉุฑุฏ-ูุนูุงุฑ)
- [ุฌูุนโุจูุฏ ููุง](#ุฌูุน-ุจูุฏ-ููุง)

<br>

- [ูพูุณุช ูุง](#ูพูุณุช-ูุง)
  - [ูพูุณุช ฑ: ุงุจุฒุงุฑ ูุง](#ูพูุณุช-ฑ-ุงุจุฒุงุฑ-ูุง)
  - [ูพูุณุช ฒ: ูพฺฉุฑุจูุฏ ูุฑุงุญู ู ุขุฒูุงุดโูุง](#ูพูุณุช-ฒ-ูพฺฉุฑุจูุฏ-ูุฑุงุญู-ู-ุขุฒูุงุด-ูุง)
  - [ูพูุณุช ณ: ูพููุฏ ูุง](#ูพูุณุช-ณ-ุฎุฑูุฌ-ูุง)
  - [ูพูุณุช ด: ููุงุจุน](#ูพูุณุช-ด)
 

---

## ฺฺฉุฏู
ุฏุฑ ุงู ฺฏุฒุงุฑุดุ ุนููฺฉุฑุฏ ุฑูฺฉุฑุฏ ููโุงูุฒุงุงูู ุฏุฑ ูุนูุงุฑโูุง RAG ุจุง ูุฏู ุงูุฒุงุด ุงุฑุชุจุงุท ุฒูููโุง ู ูุนูุง ูพุงุณุฎโูุง ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ ุฏุฑ ุจุงุฒุงุจ ู ุชุญูู ูุชูู ุนูู ู ุงุฏุจุงุช ูพฺููุด ุญูุฒู ุนููู ุฏุงุฏู ู ุงุฏฺฏุฑ ูุงุดู ุจุฑุฑุณ ูโุดูุฏ. ุณูพุณ ูุญููโ ูพุงุฏูโุณุงุฒ ูุนูุงุฑ ุงุฑุงุฆูโุดุฏู ุฏุฑ ููุงููโ ุงุตูุ ุจุง ุชูุฑฺฉุฒ ุจุฑ ุงุฑุฒุงุจ ุฎุฑูุฌ ูุฏูโูุง ุฒุจุงู ูุญู (ูุชูโุจุงุฒ)ุ ุจูโุตูุฑุช ูุฑุญููโุจูโูุฑุญูู ููุฑุฏ ูุทุงูุนู ูุฑุงุฑ ูโฺฏุฑุฏ. ุฏุฑ ุงุฏุงููุ ุฑูุด ุงุฑุฒุงุจ ุงู ูุฏูโูุง ุชุดุฑุญ ุดุฏู ู ุฏุฑ ูพุงุงูุ ูุชุงุฌ ุญุงุตู ุงุฒ ุนููฺฉุฑุฏ ูุนูุงุฑ ููโุงูุฒุงุงูู ุฏุฑ ูุฏูโูุง ูุญู ุจุง ฺฉุฏฺฏุฑ ู ููฺูู ุจุง ูุฏู ูุนุฑูโุดุฏู ุฏุฑ ููุงูู ููุงุณู ูโฺฏุฑุฏุฏ.

ูุงฺฺฏุงู ูููุฏู:
ูุฏู ูุง ุฒุจุงู ุจุฒุฑฺฏ -
ุจุงุฒุงุจ ุงุทูุงุนุงุช -
ูพุดโูพุฑุฏุงุฒุด -
ููโุงูุฒุง -
ููุงูุชู

---

## ููุฏูู

&nbsp;&nbsp;&nbsp;ุฏุฑ ุฏูุง ุงูุฑูุฒุ ุจุง ูุฑูุฏ ูุฏูโูุง ูููุฏ ููุด ูุตููุน ู ุจูโูฺู ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ ู ุจู ุฒูุฏฺฏ ุฑูุฒูุฑูโ ุจุดุฑ ู ุจูุฑูโููุฏ ุงุฒ ูุฒุงุง ฺฏุณุชุฑุฏูโ ุขูโูุง ุฏุฑ ูพุฑุฏุงุฒุด ุงุทูุงุนุงุชุ ุชููุฏ ูุญุชูุง ู ุณุงุฑ ฺฉุงุฑุจุฑุฏูุงุ ููโุฒูุงู ุจุง ูุฑุตุชโูุงุ ุจุง ฺุงูุดโูุง ู ูุฎุงุทุฑุงุช ูุฒ ููุงุฌู ูโุดูู.

&nbsp;&nbsp;&nbsp;ฺฉ ุงุฒ ูููโุชุฑู ฺุงูุดโูุง ุงู ูุฏูโูุงุ ูพุฏุฏูโ ุชูููโุฒุง [^1] ุง ุชููุฏ ุงุทูุงุนุงุช ูุงุฏูู ู ฺฏูุฑุงูโฺฉููุฏู ุฏุฑ ุฎุฑูุฌ ุณุณุชูโูุงุณุช. ฺฏุฑฺู ฺูู ุฎุทุงูุง ุฏุฑ ูพุงุณุฎ ุจู ูพุฑุณุดโูุง ุนููู ููฺฉู ุงุณุช ฺูุฏุงู ุฌุฏ ุชูู ูุดููุฏุ ุงูุง ุฏุฑ ฺฉุงุฑุจุฑุฏูุง ุชุญููุงุช ุง ูุญุงุณุจุงุช ูุงุจู ูพุฐุฑุด ูุณุชูุฏ ู ุฏุฑ ุญูุฒูโูุง ุญุณุงุณ ูุงููุฏ ูพุฒุดฺฉ ุญุช ูโุชูุงููุฏ ูพุงูุฏูุง ุฌุจุฑุงูโูุงูพุฐุฑ ุจูโููุฑุงู ุฏุงุดุชู ุจุงุดูุฏ.
ุนูุงูู ุจุฑ ุงูุ ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ุนููู ุฒุจุงู ุฏุฑ ูุณุงุฆู ุชุฎุตุตุ ูุจูุฏ ุขููุฒุด ฺฉุงู ุจูโุฏูู ูุญุฏูุฏุช ููุงุจุน ุณุฎุชโุงูุฒุงุฑ ุง ฺฉูุจูุฏ ุฏุงุฏูุ ู ููฺูู ุจูโุฑูุฒ ูุจูุฏู ูุฏูโูุง ุงุฒ ุฌููู ุนูุงูู ูุณุชูุฏ ฺฉู ุงุญุชูุงู ุจุฑูุฒ ุชููู ุฏุฑ ุฎุฑูุฌ ุงู ุณุณุชูโูุง ุฑุง ุงูุฒุงุด ูโุฏููุฏ.
ุจู ููู ุฏููุ ุชุงฺฉููู ุฑุงูฺฉุงุฑูุง ูุชุนุฏุฏ ุจุฑุง ฺฉุงูุด ุงู ูุดฺฉู ุงุฑุงุฆู ุดุฏู ุงุณุชุ ุงุฒ ุฌููู ุฑูุดโูุง ูุจุชู ุจุฑ ูพุงุด ู ุชุดุฎุต ุชูููโุฒุง [2]ุ ูููุฏุณ ุฏุณุชูุฑุงุช [^2]  [3]ู ุชููุฏ ุชููุชโุดุฏู ุจุง ุจุงุฒุงุจ[^3]. [4] [5] 

![ุชุตูุฑ ฑ - ุงููุงุน ุชููู ุฏุฑ ูุฏู ูุง ุฒุจุงู](/assets/patterneffort/synergistic-rag/media/fig1.jpeg)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ฑ โ ุฏู ููููู ุงุฒ ุงููุงุน ุชููู : ุชููู ุจุฑ ูุจูุง ููุทู (ุณูุช ุฑุงุณุช) โ ุชููู ุจุฑ ูุจูุง ุฏุงูุด (ุณูุช ฺูพ)</sub>
</p>
<br>

---
## ูุนูุงุฑ RAG
&nbsp;&nbsp;&nbsp;ุจูโุทูุฑ ฺฉูุ ุฏุฑ ูุนูุงุฑ RAG ฺฉู ูุฎุณุชู ุจุงุฑ ุฏุฑ ุณุงู ฒฐฒฐ ููุงุฏ ุฏุฑ ุญูุฒูโ ูพุฑุฏุงุฒุด ุฒุจุงูโูุง ุทุจุน  ูุนุฑู ุดุฏุ ุฏุฑ ฺฉูุงุฑ ูพุฑุณุด ูุฑูุฏ ฺฉุงุฑุจุฑุ ุงุทูุงุนุงุช ูุฑุชุจุท ุจุง ุขู ูุฒ ุจู ูุฏู ุฒุจุงู ุฏุงุฏู ูโุดูุฏ. ุฏุฑ ูุชุฌูุ ูุฏู ุจูโุฌุง ุงุชฺฉุง ุตุฑู ุจู ุฏุงูุด ุงูููโ ุฎูุฏุ ุจุง ุชูุฌู ุจู ุงู ุงุทูุงุนุงุช ุฒูููโุง [^5] ูุงุฏุงุฑ ูโุดูุฏ ุชุง ูพุงุณุฎ ุฏููโุชุฑ ุชููุฏ ฺฉูุฏ.
ุจุง ุชูุฌู ุจู ูุญุฏูุฏุช ูุฑูุฏโูุง ูุฏูโูุง ุฒุจุงู ู ฺฉู ุจู ุขูโูุง ุชูฺฉูโูุง ูุฑูุฏ [^6] ฺฏูุชู ูโุดูุฏ (ูุฑ ุชูฺฉู ุจูโุทูุฑ ุชูุฑุจ ุดุงูู ฺูุงุฑ ุญุฑู ุงููุจุง ุงุณุช [6]) ู ู ุจุง ุฏุฑ ูุธุฑ ฺฏุฑูุชู ฺฏุณุชุฑุฏฺฏ ูุงุฒ ฺฉุงุฑุจุฑุงู ู ุชุนุฏุงุฏ ุจุงูุง ูพุฑุณุดโูุงุ ูุงุฒู ุงุณุช ุงู ูุฑุขูุฏ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงูุฌุงู ุดูุฏ. ุงู ูุฑุขูุฏ ุจุง ฺฉูฺฉ ุงุชุตุงู ฺฉ ูพุงฺฏุงู ุฏุงุฏู  ุงููู ุจู ูุนูุงุฑ RAG ู ุณูพุณ ุชุจุฏู ุฏุงูุด ููุฌูุฏ ุจู ููุงุฏุฑ ุงูุฏุณโฺฏุฐุงุฑ ุดุฏู ุจุฑุฏุงุฑ ููุฏูุฑ ูโฺฏุฑุฏุฏ.
ุงู ุฎูุฏฺฉุงุฑุณุงุฒ ุจุง ุงุชุตุงู ฺฉ ูพุงฺฏุงู ุฏุงุฏูโ ุงููู ุจู ูุนูุงุฑ RAG ู ุณูพุณ ุชุจุฏู ุฏุงูุด ููุฌูุฏ ุจู ููุงุฏุฑ ุจุฑุฏุงุฑ ุงูุฏุณโฺฏุฐุงุฑโุดุฏู ุงูฺฉุงูโูพุฐุฑ ูโฺฏุฑุฏุฏ. ุจู ุงู ุชุฑุชุจุ ุจุง ูุฑูุฏ ูพุฑุณุด ฺฉุงุฑุจุฑ ุจู ุณุณุชูุ ุงุจุชุฏุง ุฏุงูุด ูุฑุชุจุท ุฏุฑ ูุถุง ุจุฑุฏุงุฑ ูพุงฺฏุงู ุฏุงุฏู ุฌุณุชุฌู ู ุจุงุฒุงุจ ูโุดูุฏ. ุณูพุณ ููุงูุชู [^7] ุจุงุฒุงุจโุดุฏู ุฏุฑ ฺฉูุงุฑ ูพุฑุณุด ฺฉุงุฑุจุฑ ุจู ูุฏู ุฏุงุฏู ูโุดูุฏ ุชุง ูพุงุณุฎ ููุง ุชููุฏ ฺฏุฑุฏุฏ.
<br>

ุงุฒ ูููโุชุฑู ูุฒุงุง ูุนูุงุฑ RAG ูโุชูุงู ุจู ููุงุฑุฏ ุฒุฑ ุงุดุงุฑู ฺฉุฑุฏ:
<br>

&nbsp;ฑ- ุจูููโุณุงุฒ ุชูฺฉูโูุง: ุจุงุฒุงุจ ููุงูุชู ูุฑุชุจุท ููุฑุงู ุจุง ฺฉุงูุด ุญุฌู ุฏุงุฏูโูุง ูุฑูุฏ ู ุตุฑููโุฌู ุฏุฑ ูุตุฑู ููุงุจุน.<br>
&nbsp;ฒ- ุงูุฒุงุด ุฏูุช: ุชููุฏ ูพุงุณุฎโูุง ุจุฑ ูุจูุง ุฏุงุฏูโูุง ูุนุชุจุฑ ู ูุทุน ุฎุงุฑุฌ ุงุฒ ูุฏู.<br>
&nbsp;ณ- ููุงุณโูพุฐุฑ: ุงูฺฉุงู ุงุณุชูุงุฏู ูพูุง ุงุฒ ุฏุชุงุณุชโูุง ุจุฒุฑฺฏ ู ูุชููุน.<br>
&nbsp;ด- ุงูุนุทุงูโูพุฐุฑ: ูุงุจูุช ุชููู ุขุณุงู ุจุง ุณุงุฑ ุณุณุชูโูุง ู ุงุจุฒุงุฑูุง.<br>
&nbsp;ต- ุจูุจูุฏ ุชุฌุฑุจูโ ฺฉุงุฑุจุฑ: ุงุฑุงุฆู ูพุงุณุฎโูุง ุณุฑุนโุชุฑ ู ุฏููโุชุฑ.<br>

![ุชุตูุฑ ฒ - ุณุงุฎุชุงุฑ ฺฉู RAG](/assets/patterneffort/synergistic-rag/media/fig2.jpeg)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ฒ โ ุณุงุฎุชุงุฑ ฺฉู ูุนูุงุฑ RAG ุณุงุฏู </sub>
</p>
<br>

### ูุฒุงุง ู ฺุงูุด ูุง RAG

ุงุฒ ูููโุชุฑู ฺุงูุดโูุง ูุนูุงุฑ RAG ูุฒ ูโุชูุงู ุจู ููุงุฑุฏ ุฒุฑ ุงุดุงุฑู ฺฉุฑุฏ:<br>
ฑ- ุงุฑุชุจุงุท ูุนูุง ุฏุงุฏูโูุง ุจุงุฒุงุจโุดุฏู: ฺฉูุช ูพุงุณุฎโูุง ุจู ูุฒุงู ุงุฑุชุจุงุท ู ุงุนุชุจุงุฑ ููุงุจุน ุจุฑูู ูุงุจุณุชู ุงุณุช.<br>
ฒ- ุชุงุฎุฑ ุฏุฑ ูพุงุณุฎโุฏู: ุงูุฒุงุด ูุฑุงุญู ุจุงุฒุงุจ ูโุชูุงูุฏ ุฒูุงู ุชููุฏ ูพุงุณุฎ ุฑุง ุจุดุชุฑ ฺฉูุฏ.<br>
ณ- ุงูุจุงุฑูโูุง ุฏุงุฏู: ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ุณุงุฎุชโุงูุชู ู ูุฏุฑุช ุฑูุงุจุท ูุงู ููุงุจุน ููฺูุงู ุฏุดูุงุฑ ุงุณุช.<br>
ด- ูุญุฏูุฏุชโูุง ููุงูุชู (Context): ุญุฌู ุฒุงุฏ ุฏุงุฏูโูุง ุจุงุฒุงุจโุดุฏู ููฺฉู ุงุณุช ุงุฒ ูุญุฏูุฏุช ุชูฺฉูโูุง ูุฑูุฏ ูุฏู ุฒุจุงู ูุฑุงุชุฑ ุฑูุฏุ ุจูุงุจุฑุงู ูุงุฒ ุจู ูููุทุนโุณุงุฒ [^8] ู ูุฏุฑุช ุฏุงุฏูโูุง ูุฌูุฏ ุฏุงุฑุฏ.<br>
ต- ูุงุชุฑุงุฒ ูุนูุง: ุงุณูุงุฏ ุจุงุฒุงุจโุดุฏู ููฺฉู ุงุณุช ูุงูุฏ ุงุฑุชุจุงุทุงุช ุณุงุฎุชุงุฑ ูุงุฒู ุจุฑุง ุงุณุชุฏูุงู ุนูู ูุฏู ุจุงุดูุฏ.<br>
<br>
<br>
&nbsp;
ุจุง ุชูุฌู ุจู ฺุงูุดโูุง ูุทุฑุญโุดุฏูุ ุจูโูฺู ูุญุฏูุฏุชโูุง ููุงูุชู ู ูุญุฏูุฏุช ุชูฺฉูโูุง ฺฉู ุฏุฑ ุฏุงุฏูโูุง ุญุฌู ูโุชูุงููุฏ ููุฌุฑ ุจู ุณุฑุจุงุฑ ุงุทูุงุนุงุช [^9] ุดููุฏุ ุจูุจูุฏ ุนููฺฉุฑุฏ RAG ุฏุฑ ุจุฑุฎ ฺฉุงุฑุจุฑุฏูุง ู ุจูโูฺู ูุนุงูุชโูุง ูพฺููุด ู ุงูุฑ ุถุฑูุฑ ุงุณุช.<br>
<br>
ุจุฑุง ุฑูุน ุงู ูุดฺฉูุ ุฑูุดโูุง ูุชุนุฏุฏ ุงุฑุงุฆู ุดุฏูโุงูุฏุ ุงุฒ ุฌููู ุงุณุชูุงุฏู ุงุฒ ฺฏุฑุงู ุฏุงูุด ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู (ูุนูุงุฑ  GraphRAG [7])ุ ุฑูฺฉุฑุฏ ComoRAG [8]ุ ูLongRAG  [9] ฺฉู ูุฑ ฺฉ ุงุฒ ุงู ูุนูุงุฑโูุง ุชูุงุด ฺฉุฑุฏูโุงูุฏ ุชุง ูุญุฏูุฏุชโูุง ููุฌูุฏ ุฏุฑ ุจุงุฒุงุจ ู ูุฏุฑุช ุฏุงุฏูโูุง ุญุฌู ุฑุง ฺฉุงูุด ุฏููุฏ.
ฺฉ ุงุฒ ุฌุฏุฏุชุฑู ุฑูฺฉุฑุฏูุง ุฏุฑ ุงู ุฒูููุ ูพุงุฏูโุณุงุฒ ุฑูฺฉุฑุฏ ููโุงูุฒุงุงูู [^10] ุฏุฑ ูุนูุงุฑ RAG ุงุณุช ฺฉู ุจุง ุชุฑฺฉุจ ฺูุฏู ุชฺฉูฺฉ ุจูโุตูุฑุช ูุฑุญููโุงุ ุจูุจูุฏ ฺุดูฺฏุฑ ุฏุฑ ุงุฑุชุจุงุท ูุนูุง ู ฺฉุงุฑุง ุณุณุชู ุงุฌุงุฏ ูโฺฉูุฏ.
<br><br>

----

## ุฑูฺฉุฑุฏ ูู ุงูุฒุงุงูู
&nbsp;&nbsp;&nbsp;ุจุฑ ุงุณุงุณ ููุงููโโ  โSynergizing RAG and Reasoningโ ฺฉู ุฏุฑ ุณุงู ฒฐฒต ููุชุดุฑ ุดุฏู ุงุณุช [9]ุ ููููู ููโุงูุฒุง ุฏุฑ ูุนูุงุฑ RAG ุจูโุตูุฑุช ุชุฑฺฉุจ ุชูุงูุงโูุง ฺฉุณุจ ุฏุงูุด ุฎุงุฑุฌ ุฏุฑ RAG ุจุง ูุงุจูุชโูุง ุงุณุชุฏูุงู ุฏุฑูู [^11] ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ ุชุนุฑู ูโุดูุฏ. ุงู ุชุฑฺฉุจ ุฏุฑ ุฑุงุณุชุง ุจูุจูุฏ ฺฉูุช ูพุงุณุฎโุฏู ุจู ูุณุงุฆู ูพฺุฏู ุจูโฺฉุงุฑ ฺฏุฑูุชู ูโุดูุฏ ู ููุฌุจ ุงุฑุชูุง ุฏูุช ู ุนูู ุชุญูู ุฏุฑ ฺฉุงุฑุจุฑุฏูุง ูพฺููุด ู ุชุฎุตุต ูโฺฏุฑุฏุฏ.
<br>

![ุชุตูุฑ ณ - ูุญูู  ุนููฺฉุฑุฏ RAG](/assets/patterneffort/synergistic-rag/media/fig3.jpeg)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ณ โ ููุงุณู  ุนููฺฉุฑุฏ RAG ุณุงุฏู (ุฑูฺฏ ุฒุฑุฏ) ู RAG ููโุงูุฒุง (ุฑูฺฏ ุณุจุฒ) - ููุงูู [9]</sub>
</p>
<br>

ุจุง ุชูุฌู ุจู ุชุตูุฑ ณ ูุดุงูุฏู ูโุดูุฏ ฺฉู ูุนูุงุฑโูุง RAG ุณูุช ุนูุฏุชุงู ุจู ุดุจุงูุช ูุนูุง ุฏุฑ ูุฑุขูุฏ ุจุงุฒุงุจ ุงุทูุงุนุงุช ูุชฺฉ ูุณุชูุฏ. ุงู ูุงุจุณุชฺฏ ููุฌุจ ูโุดูุฏ ฺฉู ุฏุฑ ุจุณุงุฑ ุงุฒ ููุงุฑุฏุ ุงุณูุงุฏ ุจุงุฒุงุจโุดุฏู ุตุฑูุงู ุจุฑ ุงุณุงุณ ุดุจุงูุช ุธุงูุฑ ุจู ูพุฑุณุด ู ูู ุจุฑ ุงุณุงุณ ุงุฑุชุจุงุท ููุทู ุง ุงุณุชุฏูุงู ุจุง ููุถูุน ููุฑุฏ ูุธุฑ ุงูุชุฎุงุจ ุดููุฏ. 
<br>


ุฏุฑ ุงู ูุฏูโูุงุ ูุฑูุฏ ุญุฌู ุฒุงุฏ ุงุฒ ุงุณูุงุฏ ุจุงุฒุงุจโุดุฏู ุจู ูุฏู ุฒุจุงู ูโุชูุงูุฏ ุจุงุนุซ ุณุฑุฏุฑฺฏู ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ ุดูุฏ. ุจูโูฺู ุฒูุงู ฺฉู ุงุณูุงุฏ ุดุงูู ุงุทูุงุนุงุช ุจุงุดูุฏ ฺฉู ูุงูุฏ ุงูุณุฌุงู ูุนูุง ุง ุงุฑุชุจุงุท ุณุงุฎุชุงุฑ ุจุงุดูุฏุ ูุฏู ูุงุฏุฑ ุจู ุงุณุชูุชุงุฌ ุฏูู ูุฎูุงูุฏ ุจูุฏ. ุงู ูุถุนุช ููุฌุฑ ุจู ุจุฑูุฒ ููุต ุฏุฑ ุฒูุฌุฑูโ ุงุณุชุฏูุงู ุง ููุงู ยซุญูููโ ููููุฏูยป ุฏุฑ ูพุงุณุฎโุฏู ูโุดูุฏ.
<br>

ุฏุฑ ููุงุจูุ ูุนูุงุฑ RAG ููโุงูุฒุงุงูู ุจุง ุจูุฑูโฺฏุฑ ุงุฒ ุงุณุชุฏูุงู ฺูุฏูุฑุญููโุงุ ุชุฌุฒูโ ูุฏูููุฏ ูพุฑุณุดุ ู ุจุงุฒุงุจ ูุจุชู ุจุฑ ุฒูุฌุฑูโ ููุทูุ ุชูุงุด ูโฺฉูุฏ ุชุง ุงู ฺุงูุดโูุง ุฑุง ุจุฑุทุฑู ฺฉูุฏ ู ูพุงุณุฎโูุง ุฏููโุชุฑ ู ููุณุฌูโุชุฑ ุงุฑุงุฆู ุฏูุฏ.
<br>

ุจุง ุงู ุชูุงุณุฑุ ููโุงูุฒุง ุฏุฑ ูุนูุงุฑ RAG ุงุฒ ุทุฑู ุชุฑฺฉุจ ุชูุงูุงโูุง ุงุณุชุฏูุงู ูุฏู ุจุง ูุทุนุงุช ูุนูุง [^12] ุจุงุฒุงุจโุดุฏูุ ููุฌุจ ูโุดูุฏ ฺฉู ูุฏู ุฒุจุงู ุจุชูุงูุฏ ููุงููุฏ ฺฉ ูุญูู ุฎุจุฑูุ ูพุงุณุฎ ฺฉ ูุณุฆูู ุฑุง ุฏุฑ ูุงู ุงุณูุงุฏ ูุชุนุฏุฏ ุฌุณุชุฌู ฺฉุฑุฏูุ ูุฑุชุจุทโุชุฑู ุจุฎุดโูุง ุฑุง ุฏุฑ ฺฉูุงุฑ ฺฉุฏฺฏุฑ ูุฑุงุฑ ุฏูุฏุ ู ุฏุฑ ููุงุช ุงุฒ ูุงู ุงู ุงุทูุงุนุงุช ุจู ูุชุฌูโฺฏุฑ ู ุงุณุชุฏูุงู ููุง ุจุฑุณุฏ.
<br>

ุงู ุฑูฺฉุฑุฏ ุญุช ุงูฺฉุงู ุชุตููโฺฏุฑ ุณุณุชูุงุชฺฉ ุฑุง ุจุฑุง ูุฏู ูุฑุงูู ูโุณุงุฒุฏ ู ูุนูุงุฑ RAG ุฑุง ุงุฒ ฺฉ ุงุจุฒุงุฑ ูููุนู [^13] ุตุฑูุงู ุชุญููุงุชุ ุจู ฺฉ ุฏุณุชุงุฑ ุดูุงุฎุช ูุนุงู ู ุชุดุฎุตโุฏููุฏู ุชุจุฏู ูโฺฉูุฏ ฺฉู ูุงุฏุฑ ุงุณุช ูุงุฒูุง ุถูู ฺฉุงุฑุจุฑ ุฑุง ูุฒ ูพุดโุจู ู ูพุงุณุฎโฺฏู ฺฉูุฏ.
<br>
<br>

![ุชุตูุฑ ด - ุฑููุฏ ุชุญููุงุช RAG ูู ุงูุฒุง](/assets/patterneffort/synergistic-rag/media/fig4.jpeg)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ด โ ุฑููุฏ ุชุบุฑ ุฑูฺฉุฑุฏ ูุง RAG ุฏุฑ ุณุงู ูุง ุงุฎุฑ ุงุฒ ุจุงุฒุงุจ ุณุงุฏู ุจู ุณูุช ููโุงูุฒุง ุจุง ุชูุฌู ุจู ุงูุชุดุงุฑ ูุฏู ูุง ุฒุจุงู ูุทุฑุญ โ ููุงูู [9]	</sub>
</p>
<br>

---
## ูุนูุงุฑ ูพุดููุงุฏ
&nbsp;&nbsp;&nbsp;ููุงูโุทูุฑ ฺฉู ูพุดโุชุฑ ุงุดุงุฑู ุดุฏุ ูุนูุงุฑ RAG ุฏุฑ ฺฉุงุฑุจุฑุฏูุง ุชุญููุงุช ู ูุทุงูุนูโ ุงุฏุจุงุช ุขฺฉุงุฏูฺฉ [^14] ููุด ุจุณุฒุง ุงูุง ูโฺฉูุฏ. ุงุฒ ุฌููู ูููููโูุง ูููู ุฏุฑ ุงู ุฒููู ูโุชูุงู ุจู ูุฑูโูุฑฺฉ MKRAG ุงุดุงุฑู ฺฉุฑุฏ ฺฉู ุจุง ูุงุจูุช ุชุฌูุน ุงูุชูโูุง ุงุฒ ููุงุจุน ุฏุงูุดุ ุฏุฑ ูุฑุขูุฏ ุชููุฏ ูพุงุณุฎ ุฏุฑ ุญูุฒูโ ูพุฒุดฺฉ ุจูโฺฉุงุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช. [11]<br>

ููฺููุ ูุฏูโูุง ุจุง ุฑูฺฉุฑุฏ ุงุณุชุฏูุงู ููุฑุฏูุญูุฑ [^15] ุฏุฑ ุญูุฒูโ ุจุฑุฑุณ ูพุฑููุฏูโูุง ุญููู ุชูุณุนู ุงูุชูโุงูุฏ [12] ฺฉู ุจุง ุชููู ุงุทูุงุนุงุช ุฒูููโุง ู ุชุญูู ููุทูุ ูพุงุณุฎโูุง ุฏูู ู ุณุงุฎุชุงุฑุงูุชู ุงุฑุงุฆู ูโุฏููุฏุ ููุงุฑุฏ ูุดุงุจู ุฏฺฏุฑ ูุฒ ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุฏุฑ ูุชู ุงุตู ููุงููโ Aytar ููุตูโุชุฑ ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ฺฏุฑูุชูโุงูุฏ.<br>
<br>

ุจู ุนูุงููุ ุจูโููุธูุฑ ูพุงุณุฎโฺฏู ุจู ฺุงูุดโูุง ูุนูุงุฑ RAGุ ููุณูุฏฺฏุงู ููุงูู ูพุดุฑูุชโูุง ุงุฑุงุฆูโุดุฏู ุฏุฑ ูพฺููุดโูุง ุงุฎุฑ ุฑุง ููุฑุฏ ุชูุฌู ู ุจุฑุฑุณ ูุฑุงุฑ ุฏุงุฏูโุงูุฏ. ุงุฒ ุฌููู ูููโุชุฑู ุงู ุฑูฺฉุฑุฏูุง ูโุชูุงู ุจู ููุงุฑุฏ ุฒุฑ ุงุดุงุฑู ฺฉุฑุฏ:<br>

&nbsp; ฑ- ุฑูุด ุจุงุฒุงุจ ุนุจุงุฑุงุช ูุชุฑุงฺฉู [^16] (DPR) [13]: ุงู ุฑูุด ูุนูุงุฑโุง ุดุงูู ุฏู ุงูฺฉูุฏุฑ BERT ุฑุง ูุนุฑู ูโฺฉูุฏุ ฺฉ ุงูฺฉูุฏุฑ ุจุฑุง ูพุฑุณุดโูุง ู ุฏฺฏุฑ ุจุฑุง ูุชูู ุจุงุฒุงุจโุดุฏู. ุจุง ุจูุฑูโฺฏุฑ ุงุฒ ุงุฏฺฏุฑ ุชุถุงุฏุขูุฒ [^17]ุ ุดุจุงูุชโูุง ูุนูุง ูุงู ูพุฑุณุด ู ูุชู ุจุง ุฏูุช ุจุดุชุฑ ุดูุงุณุง ูโุดููุฏ.<br>
&nbsp; ฒ- ุฑูุด ุฌุงููุง ุงุณูุงุฏ ูุฑุถ [^18]  (HyDE): ุฏุฑ ุงู ุฑูฺฉุฑุฏุ ุงุจุชุฏุง ุงุณูุงุฏ ูุฑุถ ุชููุฏ ูโุดููุฏ ฺฉู ุจูโุทูุฑ ุจุงูููู ูโุชูุงููุฏ ูพุงุณุฎ ูพุฑุณุด ุฑุง ุฏุฑ ุฎูุฏ ุฏุงุดุชู ุจุงุดูุฏ. ุณูพุณ ุงู ุงุณูุงุฏ ุจุง ูุชูู ูุงูุน ููุงุณู ุดุฏู ู ูุชุงุฌ ุจุงุฒุงุจ ุจูููโุณุงุฒ ูโฺฏุฑุฏูุฏ.<br>
&nbsp; ณ- ุฑูฺฉุฑุฏูุง ุฑุชุจูโุจูุฏ [^19] [14]: ุจุฑุง ุงูุฒุงุด ุฏูุช ุฏุฑ ุจุงุฒุงุจุ ุงุจุชุฏุง ูุฌููุนูโุง ุงุฒ ูุชูู ูุฑุชุจุท ุงูุชุฎุงุจ ุดุฏู ู ุณูพุณ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ุฏููโุชุฑุ ุฑุชุจูโุจูุฏ ูุฌุฏุฏ ุขูโูุง ุงูุฌุงู ูโุดูุฏ ุชุง ูุฑุชุจุทโุชุฑู ูพุงุณุฎโูุง ุฏุฑ ุงูููุช ูุฑุงุฑ ฺฏุฑูุฏ.<br>
&nbsp; ด- ุชฺฉูฺฉโูุง ุจุณุท ฺูุฏ ฺฉูุฆุฑ [^20] [15]: ุงู ุฑูุด ูุฏู ุฒุจุงู ุฑุง ูุงุฏุฑ ูโุณุงุฒุฏ ุชุง ุจุง ุชููุฏ ฺูุฏู ูุณุฎู ุจุงุฒููุณโุดุฏู ุงุฒ ูพุฑุณุด ุงูููุ ูุชุงุฌ ูุชููุนโุชุฑ ุฑุง ุจุงุฒุงุจ ฺฉุฑุฏู ู ูุดฺฉูุงุช ูุงููุฏ ุงุจูุงู ูุนูุง ุง ุนุฏู ุชุทุงุจู ูุงฺฺฏุงู ุฑุง ูพูุดุด ุฏูุฏ.<br><br>
ููุณูุฏฺฏุงู ุงู ููุงููุ ุจุฑุง ูพุงุณุฎโฺฏู ุจู ูุญุฏูุฏุชโูุง ูุนูุงุฑโูุง RAG ุณูุช ู ุงุณุชุงูุฏุงุฑุฏ ู ฺฉู ูพุดโุชุฑ ุจู ุขูโูุง ุงุดุงุฑู ุดุฏ (ุงุฒ ุฌููู ุณุฑุจุงุฑ ุงุทูุงุนุงุชุ ุถุนู ุฏุฑ ุงุฑุชุจุงุท ููุงูุชูโูุง ุจุงุฒุงุจโุดุฏู ู ฺุงูุด ูุงุณุงุฒฺฏุงุฑโูุง ุฌุฒุฆ ุญูุฒูโูุญูุฑ) ู ุงุฒ ุฑูุดโูุง ููู ุงุฏุดุฏู ุงูฺฏูุจุฑุฏุงุฑ ฺฉุฑุฏูโุงูุฏ. ุจุฑ ุงุณุงุณ ุงู ุฑูฺฉุฑุฏุ ุขูโูุง ฺฉ ูุนูุงุฑ ูพูุฌโูุฑุญููโุง ุงุฑุงุฆู ฺฉุฑุฏูโุงูุฏ ฺฉู ุจูโุตูุฑุช ููโุงูุฒุงุงูู ุทุฑุงุญ ุดุฏู ู ูุฏู ุขู ุงุฑุชูุง ุฏูุชุ ุงูุณุฌุงู ูุนูุง ู ฺฉุงุฑุง ุฏุฑ ุจุงุฒุงุจ ู ุชููุฏ ูพุงุณุฎโูุง ุนูู ุงุณุช. 
<br>

![ุชุตูุฑ ต - ูุนูุงุฑ RAG ุณุงุฏู](/assets/patterneffort/synergistic-rag/media/fig5.jpeg)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ต โ ูุนูุงุฑ RAG ุณุงุฏู</sub>
</p>

<br>

![ุชุตูุฑ ถ - ูุนูุงุฑ RAG ููุงูู](/assets/patterneffort/synergistic-rag/media/fig6.jpeg)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ถ โ ูุนูุงุฑ ูพุดููุงุฏ ุดุฏู ุฏุฑ ููุงูู Aytar</sub>
</p>

<br>

### ูุฑุงุญู ูุนูุงุฑ ูพุดููุงุฏ
ุจุฑ ุงุณุงุณ ุชุตูุฑ ุดูุงุฑู ถุ ุฑูุด ุงุฑุงุฆูโุดุฏู ุดุงูู ูพูุฌ ูุฑุญููโ ุงุตู ุงุณุช:<br>
<br>
&nbsp; ฑ- ูพุดโูพุฑุฏุงุฒุด ู ูพุงฺฉโุณุงุฒ ุงุทูุงุนุงุช ููุจุน ุฏุงุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑ GROBID.<br>
&nbsp; ฒ- ูุงูโุชูู ู ุชูุธู ูุฌุฏุฏ ูุฏูโูุง embedding ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง ูุฑุฌุน ุชุฎุตุต.<br>
&nbsp; ณ- ูุทุนูโุจูุฏ ูุนูุง (Semantic Chunking) ุจุฑุง ุญูุธ ุงูุณุฌุงู ู ุงุฑุชุจุงุท ููููู ุฏุฑ ุฏุงุฏูโูุง ููุจุน.<br>
&nbsp; ด- ุจูโฺฉุงุฑฺฏุฑ ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู [^21] ุฏุฑ ูุฑุขูุฏ ุจุงุฒุงุจ ุงุทูุงุนุงุช.<br>
&nbsp; ต- ุงุณุชูุงุฏู ุงุฒ ุชฺฉูฺฉโูุง ุฏุณุชูุฑ ุจูููโุดุฏู [^22] ุฏุฑ ุนููุงุช ูพุฑุณุด ฺฉุงุฑุจุฑ.<br>
<br>
ูุฑ ฺฉ ุงุฒ ุงู ูุฑุงุญู ุฏุฑ ุจุฎุด ยซูพุงุฏูโุณุงุฒยป ุจูโุตูุฑุช ููุตูโุชุฑ ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ุฎูุงููุฏ ฺฏุฑูุช.

---
## ูพุงุฏู ุณุงุฒ: ุขูุงุฏู ุณุงุฒ ุฏุงุฏู ูุง
### ุฌูุน ุขูุฑ ุงุทูุงุนุงุช ู ูพุด ูพุฑุฏุงุฒุด
ููุณูุฏฺฏุงู ุงู ููุงูู ุจุฑุง ุฌูุนโุขูุฑ ุฏุงุฏูโูุง ููุฑุฏ ุงุณุชูุงุฏู ุฏุฑ ูุฏู ู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุขูุ ูุฌููุนูโุง ุดุงูู ตฐ ูพุฑุณุด ุจู ููุฑุงู ูพุงุณุฎโูุง ูุฑุฌุน ุทุฑุงุญ ฺฉุฑุฏูโุงูุฏ ุชุง ุงูฺฉุงู ููุงุณู ูุชุงุฌ ูุฑุงูู ุดูุฏ. ุงู ูพุฑุณุดโูุง ุงุฒ ููุถูุนุงุช ูุชููุน ููฺูู ูุฎุงุจุฑุงุชุ ฺฉุดุงูุฑุฒุ ูุงู ู ุณุงุฑ ุญูุฒูโูุง ุงูุชุฎุงุจ ุดุฏูโุงูุฏ.<br>

ุจูโุนูุงููุ ุทุฑุงุญ ูพุฑุณุดโูุง ุจูโฺฏูููโุง ุงูุฌุงู ุดุฏู ุงุณุช ฺฉู ุณู ูุฑุญููโ ุงุตู ุงุฒ ูุฑูโูุฑฺฉ CRISP-DM [16]  ู ฺฉ ุงุฒ ูุฏูโูุง ุดูุงุฎุชูโุดุฏู ุฏุฑ ุญูุฒูโ ุฏุงุฏูโฺฉุงู ู ุฑุง ูพูุดุด ุฏูุฏ:<br>

&nbsp; โข	ูุฑุญูู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง: ุดุงูู ฑฐ ูพุฑุณุด.<br>
&nbsp; โข	ูุฑุญูู ูุฏูโุณุงุฒ: ุดุงูู ณต ูพุฑุณุด.<br>
&nbsp; โข	ูุฑุญูู ุงุฑุฒุงุจ: ุดุงูู ต ูพุฑุณุด.<br>

ุงู ุชูุณูโุจูุฏ ููุฌุจ ูโุดูุฏ ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ูุนูุงุฑ ูพุดููุงุฏ ุฏุฑ ุชูุงู ูุฑุงุญู ฺฉูุฏ ูุฑุขูุฏ ุฏุงุฏูโฺฉุงู ุตูุฑุช ฺฏุฑุฏ ู ูุชุงุฌ ุจูโุตูุฑุช ุฌุงูุนโุชุฑ ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ฺฏุฑูุฏ.

<br>

#### ุจู ุตูุฑุช ุฏูู ุชุฑ: <br>


&nbsp;ฑ- ูุฑุญูู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง:<br><br>
&nbsp;&nbsp;&nbsp;โข	ุงูุชุฎุงุจ ูฺฺฏโูุง: ณ ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ุญุฐู ุฏุงุฏูโูุง ูพุฑุช: ฒ ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉุงูุด ุงุจุนุงุฏ: ต ูพุฑุณุด<br>

<br>


&nbsp;ฒ- ูุฑุญูู ูุฏูโุณุงุฒ: <br><br>
&nbsp;&nbsp;&nbsp;โข	ุชููุฏ ุฏุงุฏูโูุง ุชุฑฺฉุจ: ณ ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุณุชูโุจูุฏ(Classification): ต ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ุฑฺฏุฑุณูู(Regression): ต ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ุฎูุดูโุจูุฏ(Clustering): ต ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ุงุฏฺฏุฑ ุชููุช(Reinforcement Learning): ฒ ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ุชุดุฎุต ุชุตุงูุฑ(Image Recognition): ต ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ูพุฑุฏุงุฒุด ุฒุจุงู ุทุจุน (NLP): ต ูพุฑุณุด<br>
&nbsp;&nbsp;&nbsp;โข	ุชุญูู ุณุฑโูุง ุฒูุงู(Time Series Analysis) : ต ูพุฑุณุด<br>

<br>



&nbsp;ณ- ูุฑุญูู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ูุฏู:<br>
&nbsp;&nbsp;&nbsp;โข	ุงุฎุชุตุงุต ต ูพุฑุณุด ุจุฑุง ุณูุฌุด ฺฉูุช ู ุฏูุช ูุชุงุฌ.<br>

<br>

<br>

 ุณูพุณ ููุณูุฏฺฏุงู ููุงููุ ุจุง ุชูุฌู ุจู ูพุฑุณุดโูุง ุทุฑุงุญโุดุฏูุ ูุฑ ูพุฑุณุด ุฑุง ุจู ฺฉูฺฉ ูุฏู GPT-4o ุจู ุณู ุจุฎุด ุงุตู ุชุจุฏู ฺฉุฑุฏูุฏ:
<br>
<br>
&nbsp;โข	ุชุงูพฺฉ ุงุตู [^23]<br>
&nbsp;โข	ุญูุฒูโูุง ฺฉุงุฑุจุฑุฏ [^24]<br>
&nbsp;โข	ุงูุฒุงูุงุช ูุดุฎุต [^25] <br>

ุจุฑ ุงุณุงุณ ููุถูุนุงุช ุงุณุชุฎุฑุงุฌโุดุฏูุ ููุงูุงุช ูุฑุชุจุท ุจุฑุง ูุฑ ูพุฑุณุด ุงุฒ ุทุฑู ุฑุงุจุท ุจุฑูุงููโููุณ `arXiv API` ุฏุฑุงูุช ุดุฏูุฏ. ุฏุฑ ูุฌููุน ุญุฏูุฏ ตฐฐฐ ููุงูู ุฏุฑ ูุงูุจ ูุงูโูุง PDF ฺฏุฑุฏุขูุฑ ุดุฏ ุชุง ุจูโุนููุงู ููุจุน ุฏุงุฏู ุจุฑุง ูุฑุงุญู ุจุนุฏ ูุนูุงุฑ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑูุฏ.<br>

&nbsp;&nbsp;&nbsp;ุจุง ุชูุฌู ุจู ุงููุช ูุฑุญููโ ุงุฑุฒุงุจุ ูุงุฒู ุงุณุช ูพุฑุณุดโูุง ุทุฑุงุญโุดุฏู ู ูพุงุณุฎโูุง ูุฑุฌุน ุงุฒ ุตุญุช ู ุฏูุช ุจุงูุง ุจุฑุฎูุฑุฏุงุฑ ุจุงุดูุฏ. ุจูโููุธูุฑ ุงุทููุงู ุจุดุชุฑ ุฏุฑ ูพุงุฏูโุณุงุฒ ููุงููุ ุงุจุชุฏุง ููุฑุณุช ุดุงูู ุญุฏูุฏ ตฐฐฐ ููุงูู ุงุฒ ููุถูุนุงุช ูุฎุชูู ุงุฒ ุทุฑู ุฑุงุจุท ุจุฑูุงููโููุณ `arXiv API` ฺฏุฑุฏุขูุฑ ุดุฏ ู ุณูพุณ ูุณุฎูโูุง ุขููโ [^26] ุขูโูุง ุงุฒ ุทุฑู ูพุงฺฏุงู ุฏุงุฏูโ ฺฏูฺฏู ุจุงุฑฺฏุฑ ฺฏุฑุฏุฏ.

<br>

ุฏุฑ ุงุฏุงููุ ุจุง ุงุณุชูุงุฏู ุงุฒ ตฐ ูพุฑุณุด ุทุฑุงุญโุดุฏู ุชูุณุท ููุณูุฏฺฏุงูุ ูพุงุณุฎโูุง ุชููุฏุดุฏู ุชูุณุท ูุฏูโูุง ุฒุจุงู ูุฎุชูู ููุฑุฏ ุงุฑุฒุงุจ ู ููุงุณู ูุฑุงุฑ ฺฏุฑูุชูุฏ. ูุชุงุฌ ุงู ููุงุณู ุฏุฑ ุจุฎุด ยซูุชุงุฌยป ุจูโุตูุฑุช ุชูุตู ุงุฑุงุฆู ุฎูุงูุฏ ุดุฏ.

<br>

ุจุฑุง ุฏุฑุงูุช ููุงูุงุชุ ุงุจุชุฏุง ูุงุฒู ุงุณุช ุงุจุฒุงุฑูุง ู ฺฉุชุงุจุฎุงููโูุง ููุฑุฏ ูุงุฒ ูุตุจ ุดููุฏ:<br>


&nbsp; **ฑ- ุงุจุฒุงุฑ gsutil:** ุงู ุงุจุฒุงุฑ ฺฉู ุชูุณุท Google Cloud ุงุฑุงุฆู ุดุฏู ุงุณุช [17]ุ ุงูฺฉุงู ูุฏุฑุช ุญุงูุธูโูุง ุงุจุฑ ุฑุง ูุฑุงูู ูโฺฉูุฏ. ุงุฒ ุทุฑู ุขู ูโุชูุงู ุนููุงุชโูุง ูุงููุฏ ุจุงุฑฺฏุฑ [^27] ุ ุจุงุฑฺฏุฐุงุฑ [^28] ู ุณุงุฑ ุชุนุงููุงุช ูุฑุชุจุท ุจุง ูุณุชโูุง ุณุทู [^29] ุฑุง ุงุฒ ุทุฑู ุฎุท ูุฑูุงู ุงุฌุฑุง ฺฉุฑุฏ.

<br>

ุจุฑุง ูุตุจ ู ุฑุงูโุงูุฏุงุฒ ุงุจุฒุงุฑ gsutil ูุฑุงุญู ุฒุฑ ุฏูุจุงู ูโุดููุฏ:
<br>

&nbsp;-**ุฏุฑ ุณุณุชู ุนุงูู ููุฏูุฒ:**
<br>
&nbsp;&nbsp;&nbsp;ูุงู ูุตุจ Google Cloud CLI ุฑุง ุงุฒ ููฺฉ ุฒุฑ ุฏุฑุงูุช ฺฉุฑุฏู:

[https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe](https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe)

<br>

&nbsp;&nbsp;&nbsp;ุง ูโุชูุงู ุฏุฑ PowerShell ุฏุณุชูุฑ ุฒุฑ ุฑุง ูุงุฑุฏ ฺฉุฑุฏ:
<br>

```Powershell
(New-Object Net.WebClient).DownloadFile("https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe", "$env:Temp\GoogleCloudSDKInstaller.exe")

$env:Temp\GoogleCloudSDKInstaller.exe
```
<br>

&nbsp;-**ุฑุงูููุง ูุตุจ ุจุฑุง ุณุงุฑ ุณุณุชูโุนุงููโูุง ู ุชูุฒุนโูุง ูููฺฉุณ ุฏุฑ ููฺฉ ุฒุฑ ุฏุฑ ุฏุณุชุฑุณ ุงุณุช:**

[https://cloud.google.com/storage/docs/gsutil_install](https://cloud.google.com/storage/docs/gsutil_install)

<br>

&nbsp; **ฒ- ฺฉุชุงุจุฎุงููโ feedparser:** ุงู ฺฉุชุงุจุฎุงูู ุฏุฑ ุฒุจุงู Python ุจุฑุง ูพุฑุฏุงุฒุด ู ุชุฌุฒูโ ูุฏูุง RSS ู Atom ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ ู ุงูฺฉุงู ุงุณุชุฎุฑุงุฌ ู ูุฏุฑุช ุฏุงุฏูโูุง ููุชุดุฑุดุฏู ุฏุฑ ุงู ูุฏูุง ุฑุง ูุฑุงูู ูโุณุงุฒุฏ. ุจุฑุง ูุตุจ ุงู ฺฉุชุงุจุฎุงูู ฺฉุงู ุงุณุช ุชุง ุฏุณุชูุฑ pip install feedparser  ุฏุฑ ูุญุท ุฎุท ูุฑูุงู ูพุงุชูู ุงุฌุฑุง ุดูุฏ.

<br>

### ุฏุฑุงูุช ููุงูุงุช
ฺฉุฏ ุฒุฑ ูุญูู  ุฏุฑุงูุช ููุงูุงุช ุฑุง ูุดุงู ูโุฏูุฏ:

```python
import feedparser
import os
import time
import json
from collections import defaultdict

MAX_TOTAL_PAPERS = 5200
CATEGORIES = ["cs.LG", "stat.ML", "cs.CL", "cs.AI", "cs.CV", "cs.NE", "cs.IR", "cs.CR", "cs.SE", "cs.SI"]
BATCH_SIZE = 100
category_papers = defaultdict(list)

```

<br>

ุฏุฑ ุงุจุชุฏุง ฺฉุฏุ ฺฉุชุงุจุฎุงููโูุง ููุฑุฏ ูุงุฒ ุจุฑุง ุงุฌุฑุง ุนููุงุช ูุฑุงุฎูุงู ูโุดููุฏ. ุงู ฺฉุชุงุจุฎุงููโูุง ุดุงูู ุงุจุฒุงุฑูุง ุจุฑุง ูพุฑุฏุงุฒุด ูุฏูุงุ ูุฏุฑุช ูุงูโูุงุ ุฒูุงูโุจูุฏุ ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง JSON ู ุณุงุฎุชุงุฑูุง ุฏุงุฏูโุง ูพุดุฑูุชู ูุณุชูุฏ.<br>
ูพุณ ุงุฒ ุขูุ ูุชุบุฑูุง ุงุตู ุจุฑุง ฺฉูุชุฑู ูุฑุขูุฏ ุฏุฑุงูุช ููุงูุงุช ุชุนุฑู ูโุดููุฏ:

<br>
โข	MAX_TOTAL_PAPERS: ุงู ูุชุบุฑ ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ููุงูุงุช ุฑุง ฺฉู ุจุงุฏ ุงุฒ ูพุงฺฏุงู ุฏุงุฏู ุฏุฑุงูุช ุดููุฏ ูุดุฎุต ูโฺฉูุฏ (ุฏุฑ ุงูุฌุง ตฒฐฐ ููุงูู). <br>
โข	CATEGORIES: ุฏุฑ ุงู ูุชุบุฑุ ููุฑุณุช ุงุฒ ุฏุณุชูโุจูุฏโูุง ู ููุถูุนุงุช ุนูู ููุฑุฏ ูุธุฑ ุชุนุฑู ุดุฏู ุงุณุชุ ูุงููุฏ ุงุฏฺฏุฑ ูุงุดูุ ููุด ูุตููุนุ ุจูุง ูุงุดูุ ูพุฑุฏุงุฒุด ุฒุจุงู ุทุจุน ู ุณุงุฑ ุญูุฒูโูุง ูุฑุชุจุท.<br>
โข	BATCH_SIZE: ุงู ูุชุบุฑ ุงูุฏุงุฒูโ ูุฑ ุฏุณุชูโ ุจุงุฑฺฏุฑ ููุงูุงุช ุฑุง ุชุนู ูโฺฉูุฏ (ุฏุฑ ุงูุฌุง ฑฐฐ ููุงูู ุฏุฑ ูุฑ ุจุงุฑฺฏุฑ). ุจุณุชูโุจูุฏ ุฏุงุฏูโูุง ุนูุงูู ุจุฑ ูุฏุฑุช ุจูุชุฑ ููุงุจุน ุณุณุชูุ ููุด ููู ุฏุฑ ุงูุฒุงุด ุณุฑุนุช ุฌูุนโุขูุฑ ุงุทูุงุนุงุช ู ุฏุฑุงูุช ููุงูุงุช ุฏุงุฑุฏ. ุจู ุงู ุชุฑุชุจุ ุจูโุฌุง ูพุฑุฏุงุฒุด ฺฉู ุฏุงุฏูโูุง ุจูโุตูุฑุช ฺฉโุฌุงุ ุฏุงุฏูโูุง ุฏุฑ ุจุณุชูโูุง ฺฉูฺฺฉโุชุฑ ุชูุณู ุดุฏู ู ุจูโุตูุฑุช ูุฑุญููโุง ุจุงุฑฺฏุฑ ูโุดููุฏ. ุงู ุฑูุด ูู ูุดุงุฑ ุฑู ุญุงูุธู ู ูพุฑุฏุงุฒูุฏู ุฑุง ฺฉุงูุด ูโุฏูุฏ ู ูู ุงูฺฉุงู ฺฉูุชุฑู ุจูุชุฑ ุฌุฑุงู ุฏุงุฏูโูุง ุฑุง ูุฑุงูู ูโุณุงุฒุฏ.<br>
โข	category_papers: ฺฉ ุณุงุฎุชุงุฑ ุฏุงุฏูโุง ุงุฒ ููุน `defaultdict(list)` ุจุฑุง ุฐุฎุฑูโ ููุงูุงุช ุฏุฑุงูุชโุดุฏู ุจุฑ ุงุณุงุณ ุฏุณุชูโุจูุฏโูุง.
<br>

ูุฑ ฺฉุฏ ุงุฒ ููุฑุณุช ุฒุฑุ ูุนุฑู ฺฉ ุดุงุฎูโ ูพฺููุด ุฏุฑ ูพุงฺฏุงู ุฏุงุฏูโ arXiv ูโุจุงุดุฏ:

<br>



|                      ุนููุงู                     |     ฺฉุฏ ุฏุณุชู ุจูุฏ    |
|:----------------------------------------------:|:-------------------:|
|         Machine Learning (ุนููู ฺฉุงููพูุชุฑ)       |         cs.LG       |
|             Machine Learning (ุขูุงุฑ)            |        stat.ML      |
|             Computation and Language           |         cs.CL       |
|             Artificial Intelligence            |         cs.AI       |
|     Computer Vision and Pattern Recognition    |         cs.CV       |
|        Neural and Evolutionary Computing       |         cs.NE       |
|              Information Retrieval             |         cs.IR       |
|            Cryptography and Security           |         cs.CR       |
|               Software Engineering             |         cs.SE       |
|         Social and Information Networks        |         cs.SI       |




<sub>ุฌุฏูู ฑ โ ฺฉุฏ ูุง ูุฑุจูุท ุจู ุดุงุฎู ูุง ูพฺููุด ุฏุฑ arXiv</sub>


<br>

ุณูพุณ ุชุงุจุน `()fetch_metadata` ุจุฑุง ูุงฺฉุด ู ุฐุฎุฑูโุณุงุฒ ุงุทูุงุนุงุช ููุงูุงุช ุงุฒ ูพุงฺฏุงู ุฏุงุฏูโ arXiv  ุจู ุตูุฑุช ุฒุฑ ุชุนุฑู ูโุดูุฏ:

<br>

```python
def fetch_metadata():
    base_url = "http://export.arxiv.org/api/query?"
    total_collected = 0
    for cat in CATEGORIES:
        print(f"\n๐ Fetching category: {cat}")
        for start in range(0, 750, BATCH_SIZE):
            query = f"cat:{cat}"
            url = (
                f"{base_url}search_query={query}&start={start}&max_results={BATCH_SIZE}"
                f"&sortBy=submittedDate&sortOrder=descending"
            )

            feed = feedparser.parse(url)
            if len(feed.entries) == 0:
                print("  โ๏ธ No more results for this category.")
                break

            for e in feed.entries:
                pid = e.id.split("/")[-1]
                paper = {
                    "id": pid,
                    "title": e.title.strip(),
                    "published": e.published,
                    "category": cat,
                }
                category_papers[cat].append(paper)

            print(f"  โ Batch {start}-{start+BATCH_SIZE}, total={len(category_papers[cat])}")
            time.sleep(2)
    all_papers = []
    for cat in CATEGORIES:
        all_papers.extend(category_papers[cat])
    json.dump(all_papers, open("arxiv_papers.json", "w", encoding="utf-8"), indent=2)

    print("\n๐ Paper counts per category:")
    for cat in CATEGORIES:
        print(f"  - {cat}: {len(category_papers[cat])}")
    return category_papers
```

ููุงูโุทูุฑ ฺฉู ูุดุงูุฏู ูโุดูุฏุ ุชุงุจุน ูุชุงุฏุชุง ููุงูุงุช ุฑุง ุจุฑ ุงุณุงุณ ููุถูุนุงุช ุชุนุฑูโุดุฏู (cat) ุงุฒ arXiv API ุฌูุนโุขูุฑ ูโฺฉูุฏ. ุณูพุณ ุฏุงุฏูโูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุฏุฑ ูุงู `arxiv_papers.json` ุฐุฎุฑู ูโุดููุฏ. ุฏุฑ ุงุฏุงููุ ุชุนุฏุงุฏ ููุงูุงุช ุฏุฑุงูุชโุดุฏู ุจุฑุง ูุฑ ุฏุณุชูโุจูุฏ ููุงุด ุฏุงุฏู ุดุฏู ู ุฏุฑ ููุงุชุ ูุณุช ฺฉุงูู ููุงูุงุช ุฏุฑ ุณุงุฎุชุงุฑ `category_papers` ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ ุชุง ุฏุฑ ูุฑุงุญู ุจุนุฏ ูพุฑุฏุงุฒุด ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑุฏ.

<br>

ุฏุฑ ุงุฏุงููุ ุฏุฑ ุจุฎุด ุจุนุฏ ฺฉุฏุ ุชุงุจุน `()select_papers` ุชุนุฑู ุดุฏู ุงุณุช ฺฉู ูุธููโ ุงูุชุฎุงุจ ููุงูุงุช ููุฑุฏ ูุธุฑ ุงุฒ ูุงู ุฏุงุฏูโูุง ุฌูุนโุขูุฑโุดุฏู ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ:

```python
def select_papers(category_papers):
    selected = []
    total_available = sum(len(p) for p in category_papers.values())
    print(f"\n๐ฆ Total available papers: {total_available}")

    for cat in CATEGORIES:
        cat_count = len(category_papers[cat])
        share = int((cat_count / total_available) * MAX_TOTAL_PAPERS)
        selected.extend(category_papers[cat][:share])
        print(f"  โ Selected {share} papers from {cat}")

    print(f"\n๐ฏ Total selected for GCS path generation: {len(selected)}")
    return selected
```

ุฏุฑ ฺฉุฏ ุจุงูุงุโ ุฑููุฏ ุงุฌุฑุง ุงู ุชุงุจุน ุจู ุตูุฑุช ุฒุฑ ุงุณุช:<br>

&nbsp;โข	ุงุจุชุฏุง ูุฌููุน ฺฉู ููุงูุงุช ููุฌูุฏ ุฏุฑ ูููโ ุฏุณุชูโุจูุฏโูุง ูุญุงุณุจู ู ููุงุด ุฏุงุฏู ูโุดูุฏ.<br>
&nbsp;โข	ุณูพุณ ุจุฑุง ูุฑ ุฏุณุชูโุจูุฏุ ูุณุจุช ุชุนุฏุงุฏ ููุงูุงุช ุขู ุฏุณุชู ุจู ฺฉู ููุงูุงุช ูุญุงุณุจู ูโฺฏุฑุฏุฏ.<br>
&nbsp;โข	ุจุฑ ุงุณุงุณ ุงู ูุณุจุชุ ุณูู ูุฑ ุฏุณุชู ุงุฒ ููุฏุงุฑ ุขุณุชุงููโ ุชุนูโุดุฏู (MAX_TOTAL_PAPERS = 5200) ูุดุฎุต ูโุดูุฏ.<br>
&nbsp;โข	ุจู ุนููุงู ูุซุงูุ ุงฺฏุฑ ุฏุณุชูโ cs.LG ุญุฏูุฏ ฒฐูช ุงุฒ ฺฉู ทฐฐฐ ููุงููโ ุงููู ุฑุง ุชุดฺฉู ุฏูุฏุ ุฏุฑ ุงูุชุฎุงุจ ููุง ูุฒ ุญุฏูุฏ ฒฐูช ุงุฒ ตฒฐฐ ููุงููโ ูุฏู ุจู ุงู ุฏุณุชู ุงุฎุชุตุงุต ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.<br>
&nbsp;โข	ุฏุฑ ููุงุชุ ูุณุช ููุงูุงุช ุงูุชุฎุงุจโุดุฏู ุฏุฑ ุฎุฑูุฌ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ ุชุง ุจุฑุง ูุฑุงุญู ุจุนุฏ (ูุงููุฏ ุชููุฏ ูุณุฑูุง ุฐุฎุฑูโุณุงุฒ ุง ูพุฑุฏุงุฒุด ุจุดุชุฑ) ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑุฏ.<br>

<br>
ุณูพุณ ูุณุช ููุง ููุงูุงุช ุงูุชุฎุงุจโุดุฏู (ุฐุฎุฑูโุดุฏู ุฏุฑ ูุชุบุฑ selected) ุจู ุชุงุจุน ููุง ุงุฑุณุงู ูโุดูุฏ. ุงู ุชุงุจุน ูุธูู ุฏุงุฑุฏ ููฺฉโูุง ุฏุงูููุฏ ูุฑุจูุท ุจู ูุฑ ููุงูู ุฑุง ุงุฌุงุฏ ฺฉุฑุฏู ู ุจุฑุง ุงุณุชูุงุฏูโูุง ุจุนุฏ ุขูุงุฏู ุณุงุฒุฏ.

<br>

```python
def generate_gcs_paths(papers, output_file="gcs_paths.txt"):
    paths = []
    for p in papers:
        pid = p["id"]
        prefix = pid[:4]    
        gcs_path = f"gs://arxiv-dataset/arxiv/arxiv/pdf/{prefix}/{pid}.pdf"
        paths.append(gcs_path)

    with open(output_file, "w") as f:
        f.write("\n".join(paths))

    print(f"\nโ GCS paths saved in: {output_file}")
    print(f"๐ฅ To download, run:\n  gsutil -m cp -I ./pdfs < {output_file}")
```
ุชุงุจุน `()generate_gcs_paths` ูุธููโ ุชููุฏ ูุณุฑูุง ุฏุงูููุฏ ููุงูุงุช ุงุฒ ูุถุง ุงุจุฑGoogle Cloud Storage (GCS) ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ. ุฑููุฏ ุงุฌุฑุง ุงู ุชุงุจุน ุจู ุตูุฑุช ุฒุฑ ุงุณุช:

&nbsp;&nbsp;&nbsp;โข	ุงุจุชุฏุง ุจุฑุง ูุฑ ููุงููุ ุดูุงุณูโ ููุงูู (id) ุงุณุชุฎุฑุงุฌ ูโุดูุฏ.
<br>
&nbsp;&nbsp;&nbsp;โข	ุณูพุณ ฺูุงุฑ ุฑูู ุงุจุชุฏุง ุดูุงุณู ุจู ุนููุงู prefix ุฏุฑ ูุณุฑ ุฐุฎุฑูโุณุงุฒ ุงุณุชูุงุฏู ูโฺฏุฑุฏุฏ.
<br>
&nbsp;&nbsp;&nbsp;โข	ูุณุฑ ููุง ูุงู PDF ููุงูู ุจุฑ ุงุณุงุณ ูุงูุจ ุฒุฑ ุณุงุฎุชู ูโุดูุฏ:<br>
```terminal
gs://arxiv-dataset/arxiv/arxiv/pdf/{prefix}/{id}.pdf
```
&nbsp;&nbsp;&nbsp;โข	ู	ูููโ ูุณุฑูุง ุณุงุฎุชูโุดุฏู ุฏุฑ ฺฉ ูุณุช ุฌูุนโุขูุฑ ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ูพุงุงูุ ุงู ูุณุช ุฏุฑ ูุงู ูุชู `gcs_paths.txt` ุฐุฎุฑู ูโุดูุฏ ุชุง ุฏุฑ ูุฑุงุญู ุจุนุฏ ุจุฑุง ุฏุงูููุฏ ุฏุณุชูโุง ููุงูุงุช ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููฺูู ุฏุณุชูุฑ ูููููโุง ุจุฑุง ุฏุงูููุฏ ูุงูโูุง ุจุง ุงุจุฒุงุฑ gsutil ฺุงูพ ูโุดูุฏ ุชุง ฺฉุงุฑุจุฑ ุจุชูุงูุฏ ููุงูุงุช ุฑุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑุงูุช ฺฉูุฏ.<br>


ุฏุฑ ูพุงุงู ุงู ฺฉุฏุ pipeline ุฏุณุชูุฑุงุช ูุฑุงุฎูุงู ุชูุงุจุน ููุดุชู ุดุฏู ู ุณูพุณ ูุงู .py ุงู ฺฉุฏ ูพุงุชูู ุงุฌุฑุง ูโฺฏุฑุฏุฏ.

```python
if __name__ == "__main__":
    category_papers = fetch_metadata()
    selected_papers = select_papers(category_papers)
    generate_gcs_paths(selected_papers)
```
<br>
ุฎุฑูุฌ ุงุฌุฑุง ุงู ุจุฑูุงูู ุจู ุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ:

```terminal
(venv) /root/myprojects/synergisticrag/download_arxiv_pdfs.py

๐ Fetching category: cs.LG
  โ Batch 0-100, total=100
  โ Batch 100-200, total=200
  โ๏ธ No more results for this category.
.
...
.....

๐ Paper counts per category:
  - cs.LG: 200
  - stat.ML: 400
  - cs.CL: 400
  - cs.AI: 100
  - cs.CV: 100
  - cs.NE: 500
  - cs.IR: 300
  - cs.CR: 300
  - cs.SE: 500
  - cs.SI: 800

๐ฆ Total available papers: 3600
  โ Selected 288 papers from cs.LG
  โ Selected 577 papers from stat.ML
  โ Selected 577 papers from cs.CL
  โ Selected 144 papers from cs.AI
  โ Selected 144 papers from cs.CV
  โ Selected 722 papers from cs.NE
  โ Selected 433 papers from cs.IR
  โ Selected 433 papers from cs.CR
  โ Selected 722 papers from cs.SE
  โ Selected 1155 papers from cs.SI

๐ฏ Total selected for GCS path generation: 5200
โ GCS paths saved in: gcs_paths.txt
๐ฅ To download, run:
  gsutil -m cp -I ./pdfs < gcs_paths.txt
```
<br>

ุณูพุณ ุจุง ุงุฌุฑุง ุฏุณุชูุฑ `gsutil -m cp -I ./pdfs < gcs_paths.txt` ุฏุฑ ุชุฑููุงู (powershell ุง Bash) ููุงูุงุช ุฏุฑุงูุช ูโุดููุฏ.
<br>
ูุชุฌู  ุงุฌุฑุง ุฏุณุชูุฑ ูุดุงุจู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:


![ุชุตูุฑ ท โ ุชุฑููุงู bash ุฏุฑ ุญุงู ุงุฌุฑุง ุฏุณุชูุฑ gsutil](/assets/patterneffort/synergistic-rag/media/fig7.jpeg)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ท โ ุชุฑููุงู bash ุฏุฑ ุญุงู ุงุฌุฑุง ุฏุณุชูุฑ gsutil</sub>
</p>

<br>

---
## ูพุดโูพุฑุฏุงุฒุด ุงุทูุงุนุงุช
ูพุณ ุงุฒ ุฏุฑุงูุช ูุงูโูุง ููุงูุงุช ู ูุฑุงุฑ ุฏุงุฏู ุขูโูุง ุฏุฑ ูพูุดูโ pdfsุ ูุฑุญููโ ูพุดโูพุฑุฏุงุฒุด ุขุบุงุฒ ูโุดูุฏ. ุฏุฑ ุงู ูุฑุญููุ ูุฑูุช ููุงูุงุช ุงุฒ PDF ุจู TEI ุชุจุฏู ุฎูุงูุฏ ุดุฏ.

<br>
ุจุฑุง ูพุดโูพุฑุฏุงุฒุด ู ุชุจุฏู ูุงูโูุง PDF ุจู ูุฑูุชโูุง ูุชู ูุงููุฏ txtุ xml ุง ุณุงุฑ ูุงูุจโูุง ูุงุจู ูพุฑุฏุงุฒุดุ ุงุจุฒุงุฑูุง ูุชููุน ุงุฑุงุฆู ุดุฏูโุงูุฏ.<br>

&nbsp;โข	ุงุจุฒุงุฑูุง ุนููู ุจุฑุง ุชุจุฏู ูุฑูุช:<br>

&nbsp;&nbsp;&nbsp;o	ุงุจุฒุงุฑ PyMuPDF<br>
&nbsp;&nbsp;&nbsp;o	ุงุจุฒุงุฑ PDFplumber<br>
&nbsp;&nbsp;&nbsp;o	ุงุจุฒุงุฑ PyPDF2<br>

ุงู ุงุจุฒุงุฑูุง ุงูฺฉุงู ุงุณุชุฎุฑุงุฌ ูุชู ุงุฒ ูุงูโูุง PDF ู ุฐุฎุฑูโุณุงุฒ ุขู ุฏุฑ ูุงูุจโูุง ุณุงุฏูโุชุฑ ุฑุง ูุฑุงูู ูโฺฉููุฏ.

<br>

&nbsp;โข	ุงุจุฒุงุฑูุง ุชุฎุตุตโุชุฑ:
<br>

&nbsp;&nbsp;&nbsp;o	ุงุจุฒุงุฑ Camelot [18] ุงู ุงุจุฒุงุฑ ุจูโุทูุฑ ูฺู ุจุฑุง ุงุณุชุฎุฑุงุฌ ุฌุฏููโูุง ุงุฒ ูุงูโูุง PDF ุทุฑุงุญ ุดุฏู ู ุฏุฑ ูพุฑูฺูโูุง ฺฉู ูุงุฒ ุจู ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุฌุฏูู ุฏุงุฑูุฏ ุจุณุงุฑ ฺฉุงุฑุจุฑุฏ ุงุณุช.

<br>
ุจุฑุง ูพุดโูพุฑุฏุงุฒุด ู ูพุงฺฉุณุงุฒ ูุชูุ ุนููุงุชโูุง ูุงููุฏ ุญุฐู ุนูุงุฆู ุฒุงุฆุฏ ู ููุฒ (ฺฉุงุฑุงฺฉุชุฑูุง ูฺู)ุ ุฌุฏุงุณุงุฒ ุง ุชูฺฉูโุณุงุฒ ฺฉููุงุช ู ุณุงุฏูโุณุงุฒ ุฏุงุฏูโูุง ุงูุฌุงู ูโุดูุฏ. ุฏุฑ ุงู ุฒูููุ ุงุจุฒุงุฑูุง NLP ู ูพุฑุฏุงุฒุด ูุชู ูุชุนุฏุฏ ุงุฑุงุฆู ุดุฏูโุงูุฏ.
<br>
ฺฉ ุงุฒ ุงุจุฒุงุฑูุง ูพุฑฺฉุงุฑุจุฑุฏุ NLTK ุงุณุช ฺฉู ุงูฺฉุงูุงุช ูุชููุน ุจุฑุง ูพุฑุฏุงุฒุด ุฒุจุงู ุทุจุน ูุฑุงูู ูโฺฉูุฏ. ุจู ุนููุงู ูููููุ ูโุชูุงู ุงุฒ ูุงฺูู stopwords ุฏุฑ ุงู ฺฉุชุงุจุฎุงูู ุจุฑุง ุญุฐู ฺฉููุงุช ุชููู (ูุงููุฏ ยซูยปุ ยซุงุฒยปุ ยซุจูยป) ุงุณุชูุงุฏู ฺฉุฑุฏ ุชุง ูุชู ููุง ุชูุฒุชุฑ ู ุขูุงุฏูโ ุชุญูู ุดูุฏ.
ููุณูุฏฺฏุงู ุงู ููุงูู ูุฒ ุจุฑุง ุงูุฌุงู ุนููุงุช ูุง ููู (ุดุงูู ูพุงฺฉุณุงุฒ ูุชูุ ุชุจุฏู ูุฑูุชุ ุดูุงุณุง ุฌููุงุช ู ุญุฐู ููุฒ) ุงุฒ ุงุจุฒุงุฑ GROBID [19] ุงุณุชูุงุฏู ฺฉุฑุฏูโุงูุฏ.

<br>

<br>

### ุงูุง GROBID ฺุณุช ู ฺู ูุฒุงุง ู ุจุฑุชุฑโูุง ูุณุจุช ุจู ุณุงุฑ ุงุจุฒุงุฑูุง ูุดุงุจู ุฏุงุฑุฏุ
<br>
GROBID ฺฉู ูุฎูู  โGeneRation Of BIbliographic Dataโ [^30]  ุงุณุชุ ฺฉ ฺฉุชุงุจุฎุงูู ู ุงุจุฒุงุฑ ูุจุชู ุจุฑ ุงุฏฺฏุฑ ูุงุดู ูโุจุงุดุฏ. ุงู ุงุจุฒุงุฑ ุจุง ูุฏู ุงุณุชุฎุฑุงุฌุ ุชุฌุฒูโูุชุญูู ู ุจุงุฒุณุงุฒ ุงุณูุงุฏ ุนูู ุทุฑุงุญ ุดุฏู ู ูุงุฏุฑ ุงุณุช ูุงูโูุง ุจุง ุณุงุฎุชุงุฑูุง ูุงููุฏ PDF ุฑุง ุจู ูุงูุจโูุง ูุชู ุงุณุชุงูุฏุงุฑุฏ ูุธุฑ XML/TEI ุชุจุฏู ฺฉูุฏ. ุชูุฑฺฉุฒ ุงุตู  GROBID ุจุฑ ูุดุฑุงุช ุนููุ ููุงูุงุช ูพฺููุด ู ฺฏุฒุงุฑุดโูุง ูู ุงุณุช ู ุจู ููู ุฏูู ุฏุฑ ูพุฑูฺูโูุง ูุฑุชุจุท ุจุง ูพุฑุฏุงุฒุด ู ุณุงุฒูุงูโุฏู ุฏุงุฏูโูุง ุนูู ฺฉุงุฑุจุฑุฏ ฺฏุณุชุฑุฏูโุง ุฏุงุฑุฏ.

<br>

ุงุฒ ูููโุชุฑู ฺฉุงุฑุจุฑุฏ ูุง ุงุจุฒุงุฑ GROBID ูโุชูุงู ุจู ููุงุฑุฏ ุฒุฑ ุงุดุงุฑู ฺฉุฑุฏ:<br>

- ุงุณุชุฎุฑุงุฌ ุณุฑุจุฑฺฏ [^31] ู ุชุฌุฒู ู ุชุญูู [^32] ููุงูุงุช: ุงุทูุงุนุงุช ูุงููุฏ ฺฺฉุฏูุ ููุณูุฏฺฏุงูุ ฺฉููุงุช ฺฉูุฏ ู ุณุงุฑ ุฏุงุฏู ูุง ุงููู.
- ุงุณุชุฎุฑุงุฌ ููุงุจุน ู ูุชุงุฏุชุง: ุดูุงุณุง ุดูุงุณูโูุง ุงุณุชุงูุฏุงุฑุฏ ูุงููุฏ DOIุ PMID ู ุฏฺฏุฑ ุฏุงุฏูโูุง ฺฉุชุงุจโุดูุงุฎุช ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ุงุฏฺฏุฑ ุนูู ุฏุฑ ุญูุฒู ุงุณุชูุงุฏ [^33].
- ุดูุงุณุง ูุญุชูุง ุงุณุชูุงุฏ: ุชุดุฎุต ุจุฎุดโูุง ุงุฒ ูุชู ฺฉู ุจู ููุงุจุน ุฏฺฏุฑ ุงุฑุฌุงุน ุฏุงุฏูโุงูุฏ ู ุดูุงุณุง ูุฑุงุฌุน ฺฉู ุจู ุขูโูุง ุงุณุชูุงุฏ ุดุฏู ุงุณุช.
- ุชุญูู ููุงุจุน: ุจุฑุฑุณ ู ุณุงุฒูุงูโุฏู ุฏุงุฏูโูุง ูุฑุจูุท ุจู ููุงุจุน ุนูู.
- ุชุญูู ูุงูโูุง: ุดูุงุณุง ู ุชุฌุฒูโ ูุงู ุงุดุฎุงุต (ูุงู ฺฉูฺฺฉุ ูุงู ูุงููุ ูุงู ุฎุงููุงุฏฺฏ ู...) ุฏุฑ ุณุฑุจุฑฺฏ ู ููุงุจุนุ ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏู ูุฏู ูุฌุฒุง.
- ุชุญูู ูพููุฏูุง ู ุขุฏุฑุณโูุง: ุงุณุชุฎุฑุงุฌ ู ูพุฑุฏุงุฒุด ููฺฉโูุง ู ูุดุงูโูุง ููุฌูุฏ ุฏุฑ ูุชู.
- ุชุญูู ู ูุฑูุงูโุณุงุฒ ุชุงุฑุฎโูุง: ุดูุงุณุง ุชุงุฑุฎโูุง ููุฌูุฏ ุฏุฑ ูุชู ู ุชุจุฏู ุขูโูุง ุจู ูุงูุจ ุงุณุชุงูุฏุงุฑุฏ.
- ุณุงุฑ ูุงุจูุชโูุง: ุดุงูู ูุฌููุนูโุง ุงุฒ ุงุจุฒุงุฑูุง ฺฉูฺฉ ุจุฑุง ูพุฑุฏุงุฒุด ู ุณุงุฎุชุงุฑุณุงุฒ ุฏุงุฏูโูุง ุนูู.

<br>

ุฏุฑ ูุชุฌูโ ุงู ูุฑุขูุฏูุง ูพุฑุฏุงุฒุด ุจุฑุง ูุงูโูุง PDFุ ุงุจุฒุงุฑ GROBID ุจุด ุงุฒ ตต ุจุฑฺุณุจ ููุง ุฑุง ุจุฑุง ุณุงุฎุชุงุฑูุง ุฑุฒุฏุงูู [^34] ุดุฏู ูุฏุฑุช ู ูพุฑุฏุงุฒุด ูโฺฉูุฏ. ุงู ุจุฑฺุณุจโูุง ุดุงูู ุงููุงุน ูุชุงุฏุชุง ู ุณุงุฎุชุงุฑูุง ูุชู ูุงููุฏ ูพุงุฑุงฺฏุฑุงูโูุงุ ุชุชุฑูุงุ ุดุฑุญ ุชุตุงูุฑ ู ุณุงุฑ ุงุฌุฒุง ูุชู ูุณุชูุฏ.
<br>

ุฏุฑ ฺฉูุงุฑ ฺฉุงุฑุจุฑุฏูุง ุฐฺฉุฑุดุฏูุ ุงุจุฒุงุฑ GROBID ูุฒุงุง ุฏฺฏุฑ ูุฒ ุฏุงุฑุฏ ฺฉู ุขู ุฑุง ุงุฒ ุณุงุฑ ุงุจุฒุงุฑูุง ูุดุงุจู ูุชูุงุฒ ูโุณุงุฒุฏ. ุงุฒ ุฌููู ูโุชูุงู ุจู ุณุฑุนุช ุจุงูุง ู ููุงุณโูพุฐุฑ ุฏุฑ ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุญุฌู ุงุดุงุฑู ฺฉุฑุฏุ ุจูโุทูุฑ ูุซุงูุ ฺฉ ุณุณุชู ูุฌูุฒ ุจู ูพุฑุฏุงุฒูุฏูโ ฑถ ูุณุชูโุง ุง ฑถ ุฑุดุชูโุง ู ณฒ ฺฏฺฏุงุจุงุช ุญุงูุธูโ ุฑู ูุงุฏุฑ ุงุณุช ุฑูุฒุงูู ุญุฏูุฏ นฑต ูุฒุงุฑ ูุงู PDF ุง ูุฒุฏฺฉ ุจู ฒฐ ูููู ุตูุญู ุฑุง ูพุฑุฏุงุฒุด ฺฉูุฏ. ุนูุงูู ุจุฑ ุงูุ ูุงฺููุงุฑ ุจูุฏู ูุฏูโูุง ุนูู ุฏุฑ ุงู ฺฉุชุงุจุฎุงูู ู ุจุงุฒฺฉุงุฑุจุฑุฏูพุฐุฑ [^35] ุขูโูุง ุฏุฑ ุณุงุฑ ุจุฑูุงููโูุง ู ฺฉุฏูุงุ ุงุฒ ุฏฺฏุฑ ูฺฺฏโูุง ุงุณุช ฺฉู GROBID ุฑุง ุจุฑุฌุณุชู ูโุณุงุฒุฏ.
<br>

ูุฐุง ุฏุฑ ุงู ูพฺููุด ูุฒ ุจุฑุง ุงูุฌุงู ูุฑุขูุฏ ูพุดโูพุฑุฏุงุฒุด ู ุงุตูุงุญ ูุงูโูุง ูุชู ุฏุงูููุฏุดุฏู ุงุฒ ุงุจุฒุงุฑ GROBID ุงุณุชูุงุฏู ุดุฏู ุงุณุช.

![ุชุตูุฑ ธ โ ูุญูู  ุนููฺฉุฑุฏ GROBID โ ุชุตูุฑ ุงุฑุงุฆู ุดุฏู ุชูุณุท ุชูุณุนู ุฏููุฏู](/assets/patterneffort/synergistic-rag/media/fig8.jpg)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ธ โ ูุญูู  ุนููฺฉุฑุฏ GROBID โ ุชุตูุฑ ุงุฑุงุฆู ุดุฏู ุชูุณุท ุชูุณุนู ุฏููุฏู</sub>
</p>

<br>

### ูุตุจ GROBID
ุจุฑุง ูุตุจ ู ุฑุงูโุงูุฏุงุฒ GROBIDุ ุฏุฑ ุงุจุชุฏุง ูุงุฒู ุงุณุช ฺฉู Docker ุจุฑ ุฑู ุณุณุชู ูุตุจ ุดุฏู ุจุงุดุฏ. ุงู ูพุดโูุงุฒ ุงูฺฉุงู ุงุฌุฑุง ุขุณุงู ู ูุงุจู ุญูู ุณุฑูุณ GROBID ุฑุง ูุฑุงูู ูโฺฉูุฏ ู ูุญุท ุงุฒููู ุจุฑุง ูุฏุฑุช ูุงุจุณุชฺฏโูุง ู ุงุฌุฑุง ูพุงุฏุงุฑ ุขู ุงุฌุงุฏ ูโููุงุฏ. 

<br>
- ุจุฑุง ุฏุฑุงูุช ูุณุฎูโ ฺฉุงูู ู ุงุณุชูุงุฏู ุงุฒ ูุงุจูุชโูุง ุขู ุฑู GPUุ ูโุชูุงู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุจูุฑู ฺฏุฑูุช:

```powershell
docker run --rm --gpus all --init --ulimit core=0 -p 8070:8070 grobid/grobid:0.8.2-full 
```

ุงู ุฏุณุชูุฑ ุจุงุนุซ ูโุดูุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	ุงูุฌ ฺฉุงููGROBID  (ูุณุฎูโ 0.8.2 `full-`) ุฏุฑุงูุช ู ุงุฌุฑุง ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูพุฑุฏุงุฒุดโูุง ุจุฑ ุฑู GPU ุณุณุชู ุจุง ุณุฑุนุช ู ูุฏุฑุช ุจุดุชุฑ ุงูุฌุงู ฺฏุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุณุฑูุณ GROBID ุฑู ูพูุฑุช 8070 ุฏุฑ ุฏุณุชุฑุณ ูุฑุงุฑ ฺฏุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ฺฏุฒููโ `rm-` ูพุณ ุงุฒ ูพุงุงู ุงุฌุฑุง ฺฉุงูุชูุฑ ุฑุง ุญุฐู ฺฉูุฏ ู ุณุณุชู ุชูุฒ ุจุงู ุจูุงูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ฺฏุฒููโ `init-` ู `ulimit core=0--` ุจุฑุง ูุฏุฑุช ุจูุชุฑ ููุงุจุน ู ุฌููฺฏุฑ ุงุฒ ุชููุฏ ูุงูโูุง core dump ุงุณุชูุงุฏู ุดููุฏ.<br>

<br>

- ุจุฑุง ูุตุจ ู ุจูโฺฉุงุฑฺฏุฑ ูุณุฎูโ ุณุจฺฉ GROBID ฺฉู ุชููุง ุจุฑ ุฑู CPU ุงุฌุฑุง ูโุดูุฏุ ูโุชูุงู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ:
```powershell
docker run --rm --init --ulimit core=0 -p 8070:8070 grobid/grobid:0.8.2-crf
```

ุฏุฑ ุงู ุญุงูุช:<br>

&nbsp;&nbsp;&nbsp;โข	ุฎุฑูุฌ ุญุงุตู ุฏูุช ฺฉูุชุฑ ูุณุจุช ุจู ูุณุฎูโ ฺฉุงูู ุฏุงุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงูุง ุญุฌู image ุฏุฑุงูุชโุดุฏู ฺฉูุชุฑ ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ููฺูู ูุฒุงู ูุตุฑู ุญุงูุธูโ RAM ฺฉุงูุด ูโุงุจุฏ.
<br>



![ุชุตูุฑ น โ ููุง ุงุฒ ุฑุงุจุท ฺฉุงุฑุจุฑ GROBID ุฏุฑ localhost](/assets/patterneffort/synergistic-rag/media/fig9.png)
<p style="text-align:center;">
  <sub>ุชุตูุฑ น โ ููุง ุงุฒ ุฑุงุจุท ฺฉุงุฑุจุฑ GROBID ุฏุฑ localhost</sub>
</p>

<br>

### ูุฑุขูุฏ ูพุด ูพุฑุฏุงุฒุด
ุจุฑุง ุงูุฌุงู ุนููุงุชโูุง ูพุดโูพุฑุฏุงุฒุดุ ุงุจุชุฏุง ููุงูโุทูุฑ ฺฉู ูพุดโุชุฑ ุงุดุงุฑู ุดุฏุ ฺฉุงูุชูุฑ GROBID ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ูุฑุงุฎูุงู ูโฺฉูู:

```powershell
 docker run --rm -d --name grobid_batch `
    -p 8070:8070 `
    -v " โEnter pdfs location hereโ :/pdfs" `
    -v " โEnter TEI outputs location hereโ :/tei" `
    lfoppiano/grobid:0.8.2
```

ุฏุฑ ุงู ุฏุณุชูุฑ:

&nbsp;&nbsp;&nbsp;โข	ุฎุท ุงูู: ฺฉุงูุชูุฑ ุชุนุฑู ุดุฏู ู ูุงู ุขู grobid_batch ุชุนู ูโุดูุฏ. ฺฏุฒููโ `rm-` ูุดุฎุต ูโฺฉูุฏ ฺฉู ูพุณ ุงุฒ ุชููู ฺฉุงูุชูุฑุ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุญุฐู ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุฏูู: ูพูุฑุช ุงุฌุฑุง ุณุฑูุณ ุฑู 8070 ุชูุธู ูโุดูุฏ ุชุง ุฏุณุชุฑุณ ุจู GROBID ุงูฺฉุงูโูพุฐุฑ ุจุงุดุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุณูู: ูุณุฑ ูุงูโูุง ูุฑูุฏ ( PDF ูุง) ุจุฑุง ฺฉุงูุชูุฑ ุชุนุฑู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ฺูุงุฑู: ูุณุฑ ุฎุฑูุฌ ูพุฑุฏุงุฒุด(ูุงูโูุง TEI) ูุดุฎุต ูโฺฏุฑุฏุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุขุฎุฑ: ุงุฒ ูุณุฎู  ุฑุณู GROBID ุฏุฑ Docker hub ุงุณุชูุงุฏู ูโุดูุฏ. (ุฏุฑ ุตูุฑุช ูุงุฒุ ูโุชูุงู ุงุฒ ูุณุฎูโูุง ุฌุงฺฏุฒู ูุงููุฏ grobid/grobid:0.8.2-full ู grobid/grobid:0.8.2-crf ูุฒ ุจูุฑู ฺฏุฑูุช.)

<br>

ุฏุฑ ุงุฏุงููุ ุงุณฺฉุฑูพุช ูพุงุชูู ุชุฏููโุดุฏู ุจุฑุง ุงูุฌุงู ุนููุงุชโูุง ูพุดโูพุฑุฏุงุฒุด ุงุฌุฑุง ูโฺฏุฑุฏุฏ:
```python
import os, requests, json
from tqdm import tqdm
from time import sleep

PDF_DIR = r" Enter pdfs location here "
OUT_DIR = r" Enter TEI outputs location here "
API_URL = "http://localhost:8070/api/processFulltextDocument"

BATCH_SIZE = 5
RETRY_LIMIT = 1
TIMEOUT = 180
```
ุฏุฑ ุงุจุชุฏุง ฺฉุฏ:
<br>
โข	ุฏุฑ ุฎุท ุงููุ ฺฉุชุงุจุฎุงููโูุง ูุงุฒู ุจุฑุง ูุฏุฑุช ูุงูโูุง ุฏุฑ ุณุณุชู ุนุงูู (os)ุ ุจุฑูุฑุงุฑ ุงุฑุชุจุงุท ุจุง API (requests) ู ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง JSON ูุฑุงุฎูุงู ูโุดููุฏ. <br>
โข	ุฏุฑ ุฎุท ุฏูู ู ุณููุ ุงุจุฒุงุฑูุง ฺฉูฺฉ ุดุงูู tqdm ุจุฑุง ููุงุด ููุงุฑ ูพุดุฑูุช ู sleep ุจุฑุง ูุฏุฑุช ุฒูุงูโุจูุฏ ุฏุฑ ูพุงูพูุงู ูพุฑุฏุงุฒุด ูุงุฑุฏ ูโุดููุฏ.<br>

ุณูพุณ ุฏุฑ ุฎุทูุท ูุฑุจูุท ุจู ุขุฏุฑุณ ูุง:<br>
&nbsp;&nbsp;&nbsp;โข	`PDF_DIR`: ูุณุฑ ูุงูโูุง ูุฑูุฏ (PDF ูุง) ุฑุง ูุดุฎุต ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	`OUT_DIR`: ูุณุฑ ูุงูโูุง ุฎุฑูุฌ (TEI) ุฑุง ุชุนู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	`API_URL`: ุขุฏุฑุณ ูพุฑุฏุงุฒุด ููุฑุฏ ูุธุฑ ุฏุฑ ุณุฑูุณ GROBID ุฑุง ูุดุฎุต ูโููุงุฏ. ุฏุฑ ุงูุฌุง ุงุฒ ูุงฺูู<br> ูพุฑุฏุงุฒุด ฺฉุงูู `processFulltextDocument` ุงุณุชูุงุฏู ุดุฏู ุงุณุช ฺฉู ุดุงูู ุนููุงุชโูุง ูุงููุฏ ุญุฐู ููุฒ ู ฺฉุณุงูโุณุงุฒ ฺฉููุงุช ุงุณุช. <br>

ุฏุฑ ุณู ุฎุท ูพุงุงู: <br>
&nbsp;&nbsp;&nbsp;โข	BATCH_SIZE = 5: ุงูุฏุงุฒู ูุฑ ุจุณุชูโ ูุฑูุฏ ุฑุง ุชุนู ูโฺฉูุฏ (ูพุฑุฏุงุฒุด ต ูุงู ุฏุฑ ูุฑ ููุจุช ุงุฌุฑุง).<br>
&nbsp;&nbsp;&nbsp;โข	RETRY_LIMIT = 1: ุชุนุฏุงุฏ ุชูุงุด ูุฌุฏุฏ ุฏุฑ ุตูุฑุช ุนุฏู ููููุช ุฏุฑ ูพุฑุฏุงุฒุด ุฑุง ูุดุฎุต ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	TIMEOUT = 180: ุญุฏุงฺฉุซุฑ ุฒูุงู ูพุฑุฏุงุฒุด ูุฑ ูุงู (ุจุฑ ุญุณุจ ุซุงูู) ุฑุง ุชุนู ูโฺฉูุฏ.

<br>

ุณูพุณ ูพุงุฑุงูุชุฑูุง ูุฑุจูุท ุจู ุนููุงุช ูพุดโูพุฑุฏุงุฒุด ูุทุงุจู ฺฉุฏ ุฒุฑ ูุดุฎุต ูโฺฏุฑุฏูุฏ:
```python
PARAMS = {
    "consolidateHeader": 1,
    "consolidateCitations": 0,
    "segmentSentences": 1,
    "generateIDs": "true",
    "teiCoordinates": "false",
    "removeInvalidXMLChars": "true"
}
```

ุฏุฑ ุงู ูุณูุช:<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุงูู: `consolidateHeader` ุงุทูุงุนุงุช ุณุฑุจุฑฺฏ ูุฑ ููุงูู ุฑุง (ุดุงูู ุนููุงูุ ููุณูุฏฺฏุงู ู ููุณุณุงุช) ุฑุง ุชุฌูุน ู ุงุฏุบุงู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุฏูู: `consolidateCitations` ุง ูุฑุขูุฏ ุงุฏุบุงู ุงุฑุฌุงุนุงุช ุงุณุช ฺฉู ุจุง ุชูุฌู ูุงุฒููุฏ ุจู ุงุชุตุงู ูพุงฺฏุงู ุฏุงุฏู ู ุงุทูุงุนุงุช ุฌุงูุจ ู ุนุฏู ฺฉุงุฑุจุฑุฏ ุฏุฑ ูุนูุงุฑ RAG ุบุฑ ูุนุงู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุณูู: `segmentSentences` ฺฉู ูุธูู  ุดูุงุณุง ู ุชูฺฉฺฉ ุฌููุงุช ุงุฒ ฺฉุฏฺฏุฑ ุฑุง ุฏุงุฑุฏ. (ุงู ููุฑุฏ ุจุง ุชูุฌู ุจู ูุนูุงุฑ ููุงูู ู ูุฑุขูุฏ ูุทุนู ุจูุฏ ูุนูุง ุฏุฑ ูุฑุญูู  ุจุนุฏ ููุด ฺฉูุฏ ู ุญุงุช ุฏุงุฑุฏ.)<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ฺูุงุฑู:โ `generateIDs` ฺฉู ุจุฑุง ูุฑ ุจุฎุด ูพุฑุฏุงุฒุด ุดุฏู ฺฉ ุดูุงุณู ููุญุตุฑ ุจู ูุฑุฏ ุชููุฏ ูฺฉูุฏ ุชุง ุดูุงุณุง ู ูพุฑุฏุงุฒุด ุงุฑุฌุงุนุงุช ุงูุฌุงู ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ูพูุฌู: `teiCoordinates` ฺฉู ูุฎุชุตุงุช ูุฑ ุนูุตุฑ ุฑุง ุฏุฑ ุตูุญู ุชุดุฎุต ูุฏูุฏ.(ุงู ููุฑุฏ ูุฒ ุบุฑุถุฑูุฑ ุงุณุช.)<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุดุดู: `removeInvalidXMLChars` ฺฉู ูุธูู  ุขู ุดูุงุณุง ู ุญุฐู ฺฉุงุฑุงฺฉุชุฑ ูุง ุงุณุช ฺฉู ููุฌุฑ ุจู ุฎุฑุงุจ ุฎุฑูุฌ XML ูโุดูุฏ. ูุฐุง ูุนุงู ุณุงุฒ ุขู ุถุฑูุฑ ุงุณุช.<br>


ุฏุฑ ูุณูุช ุจุนุฏ:
```python
os.makedirs(OUT_DIR, exist_ok=True)
meta_file = os.path.join(OUT_DIR, "metadata.jsonl")
fail_file = os.path.join(OUT_DIR, "failed.txt")

pdf_files = [
    f for f in os.listdir(PDF_DIR)
    if f.lower().endswith(".pdf") 
    and not os.path.exists(os.path.join(OUT_DIR, f.replace(".pdf", ".tei.xml")))
]
```
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ุฎุท ุงูู ุจุฑุง ุงุทููุงู ุจุดุชุฑุ ูุณุฑ ุฎุฑูุฌ (OUT_DIR) ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ุงุฌุงุฏ ูโุดูุฏ ุชุง ูุงูโูุง ูพุฑุฏุงุฒุดโุดุฏู ุฏุฑ ุขู ุฐุฎุฑู ฺฏุฑุฏูุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ุฎุท ุฏูู ู ุณูู :โ <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุงู `metadata.jsonl` ุจุฑุง ุฐุฎุฑูโ ูุชุงุฏุชุง ูุฑุจูุท ุจู ูุงูโูุง ูพุฑุฏุงุฒุดโุดุฏู ุงุฌุงุฏ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุงู `failed.txt` ุจุฑุง ุซุจุช ูุงู ูุงูโูุง ฺฉู ูพุฑุฏุงุฒุด ุขูโูุง ูุงูููู ุจูุฏู ุงุณุช ุฏุฑ ูุธุฑ ฺฏุฑูุชู <br>ูโุดูุฏ.

&nbsp;&nbsp;&nbsp;โข	ุจุฎุด ูุฑุจูุท ุจู `pdf_files`: ุจุง ููุงุณูโ ูุงูโูุง ููุฌูุฏ ุฏุฑ ูุณุฑ ูุฑูุฏ `PDF_DIR` ู ุฎุฑูุฌ `OUT_DIR`ุ ุชููุง ูุงูโูุง PDF ฺฉู ูููุฒ ูพุฑุฏุงุฒุด ูุดุฏูโุงูุฏ ุฏุฑ ูุณุช `pdf_files` ูุฑุงุฑ ูโฺฏุฑูุฏ. ุงู ฺฉุงุฑ ุจู ููุธูุฑ ุฌููฺฏุฑ ุงุฒ ูพุฑุฏุงุฒุด ุชฺฉุฑุงุฑ ุงูุฌุงู ูโุดูุฏ.

<br>

ุฏุฑ ุญููู ุงุตู ฺฉุฏ:
```python
for i in range(0, len(pdf_files), BATCH_SIZE):
    batch = pdf_files[i:i+BATCH_SIZE]

    for fname in tqdm(batch, desc=f"Batch {i//BATCH_SIZE + 1}"):
        pdf_path = os.path.join(PDF_DIR, fname)
        tei_path = os.path.join(OUT_DIR, fname.replace(".pdf", ".tei.xml"))

        for attempt in range(1, RETRY_LIMIT + 1):
            try:
                with open(pdf_path, "rb") as f:
                    r = requests.post(API_URL, files={"input": f}, params=PARAMS, timeout=TIMEOUT)

                if r.status_code == 200 and len(r.content) > 500 and b"<TEI" in r.content:
                    with open(tei_path, "wb") as out:
                        out.write(r.content)
                    
                    with open(meta_file, "a", encoding="utf-8") as mf:
                        mf.write(json.dumps({"pdf": pdf_path, "tei": tei_path}) + "\n")
                    break
                else:
                    print(f"โ๏ธ HTTP {r.status_code} for {fname}, attempt {attempt}")
            except requests.exceptions.RequestException as e:
                print(f"โ Exception for {fname}, attempt {attempt}: {e}")

            sleep(2)
        else:
            with open(fail_file, "a", encoding="utf-8") as ff:
                ff.write(fname + "\n")
            print(f"โ Failed after {RETRY_LIMIT} attempts: {fname}")

    sleep(1)

print(f"\nโ Completed. {len(os.listdir(OUT_DIR))} TEI files created in {OUT_DIR}")
```

&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ุญูููโ ุจุฑูู: ูุงูโูุง PDF ุจุฑ ุงุณุงุณ ุงูุฏุงุฒูโ ุจุณุชูโ ุชุนูโุดุฏู `BATCH_SIZE` ุจู ุชุฑุชุจ ูุงุฑุฏ ูุฑุขูุฏ ูพุฑุฏุงุฒุด ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ุญูููโ ูุงู: ูุฑ ูุงู ุฏุฑ ุจุณุชู ุจุฑุฑุณ ุดุฏู ู ูุณุฑ ูุฑูุฏ `pdf_path` ู ุฎุฑูุฌ `tei_path` ุขู ูุดุฎุต ูโฺฏุฑุฏุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ุญูููโ ุฏุงุฎู (ุชูุงุด ูุฌุฏุฏ): <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุงู PDF ุจุงุฒ ุดุฏู ู ุจู API ุณุฑูุณ GROBID ุงุฑุณุงู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุฏุฑ ุตูุฑุช ููููุช (ฺฉุฏ ูุถุนุช 200 ู ูุญุชูุง ูุนุชุจุฑ ุดุงูู ุชฺฏ `<TEI>`)ุ ุฎุฑูุฌ ูพุฑุฏุงุฒุด ุฏุฑ ูุณุฑ ููุตุฏ ุฐุฎุฑู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุณูพุณ ูุชุงุฏุชุง ูุฑุจูุท ุจู ูุงู ุฏุฑ `meta_file` ุซุจุช ูโฺฏุฑุฏุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุฏุฑ ุตูุฑุช ุฎุทุง ุง ุนุฏู ููููุชุ ูพุงู ูุดุฏุงุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ ู ูพุณ ุงุฒ ูพุงุงู ุชุนุฏุงุฏ ุชูุงุดโูุง ูุฌุงุฒ `RETRY_LIMIT`ุ ูุงู ูุงู ุฏุฑ `fail_file` ุฐุฎุฑู ูโุดูุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ูุฏุฑุช ุฒูุงูโุจูุฏ: ุจู ูุฑ ุชูุงุด ู ูุฑ ุจุณุชู ูพุฑุฏุงุฒุดุ ุชููู ฺฉูุชุงู (sleep) ุจุฑุง ูุฏุฑุช ูพุงูพูุงู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ูพุงุงู ุจุฑูุงูู: ูพุณ ุงุฒ ุชฺฉูู ูพุฑุฏุงุฒุดุ ุชุนุฏุงุฏ ูุงูโูุง TEI ุงุฌุงุฏุดุฏู ุฏุฑ ูุณุฑ ุฎุฑูุฌ ููุงุด ุฏุงุฏู ูโุดูุฏ.

<br>

ุฏุฑ ูพุงุงู ูุฒ ูพุงู ุงุชูุงู ูพุฑุฏุงุฒุด ุจู ููุงุด ุฏุฑ ูโุขุฏ.


![ุชุตูุฑ ฑฐ โ ููููู  ุฏุณุชูุฑ ุงุฌุฑุง ฺฉุงูุชูุฑ GROBID](/assets/patterneffort/synergistic-rag/media/fig10.JPG)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ฑฐ โ ููููู  ุฏุณุชูุฑ ุงุฌุฑุง ฺฉุงูุชูุฑ GROBID</sub>
</p>

<br>


![ุชุตูุฑ ฑฑ โ ููููู  ุชุฑููุงู ุงุฌุฑุง ุฏุณุชูุฑุงุช ฺฉุฏ ูพุดโูพุฑุฏุงุฒุด](/assets/patterneffort/synergistic-rag/media/fig11.JPG)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ฑฑ โ ููููู  ุชุฑููุงู ุงุฌุฑุง ุฏุณุชูุฑุงุช ฺฉุฏ ูพุดโูพุฑุฏุงุฒุด</sub>
</p>

<br>

ุจู ุทูุฑ ูุซุงู ุฏุฑ ุชุตูุฑ ฑฑ ูุดุงูุฏู ูโุดูุฏ ฺฉู ูพุณ ุงุฒ ุงุฌุฑุง ฺฉุฏ ุนููุงุช ูพุดโูพุฑุฏุงุฒุด ุจุฑ ุฑู ตฑฑน ูุงู ููุงููุ ุชุนุฏุงุฏ ตฑฑธ ูุงู ูพุฑุฏุงุฒุด ุดุฏู ู ุชููุง ฺฉ ูุงู ุจุง ุฎุทุง ููุงุฌู ฺฏุฑุฏุฏู ุงุณุช.<br>

ุนูุช ุจุฑูุฒ ุฎุทุง ูโุชูุงูุฏ ููุงุฑุฏ ุฒุฑ ุจุงุดุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ุนุฏู ุฏุณุชุฑุณ ุจู ูุถุง ฺฉุงู ุญุงูุธูโ RAM ุฏุฑ ุฒูุงู ูพุฑุฏุงุฒุด.<br>
&nbsp;&nbsp;&nbsp;โข	ุงุณฺฉุฑูโุดุงุช ุจูุฏู ูุงู ููุงูู (ุจู ุนูุช ุนุฏู ูุฌูุฏ ูุงุจูุช OCR ุฏุฑ GROBID).<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุฑุงุจ ุง ูุงูุต ุจูุฏู ูุงู ูุฑูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฑูุฒฺฏุฐุงุฑ ุง ูุญุฏูุฏุชโูุง ุงููุช ุงุนูุงูโุดุฏู ุจุฑ ุฑู ูุงู<br>
&nbsp;&nbsp;&nbsp;โข	ุณุงุฑ ูุดฺฉูุงุช ูุฑุชุจุท ุจุง ุณุงุฎุชุงุฑ ูุงู PDF.<br>

ุฏุฑ ุณุณุชู ููุฑุฏ ุงุณุชูุงุฏู ุจุฑุง ุชููโ ุงู ฺฏุฒุงุฑุดุ ุงุฒ ูพุฑุฏุงุฒูุฏูโ Intel Core i7-8700Kุ ุจู ููุฑุงู ณฒ ฺฏฺฏุงุจุงุช ุญุงูุธูโ RAM ู ฺฉุงุฑุช ฺฏุฑุงูฺฉ Nvidia GTX 1080Ti 11GB OC ุจูุฑู ฺฏุฑูุชู ุดุฏู ุงุณุช. ุงุฒ ูุฌููุน ุญุงูุธูโ RAMุ ููุฏุงุฑ ฑต ฺฏฺฏุงุจุงุช ุจู ุงุฌุฑุง ุณุฑูุณ GROBID ุฏุฑ ูุญุท Docker ุงุฎุชุตุงุต ุงูุชู ุงุณุช.<br>

ูุฏุช ุฒูุงู ุณูพุฑโุดุฏู ุจุฑุง ุงุฌุฑุง ุนููุงุช ูพุดโูพุฑุฏุงุฒุด ุชูุฑุจุงู ฑฐ ุณุงุนุช ุจูุฏู ุงุณุช. ูุงุฒู ุจู ุฐฺฉุฑ ุงุณุช ฺฉู ุงุนุฏุงุฏ ููุงุด ุฏุงุฏูโุดุฏู ุฏุฑ ุชุตูุฑ ูุฑุจูุท ุจู ุงุฌุฑุง ุฏูู ฺฉุฏ ูุณุชูุฏ ู ุงุฒ ุฏูุช ฺฉุงูู ุจุฑุฎูุฑุฏุงุฑ ููโุจุงุดูุฏ.

<br>

---
## ูพุงุฏู ุณุงุฒ: ูุฏู ูุง ุฌุงููุง

### ูุฏู ูุง ุฌุงููุง

ุฏุฑ ุฏููู ูุฑุญูู ุงุฒ ูพุงุฏูโุณุงุฒ ูุนูุงุฑ RAG ููโุงูุฒุงุ ุจู ุจุฑุฑุณ ู ุจูโฺฉุงุฑฺฏุฑ ูุฏูโูุง ุฌุงููุง [^36] ูพุฑุฏุงุฎุชู ูโุดูุฏ.<br>

ุฏุฑ ุญูุฒูโ ุงุฏฺฏุฑ ูุงุดูุ ุฌุงููุงโ ฺฉ ุงุฒ ุฑูุดโูุง ุงุฏฺฏุฑ ุจุงุฒููุง [^37] ุง ุงุฏฺฏุฑ ูฺฺฏ [^38] ุจูโุดูุงุฑ ูโุฑูุฏ ฺฉู ุท ุขู ุฏุงุฏูโูุง ูพฺุฏู ู ุจุง ุงุจุนุงุฏ ุจุงูุง ุจู ฺฉ ูุถุง ุจุฑุฏุงุฑ ุจุง ุงุจุนุงุฏ ฺฉูุชุฑ ูฺฏุงุดุช ูโุดููุฏ. ูุฏู ุงุฒ ุงู ูุฑุงูุฏุ ฺฉุงูุด ูพฺุฏฺฏ ุฏุงุฏูโูุง ู ุงุณุชุฎุฑุงุฌ ูฺฺฏโูุง ฺฉูุฏ ุจุฏูู ุงุชฺฉุง ุจู ุฏุงูุด ูพุดู [^39] ุฏุฑุจุงุฑูโ ุณุงุฎุชุงุฑ ุง ูุญุชูุง ุฏุงุฏู ุงุณุช.<br>

![ุชุตูุฑ ฑฒ โ ุดูุง ฺฉู ุงุฒ ูุญูู  ุนููฺฉุฑุฏ ูุฏู embedding](/assets/patterneffort/synergistic-rag/media/fig12.JPG)
<p style="text-align:center;">
  <sub>ุชุตูุฑ ฑฒ โ ุดูุง ฺฉู ุงุฒ ูุญูู  ุนููฺฉุฑุฏ ูุฏู embedding</sub>
</p>

<br>

ุฏุฑ ูพุฑุฏุงุฒุด ุฒุจุงู ูุง ุทุจุน ูุฒ ฺฉ ุงุฒ ุฑูุด ูุง ุจุงุฒููุง ุงุณุชูุงุฏู ุงุฒ ุจุฑุฏุงุฑ ูุง ูฺฺฏ ุจุฑุง ุชุตูุฑ ฺฉุฑุฏู ููุงูู ูุดุงุจู ุฏุฑ ูุฒุฏฺฉ ฺฉุฏฺฏุฑ ูโุจุงุดุฏ. ุจุฑุง ูุญุงุณุจู  ูุงุตูู ุฏู ุจุงุฒููุง ูุงุฒู ุงุณุช ุชุง ฺฉ ูุนุงุฑ ุดุจุงูุช ุงูุชุฎุงุจ ุดูุฏ.<br>


ูุนุงุฑ ูุง ุดุจุงูุช ุนุจุงุฑุชูุฏ ุงุฒ:<br>

&nbsp;&nbsp;&nbsp;ฑ- ูุงุตูู  ุงููุฏุณ : <br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ูุฑููู:

<br>

$$
|a - b|
$$

<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ูุฑููู ุงุณฺฉุงูุฑ:
<br>

$$
\sqrt{ \sum (a_n - b_n)^2 }
$$

<br>

&nbsp;&nbsp;&nbsp;ฒ- ุดุจุงูุช ฺฉุณููุณ :<br>
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ูุฑููู:

<br>

$$
\frac{a \cdot b}{|a| \, |b|}
$$

<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ูุฑููู ุงุณฺฉุงูุฑ:

<br>

$$
\frac{ \sum a_n b_n }{ \sqrt{ \left( \sum a_n^2 \right) \left( \sum b_n^2 \right) } }
$$

<br>

ณ- ุถุฑุจ ุฏุงุฎู :

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ูุฑููู:

<br>

$$
a \cdot b
$$


<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ูุฑููู ุงุณฺฉุงูุฑ:

<br>

$$
\sum a_n b_n
$$

<br>

ุงุฒ ุฌููู ุงุจุฒุงุฑูุง ุฑุงุฌ ุฏุฑ ุญูุฒูโ ุจุงุฒููุง ุจุฑุฏุงุฑ ูโุชูุงู ุจู ูุฏู GloVe ุงุฑุงุฆูโุดุฏู ุชูุณุท ุฏุงูุดฺฏุงู ุงุณุชูููุฑุฏโ [20]ุ ู ููฺูู ูุฏูโูุง BERT [21] ู Word2Vec [22] ุชูุณุนูโุงูุชู ุชูุณุท ฺฏูฺฏู ุงุดุงุฑู ฺฉุฑุฏ. <br>

ุจุฑุง ูพุฑุฏุงุฒุด ุฌููุงุช ุฏุฑ ุงู ูุนูุงุฑุ ุงุฒ ฺฉ ูุฏู ุฌุงููุง ุฌููุงุช ูุจุชู ุจุฑ ูุงฺูู Sentence Transformers ู ฺฉู ุจูโุทูุฑ ูุนููู ุจุง ุนููุงู SBERT ุดูุงุฎุชู ูโุดูุฏ ู ุงุณุชูุงุฏู ุดุฏู ุงุณุชโ [23]. ุฏุฑ ุงู ูพุงุฏูโุณุงุฒุ ูุฏู `all-mpnet-base-v2` ุจูโุนููุงู ูุฏู ุงุตู ุชููุฏ ุจุงุฒููุงโูุง ุจุฑุฏุงุฑ ุฌููุงุช ุจูโฺฉุงุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช. <br>

ุจุฑุง ุฏุฑุงูุช ู ุงุณุชูุงุฏู ุงุฒ ูุฏู ุจูโุตูุฑุช ูุญูุ ุงูฺฉุงู ูุฑุงุฌุนู ุจู ูพุงฺฏุงู HuggingFace ู ุฏุงูููุฏ ูุณุฎูโ ููุฑุฏูุธุฑ ูุฌูุฏ ุฏุงุฑุฏ. ููฺูู ูโุชูุงู ูุฏู ุฑุง ุฏุฑ ุฒูุงู ุงุฌุฑุง ูุฑุขูุฏ ูพุฑุฏุงุฒุดุ ุจูโุตูุฑุช ูุณุชูู ูุฑุงุฎูุงู ู ุจุงุฑฺฏุฐุงุฑ ฺฉุฑุฏ. <br>

ุจุฑุง ูพุงุฏูโุณุงุฒ ุฑูุด ูุฎุณุชุ ุงุจุชุฏุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ูุงฺูู `Sentence-Transformers` ุฏุฑุงูุช ู ุฏุฑ ูุญุท ฺฉุงุฑ ูุตุจ ูโุดูุฏ: <br>

```powershell
pip install โU sentence-transformers
```
<br>
ุณูพุณ ุจูโููุธูุฑ ุฏุงูููุฏ ูุฏู ุจูโุตูุฑุช ูุญูุ ุงุจุฒุงุฑ ุฎุท ูุฑูุงู (CLI) ูุฑุจูุท ุจู HuggingFace Hub ุจุง ุฏุณุชูุฑ ุฒุฑ ูุตุจ ูโฺฏุฑุฏุฏ: <br>

```powershell
pip install โU โhuggingface_hub[cli]โ 
```
<br>

ุจุฑุง ุฏุงูููุฏ ูุฏู (ุฏุฑ ุงูุฌุง ูุฏู `all-mpnet-base-v2`) ุจูโุตูุฑุช ูุญูุ ุงุฒ ูุงูุจ ุฏุณุชูุฑ ูุดุงุจู ุฒุฑ ุงุณุชูุงุฏู ูโุดูุฏ:<br>

```powershell
hf download sentence-transformers/all-mpnet-base-v2 -โlocal-dir โูุญู ุฐุฎุฑู ุณุงุฒโ
```
<br>

### ุขูุงุฏู ุณุงุฒ ุฏุงุฏู ูุง ุขููุฒุด
ูุงุฒู ุจู ุฐฺฉุฑ ุงุณุช ฺฉู ุจูโููุธูุฑ ููุงุณู ู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ูุนูุงุฑ ูพุดููุงุฏุ ููุณูุฏฺฏุงู ููุงูู ุจุฑุง ูุงูโุชูู [^40] ูุฏู ุฌุงููุงุ ุดุด ูพฺฉุฑุจูุฏ [^41] ูุชูุงูุช ุฑุง ูุทุงุจู ุขูฺู ุฏุฑ ุตูุญูโ ฑฐ ููุงูู ุงุฑุงุฆู ุดุฏู ุงุณุชุ ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ุฏุงุฏูโุงูุฏุ ุงู ูพฺฉุฑโุจูุฏโูุง ุจู ุดุฑุญ ุฒุฑ ูุณุชูุฏ:

<br>

ฑ- **No FT**: ูุฏู `all-mpnet-base-v2` ุจุฏูู ุงูุฌุงู ูฺโฺฏููู ุฑุฒุชูุธู(ูุงูโุชูู).<br>
ฒ- **5 TB**: ุฑุฒุชูุธู ูุฏู `all-mpnet-base-v2` ุจุง ุฏุชุงุณุช [^42] ูุชุดฺฉู ุงุฒ ต ฺฉุชุงุจ ูุฑุฌุน ุญูุฒู ุนููู ุฏุงุฏู (ุฏุฑ ุงู ุญุงูุชุ ุชููุง ุชุจุฏู PDF ุจู TXT ุงูุฌุงู ุดุฏู ู ูฺโฺฏููู ูพุดโูพุฑุฏุงุฒุด ุง ุงุณุชูุงุฏู ุงุฒ GROBID ุตูุฑุช ูฺฏุฑูุชู ุงุณุช.)<br>
ณ- **17 TB**: ุฑุฒุชูุธู ูุฏู `all-mpnet-base-v2` ุจุง ุฏุงุฏฺฏุงู ูุชุดฺฉู ุงุฒ ฑท ฺฉุชุงุจ ูุฑุฌุน ุญูุฒู ุนููู ุฏุงุฏู (ูุดุงุจู ุญุงูุช ูุจูุ ุตุฑูุงู ุชุจุฏู PDF ุจู TXT ุงูุฌุงู ุดุฏู ู ุงุฒ GROBID ุงุณุชูุงุฏู ูุดุฏู ุงุณุช.)<br>
ด- **5 TB + G**: ุฑุฒุชูุธู ูุฏู `all-mpnet-base-v2` ุจุง ุฏุงุฏฺฏุงู ูุชุดฺฉู ุงุฒ ต ฺฉุชุงุจ ูุฑุฌุน ุญูุฒู ุนููู ุฏุงุฏู ฺฉู ุชูุณุท GROBID ูุฒ ูพุดโูพุฑุฏุงุฒุด ุดุฏู ุงูุฏ.<br>
ต- **17 TB + G**: ุฑุฒุชูุธู ูุฏู `all-mpnet-base-v2` ุจุง ุฏุงุฏฺฏุงู ูุชุดฺฉู ุงุฒ ฑท ฺฉุชุงุจ ูุฑุฌุน ุญูุฒู ุนููู ุฏุงุฏู ฺฉู ุชูุณุท GROBID ูุฒ ูพุดโูพุฑุฏุงุฒุด ุดุฏู ุงูุฏ.<br>
ถ- **17 TB + G + SNS**: ุฑุฒุชูุธู ูุฏู `all-mpnet-base-v2` ุจุง ุฏุงุฏฺฏุงู ูุชุดฺฉู ุงุฒ ฑท ฺฉุชุงุจ ูุฑุฌุน ุญูุฒู ุนููู ุฏุงุฏู ฺฉู ุชูุณุท GROBID ูุฒ ูพุดโูพุฑุฏุงุฒุด ุดุฏู ุงูุฏ.<br>

ุงูุฒูู ุจุฑ ต  ูพฺฉุฑุจูุฏ ูุฎุณุชุ ฺฉ ูุฑุญููโ ุชฺฉูู ุจุง ุนููุงู (SNS) Semantic Node Splitter ุง ุชูุณู ฺฏุฑูโูุง ูุนูุง ูุฒ ุจุฑ ุฏุงุฏูโูุง ุขููุฒุด ุงุนูุงู ุดุฏู ุงุณุช. ูุฏู ุงุฒ ุงู ูุฑุญููุ ุงูุฒุงุด ุฎููุต ูุนูุง ุจุงุฒููุงโูุง ู ุฏุฑ ูุชุฌู ุจูุจูุฏ ฺฉูุช ุจุงุฒุงุจ ุงุทูุงุนุงุช ุงุณุช. ุฏุฑ ุงุฏุงููุ ุจูโุทูุฑ ููุตู ุจู ุณุงุฒูฺฉุงุฑ ู ููุด ุงู ูุฑุญูู ูพุฑุฏุงุฎุชู ุฎูุงูุฏ ุดุฏ.<br>

---
#### ุนูุงูู ฺฉุชุงุจ ูุง ูพฺฉุฑุจูุฏ ูุง 5 TB:
1. Aggarwal, C. C. (2018). Neural Networks and Deep Learning: A Textbook. Springer.
2. Alpaydฤฑn, E. (2014). Introduction to Machine Learning (3rd ed.). The MIT Press.
3. Bruce, P., & Bruce, A. (2017). Practical Statistics for Data Scien-tists: 50 Essential Concepts. OโReilly Media.
4. Langr, J., & Bok, V. (2019). GANs in Action: Deep Learning with Generative Adversarial Networks. Manning Publications.
5. Montgomery, D. C., Jennings, C. L., & Kulahci, M. (2015). Intro-duction to Time Series Analysis and Forecasting (2nd ed.). Wiley.

<br>

#### ุนูุงูู ฺฉุชุงุจ ูุง ุญุงูุช ูุง 17 TB:
1. Aรenmacher, Matthias. Multimodal Deep Learning. Self-published, 2023.
2. Bertsekas, Dimitri P. A Course in Reinforcement Learning. Arizona State University.
3. Boykis, Vicki. What are Embeddings. Self-published, 2023.
4. Bruce, Peter, and Andrew Bruce. Practical Statistics for Data Scientists: 50 Essential Concepts. OโReilly Media, 2017.
5. Daumรฉ III, Hal. A Course in Machine Learning. Self-published.
6. Deisenroth, Marc Peter, A. Aldo Faisal, and Cheng Soon Ong.Mathematics for Machine Learning. Cambridge University Press, 2020.
7. Devlin, Hannah, Guo Kunin, Xiang Tian. Seeing Theory. Self-published.
8. Gutmann, Michael U. Pen & Paper: Exercises in Machine Learning. Self-published.
9. Jung, Alexander. Machine Learning: The Basics. Springer, 2022.
10. Langr, Jakub, and Vladimir Bok. Deep Learning with Generative Adversarial Networks. Manning Publications, 2019.
11. MacKay, David J.C. Information Theory, Inference, and Learning Algorithms. Cambridge University Press, 2003.
12. Montgomery, Douglas C., Cheryl L. Jennings, and Murat Kulahci.Introduction to Time Series Analysis and Forecasting. 2nd Edition, Wiley, 2015.
13. Nilsson, Nils J. Introduction to Machine Learning: An Early Draft of a Proposed Textbook. Stanford University, 1996.
14. Prince, Simon J.D. Understanding Deep Learning. Draft Edition, 2024.
15. Shashua, Amnon. Introduction to Machine Learning. The Hebrew University of Jerusalem, 2008.
16. Sutton, Richard S., and Andrew G. Barto. Reinforcement Learning: An Introduction. 2nd Edition, MIT Press, 2018.
17. Alpaydin, Ethem. Introduction to Machine Learning. 3rd Edition, MIT Press, 2014.

<br>

---

### ูพุฑุฏุงุฒุด ูุชู ฺฉุชุงุจ ูุง
ุจุฑุง ูพฺฉุฑุจูุฏโูุง ฒ ู ณุ ุงุจุชุฏุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑูุง ุชุจุฏู PDF ุจู TXT ู ฺฉู ุฏุฑ ุจุฎุดโูุง ูพุดู ูุนุฑู ุดุฏูุฏ ู ูุงูโูุง ูุฑุจูุท ุจู ฺฉุชุงุจโูุง ูุฑุฌุน ุจู ูุฑูุช ูุชู (TXT) ุชุจุฏู ูโุดููุฏ. ูพุณ ุงุฒ ุงูุฌุงู ุงู ูุฑุญููุ ูุญุชูุง ูุชู ุงุณุชุฎุฑุงุฌโุดุฏู ุจูโุนููุงู ูุฑูุฏ ุจุฑุง ูุฑุขูุฏ ุฑุฒุชูุธู ูุฏู ุฌุงููุง ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ.<br>

```python
import os, json
from tqdm import tqdm
import fitz  # PyMuPDF

BOOK_DIR = r" Enter Books .pdf files location "
OUT_DIR = r" Enter Books .txt files extraction destination "
os.makedirs(OUT_DIR, exist_ok=True)

meta_file = os.path.join(OUT_DIR, "metadata_books_raw.jsonl")

book_files = [
    f for f in os.listdir(BOOK_DIR)
    if f.lower().endswith(".pdf")
    and not os.path.exists(os.path.join(OUT_DIR, f.replace(".pdf", ".txt")))
]

def extract_text_fitz(pdf_path):
    doc = fitz.open(pdf_path)
    text_parts = []
    for page in doc:
        text = page.get_text("text")  
        text_parts.append(text)
    doc.close()
    return "\n".join(text_parts)

for fname in tqdm(book_files, desc="Books without GROBID (fast)"):
    pdf_path = os.path.join(BOOK_DIR, fname)
    out_txt = os.path.join(OUT_DIR, fname.replace(".pdf", ".txt"))
    try:
        text = extract_text_fitz(pdf_path)
        if len(text.strip()) < 200:
            print(f"โ๏ธ Very short text (maybe scanned): {fname}")
            continue
        with open(out_txt, "w", encoding="utf-8") as f:
            f.write(text)
        with open(meta_file, "a", encoding="utf-8") as mf:
            mf.write(json.dumps({"pdf": pdf_path, "text": out_txt}) + "\n")
    except Exception as e:
        print(f"โ Failed {fname}: {e}")
```
<p style="text-align:center;">
  <sub>ููููู ฺฉุฏ ุชุจุฏู ูุงู ฺฉุชุงุจ ูุง PDF ุจู TXT ุฎุงู</sub>
</p>

<br>

ุจุฑุง ูพฺฉุฑุจูุฏโูุง ด ู ต ูุฒ ูุฑุขูุฏ ุชุจุฏู ู ูพุดโูพุฑุฏุงุฒุด ฺฉุชุงุจโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑ GROBID ุงูุฌุงู ูโุดูุฏุ ูุดุงุจู ููุงู ุฑูุด ฺฉู ุจุฑุง ูพุฑุฏุงุฒุด ูุงูโูุง ููุงูุงุช ุจูโฺฉุงุฑ ฺฏุฑูุชู ุดุฏู ุจูุฏ. ุฏุฑ ุงู ูุฑุญููุ GROBID ุณุงุฎุชุงุฑ ููุทู ุงุณูุงุฏ ุฑุง ุงุณุชุฎุฑุงุฌ ฺฉุฑุฏู ู ูุชู ฺฉุชุงุจโูุง ุฑุง ุจุง ุฏูุช ุจุดุชุฑ ุชูฺฉฺฉ ู ุงุณุชุงูุฏุงุฑุฏุณุงุฒ ูโฺฉูุฏ ุชุง ุฏุงุฏูโูุง ูุฑูุฏ ุจุฑุง ุฑุฒุชูุธู ูุฏู ุฌุงููุง ุงุฒ ฺฉูุช ุจุงูุงุชุฑ ุจุฑุฎูุฑุฏุงุฑ ุจุงุดูุฏ:

```python
import os, requests, json
from tqdm import tqdm
from time import sleep
import xml.etree.ElementTree as ET

BOOK_DIR = r" Enter Books .pdf files location "
OUT_DIR = r" Enter .tei Processed Books files extraction destination "
API_URL = "http://localhost:8070/api/processFulltextDocument"

PARAMS = {
    "consolidateHeader": 1,
    "segmentSentences": 1,
    "generateIDs": "true",
    "removeInvalidXMLChars": "true"
}
TIMEOUT = 1000
RETRY_LIMIT = 1

os.makedirs(OUT_DIR, exist_ok=True)
meta_file = os.path.join(OUT_DIR, "metadata_books.jsonl")

book_files = [
    f for f in os.listdir(BOOK_DIR)
    if f.lower().endswith(".pdf")
    and not os.path.exists(os.path.join(OUT_DIR, f.replace(".pdf", ".txt")))
]

def tei_to_plaintext(tei_content: bytes):
    root = ET.fromstring(tei_content)
    ns = {"tei": "http://www.tei-c.org/ns/1.0"}
    paras = [" ".join(p.itertext()).strip() for p in root.findall(".//tei:text/tei:body//tei:p", ns)]
    return "\n\n".join(paras)

for fname in tqdm(book_files, desc="Books with GROBID"):
    pdf_path = os.path.join(BOOK_DIR, fname)
    out_txt = os.path.join(OUT_DIR, fname.replace(".pdf", ".txt"))
    tei_path = os.path.join(OUT_DIR, fname.replace(".pdf", ".tei.xml"))

    for attempt in range(1, RETRY_LIMIT + 1):
        try:
            with open(pdf_path, "rb") as f:
                r = requests.post(API_URL, files={"input": f}, params=PARAMS, timeout=TIMEOUT)
            if r.status_code == 200 and b"<TEI" in r.content:
                with open(tei_path, "wb") as out:
                    out.write(r.content)
                text = tei_to_plaintext(r.content)
                with open(out_txt, "w", encoding="utf-8") as t:
                    t.write(text)
                with open(meta_file, "a", encoding="utf-8") as mf:
                    mf.write(json.dumps({"pdf": pdf_path, "tei": tei_path, "text": out_txt}) + "\n")
                break
            else:
                print(f"โ๏ธ HTTP {r.status_code} for {fname}, attempt {attempt}")
        except Exception as e:
            print(f"โ Exception for {fname}, attempt {attempt}: {e}")
        sleep(3)
    else:
        print(f"โ Failed after {RETRY_LIMIT} attempts: {fname}")




```
<p style="text-align:center;">
  <sub>ฺฉุฏ ุชุจุฏู ูุงู ฺฉุชุงุจ ูุง PDF ุจู TXT ูพุดโูพุฑุฏุงุฒุด ุดุฏู ุจุง GROBID</sub>
</p>

<br>

---

### ุฑุฒโุชูุธู ูุฏู ุฌุงููุง 
ูพุณ ุงุฒ ุขูุงุฏูโุณุงุฒ ูุชู ุฏุงุฏฺฏุงูุ ูุฏู ุฌุงููุง ุจุฑุง ูพฺฉุฑุจูุฏโูุง ฒ ุชุง ถ ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉุฏ ุฒุฑ ุขููุฒุด ุฏุงุฏู ูโุดูุฏ. ุฏุฑ ุจุฎุด ูุฎุณุชุ ฺฉุชุงุจุฎุงููโูุง ู ุงุจุฒุงุฑูุง ููุฑุฏูุงุฒ ูุฑุงุฎูุงู ูโุดููุฏ:
```python
import os
import random
from pathlib import Path
from tqdm import tqdm
from nltk.tokenize import sent_tokenize
from torch.utils.data import DataLoader
from sentence_transformers import SentenceTransformer, InputExample, losses, evaluation
import nltk
nltk.download('punkt', quiet=True)
```
ุฏุฑ ฺฉุฏ ููู:<br>

&nbsp;&nbsp;&nbsp;โข	ุฎุท ุงูู (os): ุจุฑุง ูพุฑุฏุงุฒุด ูุงูโูุง ุฏุฑ ุณุณุชูโุนุงููุ ุดุงูู ุฎูุงูุฏู ูุฑูุฏโูุง ู ููุดุชู ุฎุฑูุฌโูุง ุงุณุชูุงุฏู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุฏูู (random):โ ุจุฑุง ุฏุฑููโุณุงุฒ (shuffling) ุฌููุงุช ูพุด ุงุฒ ูุฑุญููโ ุขููุฒุด ู ุงุนุชุจุงุฑุณูุฌ [^43] ุจูโฺฉุงุฑ ูโุฑูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ุณูู (Path): ุงุฒ `pathlib` ุฌูุช ูุฏุฑุช ูุณุฑูุง ู ูุงูโูุง ุฏุฑ ูุงูุจ ุณุงุฎุชโุงูุชู ู ูุณุชูู ุงุฒ ุณุณุชูโุนุงูู ุงุณุชูุงุฏู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุท ฺูุงุฑู (tqdm) ุจุฑุง ุงุฌุงุฏ ููุงุฑ ูพุดุฑูุช ุฏุฑ ุชุฑููุงูุ ูุดุงุจู ูููููโูุง ูพุดู.

<br>

ุนูุงูู ุจุฑ ุงู:<br>

&nbsp;&nbsp;&nbsp;โข	ุงุฒ `sent_tokenize` ุฏุฑ `nltk.tokenize` ุจุฑุง ุชูุณู ูุชูโูุง ุจู ุฌููุงุช ุงุณุชูุงุฏู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงุฒ `DataLoader` ุฏุฑ `torch.utils.data` ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง ู ูุฏุฑุช ุฏุณุชูโูุง ุขููุฒุด ุฏุฑ PyTorch ุจูุฑู ฺฏุฑูุชู ูโุดูุฏ.

<br>

ุฏุฑ ฺฉุชุงุจุฎุงููโ sentence_transformers ูุฒ:<br>

&nbsp;&nbsp;&nbsp;โข	ฺฉูุงุณ SentenceTransformer ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฌุงููุง ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉูุงุณ InputExample ุณุงุฎุชุงุฑ ูููููโูุง ุขููุฒุด ุฑุง ุชุนุฑู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุงฺูู losses ุจุฑุง ูพุงุฏูโุณุงุฒ ุชูุงุจุน ุฎุทุง ุฏุฑ ูุฑุขูุฏ ุขููุฒุด ุจูโฺฉุงุฑ ูโุฑูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุงฺูู evaluation ุงุจุฒุงุฑูุง ูุงุฒู ุจุฑุง ุงุฑุฒุงุจ ูุฏู ุฑุง ูุฑุงูู ูโฺฉูุฏ.<br>

ุฏุฑ ุฏู ุฎุท ูพุงุงูุ ุงุจุชุฏุง ฺฉุชุงุจุฎุงููโ nltk ุจุงุฑฺฏุฐุงุฑ ุดุฏู ู ุณูพุณ ูุฏู Punkt ุจุฑุง ุชูุณู ุฌููุงุช ุฏุงูููุฏ ูโุดูุฏ ุชุง ุงูฺฉุงู ูพุฑุฏุงุฒุด ูุชูู ูุฑุงูู ฺฏุฑุฏุฏ.<br>

ุฏุฑ ุงุฏุงููุ ููุงููุฏ ุจุฎุดโูุง ูพุดูุ ุชูุธูุงุช ุงููู ููุฑุฏูุงุฒ ุจุฑุง ุฑุฒุชูุธู ูุฏู ุฌุงููุง ุชุนุฑู ูโุดูุฏ. ูุทุนูโฺฉุฏ ุฒุฑ ูุณุฑูุง ูุฑูุฏ ู ุฎุฑูุฌ ู ููฺูู ูพุงุฑุงูุชุฑูุง ุงุตู ุขููุฒุด ุฑุง ูุดุฎุต ูโฺฉูุฏ:
```python
DATA_ROOT = Path(r" Enter documents address here ")
BASE_MODEL = Path(r" Enter raw model address here e.g. all-mpnet-base-v2 ")
SAVE_DIR = Path(r" Enter fine-tuned model address here ")
SAVE_DIR.mkdir(parents=True, exist_ok=True)

EPOCHS = 15
BATCH_SIZE = 16
LR = 2e-5
MAX_SENT_PER_FILE = 6000   
WINDOW_SIZE = 3      
```
ฺูุงุฑ ุฎุท ูุฎุณุช ุจู ุชุฑุชุจ ููุงุฑุฏ ุฒุฑ ุฑุง ูุดุฎุต ูโฺฉููุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	DATA_ROOT: ูุณุฑ ุฏุงุฏฺฏุงู ูุฑูุฏ (ูุชู ฺฉุชุงุจโูุง ุง ุงุณูุงุฏ ูพุฑุฏุงุฒุดโุดุฏู).<br>
&nbsp;&nbsp;&nbsp;โข	BASE_MODEL: ูุณุฑ ูุฏู ุงููู (ุฎุงู) ูุงููุฏ all mpnet base v2.<br>
&nbsp;&nbsp;&nbsp;โข	SAVE_DIR: ูุณุฑ ุฐุฎุฑูโุณุงุฒ ูุฏู ุฑุฒุชูุธูโุดุฏู.<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุณุชูุฑ mkdir ูุฒ ูพูุดูโ ููุตุฏ ุฑุง ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ุงุฌุงุฏ ูโฺฉูุฏ.
<br>

ุณูพุณ ูพูุฌ ุฎุท ุจุนุฏ ูพุงุฑุงูุชุฑูุง ุงุตู ุขููุฒุด ูุฏู ุฑุง ุชุนู ูโฺฉููุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	EPOCHS: ุชุนุฏุงุฏ ุฏูุฑูโูุง ุขููุฒุด. ุจูโุนููุงู ูููููุ ููุฏุงุฑ ฑต ุจุฑุง ุขููุฒุด ุจุฑ ุฑู ุฏุงุฏฺฏุงู ต ฺฉุชุงุจ ุงุณุชูุงุฏู ุดุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	BATCH_SIZE: ุงูุฏุงุฒูโ ุฏุณุชูโูุง ุขููุฒุดุ ฺฉู ุฏุฑ ุงูุฌุง ููุฏุงุฑ ฑถ ุงูุชุฎุงุจ ุดุฏู ุงุณุช.
&nbsp;&nbsp;&nbsp;โข	LR: ูุฑุฎ ุงุฏฺฏุฑ ูุฏูุ ุจุฑุงุจุฑ ุจุง ฐูซฐฐฐฐฒ.<br>
&nbsp;&nbsp;&nbsp;โข	MAX_SENT_PER_FILE: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฌููุงุช ฺฉู ุงุฒ ูุฑ ฺฉุชุงุจ ุงุณุชุฎุฑุงุฌ ู ูพุฑุฏุงุฒุด ูโุดูุฏ. ุฏุฑ ุงู ูุซุงูุ ุจุฑุง ูุฑ ฺฉุชุงุจ ุณูู ถฐฐฐ ุฌููู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	WINDOW_SIZE: ุงูุฏุงุฒูโ ูพูุฌุฑูโ ููุงุณู ุฌููุงุช. ุงู ูพุงุฑุงูุชุฑ ุชุนู ูโฺฉูุฏ ฺฉู ูุฑ ุฌููู ุจุง ฺูุฏ ุฌูููโ ูุฌุงูุฑ ุฎูุฏ ุฌูุชโุณุงุฒ ู ููุงุณู ุดูุฏ.

<br>

ุฏุฑ ุจุฎุด ุณูู ู ุฏุฑ ูุณูุช ุชุนุฑู ุชูุงุจุนุ ูุฎุณุชู ุชุงุจุน ุจุง ูุงู `load_text_files` ุจูโุตูุฑุช ุฒุฑ ูพุงุฏูโุณุงุฒ ูโุดูุฏ:
```python
def load_text_files(data_dir):
    files = sorted([f for f in data_dir.glob("*.txt")])
    print(f"๐ Found {len(files)} text files in {data_dir}")
    return files
```
<br>

ุงู ุชุงุจุน ูุธูู ุฏุงุฑุฏ ุชูุงู ูุงูโูุง ูุชู ุจุง ูพุณููุฏ TXTุฑุง ุฏุฑ ูุณุฑ ูุดุฎุตโุดุฏู ุดูุงุณุง ฺฉุฑุฏู ู ุขูโูุง ุฑุง ุจูโุตูุฑุช ฺฉ ููุฑุณุช ูุฑุชุจโุดุฏู ุจุงุฒฺฏุฑุฏุงูุฏ. ุจูโุนูุงูู:<br>

&nbsp;&nbsp;&nbsp;โขูุณุฑ ูุฑูุฏ data_dir ุฑุง ูพูุงุด ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โขุชูุงู ูุงูโูุง ุจุง ุงูฺฏู `*.txt`ุฑุง ุงุณุชุฎุฑุงุฌ ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โขุขูโูุง ุฑุง ูุฑุชุจโุณุงุฒ ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โขุชุนุฏุงุฏ ูุงูโูุง ุงูุชโุดุฏู ุฑุง ฺุงูพ ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โขู ุฏุฑ ููุงุช ููุฑุณุช ูุงูโูุง ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.

<br>

ุชุงุจุน ุฏูู ุจุง ูุงู `file_to_sentences` ุชุนุฑู ูโุดูุฏ ฺฉู ุฏุฑ ุชุงุจุน ุณูู (ุฏุฑ ุงุฏุงูู) ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ุฎูุงูุฏ ฺฏุฑูุช:

```python
def file_to_sentences(path, min_len=30):
    try:
        text = path.read_text(encoding="utf-8", errors="ignore")
    except:
        return []
    sents = [s.strip() for s in sent_tokenize(text) if len(s.strip()) >= min_len]
    return sents[:MAX_SENT_PER_FILE]
```
ุชุงุจุน `file_to_sentences` ูุธูู ุฏุงุฑุฏ ูุชู ููุฌูุฏ ุฏุฑ ูุงู ูุฑูุฏ ุฑุง ุฎูุงูุฏู ู ุขู ุฑุง ุจู ูุฌููุนูโุง ุงุฒ ุฌููุงุช ูุงุจู ุงุณุชูุงุฏู ุฏุฑ ูุฑุขูุฏ ุขููุฒุด ุชุจุฏู ฺฉูุฏ. ุนููฺฉุฑุฏ ุงู ุชุงุจุน ุจูโุตูุฑุช ุฒุฑ ุงุณุช:

&nbsp;&nbsp;&nbsp;โขูพุงุฑุงูุชุฑ ูุฑูุฏ path ูุณุฑ ูุงู ูุชู (TXT) ุงุณุชุฎุฑุงุฌโุดุฏู ุงุฒ ูุฑุญููโ ูุจู ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุฏุฑ ูุฑุญููโ ูุฎุณุชุ ุชูุงุด ูโุดูุฏ ูุญุชูุง ูุงู ุจุง ฺฉุฏฺฏุฐุงุฑ UTF 8 ุฎูุงูุฏู ุดูุฏ. ุฏุฑ ุตูุฑุช ุจุฑูุฒ ุฎุทุงุ ุชุงุจุน ฺฉ ููุฑุณุช ุฎุงู ุจุงุฒูโฺฏุฑุฏุงูุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุณูพุณ ูุชู ุฎูุงูุฏูโุดุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน sent_tokenize ุจู ุฌููุงุช ุชูุณู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุชููุง ุฌููุงุช ุงูุชุฎุงุจ ูโุดููุฏ ฺฉู ุญุฏุงูู ณฐ ฺฉุงุฑุงฺฉุชุฑ ุทูู ุฏุงุดุชู ุจุงุดูุฏุ
ุงู ุดุฑุท ุจุฑุง ุญุฐู ุฌููุงุช ุจุณุงุฑ ฺฉูุชุงู ู ูุงูุฏ ุงุฑุฒุด ูุนูุง ุงุนูุงู ุดุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โขุฏุฑ ููุงุชุ ุชุงุจุน ุญุฏุงฺฉุซุฑ `MAX_SENT_PER_FILE` ุฌููู (ุฏุฑ ุงูุฌุง ถฐฐฐ ุฌููู) ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ ุชุง ุญุฌู ุฏุงุฏูโ ูุฑูุฏ ุจุฑุง ูุฑ ฺฉุชุงุจ ฺฉูุชุฑู ุดูุฏ.

<br>


ุฏุฑ ูุณูุช ุจุนุฏุ ุชุงุจุน ุณูู ุจุง ูุงู `build_examples` ูุธููโ ุชููุฏ ุฌูุชโุฌููุงุช ุขููุฒุด ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ. ุงู ุชุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงูโูุง ูุชู ูุฑูุฏุ ุฌููุงุช ุงุณุชุฎุฑุงุฌโุดุฏู ู ุงูุฏุงุฒูโ ูพูุฌุฑูโ ูุนูุงุ ูุฌููุนูโุง ุงุฒ ูููููโูุง ููุงุณุจ ุจุฑุง ุฑุฒุชูุธู ูุฏู ุฌุงููุง ุงุฌุงุฏ ูโฺฉูุฏ:
```python
def build_examples(files):
    examples = []
    for f in tqdm(files, desc="Building training pairs"):
        sents = file_to_sentences(f)
        if len(sents) < 2:
            continue
        for i in range(len(sents) - 1):
            examples.append(InputExample(texts=[sents[i], sents[i + 1]]))
            for j in range(2, WINDOW_SIZE + 1):
                if i + j < len(sents):
                    examples.append(InputExample(texts=[sents[i], sents[i + j]]))
    print(f"โ Total training pairs: {len(examples)}")
    return examples
```
ุชุงุจุน build_examples ูุฑุงุญู ุฒุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ:<br>

&nbsp;&nbsp;&nbsp;โขูุฑูุฏ ุชุงุจุนุ ููุฑุณุช ูุงูโูุง ูุชู ุงุณุชุฎุฑุงุฌโุดุฏู ุงุฒ load_text_files ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โขุจุฑุง ูุฑ ูุงูุ ุงุจุชุฏุง ุจุง ุงุณุชูุงุฏู ุงุฒ file_to_sentences ุฌููุงุช ูุนุชุจุฑ ุงุณุชุฎุฑุงุฌ ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุงฺฏุฑ ุชุนุฏุงุฏ ุฌููุงุช ฺฉูุชุฑ ุงุฒ ุฏู ุจุงุดุฏุ ูุงู ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุณูพุณ ุจุฑุง ูุฑ ุฌูููุ ฺฉ ุฌูุช ุฌููู ุจุง ุฌูููโ ุจุนุฏ ุณุงุฎุชู ูโุดูุฏ (ูุงุตููโ ฑ).<br>
&nbsp;&nbsp;&nbsp;โขุฏุฑ ุงุฏุงููุ ุจุง ุชูุฌู ุจู ููุฏุงุฑ `WINDOW_SIZE`ุ ุฌููุงุช ุจุง ูุงุตููโูุง ุจุดุชุฑ (ูุซูุงู ฒ ู ณ) ูุฒ ุจุง ุฌูููโ ูุนู ุฌูุช ูโุดููุฏ. ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ูุฏู ุจุชูุงูุฏ ุฑูุงุจุท ูุนูุง ูุงู ุฌููุงุช ูุฒุฏฺฉ ุฑุง ุจูุชุฑ ุงุฏ ุจฺฏุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุฏุฑ ููุงุชุ ุชุนุฏุงุฏ ฺฉู ุฌูุชโูููููโูุง ุณุงุฎุชูโุดุฏู ฺุงูพ ุดุฏู ู ููุฑุณุช ูููููโูุง ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ.<br>

ุญูููโ tqdm ููุงููุฏ ุจุฎุดโูุง ูพุดูุ ูุธููโ ููุงุด ููุงุฑ ูพุดุฑูุช ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ ู ุฑููุฏ ุณุงุฎุช ุฌูุชโูููููโูุง ุฑุง ุฏุฑ ุชุฑููุงู ุจูโุตูุฑุช ุฒูุฏู ูุดุงู ูโุฏูุฏ.
<br>


ุฏุฑ ุงุฏุงููุ ุฏุงุฏูโูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุจู ูููููโูุง ุขููุฒุด ุชุจุฏู ุดุฏู ู ุณูพุณ ุจุฑุง ุขููุฒุด ูุฏู ุฌุงููุง ุชูฺฉฺฉ ูโุดููุฏ:
```python
files = load_text_files(DATA_ROOT)
examples = build_examples(files)
random.shuffle(examples)

split = int(len(examples) * 0.95)
train_examples = examples[:split]
val_examples = examples[split:]
```

&nbsp;&nbsp;&nbsp;โขุฎุท ุงูู: ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน `load_text_files`ุ ุชูุงู ูุงูโูุง ูุชู ููุฌูุฏ ุฏุฑ ูุณุฑ ุฏุงุฏูโูุง ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุฎุท ุฏูู: ุชุงุจุน `build_examples` ุงุฒ ุฑู ูุงูโูุง ูุชูุ ุฌูุชโุฌููุงุช ุขููุฒุด ุฑุง ุจุฑ ุงุณุงุณ ุงูุฏุงุฒูโ ูพูุฌุฑูโ ูุนูุง ุงุฌุงุฏ ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุฎุท ุณูู: ููุฑุณุช ูููููโูุง ุชููุฏุดุฏู ุจูโุตูุฑุช ุชุตุงุฏู ุฏุฑููโุณุงุฒ (shuffle) ูโุดูุฏ ุชุง ุชุฑุชุจ ุฌููุงุช ุฏุฑ ูุฑุขูุฏ ุขููุฒุด ุจุงุนุซ ุงุฌุงุฏ ุณูฺฏุฑ ูุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โขุณู ุฎุท ูพุงุงู ุฏุงุฏูโูุง ุฏุฑููโุฑุฎุชูโุดุฏู ุฑุง ุจู ุฏู ุจุฎุด ุชูุณู ูโฺฉููุฏ:<br>
&nbsp;&nbsp;&nbsp;โข ูชนต ุจุฑุง ุขููุฒุด ูุฏู (train_examples)<br>
&nbsp;&nbsp;&nbsp;โข ตูช ุจุฑุง ุงุนุชุจุงุฑุณูุฌ ูุฏู (val_examples)<br>

ุงู ูุณุจุช ุจุงุนุซ ูโุดูุฏ ูุฏู ุฏุฑ ุทูู ุขููุฒุด ุจู ุงูุฏุงุฒูโ ฺฉุงู ุฏุงุฏูโ ูุชููุน ุฏุฑุงูุช ฺฉูุฏ ู ุฏุฑ ุนู ุญุงู ูุฌููุนูโุง ูุณุชูู ุจุฑุง ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุขู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ.<br>


ุฏุฑ ุงุฏุงููุ ุฏุงุฏูโูุง ุขููุฒุด ู ุงุนุชุจุงุฑุณูุฌ ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ูุฑุขูุฏ ุฑุฒุชูุธู ูุฏู ุขูุงุฏู ูโุดููุฏ:
```python
train_dataloader = DataLoader(train_examples, shuffle=True, batch_size=BATCH_SIZE)
val_sentences1 = [ex.texts[0] for ex in val_examples]
val_sentences2 = [ex.texts[1] for ex in val_examples]
val_scores = [1.0] * len(val_examples)

val_evaluator = evaluation.EmbeddingSimilarityEvaluator(
    val_sentences1,
    val_sentences2,
    val_scores,
    name="val"
)
```
ุชูุถุญ ุนููฺฉุฑุฏ ฺฉุฏ ุจุงูุง:<br>
ฑ) ุณุงุฎุช DataLoader ุจุฑุง ุฏุงุฏูโูุง ุขููุฒุด:<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ฺฉูุงุณ DataLoader ุงุฒ ฺฉุชุงุจุฎุงููโ PyTorch ูุฑุงุฎูุงู ูโุดูุฏ. 
ุงู ฺฉูุงุณ ูุธูู ุฏุงุฑุฏ:<br>
&nbsp;&nbsp;&nbsp;โข ุฏุงุฏูโูุง ุขููุฒุด ุฑุง ุฏุฑ ุฏุณุชูโูุง ฺฉูฺฺฉ (Batch) ูุทุงุจู ููุฏุงุฑ `BATCH_SIZE` ุขูุงุฏู ฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุชุฑุชุจ ุฏุงุฏูโูุง ุฑุง ุฏุฑ ูุฑ epoch ุจูโุตูุฑุช ุชุตุงุฏู ุชุบุฑ ุฏูุฏ (shuffle=True).<br>
&nbsp;&nbsp;&nbsp;โข ู ุฏุงุฏูโูุง ุฑุง ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุญูููโ ุขููุฒุด ูุฏู ุฏุฑ ุงุฎุชุงุฑ Sentence Transformers ูุฑุงุฑ ุฏูุฏ.<br>

ฒ) ุงุณุชุฎุฑุงุฌ ุฌููุงุช ุงุนุชุจุงุฑุณูุฌ:<br>
ุฏุฑ ุฏู ุฎุท ุจุนุฏ:<br>
&nbsp;&nbsp;&nbsp;โขval_sentences1 ุดุงูู ุฌูููโ ุงูู ูุฑ ุฌูุช ูููููโ ุงุนุชุจุงุฑุณูุฌ ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โขval_sentences2 ุดุงูู ุฌูููโ ุฏูู ูุฑ ุฌูุช ููููู ุงุณุช.<br>
ุงู ุฏู ููุฑุณุช ูุฑูุฏโูุง ูุงุฒู ุจุฑุง ูุญุงุณุจูโ ุดุจุงูุช ูุนูุง ูุณุชูุฏ.<br>

ณ) ุชุนุฑู ููุฑุงุช ุดุจุงูุช ูุงูุน:<br>
ุฏุฑ ุฎุท ฺูุงุฑูุ ุจุฑุง ูุฑ ุฌูุช ุฌููู ฺฉ ููุฏุงุฑ ฑ.ฐ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. ุงู ููุฏุงุฑ ูุดุงู ูโุฏูุฏ ฺฉู ุชูุงู ุฌูุชโุฌููุงุช ุงุนุชุจุงุฑุณูุฌ ุงุฒ ูุธุฑ ูุนูุง ูุฑุชุจุท ูุณุชูุฏ ู ุจุงุฏ ุดุจุงูุช ุจุงูุง ุฏุงุดุชู ุจุงุดูุฏ.<br>

ด)  ุชุนุฑู ุงุฑุฒุงุจ ุดุจุงูุช  (EmbeddingSimilarityEvaluator)<br>
ุฏุฑ ุจุฎุด ูพุงุงูุ ุดุก val_evaluator ุณุงุฎุชู ูโุดูุฏ. ุงู ุงุฑุฒุงุจ:<br>
&nbsp;&nbsp;&nbsp;โข ุจุฑุฏุงุฑูุง embedding ุฌููุงุช ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ูุญุงุณุจู ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุดุจุงูุช ฺฉุณููุณ ุจู ูุฑ ุฌูุช ุฌููู ุฑุง ุจูโุฏุณุช ูโุขูุฑุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุงู ุดุจุงูุช ูพุดโุจูโุดุฏู ุฑุง ุจุง ููุฏุงุฑ ูุงูุน (val_scores) ููุงุณู ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ู ุฏุฑ ููุงุช ุจุง ูุญุงุณุจูโ ููุจุณุชฺฏ [^44] ูุงู ุฏู ูุฌููุนู ููุฑูุ ฺฉูุช ูุฏู ุฑุง ุฏุฑ ูุฑุญููโ ุงุนุชุจุงุฑุณูุฌ ฺฏุฒุงุฑุด ูโฺฉูุฏ.<br>

ุงู ุงุฑุฒุงุจ ุฏุฑ ุทูู ุขููุฒุด ู ุฏุฑ ูพุงุงู ูุฑ epoch ุงุฌุฑุง ูโุดูุฏ ุชุง ุฑููุฏ ุจูุจูุฏ ูุฏู ูุงุจู ูพุงุด ุจุงุดุฏ.<br>

ุฏุฑ ุงู ูุฑุญููุ ูุฏู ูพุงู ุจุงุฑฺฏุฐุงุฑ ุดุฏู ู ุชุงุจุน ูุฒูู ู ูพุงุฑุงูุชุฑูุง ูุฑุจูุท ุจู ฺฏุฑูโุณุงุฒ ูุฑุฎ ุงุฏฺฏุฑ ุชุนุฑู ูโุดููุฏ:
```python
print(f"๐น Loading base model: {BASE_MODEL}")
model = SentenceTransformer(str(BASE_MODEL))
train_loss = losses.MultipleNegativesRankingLoss(model)
warmup_steps = max(100, int(len(train_dataloader) * EPOCHS * 0.1))
print(f"๐ Starting fine-tuning... (epochs={EPOCHS}, batch={BATCH_SIZE})")
```
ฑ) ุจุงุฑฺฏุฐุงุฑ ูุฏู ูพุงู<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ูุณุฑ ูุฏู ูพุงู ฺุงูพ ูโุดูุฏ ู ุณูพุณ:<br>
&nbsp;&nbsp;&nbsp;โขุจุง ุงุณุชูุงุฏู ุงุฒ `SentenceTransformer`ุ ูุฏู ุงููู (ูุซูุงู all mpnet base v2) ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข ุงู ูุฏู ููุทูโ ุดุฑูุน ูุฑุขูุฏ ุฑุฒุชูุธู ุงุณุช.<br>

ฒ) ุชุนุฑู ุชุงุจุน ูุฒูู (Loss Function)<br>
ุฏุฑ ุฎุท ุจุนุฏุ ุชุงุจุน ูุฒูู `MultipleNegativesRankingLoss` ุงูุชุฎุงุจ ูโุดูุฏ. ุงู ุชุงุจุน:<br>
&nbsp;&nbsp;&nbsp;โข ุฌููุงุช ูุฑุชุจุท ู ููโูุนู ุฑุง ุจู ฺฉุฏฺฏุฑ ูุฒุฏฺฉโุชุฑ ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ู ุณุงุฑ ูููููโูุง ุฑุง ุจูโุนููุงู ูููููโูุง ููู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ู ุงุฒ ุขูโูุง ูุงุตูู ูโฺฏุฑุฏ.<br>
ุงู ุฑูุด ฺฉ ุงุฒ ุฑุงุฌโุชุฑู ู ูุคุซุฑุชุฑู ุชูุงุจุน ูุฒูู ุจุฑุง ุขููุฒุด ูุฏูโูุง embedding ูุจุชู ุจุฑ ุดุจุงูุช ูุนูุง ุงุณุช.<br>

ณ) ุชุนู `warmup_steps` ุจุฑุง ฺฉูุชุฑู ูุฑุฎ ุงุฏฺฏุฑ<br>
ุฏุฑ ุฎุท ุณููุ ููุฏุงุฑ `warmup_steps` ูุญุงุณุจู ูโุดูุฏ. ุงู ููุฏุงุฑ ุชุนู ูโฺฉูุฏ ฺฉู:<br>
&nbsp;&nbsp;&nbsp;โข ูุฑุฎ ุงุฏฺฏุฑ ุฏุฑ ุงุจุชุฏุง ุขููุฒุด ุจูโุตูุฑุช ุชุฏุฑุฌ ุงุฒ ุตูุฑ ุดุฑูุน ุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ู ุท ุญุฏูุฏ ฑฐูช ุงุฒ ฺฉู ฺฏุงูโูุง ุขููุฒุด ุจู ููุฏุงุฑ ููุง ุฎูุฏ ุนู
$
2 \times 10^{-5}
$
 ุจุฑุณุฏ.<br>

&nbsp;&nbsp;&nbsp;โข ุงู ุชฺฉูฺฉ ฺฉู ุจู ุขู **Warmup** ฺฏูุชู ูโุดูุฏุ ููุด ููู ุฏุฑ:<br>
&nbsp;&nbsp;&nbsp;โข ุฌููฺฏุฑ ุงุฒ ููุณุงูโูุง ุดุฏุฏ ุฏุฑ ุงุจุชุฏุง ุขููุฒุดุ<br>
&nbsp;&nbsp;&nbsp;โข ุงูุฒุงุด ูพุงุฏุงุฑ ูุฑุขูุฏ ุงุฏฺฏุฑุ<br>
&nbsp;&nbsp;&nbsp;โข ู ุจูุจูุฏ ุฏูุช ููุง ูุฏู
ุฏุงุฑุฏ.<br>

ด) ุขุบุงุฒ ูุฑุขูุฏ ุฑุฒุชูุธู<br>
ุฏุฑ ุฎุท ูพุงุงูุ ูพุงู ุขุบุงุฒ ุขููุฒุด ฺุงูพ ูโุดูุฏ ู ูพุงุฑุงูุชุฑูุง ฺฉูุฏ ูุงููุฏ ุชุนุฏุงุฏ epoch ูุง ู ุงูุฏุงุฒูโ batch ููุงุด ุฏุงุฏู ูโุดูุฏ.<br>


ุฏุฑ ูุฑุญููโ ูพุงุงูุ ูุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุงุฑุงูุชุฑูุง ุงุฒ ูพุด ุชุนูโุดุฏู ุขููุฒุด ุฏุงุฏู ูโุดูุฏ:
```python
model.fit(
    train_objectives=[(train_dataloader, train_loss)],
    evaluator=val_evaluator,
    epochs=EPOCHS,
    warmup_steps=warmup_steps,
    optimizer_params={'lr': LR},
    output_path=str(SAVE_DIR),
    save_best_model=True,          
    show_progress_bar=True
)
print(f"โ Best fine-tuned model saved to: {SAVE_DIR}/best_model")
```
ฑ) ุงุฌุฑุง ุขููุฒุด ูุฏู<br>
ุชุงุจุน `model.fit` ูุฑุขูุฏ ุฑุฒุชูุธู ุฑุง ุขุบุงุฒ ูโฺฉูุฏ. ุฏุฑ ุงู ูุฑุญูู:<br>
&nbsp;&nbsp;&nbsp;โข `train_dataloader` ุฏุงุฏูโูุง ุขููุฒุด ุฑุง ุฏุฑ ูุงูุจ `batch` ูุง ูุชูุงู ูุฑุงูู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข `train_loss` ุชุงุจุน ูุฒููโุง ุงุณุช ฺฉู ูุฏู ุจุฑ ุงุณุงุณ ุขู ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข `val_evaluator` ุฏุฑ ูพุงุงู ูุฑ `epoch` ุจุฑุง ุงุฑุฒุงุจ ฺฉูุช ูุฏู ูุฑุงุฎูุงู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข `warmup_steps` ุชุนุฏุงุฏ ฺฏุงูโูุง ุฑุง ูุดุฎุต ูโฺฉูุฏ ฺฉู ุท ุขู ูุฑุฎ ุงุฏฺฏุฑ ุจูโุตูุฑุช ุชุฏุฑุฌ ุงูุฒุงุด ูโุงุจุฏ.<br>

ฒ) ุชูุธู ูุฑุฎ ุงุฏฺฏุฑ<br>
ูพุงุฑุงูุชุฑ `optimizer_params` (ุฏุฑ ุงูุฌุง ุจุง ููุฏุงุฑ LR = 2e-5) ูุฑุฎ ุงุฏฺฏุฑ ููุง ูุฏู ุฑุง ุชุนู ูโฺฉูุฏ. ุฏุฑ ุงู ููุฏุงุฑ ูพุณ ุงุฒ ุท ุฏูุฑูโ `warmup` ุจูโุทูุฑ ฺฉุงูู ูุนุงู ูโุดูุฏ.<br>



ณ) ุฐุฎุฑูโุณุงุฒ ุจูุชุฑู ูุณุฎู ูุฏู<br>
ูพุงุฑุงูุชุฑ `save_best_model=True` ุจุงุนุซ ูโุดูุฏ ฺฉู:<br>
&nbsp;&nbsp;&nbsp;โข ุฏุฑ ูพุงุงู ูุฑ epochุ ุงุฑุฒุงุจ `val_evaluator` ุงุฌุฑุง ุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุนููฺฉุฑุฏ ูุฏู ุจุฑ ุงุณุงุณ ูุชุฑฺฉ ุดุจุงูุช ูุนูุง ุณูุฌุฏู ุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ู ุจูุชุฑู ูุณุฎูโ ูุฏู (ุจุง ุจุงูุงุชุฑู ุงูุชุงุฒ ุงุนุชุจุงุฑุณูุฌ) ุฏุฑ ูุณุฑ ูุดุฎุตโุดุฏู ุฐุฎุฑู ฺฏุฑุฏุฏ.<br>
ุฏุฑ ูพุงุงูุ ูุณุฑ ุฐุฎุฑูโุณุงุฒ ุจูุชุฑู ูุฏู ฺุงูพ ูโุดูุฏ ุชุง ฺฉุงุฑุจุฑ ุงุฒ ููููุช ูุฑุขูุฏ ุฑุฒุชูุธู ูุทูุฆู ุดูุฏ.
<br>

ุฎุฑูุฌ ุงุฌุฑุง ุงู ูุฑุงุญู ูุดุงุจู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:
 
![
ุชุตูุฑ ฑณ โ ูุซุงู ุงุฒ ุชุฑููุงู ุงุฌุฑุง ุฏุณุชูุฑุงุช ฺฉุฏ ูุงูโุชูู ูุฏู embedding โ ุจุฑุง ูพฺฉุฑุจูุฏ 5 TB + G
](/assets/patterneffort/synergistic-rag/media/fig13.JPG)
<p style="text-align:center;">
  <sub>
ุชุตูุฑ ฑณ โ ูุซุงู ุงุฒ ุชุฑููุงู ุงุฌุฑุง ุฏุณุชูุฑุงุช ฺฉุฏ ูุงูโุชูู ูุฏู embedding โ ุจุฑุง ูพฺฉุฑุจูุฏ  5TB + G
</sub>
</p>

<br>
 
![
ุชุตูุฑ ฑด โ ูุซุงู ุงุฒ ุชุฑููุงู ุงุฌุฑุง ุฏุณุชูุฑุงุช ฺฉุฏ ูุงูโุชูู ูุฏู embedding โ ุจุฑุง ูพฺฉุฑุจูุฏ  5TB + G โ ุงุชูุงู ูุฑุขูุฏ
](/assets/patterneffort/synergistic-rag/media/fig14.JPG)
<p style="text-align:center;">
  <sub>
ุชุตูุฑ ฑด โ ูุซุงู ุงุฒ ุชุฑููุงู ุงุฌุฑุง ุฏุณุชูุฑุงุช ฺฉุฏ ูุงูโุชูู ูุฏู embedding โ ุจุฑุง ูพฺฉุฑุจูุฏ  5TB + G โ ุงุชูุงู ูุฑุขูุฏ
</sub>
</p>

<br>

---
### ุฑุฒโุชูุธู ุจุง SNS

ููุงูโุทูุฑ ฺฉู ูพุดโุชุฑ ุงุดุงุฑู ุดุฏุ ุฏุฑ ุดุดูู ูพฺฉุฑุจูุฏ ุขุฒูุงุด ููุงูู (17TB + G + SNS)ุ ุฏุงุฏูโูุง ฺฉู ุชูุณุท  (SNS) Semantic Node Splitter [^45]  ูพุฑุฏุงุฒุด ุดุฏูโุงูุฏุ ุจุฑุง ุขููุฒุด ูุฌุฏุฏ ู ุฑุฒุชูุธู ูุฏู ุฌุงููุง ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑูุชูโุงูุฏ. ุชูุงูุช ุงุตู ุงู ูพฺฉุฑุจูุฏ ุจุง ูพฺฉุฑุจูุฏโูุง ูุจู ุฏุฑ ูุญูู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง ุขููุฒุด ุงุณุช.<br>

ุฏุฑ ูพฺฉุฑุจูุฏโูุง ูพุดูุ ุฌููุงุช ุจูโุตูุฑุช ุชุฑุชุจ ู ุจุฏูู ุชูุฌู ุจู ูุฒุงู ุดุจุงูุช ูุนูุง ุจุง ฺฉุฏฺฏุฑ ุฌูุช ูโุดุฏูุฏ. ุงู ุฑูุด ุงฺฏุฑฺู ุณุงุฏู ู ฺฉูโูุฒูู ุงุณุชุ ุงูุง ุงูุฒุงูุงู ุชุถูู ููโฺฉูุฏ ฺฉู ุฌูุชโุฌูููโูุง ุงูุชุฎุงุจโุดุฏู ุงุฒ ูุธุฑ ูุนูุง ุจุง ฺฉุฏฺฏุฑ ููโุฑุงุณุชุง ุจุงุดูุฏ. ุฏุฑ ูุชุฌูุ ูุฏู ุฌุงููุง ุฏุฑ ูุฑุญูู ุฑุฒุชูุธูุ ุณฺฏูุงูโูุง ุขููุฒุด ุถุนูโุชุฑ ู ูพุฑุงฺฉูุฏูโุชุฑ ุฏุฑุงูุช ูโฺฉุฑุฏ.<br>

ุงูุง ุฏุฑ ูพฺฉุฑุจูุฏ ูุจุชู ุจุฑ SNSุ ุฌููุงุช ุงุจุชุฏุง ุจุฑุงุณุงุณ ุดุจุงูุช ูุนูุง ุฎูุดูโุจูุฏ ุดุฏู ู ุณูพุณ ูุฑ ุฎูุดู ุจูโุนููุงู ฺฉ ยซฺฏุฑู ูุนูุงยป ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. ุฌููุงุช ููุฌูุฏ ุฏุฑ ูุฑ ฺฏุฑู ุงุฒ ูุธุฑ ูุนูุง ุจู ฺฉุฏฺฏุฑ ูุฒุฏฺฉโุงูุฏ ู ุจูุงุจุฑุงู ุฌูุชโุฌูููโูุง ุชุดฺฉูโุดุฏู ุจุฑุง ุฑุฒุชูุธูุ ฺฉูุช ุจุณุงุฑ ุจุงูุงุชุฑ ุฏุงุฑูุฏ.

<br>

ุงู ุชุบุฑ ุจุงุนุซ ูโุดูุฏ ูุฏู ุฌุงููุง ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ:<br>

&nbsp;&nbsp;&nbsp;โข ุฏุฑฺฉ ุนููโุชุฑ ุงุฒ ุณุงุฎุชุงุฑ ูุนูุง ูุชู ูพุฏุง ฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุจุฑุฏุงุฑูุง ุฏููโุชุฑ ู ููุณุฌูโุชุฑ ุจุฑุง ุฌููุงุช ุชููุฏ ฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ู ุฏุฑ ููุงุชุ context ูุง ูุฑุชุจุทโุชุฑ ุฑุง ุฏุฑ ูพุงุณุฎ ุจู ูพุฑุณุด ฺฉุงุฑุจุฑ ุจุงุฒุงุจ ฺฉูุฏ.

<br>

ุจู ุจุงู ุฏฺฏุฑุ SNS ุจุง ุงุฌุงุฏ ุฌูุชโูุง ุขููุฒุด ูุจุชู ุจุฑ ุดุจุงูุช ูุนูุงุ ฺฉูุช ุณฺฏูุงู ุขููุฒุด ุฑุง ุงูุฒุงุด ูโุฏูุฏ ู ุงู ููุถูุน ุจูโุทูุฑ ูุณุชูู ุฏุฑ ุจูุจูุฏ ุนููฺฉุฑุฏ ูุฏู ุฌุงููุง ุฏุฑ ูุนูุงุฑ RAG ููุนฺฉุณ ูโุดูุฏ.<br>

ุจุฑุง ูพุงุฏู ุณุงุฒ ุงู ูุฑุญูู ฺฉุงูุณุช ุชุง ุฏู ุชุบุฑ ุฒุฑ ุฏุฑ ฺฉุฏ ุฑุฒุชูุธู ูุนุฑู ุดุฏู ุงุฌุงุฏ ุดูุฏ:<br>

ฑ) ุงุจุชุฏุง ุชุงุจุน `sns_split` ุจู ฺฉุฏ ุฑุฒุชูุธู ุงูุฒูุฏู ูโฺฏุฑุฏุฏ:<br>
```python
SNS_THRESHOLD = 0.55
MAX_NODE_LEN = 8
MIN_NODE_LEN = 2

model = SentenceTransformer(str(BASE_MODEL))

def sns_split(sents):
    if len(sents) <= MIN_NODE_LEN:
        return [" ".join(sents)]

    with torch.no_grad():
        embs = model.encode(
            sents,
            normalize_embeddings=True,
            show_progress_bar=False,
            batch_size=96
        )

    sims = util.cos_sim(embs[:-1], embs[1:]).diagonal().cpu().numpy()
    nodes, cur = [], [sents[0]]

    for i in range(1, len(sents)):
        if sims[i - 1] < SNS_THRESHOLD or len(cur) >= MAX_NODE_LEN:
            nodes.append(" ".join(cur))
            cur = [sents[i]]
        else:
            cur.append(sents[i])

    if cur:
        nodes.append(" ".join(cur))

    return nodes
```
ุฏุฑ ฺฉุฏ ุจุงูุงุ ุฏุฑ ุงุจุชุฏุง ูพุงุฑุงูุชุฑูุง ุงุตู ุชุงุจุน ุจูโุตูุฑุช ุฒุฑ ุชุนุฑู ูโุดููุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	SNS_THRESHOLD: ุญุฏุงูู ุดุจุงูุช ูุนูุง ูุงุฒู ุจู ุฏู ุฌููู ูุชูุงู ุจุฑุง ูุฑุงุฑ ฺฏุฑูุชู ุฏุฑ ฺฉ ฺฏุฑู ูุดุชุฑฺฉ.<br>
&nbsp;&nbsp;&nbsp;โข	MAX_NODE_LEN: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฌููุงุช ูุฌุงุฒ ุฏุฑ ฺฉ ฺฏุฑู.<br>
&nbsp;&nbsp;&nbsp;โข	MIN_NODE_LEN: ุญุฏุงูู ุชุนุฏุงุฏ ุฌููุงุช ูุงุฒู ุจุฑุง ุชุดฺฉู ฺฉ ฺฏุฑู ูุณุชูู.<br>
ุงู ูพุงุฑุงูุชุฑูุง ุฑูุชุงุฑ SNS ุฑุง ฺฉูุชุฑู ูโฺฉููุฏ ู ุชุนู ูโฺฉููุฏ ฺฉู ฺฏุฑูโูุง ฺูุฏุฑ ฺฉูฺฺฉ ุง ุจุฒุฑฺฏ ุจุงุดูุฏ.

<br>

ุณูพุณ:
<br>
&nbsp;&nbsp;&nbsp;โข	model: ูุฏู ุฌุงููุง ูพุงู (ููุงู ูุฏู ฺฉู ูุฑุงุฑ ุงุณุช ุฑุฒุชูุธู ุดูุฏ) ุจุฑุง ูุญุงุณุจู ุดุจุงูุช ูุนูุง ุจู ุฌููุงุช ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ุฑุฒุชูุธู ุฏููุงู ุจุฑ ุงุณุงุณ ููุงู ูุถุง ุจุฑุฏุงุฑ ุงูุฌุงู ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	embs: ุจุฑุฏุงุฑูุง ุฌููุงุช ุจุง ูุฑูุงูโุณุงุฒ ูุงุญุฏ ุชููุฏ ูโุดููุฏุ ูุญุงุณุจุงุช ุฏุงุฎู `torch.no_grad` ู ุจุง `batch_size=96` ุงูุฌุงู ูโฺฏุฑุฏ ุชุง ูุตุฑู ุญุงูุธู ู ุณุฑุนุช ุจููู ุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	sims: ุณูพุณ ุดุจุงูุช ฺฉุณููุณ ุจู ูุฑ ุฌููู ู ุฌููู ุจุนุฏ ูุญุงุณุจู ูโุดูุฏ. ุฏุฑ ุงูุฌุง ุชููุง ุดุจุงูุชโูุง ูุชูุงู ุงููุช ุฏุงุฑูุฏ. (SNS ฺฉ ุงูฺฏูุฑุชู ุฎุท ุงุณุชุ ูู ุฎูุดูโุจูุฏ ฺฉุงูู.) ุงู ุดุจุงูุชโูุง ุชุนู ูโฺฉููุฏ ฺฉู ุขุง ุฏู ุฌููู ุจุงุฏ ุฏุฑ ฺฉ ฺฏุฑู ูุฑุงุฑ ุจฺฏุฑูุฏ ุง ุฎุฑ.
<br>

ุฏุฑ nodesุ cur ู ุญููู for ุจุนุฏ ุงุฒ ุขู:<br>

&nbsp;&nbsp;&nbsp;โข	ฺฉ ฺฏุฑู ุฌุฏุฏ ุจุง ุฌููู ุงูู ุดุฑูุน ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุญููู: ุจุฑุง ูุฑ ุฌููู ุจุนุฏุ ุงุจุชุฏุง ุจุฑุฑุณ ูโุดูุฏ:<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุงฺฏุฑ ุดุจุงูุช ุจุง ุฌููู ูุจู ฺฉูุชุฑ ุงุฒ ุขุณุชุงูู ุจุงุดุฏ ุง ุทูู ฺฏุฑู ุจู ุญุฏุงฺฉุซุฑ ุจุฑุณุฏุ ฺฏุฑู ุฌุงุฑ ุจุณุชู ูโุดูุฏ ู ุฌููู ูุนู ุจูโุนููุงู ุดุฑูุน ฺฏุฑู ุฌุฏุฏ ูุฑุงุฑ ูโฺฏุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุฌููู ูุนู ุจู ฺฏุฑู ุฌุงุฑ ุงุถุงูู ูโุดูุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ูพุงุงู: ุงฺฏุฑ ฺฏุฑูโุง ูููโฺฉุงุฑู ุจุงู ูุงูุฏู ุจุงุดุฏุ ุจู ุฎุฑูุฌ ุงูุฒูุฏู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุฑูุฌ:<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุฌููุนูโุง ุงุฒ ฺฏุฑูโูุง ูุนูุง ุจุง ุฌููุงุช ูุฑุชุจุท ู ุทูู ฺฉูุชุฑูโุดุฏู ฺฉู ุจุฑุง ุณุงุฎุช ุฌูุชโุฌูููโูุง ุจุงฺฉูุช ุฏุฑ ูุฑุญูู ุฑุฒุชูุธู ุง ุงุฑุฒุงุจ ุงุณุชูุงุฏู ูโุดููุฏ.

<br>

ุฎุฑูุฌ ุชุงุจุน ูุฌููุนูโุง ุงุฒ ฺฏุฑูโูุง ูุนูุง ุงุณุช ฺฉู ูุฑ ฺฏุฑู ุดุงูู ฺูุฏ ุฌููู ูุฑุชุจุท ุงุณุช. ุงู ฺฏุฑูโูุง ุณูพุณ ุจุฑุง ุณุงุฎุช ุฌูุชโุฌูููโูุง ุจุงฺฉูุช ุฏุฑ ูุฑุญูู ุฑุฒุชูุธู ุงุณุชูุงุฏู ูโุดููุฏ.<br>


ฒ) ุณูพุณุ ุชุงุจุน file_to_sentences  ุจู ุตูุฑุช ุฒุฑ ุจุงุฒููุณ ุดูุฏ:
```python
def file_to_sentences(path, min_len=30):
    try:
        text = path.read_text(encoding="utf-8", errors="ignore")
    except Exception:
        return []

    sents = [s.strip() for s in sent_tokenize(text) if len(s.strip()) >= min_len]

    if len(sents) == 0:
        return []

    nodes = sns_split(sents)

    return nodes[:MAX_SENT_PER_FILE]
```
ุชูุถุญ ุนููฺฉุฑุฏ ุชุงุจุน ุจุงุฒููุณ ุดุฏู:<br>

&nbsp;&nbsp;&nbsp;โข	ุฎูุงูุฏู ูุงู ูุฑูุฏ: ูุชู ูุงู ุจุง ุฑูุฒฺฏุฐุงุฑ UTF 8 ุฎูุงูุฏู ูโุดูุฏ. ุฏุฑ ุตูุฑุช ุจุฑูุฒ ุฎุทุงุ ุชุงุจุน ููุฏุงุฑ ุฎุงู ุจุงุฒูโฺฏุฑุฏุงูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงุณุชุฎุฑุงุฌ ุฌููุงุช ูุนุชุจุฑ: ูุชู ุจู ุฌููุงุช ุชูุณู ูโุดูุฏ ู ุชููุง ุฌููุงุช ฺฉู ุทูู ุขูโูุง ุญุฏุงูู `min_len` ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ ูฺฏู ุฏุงุดุชู ูโุดููุฏ. ุงู ฺฉุงุฑ ุงุฒ ูุฑูุฏ ุฌููุงุช ุจุณุงุฑ ฺฉูุชุงู ู ุจโูุนูุง ุฌููฺฏุฑ ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑุฑุณ ุฎุงู ูุจูุฏู ุฌููุงุช: ุงฺฏุฑ ูฺ ุฌููู ูุนุชุจุฑ ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุชุงุจุน ููุฏุงุฑ ุฎุงู ุจุงุฒูโฺฏุฑุฏุงูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุชูุณู ุฌููุงุช ุจู ููุฏูุง ูุนูุง: ุจูโุฌุง ุจุงุฒฺฏุฑุฏุงูุฏู ุฌููุงุช ุฎุงูุ ุชุงุจุน `sns_split` ูุฑุงุฎูุงู ูโุดูุฏ ุชุง ุฌููุงุช ุจุฑุงุณุงุณ ุดุจุงูุช ูุนูุง ุจู ฺฏุฑูโูุง ูุนูุง ุชูุณู ุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุญุฏูุฏ ฺฉุฑุฏู ุชุนุฏุงุฏ ุฎุฑูุฌ: ุชููุง ุชุนุฏุงุฏ ูุดุฎุต ุงุฒ ููุฏูุง (ุชุง ุณูู `MAX_SENT_PER_FILE`) ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ ุชุง ุญุฌู ุฏุงุฏู ุขููุฒุด ฺฉูุชุฑู ุดูุฏ.<br>

ุจุง ุงู ุจุงุฒููุณ:<br>

&nbsp;&nbsp;&nbsp;โข	ูุงุญุฏูุง ุขููุฒุด ูุฏู ุฌุงููุง ุงุฒ ุฌููุงุช ูพุฑุงฺฉูุฏู ู ุชุฑุชุจ ุจู ฺฏุฑูโูุง ูุนูุง ููุณุฌู ุชุจุฏู ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑ ฺฏุฑู ุดุงูู ฺูุฏ ุฌููู ูุฑุชุจุท ุงุณุช ู ุจูุงุจุฑุงู ุณฺฏูุงู ุขููุฒุด ุจุณุงุฑ ููโุชุฑ ุจู ูุฏู ููุชูู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงู ููุถูุน ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ุจุงุนุซ ุงูุฒุงุด ุงุฑุชุจุงุท ูุนูุง context ูุง ุจุงุฒุงุจโุดุฏู ู ุฏุฑ ูุชุฌู ุจูุจูุฏ ฺฉูุช ูพุงุณุฎ ููุง ูุฏู ูโุดูุฏ.<br>
ุฎุฑูุฌ ุนููฺฉุฑุฏ ุงู ูพฺฉุฑุจูุฏ ู ููุงุณู ุนููฺฉุฑุฏ ุขู ุจุง ูพฺฉุฑุจูุฏ ูุง ูพุดู ุฏุฑ ุจุฎุด ูุชุงุฌ ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ุฎูุงูุฏ ฺฏุฑูุช.

<br>

#### ฺฉ ูฺฉุชู ููู ุฏุฑุจุงุฑู ุจูููโุณุงุฒ ุฒูุงู ุงุฌุฑุง ุงู ฺฉุฏ:
ุจุง ุชูุฌู ุจู ุงูฺฉู ุฏุฑ ุงู ูพฺฉุฑุจูุฏุ ูุฑุขูุฏ ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง ุจุฑ ูพุงู ูุฏู ุฌุงููุง ุงูุฌุงู ูโุดูุฏุ ุงุฌุฑุง ฺฉู ุนููุงุช ุฏุฑ ฺฉ ูุฑุญูู ูโุชูุงูุฏ ูุฒูู ุฒูุงู ูุงุจูโุชูุฌู ุงุฌุงุฏ ฺฉูุฏ. ูุญุงุณุจู ุจุฑุฏุงุฑูุง ุฌููุงุชุ ุณูุฌุด ุดุจุงูุชโูุง ูุชูุงู ู ุชุดฺฉู ููุฏูุง ูุนูุง ููฺฏ ุนููุงุชโูุง ูุณุจุชุงู ุณูฺฏู ูุณุชูุฏ ู ุชฺฉุฑุงุฑ ุขูโูุง ุฏุฑ ูุฑ ุจุงุฑ ุงุฌุฑุง ุฑุฒุชูุธูุ ุฒูุงู ฺฉู ูุฑุขูุฏ ุฑุง ุจูโุทูุฑ ุบุฑุถุฑูุฑ ุงูุฒุงุด ูโุฏูุฏ.

ูุฐุง ุจูุชุฑ ุงุณุช ุจุฑุง ฺฉุงูุด ูุฑุชุจู  ุฒูุงู ุงุฌุฑุง ุงู ฺฉุฏุ ุขู ุฑุง ุจู ุฏู ูุฑุญูู ุขูุงุฏู ุณุงุฒ ุฏุงุฏู ูุง ู ุฑุฒ ุชูุธู ูุฏู ุชูุณู ฺฉุฑุฏ.

<br>

ุงู ุชูฺฉฺฉ ุจุงุนุซ ูโุดูุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	ูุฑุชุจู ุฒูุงู ฺฉู ูุฑุขูุฏ ฺฉุงูุด ุงุจุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุนููุงุช ุณูฺฏู SNS ููุท ฺฉโุจุงุฑ ุงูุฌุงู ุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุงูฺฉุงู ุงุฌุฑุง ฺูุฏู ุฑุฒุชูุธู ุจุง ุชูุธูุงุช ูุฎุชูู ุจุฏูู ูพุฑุฏุงุฒุด ูุฌุฏุฏ ุฏุงุฏูโูุง ูุฑุงูู ุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑุขูุฏ ุชฺฉุฑุงุฑูพุฐุฑุชุฑุ ูุงุจูโฺฉูุชุฑูโุชุฑ ู ููุงุณโูพุฐุฑุชุฑ ฺฏุฑุฏุฏ.<br>

ุฏุฑ ุขุฎุฑู ูุณูุช ุงุฒ ุงู ฺฏุฒุงุฑุด ุจู ุจุฑุฑุณ ุฑูุด ูุง ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ ุงู ูุนูุงุฑ ูพุฑุฏุงุฎุชู ุฎูุงูุฏ ุดุฏ.

<br>

---
## ูพุงุฏู ุณุงุฒ: ูุทุนู ุจูุฏ ูุนูุง

### ูุทุนู ุจูุฏ ูุนูุง

ุฏุฑ ุณููู ูุฑุญูู ุงุฒ ูุนูุงุฑ ููโุงูุฒุงุ ุจู ูุทุนูโุจูุฏ ูุนูุง (Semantic Chunking) ูพุฑุฏุงุฎุชู ูโุดูุฏ. ุจุฑ ุงุณุงุณ ุชูุถุญุงุช ุงุฑุงุฆูโุดุฏู ุฏุฑ ููุงููุ ููุณูุฏฺฏุงู ุฏุฑ ูุนูุงุฑ ูพุดููุงุฏ ุฎูุฏ ุงุฒ ุฑูฺฉุฑุฏ ยซุงููโฺฺฉุฏูยป (Abstract First) ุจุฑุง ุจุงุฒุงุจ ุงุทูุงุนุงุช ุงุณุชูุงุฏู ฺฉุฑุฏูโุงูุฏ. 
<br>

ุงู ุฑูฺฉุฑุฏ ฺฉู ุนููฺฉุฑุฏ ุขู ุฏุฑ ุจุฎุดโูุง ุจุนุฏ ฺฏุฒุงุฑุด ุจูโุทูุฑ ุฏูู ุจุฑุฑุณ ุฎูุงูุฏ ุดุฏุ ุงุฒ ุฏู ูุคูููโ ุงุตู ุชุดฺฉู ุดุฏู ุงุณุช: <br>
ฑ) Semantic Chunking <br>
ฒ) RAG (Retrieval-Augmented Generation) <br>

ุฏุฑ ุงู ุจุฎุดุ ุงุจุชุฏุง ูุญููโ ุนููฺฉุฑุฏ ูุทุนูโุจูุฏ ูุนูุง ุฏุฑ ฺฉ ูุนูุงุฑ RAG ุณุงุฏู ุฑุง ุชุดุฑุญ ูโฺฉูู. ุณูพุณ ุฏุฑ ุงุฏุงููุ ูพุงุฏูโุณุงุฒ ุงู ูุฑุญูู ุฏุฑ ฺุงุฑฺูุจ ุฑูฺฉุฑุฏ ยซุงููโฺฺฉุฏูยป ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ุฎูุงูุฏ ฺฏุฑูุช.<br>

ุฏุฑ ฺฉ ูุนูุงุฑ RAG ุณุงุฏูุ ูุฑุขูุฏ ูุทุนูโุจูุฏ ู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง ุจุฑุง ุจุงุฒุงุจ ุงุทูุงุนุงุช ูุนูููุงู ุฏุฑ ฺูุงุฑ ูุฑุญููโ ูุชูุงู ุงูุฌุงู ูโุดูุฏ:<br>

`TEI โ Chunk โ Embed โ Store`
<br>

ุจูโุตูุฑุช ุฎูุงุตู:<br>
&nbsp;&nbsp;&nbsp;โข	TEI: ุฏุฑุงูุช ู ุขูุงุฏูโุณุงุฒ ูุฑูุฏ ูุชู (Text Extraction & Ingestion)<br>
&nbsp;&nbsp;&nbsp;โข	Chunk: ูุทุนูโุจูุฏ ูุชู ุจู ุจุฎุดโูุง ฺฉูฺฺฉโุชุฑ ู ูุนูุง<br>
&nbsp;&nbsp;&nbsp;โข	Embed: ุชุจุฏู ูุฑ ูุทุนู ุจู ุจุฑุฏุงุฑูุง ูุนูุง (Embeddings)<br>
&nbsp;&nbsp;&nbsp;โข	Store: ุฐุฎุฑูโุณุงุฒ ุจุฑุฏุงุฑูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏูโ ุจุฑุฏุงุฑ ุจุฑุง ุจุงุฒุงุจ ุจุนุฏ<br>

<br>
ุฏุฑ ุงุจุชุฏุง ูุฑุญููโ ูุทุนูโุจูุฏ ูุนูุงุ ฺฉุชุงุจุฎุงููโูุง ู ฺฉูุงุณโูุง ููุฑุฏูุงุฒ ุจุฑุง ูพุฑุฏุงุฒุด ูุชูุ ุชููุฏ ุจุฑุฏุงุฑูุง ูุนูุง ู ุงุฌุงุฏ ูพุงฺฏุงู ุฏุงุฏูโ ุจุฑุฏุงุฑ ูุฑุงุฎูุงู ูโุดููุฏ:

```python
import os
import numpy as np
from pathlib import Path
from tqdm import tqdm
from sentence_transformers import SentenceTransformer, util
from nltk.tokenize import sent_tokenize
import nltk
import chromadb
from concurrent.futures import ThreadPoolExecutor

nltk.download('punkt', quiet=True)

DATA_DIR = Path(r" Enter TEI files location here ")   
EMB_MODEL = Path(r" Enter fine-tuned embedding model address here ")
CHROMA_DIR = Path(r" Enter you Database address here ")
CHROMA_DIR.mkdir(parents=True, exist_ok=True)

```

ุฏุฑ ฺฉูุงุฑ ุงุจุฒุงุฑูุง ฺฉู ุฏุฑ ูุฑุงุญู ูพุดู ูุนุฑู ุดุฏู ุจูุฏูุฏุ ุฏุฑ ุงู ุจุฎุด ุฏู ูุคูููโ ุฌุฏุฏ ูุฒ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	`ThreadPoolExecutor` ุจุฑุง ูพุฑุฏุงุฒุด ฺูุฏูุฎ [^46] ุจูโฺฉุงุฑ ูโุฑูุฏ ู ุงูฺฉุงู ูพุฑุฏุงุฒุด ููโุฒูุงู ุชุนุฏุงุฏ ุฒุงุฏ ูุงู TEI ุฑุง ูุฑุงูู ูโฺฉูุฏ. ุงู ููุถูุน ุณุฑุนุช ูุทุนูโุจูุฏ ู ุงุณุชุฎุฑุงุฌ ุฌููุงุช ุฑุง ุจูโุทูุฑ ูุงุจู ุชูุฌู ุงูุฒุงุด ูโุฏูุฏ.
<br>

&nbsp;&nbsp;&nbsp;โข	`Chromadb` ุจุฑุง ุงุฌุงุฏ ฺฉ ูพุงฺฏุงู ุฏุงุฏูโ ุจุฑุฏุงุฑ [^47] ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ูพุงฺฏุงู ุฏุงุฏู ูุญู ุฐุฎุฑูโุณุงุฒ embedding ูุง ูุทุนุงุช ูุนูุง ุงุณุช ู ุฏุฑ ูุฑุญููโ RAG ุจุฑุง ุจุงุฒุงุจ ุณุฑุน ู ุฏูู ุงุทูุงุนุงุช ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ.

<br>

ุฏุฑ ุณู ุฎุท ูพุงุงู ฺฉุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	DATA_DIR: ูุณุฑ ูุงูโูุง TEI ูพุฑุฏุงุฒุดโุดุฏู ุฑุง ูุดุฎุต ูโฺฉูุฏ (ุฏุฑ ุงู ูพุฑูฺู ุดุงูู ตฐฐฐ ููุงูู).
<br>

&nbsp;&nbsp;&nbsp;โข	EMB_MODEL: ูุณุฑ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู ุฑุง ุชุนู ูโฺฉูุฏุ ูุฏู ฺฉู ุฏุฑ ูุฑุญููโ ูุจู ุขููุฒุด ุฏุงุฏู ุดุฏ.
<br>

&nbsp;&nbsp;&nbsp;โข	CHROMA_DIR: ูุณุฑ ุฐุฎุฑูโุณุงุฒ ูพุงฺฏุงู ุฏุงุฏูโ ุจุฑุฏุงุฑ ุฑุง ูุดุฎุต ูโฺฉูุฏ. ุฏุณุชูุฑ `mkdir` ูุฒ ุชุถูู ูโฺฉูุฏ ฺฉู ุงู ูุณุฑ ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ุงุฌุงุฏ ุดูุฏ.

<br>

ุฏุฑ ูุฑุญูู ุจุนุฏุ ูุฌููุนูโุง ุงุฒ ูพุงุฑุงูุชุฑูุง ฺฉูุฏ ุจุฑุง ฺฉูุชุฑู ูุญููโ ุชุดฺฉู ูุทุนุงุช ูุนูุง ู ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุชุนุฑู ูโุดูุฏ:

```python
SIM_THRESHOLD = 0.55
```
ุงู ููุฏุงุฑ ุขุณุชุงููโ ุญุฏุงูู ุดุจุงูุช ูุนูุง ูุงู ุฌููุงุช ฺฉ ูุทุนู ุงุณุช.
ุจุฑ ุงุณุงุณ ุงุฑุฒุงุจ ููุณูุฏฺฏุงู ููุงูู ู ุขุฒูุงุดโูุง ุชุฌุฑุจุ ููุฏุงุฑ ฐ.ตต ุจูโุนููุงู ููุฏุงุฑ ุจููู ุงูุชุฎุงุจ ุดุฏู ุงุณุช.<br>

&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ุดุจุงูุช ฺฉุณููุณ ุจู ุฏู ุฌููู ฺฉูุชุฑ ุงุฒ ฐูซตต ุจุงุดุฏ: ุฌูููโ ุฌุฏุฏ ุฏุฑ ฺฉ ูุทุนูโ ูุณุชูู ูุฑุงุฑ ูโฺฏุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ุดุจุงูุช ุจุดุชุฑ ุง ุจุฑุงุจุฑ ุจุง ุงู ููุฏุงุฑ ุจุงุดุฏ: ุฌููู ุจู ููุงู ูุทุนูโ ูุนูุง ูุจู ุงูุฒูุฏู ูโุดูุฏ.<br>

ุงู ุขุณุชุงูู ููุด ุชุนูโฺฉููุฏูโุง ุฏุฑ ุงูุฏุงุฒูุ ุงูุณุฌุงู ู ฺฉูุช ูุทุนุงุช ูุนูุง ุฏุงุฑุฏ.

<br>

![
ุชุตูุฑ ฑต โ ุขูุงูุฒ ุญุณุงุณุช ุขุณุชุงูู ูุทุนู ุจูุฏ ูุนูุง โ ุชุตูุฑ ท ููุงูู Aytar
](/assets/patterneffort/synergistic-rag/media/fig15.JPG)
<p style="text-align:center;">
  <sub>
ุชุตูุฑ ฑต โ ุขูุงูุฒ ุญุณุงุณุช ุขุณุชุงูู ูุทุนู ุจูุฏ ูุนูุง โ ุชุตูุฑ ท ููุงูู Aytar
</sub>
</p>

<br>


ุจุฑ ุงุณุงุณ ูุชุงุฌ ุงุฑุงุฆูโุดุฏู ุฏุฑ ุชุตูุฑ ฑตุ ููุฏุงุฑ ุขุณุชุงูู ุดุจุงูุช ูุนูุง ููุด ุชุนูโฺฉููุฏูโุง ุฏุฑ ฺฉูุช ูุทุนูโุจูุฏ ู ุนููฺฉุฑุฏ ููุง ูุนูุงุฑ RAG ุฏุงุฑุฏ. ุชุญูู ุญุณุงุณุช ูุดุงู ูโุฏูุฏ:<br>

&nbsp;&nbsp;&nbsp;โข		ุฏุฑ ุจุงุฒูโ ุขุณุชุงููโูุง ุจุณุงุฑ ูพุงู (ฐ.ฐต ุชุง ฐ.ฑต)ุ ุชุนุฏุงุฏ ุฒุงุฏ ูุทุนูโ ูุนูุง ฺฉูฺฺฉ ู ุฎูุฑุฏ ุชููุฏ ูโุดูุฏ. ุงู ุงูุฑ ููุฌุจ ููุงุฏุงุฑ ุจุงูุง ุจู ูุชู ูุฑุฌุน ูโฺฏุฑุฏุฏุ ุงูุง ุฏุฑ ุนู ุญุงู ุงุฑุชุจุงุท ุฒูููโุง ูุงู ูุทุนุงุช ู ูุฑุฌุน ุจูโุดุฏุช ฺฉุงูุด ูโุงุจุฏ.<br>

&nbsp;&nbsp;&nbsp;โข		ุฏุฑ ููุงุจูุ ุจุง ุงุณุชูุงุฏู ุงุฒ ุขุณุชุงููโูุง ุจุณุงุฑ ุจุงูุง (ฐ.ธต ุชุง ฐ.นต)ุ ุชููุง ุชุนุฏุงุฏ ูุญุฏูุฏ ูุทุนูโ ุจุฒุฑฺฏ ุชุดฺฉู ูโุดูุฏ. ุฏุฑ ุงู ุญุงูุชุ ุฑูุงุจุท ูุนูุง ุถุนู ูุงู ุฌููุงุช ุฏุฑูู ูุฑ ูุทุนู ููุฌุฑ ุจู ฺฉุงูุด ููุงุฏุงุฑ ุจู ูุชู ูุฑุฌุนุ ุงูุช ุงุฑุชุจุงุท ูพุงุณุฎ ู ุจูโูฺู ฺฉุงูุด ุงุฑุชุจุงุท ุฒูููโุง ุจุง ูุฑุฌุน ุฎูุงูุฏ ุดุฏ.

<br>

#### ุงูุชุฎุงุจ ููุฏุงุฑ ุจููู:<br>

ุจุง ุชูุฌู ุจู ููุญูโูุง ุนููฺฉุฑุฏ ุฏุฑ ุณู ูุนุงุฑ ุงุตู (Context Relevanceุ Faithfulnessุ Answer Relevance)ุ ููุฏุงุฑ ฐ.ตต ุจูโุนููุงู ุขุณุชุงููโ ุจููู ุงูุชุฎุงุจ ุดุฏู ุงุณุช. ุงู ููุฏุงุฑ:<br>

&nbsp;&nbsp;&nbsp;โข	ุจุดุชุฑู ุงูุชุงุฒ ุฑุง ุฏุฑ ูุนุงุฑ ุงุฑุชุจุงุท ุฒูููโุง [^48] ฺฉุณุจ ฺฉุฑุฏูุ<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ุนู ุญุงู ุณุทุญ ูุงุจู ูุจูู ุงุฒ ููุงุฏุงุฑ ุจู ูุชู [^49] ู ุงุฑุชุจุงุท ูพุงุณุฎ [^50] ุฑุง ุญูุธ ฺฉุฑุฏู ุงุณุช.<br>
ุจูุงุจุฑุงูุ ููุฏุงุฑ `SIM_THRESHOLD = 0.55` ุฏุฑ ุงู ูพุฑูฺู ุจูโุนููุงู ููุทูโ ุชุนุงุฏู ูุงู ุงูุณุฌุงู ูุนูุงุ ููุงุฏุงุฑ ู ูุงุจูุช ุจุงุฒุงุจ ุงุทูุงุนุงุช ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช.
<br>

ุฏุฑ ุฎุทูุท ุฏูู ู ุณูู ุญุฏุงูู ู ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฌููู ุฏุฑ ูุฑ ูุทุนู  ูุนูุง ุชุนู ูโฺฏุฑุฏุฏ.<br>
```python
MIN_CHUNK_LEN = 3
MAX_CHUNK_LEN = 15
BATCH_SIZE = 128          
MAX_BATCH = 5000          
THREADS = 5               
CHROMA_SAFE_LIMIT = 5400  
```

&nbsp;&nbsp;&nbsp;โข	ุฏุฑ `MIN_CHUNK_LEN` ู `MAX_CHUNK_LEN` ุงู ุฏู ูพุงุฑุงูุชุฑ ุจู ุชุฑุชุจ ุญุฏุงูู ู ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฌููุงุช ุฏุฑ ูุฑ ูุทุนูโ ูุนูุง ุฑุง ูุดุฎุต ูโฺฉููุฏ. ููุฏุงุฑูุง ุงูุชุฎุงุจโุดุฏู (ณ ู ฑต) ุชุถูู ูโฺฉููุฏ ฺฉู ูุทุนุงุช ูู ุจุด ุงุฒ ุญุฏ ฺฉูฺฺฉ ู ูู ุจุด ุงุฒ ุญุฏ ุจุฒุฑฺฏ ุจุงุดูุฏุ ุชุง ูู ุงูุณุฌุงู ูุนูุง ุญูุธ ุดูุฏ ู ูู ฺฉุงุฑุง ูุฏู ุฏุฑ ูุฑุญููโ ุจุงุฒุงุจ ุงูุฒุงุด ุงุจุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	`BATCH_SIZE` ุชุนุฏุงุฏ ุฌููุงุช ฺฉู ุฏุฑ ูุฑ ุจุณุชูโ ูพุฑุฏุงุฒุด ุจุฑุง ุงูฺฉูุฏูฺฏ ุจู ูุฏู ุฌุงููุง ุงุฑุณุงู ูโุดููุฏุ ููุฏุงุฑ ฑฒธ ุงูุชุฎุงุจ ุดุฏู ุชุง ุชุนุงุฏู ููุงุณุจ ูุงู ุณุฑุนุช ูพุฑุฏุงุฒุด ู ูุตุฑู ุญุงูุธู ุจุฑูุฑุงุฑ ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	`MAX_BATCH` ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุจุณุชูโูุง ฺฉู ุฏุฑ ุจุงูุฑ ูพุฑุฏุงุฒุด ูฺฏูุฏุงุฑ ูโุดููุฏ. ุงู ููุฏุงุฑ ุจุฑุง ฺฉูุชุฑู ุญุงูุธู ู ุฌููฺฏุฑ ุงุฒ ุงุฒุฏุญุงู ุฏุฑ ูพุฑุฏุงุฒุด ููุงุฒ ุชูุธู ุดุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	`THREADS` ุชุนุฏุงุฏ ุฑุดุชูโูุง ูพุฑุฏุงุฒุด ููุงุฒ ุจุฑุง ุงุฌุฑุง ููโุฒูุงู ุนููุงุช ูุทุนูโุจูุฏ ู embedding ููุฏุงุฑ ต ุงูุชุฎุงุจ ุดุฏู ุชุง ุณุฑุนุช ูพุฑุฏุงุฒุด ูุงูโูุง TEI ุงูุฒุงุด ุงุจุฏ ุจุฏูู ุขูโฺฉู ูุดุงุฑ ุจุด ุงุฒ ุญุฏ ุจู ููุงุจุน ุณุณุชู ูุงุฑุฏ ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	`CHROMA_SAFE_LIMIT` ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ embedding ูุง ฺฉู ุฏุฑ ูุฑ Batch ุจู ูพุงฺฏุงู ุฏุงุฏูโ ุจุฑุฏุงุฑ (ChromaDB) ุงุฑุณุงู ูโุดููุฏ. ููุฏุงุฑ ตดถฑ ุจูโุนููุงู ูุญุฏูุฏุช ุฏุงุฎู ุงููู ุฏุฑ ChromaDB ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช. ุนุฏู ุฑุนุงุช ุงู ุณูู ููุฌุฑ ุจู ุจุฑูุฒ ุฎุทุง ุฏุฑ ุนููุงุช ุฐุฎุฑูโุณุงุฒ ุจุฑุฏุงุฑูุง ุฎูุงูุฏ ุดุฏุ ูุฐุง ุฑุนุงุช ุงู ุญุฏ ุงูู ุถุฑูุฑ ุงุณุช.

<br>

ุฏุฑ ูุฑุญูู ุจุนุฏุ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ ู ุณูพุณ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุจุฑุง ุฐุฎุฑูโุณุงุฒ ูุทุนุงุช ูุนูุง ุงุฌุงุฏ ุง ุจุงุฒุงุจ ูโฺฏุฑุฏุฏ:<br>
```python
print(f"๐น Loading fine-tuned embedding model: {EMB_MODEL}")
model = SentenceTransformer(str(EMB_MODEL), device="cuda")

client = chromadb.PersistentClient(path=str(CHROMA_DIR))
collection = client.get_or_create_collection(name="semantic_chunks_articles")
```

ฑ) ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู
ุฏุฑ ุฎุท ูุฎุณุชุ ูุณุฑ ูุฏู ุฑุฒุชูุธูโุดุฏู ฺุงูพ ูโุดูุฏ ู ุณูพุณ:<br>

&nbsp;&nbsp;&nbsp;โข	ูุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ `SentenceTransformer` ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ู ุฑู ุฏุณุชฺฏุงู (cuda) GPU ูุฑุงุฑ ูโฺฏุฑุฏ ุชุง ุนููุงุช embedding ุจุง ุณุฑุนุช ุจุดุชุฑ ุงูุฌุงู ุดูุฏ.<br>
ุงู ูุฏู ููุงู ูุฏู ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ูุจู ุขููุฒุด ุฏุงุฏู ุดุฏ ู ุงฺฉููู ุจุฑุง ุชููุฏ ุจุฑุฏุงุฑูุง ูุนูุง ูุทุนุงุช ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ.
<br>

ฒ) ุงุฌุงุฏ ุง ุจุงุฒุงุจ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ<br>
ุฏุฑ ุฏู ุฎุท ุจุนุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉ `PersistentClient` ุงุฒ ฺฉุชุงุจุฎุงูู ChromaDB ุณุงุฎุชู ูโุดูุฏ ฺฉู ูพุงฺฏุงู ุฏุงุฏู ุฑุง ุฏุฑ ูุณุฑ ุชุนูโุดุฏู ุฐุฎุฑู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุณูพุณ ุจุง ุงุณุชูุงุฏู ุงุฒ `get_or_create_collection` ฺฉ ูุฌููุนู (Collection) ุจุง ูุงู `semantic_chunks_articles` ุงุฌุงุฏ ุง ุฏุฑ ุตูุฑุช ูุฌูุฏุ ุจุงุฒุงุจ ูโุดูุฏ.

<br>

ุงู ูุฌููุนู ูุญู ุฐุฎุฑูโุณุงุฒ:<br>
&nbsp;&nbsp;&nbsp;โข	ุดูุงุณู ูุฑ ูุทุนูุ<br>
&nbsp;&nbsp;&nbsp;โข	ูุชู ูุทุนูุ<br>
&nbsp;&nbsp;&nbsp;โข	ู embedding ูุฑุจูุท ุจู ุขู<br>
ุฎูุงูุฏ ุจูุฏ ู ุฏุฑ ูุฑุญูู RAG ุจุฑุง ุจุงุฒุงุจ ุณุฑุน ู ุฏูู ุงุทูุงุนุงุช ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ.

<br>


ุฏุฑ ูุฑุญูู ุจุนุฏุ ุชุงุจุน `semantic_chunk_text` ูพุงุฏูโุณุงุฒ ูโุดูุฏ ฺฉู ูุณุฆููุช ุชูุณู ูุชู ูุฑูุฏ ุจู ูุทุนุงุช ูุนูุง ููุณุฌู ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ:
<br>

```python
def semantic_chunk_text(text, threshold=0.55, min_len=3, max_len=15):
    sents = [s.strip() for s in sent_tokenize(text) if len(s.strip()) > 15]
    if len(sents) <= MIN_CHUNK_LEN:
        return [" ".join(sents)]

    with torch.no_grad():
        embs = model.encode(
            sents,
            batch_size=BATCH_SIZE,
            normalize_embeddings=True,
            show_progress_bar=False
        )

    sims = util.cos_sim(embs[:-1], embs[1:]).diagonal().cpu().numpy()
    chunks, cur_chunk = [], [sents[0]]

    for i in range(1, len(sents)):
        if sims[i-1] < SIM_THRESHOLD or len(cur_chunk) >= MAX_CHUNK_LEN:
            chunks.append(" ".join(cur_chunk))
            cur_chunk = [sents[i]]
        else:
            cur_chunk.append(sents[i])

    if cur_chunk:
        chunks.append(" ".join(cur_chunk))

    return chunks
```
ุจุง ุชูุฌู ููุงุฏุฑ ุชุนู ุดุฏู ุฏุฑ ุงุจุชุฏุง ฺฉุฏุ ูุฑุงุญู ุงุฌุฑุง ุชุงุจุน ููู ุจู ุตูุฑุช ุฒุฑ ูโุจุงุดุฏ:
<br>

ฑ) ุงุณุชุฎุฑุงุฌ ุฌูููโูุง ูุนุชุจุฑ:<br>
&nbsp;&nbsp;&nbsp;โข	ูพุฑุฏุงุฒุด: ูุชู ุจุง `sent_tokenize` ุจู ุฌูููโูุง ุฌุฏุงฺฏุงูู ุชูุณู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููุชุฑ:โ ุชููุง ุฌูููโูุง ูพุฐุฑูุชู ูโุดููุฏ ฺฉู ุทูู ุขูโูุง ุจุด ุงุฒ ฑต ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฏู: ุญุฐู ุฌูููโูุง ุจุณุงุฑ ฺฉูุชุงู ู ฺฉูโุงุฑุฒุด ุจุฑุง ุจุฑุด ูุนูุง.<br>

ฒ) ูุฏุฑุช ูุชูู ฺฉูุชุงู:<br>
&nbsp;&nbsp;&nbsp;โข	ุดุฑุท: ุงฺฏุฑ ุชุนุฏุงุฏ ุฌูููโูุง ฺฉูุชุฑ ุง ุจุฑุงุจุฑ ุจุง `MIN_CHUNK_LEN` ุจุงุดุฏุ ููุงู ุฌูููโูุง ุฏุฑ ูุงูุจ ฺฉ ูุทุนู ูุงุญุฏ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉุงุฑุจุฑุฏ: ููุงุณุจ ุจุฑุง ุงุณูุงุฏ ฺฉูฺฺฉ ุง ูพุงุฑุงฺฏุฑุงูโูุง ฺฉูุชุงู ุจุฏูู ูุงุฒ ุจู ูุญุงุณุจุงุช ุดุจุงูุช.<br>

ณ) ุจุฑุฏุงุฑุณุงุฒ ุฌููุงุช ุจุง ุจูููโุณุงุฒ ุญุงูุธู:<br>
&nbsp;&nbsp;&nbsp;โข	`no_grad`: ูุญุงุณุจู ุฏุงุฎู `torch.no_grad` ุงูุฌุงู ูโุดูุฏ ุชุง ุงุฒ ุฐุฎุฑูโุณุงุฒ ฺฏุฑุงุฏุงู ุฌููฺฏุฑ ู ูุตุฑู ุญุงูุธู ฺฉุงูุด ุงุจุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉุฏฺฏุฐุงุฑ: ุฌูููโูุง ุจุง `model.encode` ู ุจุง `batch_size=BATCH_SIZE` ฺฉุฏฺฏุฐุงุฑ ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑูุงูโุณุงุฒ: `normalize_embeddings=True`  ุจุฑุง ูพุงุฏุงุฑ ูุญุงุณุจู ุดุจุงูุช ฺฉุณููุณ.<br>

ด) ูุญุงุณุจู ุดุจุงูุช ฺฉุณููุณ ูุชูุงู:<br>
&nbsp;&nbsp;&nbsp;โข	ุฑูุด: ุดุจุงูุช ุจู ูุฑ ุฌููู ู ุฌููู ุจุนุฏ ุจุง `util.cos_sim` ูุญุงุณุจู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงุณุชุฎุฑุงุฌ: ุชููุง ูุทุฑ ุงุตู ุจุฑุฏุงุดุชู ูโุดูุฏ ุชุง ุดุจุงูุชโูุง ูุชูุงู (i,i+1) ุจูโุฏุณุช ุขุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููุทู SNS: ฺฉ ุงูฺฏูุฑุชู ุฎุท ุงุณุชุ ุฎูุดูโุจูุฏ ฺฉุงูู ุงูุฌุงู ููโุฏูุฏ ู ููุท ุชูุงู ุงููุช ุฏุงุฑุฏ.<br>

ต) ุณุงุฎุช ูุทุนุงุช ูุนูุง ุจุง ููุทู ุจุฑุด ุงุตูุงุญโุดุฏู:<br>
&nbsp;&nbsp;&nbsp;โข	ุดุฑูุน: ูุทุนู ุงูู ุจุง ุฌูููโ ูุฎุณุช ุขุบุงุฒ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุญููู: ุจุฑุง ูุฑ ุฌููู ุจุนุฏ:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุดุฑุท ุจุฑุด: ุงฺฏุฑ ุดุจุงูุช ุจุง ุฌููู ูุจู ฺฉูุชุฑ ุงุฒ `SIM_THRESHOLD` ุจุงุดุฏ ุง ุทูู ูุทุนู ุจู `MAX_CHUNK_LEN` ุจุฑุณุฏุ ูุทุนู ุฌุงุฑ ุจุณุชู ูโุดูุฏ ู ุฌููู ูุนู ุขุบุงุฒฺฏุฑ ูุทุนู ุฌุฏุฏ ูโฺฏุฑุฏุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุงุฏุงูู: ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุฌููู ุจู ูุทุนู ุฌุงุฑ ุงูุฒูุฏู ูโุดูุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ูพุงุงู: ุงฺฏุฑ ูุทุนูโุง ูููโุชูุงู ุจุงู ูุงูุฏู ุจุงุดุฏุ ุจู ุฎุฑูุฌ ุงูุฒูุฏู ูโุดูุฏ.

<br>

ุฏุฑ ูุณูุช ุจุนุฏ ุ ุชุงุจุน `process_file` ุชุนุฑู ูโุดูุฏ ฺฉู ูุณุฆููุช ุฎูุงูุฏู ูุงูโูุง TEIุ ูพุงฺฉโุณุงุฒ ุงูููโ ูุชู ู ุงุนูุงู ูุทุนูโุจูุฏ ูุนูุง ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ:<br>
```python
def process_file(txt_file):
    """Read TEI XML, clean tags, and generate semantic chunks."""
    text = txt_file.read_text(encoding="utf-8", errors="ignore")
    text = text.replace("\n", " ").replace("<", " <").replace(">", "> ").replace("  ", " ")
    text = " ".join([t for t in text.split() if not t.startswith("<")])
    chunks = semantic_chunk_text(text, SIM_THRESHOLD, MIN_CHUNK_LEN, MAX_CHUNK_LEN)
    return txt_file.name, chunks
```

ฑ) ุฎูุงูุฏู ูุงู TEI<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ูุญุชูุง ูุงู TEI ุจุง ุงุณุชูุงุฏู ุงุฒ `read_text` ุฎูุงูุฏู ูโุดูุฏ. ูพุงุฑุงูุชุฑ errors="ignore" ุชุถูู ูโฺฉูุฏ ฺฉู ุฏุฑ ุตูุฑุช ูุฌูุฏ ฺฉุงุฑุงฺฉุชุฑูุง ูุงุณุงุฒฺฏุงุฑุ ุนููุงุช ุฎูุงูุฏู ูุชููู ูุดูุฏ.<br>

ฒ) ูพุงฺฉโุณุงุฒ ุงูููโ ูุชู<br>
ุฏุฑ ุณู ุฎุท ุจุนุฏุ ูุฌููุนูโุง ุงุฒ ุนููุงุช ูพุดโูพุฑุฏุงุฒุด ุฑู ูุชู ุงูุฌุงู ูโุดูุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ุญุฐู ู ฺฉุณุงูโุณุงุฒ ุฎุทโุฌุฏุฏูุง<br>
&nbsp;&nbsp;&nbsp;โข	ุงูุฒูุฏู ูุงุตูู ูุจู ู ุจุนุฏ ุงุฒ ุชฺฏโูุง XML ุจุฑุง ุฌุฏุงุณุงุฒ ุจูุชุฑ<br>
&nbsp;&nbsp;&nbsp;โข	ุญุฐู ฺฉุงูู ุชฺฏโูุง TEI ุจุง ููุชุฑ ฺฉุฑุฏู ุชูุงู ุชูฺฉูโูุง ฺฉู ุจุง < ุขุบุงุฒ ูโุดููุฏ<br>
ุงู ูุฑุญูู ุจุงุนุซ ูโุดูุฏ ูุชู ุฎุงู TEI ุจู ฺฉ ูุชู ุชูุฒ ู ูุงุจู ูพุฑุฏุงุฒุด ุชุจุฏู ุดูุฏ.<br>

ณ) ุงุนูุงู ูุทุนูโุจูุฏ ูุนูุง<br>
ุฏุฑ ุฎุท ุจุนุฏุ ูุชู ูพุงฺฉโุณุงุฒโุดุฏู ุจู ุชุงุจุน `semantic_chunk_text` ุงุฑุณุงู ูโุดูุฏ. ุงู ุชุงุจุน ุจุง ุชูุฌู ุจู ูพุงุฑุงูุชุฑูุง ุชุนูโุดุฏู (ุขุณุชุงูู ุดุจุงูุชุ ุญุฏุงูู ู ุญุฏุงฺฉุซุฑ ุทูู ูุทุนู) ูุชู ุฑุง ุจู ูุทุนุงุช ูุนูุง ููุณุฌู ุชูุณู ูโฺฉูุฏ.<br>

ด) ุฎุฑูุฌ ุชุงุจุน<br>
ุฏุฑ ูพุงุงูุ ุชุงุจุน ฺฉ ุฒูุฌ ุฎุฑูุฌ ุจุฑูโฺฏุฑุฏุงูุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ูุงู ูุงู<br>
&nbsp;&nbsp;&nbsp;โข	ููุฑุณุช ูุทุนุงุช ูุนูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุงุฒ ุขู ูุงู
ุงู ุณุงุฎุชุงุฑ ุฎุฑูุฌ ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏูโ ุจุฑุฏุงุฑ (ChromaDB) ู ููฺูู ุจุฑุง ูพุฑุฏุงุฒุด ููุงุฒ ูุงูโูุง ุจุณุงุฑ ููุงุณุจ ุงุณุช.

<br>
 
ุฏุฑ ูุฑุญูู ุจุนุฏุ ฺูุงุฑ ุจุงูุฑ ุจุฑุง ูฺฏูโุฏุงุฑ ูููุช ุฏุงุฏูโูุง ูุฑุจูุท ุจู ูุทุนุงุช ูุนูุง ุชุนุฑู ูโุดูุฏ ู ุณูพุณ ุชุงุจุน ุจุฑุง ุงูุชูุงู ุงูู ุงู ุฏุงุฏูโูุง ุจู ูพุงฺฏุงู ุฏุงุฏู ChromaDB ูพุงุฏูโุณุงุฒ ูโฺฏุฑุฏุฏ:
```python
buffer_docs, buffer_embs, buffer_meta, buffer_ids = [], [], [], []
total_chunks = 0

def flush_to_db():
    """Write buffered data to ChromaDB safely below batch limit."""
    global buffer_docs, buffer_embs, buffer_meta, buffer_ids
    while len(buffer_docs) > 0:
        chunk_size = min(len(buffer_docs), CHROMA_SAFE_LIMIT)
        collection.add(
            documents=buffer_docs[:chunk_size],
            embeddings=buffer_embs[:chunk_size],
            metadatas=buffer_meta[:chunk_size],
            ids=buffer_ids[:chunk_size]
        )
        buffer_docs = buffer_docs[chunk_size:]
        buffer_embs = buffer_embs[chunk_size:]
        buffer_meta = buffer_meta[chunk_size:]
        buffer_ids = buffer_ids[chunk_size:]
```
ฑ) ฺูุงุฑ ุจุงูุฑ ุฒุฑ ุจุฑุง ุฐุฎุฑูโุณุงุฒ ูููุช ุฏุงุฏูโูุง ูุจู ุงุฒ ุงูุชูุงู ุจู ูพุงฺฏุงู ุฏุงุฏู ุงุณุชูุงุฏู ูโุดููุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	buffer_docs: ูุชู ูุฑ ูุทุนู ูุนูุง<br>
&nbsp;&nbsp;&nbsp;โข	buffer_embs: ุจุฑุฏุงุฑ embedding ูุฑุจูุท ุจู ูุฑ ูุทุนู<br>
&nbsp;&nbsp;&nbsp;โข	buffer_meta: ูุฑุงุฏุงุฏู ูุฑ ูุทุนู (ูุงู ูุงูุ ุดูุงุฑู ูุทุนูุ ุทูู ูุทุนู ู โฆ)<br>
&nbsp;&nbsp;&nbsp;โข	buffer_ids: ุดูุงุณู ฺฉุชุง ูุฑ ูุทุนู ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุฏุฑ ChromaDB
ุงู ุณุงุฎุชุงุฑ ุจุงูุฑฺฏุฐุงุฑ ุจุงุนุซ ูโุดูุฏ ุฏุงุฏูโูุง ุงุจุชุฏุง ุฏุฑ ุญุงูุธู ุฌูุนโุขูุฑ ุดููุฏ ู ุณูพุณ ุฏุฑ ุจุณุชูโูุง ฺฉูุชุฑูโุดุฏู ุจู ูพุงฺฏุงู ุฏุงุฏู ููุชูู ฺฏุฑุฏูุฏ.<br>

ฒ) ุชุงุจุน `flush_to_db` ูุณุฆูู ุงูุชูุงู ุงูู ุฏุงุฏูโูุง ุงุฒ ุจุงูุฑ ุจู ูพุงฺฏุงู ุฏุงุฏู ุงุณุช. ุงู ุชุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ููุฏุงุฑ `CHROMA_SAFE_LIMIT = 5400` ุงุทููุงู ุญุงุตู ูโฺฉูุฏ ฺฉู ูฺโฺฏุงู ุจุด ุงุฒ ตดฐฐ  ููุฏุงุฑ embedding ุฏุฑ ฺฉ ุฏุฑุฎูุงุณุช ุจู ChromaDB ุงุฑุณุงู ูุดูุฏ. ุงู ููุฏุงุฑ ูุญุฏูุฏุช ุฏุงุฎู ChromaDB ุงุณุช ู ุฑุนุงุช ูฺฉุฑุฏู ุขู ููุฌุฑ ุจู ุฎุทุง ุฏุฑ ุนููุงุช ุฐุฎุฑูโุณุงุฒ ุฎูุงูุฏ ุดุฏ.<br>

ณ) ููุทู ุนููฺฉุฑุฏ ุชุงุจุน: <br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุงุฏูโูุง ููุฌูุฏ ุฏุฑ ุจุงูุฑ ฺฉูุชุฑ ุง ุจุฑุงุจุฑ ุจุง ตดฐฐ ุจุงุดุฏ: ุชูุงู ุฏุงุฏูโูุง ุฏุฑ ฺฉ ูุฑุญูู ุจู ูพุงฺฏุงู ุฏุงุฏู ููุชูู ูโุดููุฏ ู ุจุงูุฑ ุชุฎูู ูโฺฏุฑุฏุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุงุฏูโูุง ุจุดุชุฑ ุงุฒ ตดฐฐ ุจุงุดุฏ: ุงุจุชุฏุง ตดฐฐ ููุฑุฏ ุงูู ุจู ูพุงฺฏุงู ุฏุงุฏู ุงุฑุณุงู ูโุดูุฏุ ุณูพุณ ุงุฒ ุจุงูุฑ ุญุฐู ูโฺฏุฑุฏุฏุ ู ุงู ูุฑุขูุฏ ุชุง ุชุฎูู ฺฉุงูู ุจุงูุฑ ุชฺฉุฑุงุฑ ูโุดูุฏ.
ุงู ุฑูุด ุงุฒ ุจุฑูุฒ ุฎุทุงูุง ูุงุด ุงุฒ ุงุฑุณุงู ุญุฌู ุจุด ุงุฒ ุญุฏ ุฏุงุฏู ุฌููฺฏุฑ ฺฉุฑุฏู ู ุฐุฎุฑูโุณุงุฒ ุฑุง ูพุงุฏุงุฑ ู ูุงุจู ุงุนุชูุงุฏ ูโฺฉูุฏ.

<br>

ุฏุฑ ุจุฎุด ูพุงุงู ฺฉุฏ ูุทุนูโุจูุฏ ุ ุฎุฑูุฌโูุง ุญุงุตู ุงุฒ ูุทุนูโุจูุฏ ุจูโุตูุฑุช ูุฑุญููโุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุฐุฎุฑู ูโุดููุฏ:
```python
txt_files = sorted(DATA_DIR.glob("*.tei.xml"))
print(f"๐ Found {len(txt_files)} TEI files for semantic chunking.")

with ThreadPoolExecutor(max_workers=THREADS) as executor:
    for name, chunks in tqdm(executor.map(process_file, txt_files), total=len(txt_files), desc="Processing TEI files"):
        embeddings = model.encode(chunks, batch_size=BATCH_SIZE, normalize_embeddings=True, show_progress_bar=False)
        ids = [f"{Path(name).stem}_chunk_{i}" for i in range(len(chunks))]
        metadata = [{"source": name, "chunk_id": i} for i in range(len(chunks))]
        buffer_docs.extend(chunks)
        buffer_embs.extend(embeddings.tolist())
        buffer_meta.extend(metadata)
        buffer_ids.extend(ids)
        total_chunks += len(chunks)
               if len(buffer_docs) >= MAX_BATCH:
            flush_to_db()

flush_to_db()
print(f"โ Done: {len(txt_files)} TEI files processed, {total_chunks} semantic chunks stored in {CHROMA_DIR}")
```
ฑ) ูุฑุงุฎูุงู ูุงูโูุง TEI<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ุชูุงู ูุงูโูุง ุจุง ูพุณููุฏ `.tei.xml` ุงุฒ ูุณุฑ ุชุนูโุดุฏู `DATA_DIR` ุฎูุงูุฏู ู ุจูโุตูุฑุช ูุฑุชุจโุดุฏู ุฏุฑ ููุฑุณุช `txt_files` ุฐุฎุฑู ูโุดููุฏ. ุงู ูุงูโูุง ูุฑูุฏ ุงุตู ูุฑุขูุฏ ูุทุนูโุจูุฏ ูุนูุง ูุณุชูุฏ.<br>

ฒ) ุขุบุงุฒ ูพุฑุฏุงุฒุด ููุงุฒ<br>
ุฏุฑ ุฎุท ุจุนุฏุ ุจุง ุงุณุชูุงุฏู ุงุฒ `ThreadPoolExecutor` ู ููุฏุงุฑ `THREADSุ` ูพุฑุฏุงุฒุด ููุงุฒ ูุงูโูุง ุขุบุงุฒ ูโุดูุฏ. ุงู ฺฉุงุฑ ุจุงุนุซ ุงูุฒุงุด ุณุฑุนุช ูพุฑุฏุงุฒุด ูุฒุงุฑุงู ูุงู TEI ูโุดูุฏ.<br>

ณ) ูพุฑุฏุงุฒุด ูุฑ ูุงู ู ุชููุฏ ูุทุนุงุช ูุนูุง:<br>
ุฏุฑ ูุฑ ุชฺฉุฑุงุฑ ุญููู:<br>
&nbsp;&nbsp;&nbsp;โข	ุชุงุจุน `process_file` ุฑู ูุงู ุงุฌุฑุง ุดุฏู ู ูุทุนุงุช ูุนูุง ุขู ุงุณุชุฎุฑุงุฌ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุณูพุณ ุจุฑุง ูุฑ ูุทุนูุ ููุฏุงุฑ ุจุฑุฏุงุฑ (embedding) ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฑุฒุชูุธูโุดุฏู ูุญุงุณุจู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑุง ูุฑ ูุทุนู ฺฉ ุดูุงุณู ฺฉุชุง (ID) ุชููุฏ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑุงุฏุงุฏู (metadata) ุดุงูู ูุงู ูุงู ู ุดูุงุฑู ูุทุนู ุณุงุฎุชู ูโุดูุฏ.<br>

ด) ุงูุฒูุฏู ุฏุงุฏูโูุง ุจู ุจุงูุฑ:<br>
ฺูุงุฑ ุจุงูุฑ ุงุตู ุจุง ุงุณุชูุงุฏู ุงุฒ extend ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	buffer_docs: ูุชู ูุทุนุงุช<br>
&nbsp;&nbsp;&nbsp;โข	buffer_embs: ุจุฑุฏุงุฑูุง embedding<br>
&nbsp;&nbsp;&nbsp;โข	buffer_meta: ูุฑุงุฏุงุฏู ูุทุนุงุช<br>
&nbsp;&nbsp;&nbsp;โข	buffer_ids: ุดูุงุณูโูุง ฺฉุชุง<br>
ุฏุฑ ุงู ูุฑุญููุ ุชุนุฏุงุฏ ฺฉู ูุทุนุงุช ูพุฑุฏุงุฒุดโุดุฏู ูุฒ ุฏุฑ `total_chunks` ุฌูุน ุฒุฏู ูโุดูุฏ.<br>

ต) ฺฉูุชุฑู ุงูุฏุงุฒู ุจุงูุฑ ู ุฐุฎุฑูโุณุงุฒ ูุฑุญููโุง:<br>
ุฏุฑ ูพุงุงู ูุฑ ุชฺฉุฑุงุฑ ุญูููุ ุงูุฏุงุฒู ุจุงูุฑ ุจุฑุฑุณ ูโุดูุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุงุฏูโูุง ุจู `MAX_BATCH` ุจุฑุณุฏุ ุชุงุจุน `flush_to_db` ูุฑุงุฎูุงู ุดุฏู ู ุฏุงุฏูโูุง ุฏุฑ ุจุณุชูโูุง ุงูู (ฺฉูุชุฑ ุงุฒ `CHROMA_SAFE_LIMIT`) ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุฐุฎุฑู ูโุดููุฏ.
ุงู ฺฉุงุฑ ุงุฒ ุงูุจุงุดุชู ุดุฏู ุจุด ุงุฒ ุญุฏ ุฏุงุฏูโูุง ุฏุฑ ุญุงูุธู ุฌููฺฏุฑ ูโฺฉูุฏ.<br>

ถ) ุชุฎูู ููุง ุจุงูุฑ:<br>
ูพุณ ุงุฒ ูพุงุงู ุญูููุ ฺฉ ุจุงุฑ ุฏฺฏุฑ `flush_to_db` ูุฑุงุฎูุงู ูโุดูุฏ ุชุง:<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุงุฏูโูุง ุจุงูโูุงูุฏู ฺฉู ฺฉูุชุฑ ุงุฒ `MAX_BATCH` ูุณุชูุฏ ูุฒ ุฐุฎุฑู ุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ู ุญุงูุธู RAM ุจูโุทูุฑ ฺฉุงูู ุชุฎูู ฺฏุฑุฏุฏ.<br>

ท) ูพุงู ููุง:<br>
ุฏุฑ ูพุงุงูุ ุชุนุฏุงุฏ ูุงูโูุง ูพุฑุฏุงุฒุดโุดุฏู ู ุชุนุฏุงุฏ ฺฉู ูุทุนุงุช ูุนูุง ุฐุฎุฑูโุดุฏู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ฺุงูพ ูโุดูุฏ.

<br>

<div align="center">

![ุชุตูุฑ ฑถ โ ูุซุงู ุฎุฑูุฌ ุงุฌุฑุง ฺฉุฏ ูุทุนู ุจูุฏ ูุนูุง ุจุฑุง ูพฺฉุฑุจูุฏ 5 TB + G](/assets/patterneffort/synergistic-rag/media/fig16.JPG)

</div>

<p style="text-align:center;">
  <sub>ุชุตูุฑ ฑถ โ ูุซุงู ุฎุฑูุฌ ุงุฌุฑุง ฺฉุฏ ูุทุนู ุจูุฏ ูุนูุง ุจุฑุง ูพฺฉุฑุจูุฏ   5TB + G</sub>
</p>

<br>

---
### ูุทุนู ุจูุฏ ูุนูุง ุฏุฑ ุฑูฺฉุฑุฏ Abstract-First
ุฏุฑ ุฑูฺฉุฑุฏ ุงููโฺฺฉุฏูุ ูุฑุขูุฏ ุจุงุฒุงุจ ุงุทูุงุนุงุช ุจูโฺฏูููโุง ุทุฑุงุญ ุดุฏู ุงุณุช ฺฉู ุงุจุชุฏุง ุฌุณุชุฌู ูุนูุง ุชููุง ุจุฑ ุฑู ฺฺฉุฏู ููุงูุงุช ุงูุฌุงู ูโุดูุฏ. ูพุณ ุงุฒ ุงูุชุฎุงุจ ููุงูุงุช ูุฑุชุจุทุ ูุชู ฺฉุงูู ุจุฏูู ููุงูู ุจูโุนููุงู ุฏุงูุด ุฒููู (Context) ุฏุฑ ฺฉูุงุฑ ุฏุณุชูุฑ ฺฉุงุฑุจุฑุฏ (Prompt) ุจู ูุฏู ุฒุจุงู ุงุฑุงุฆู ูโฺฏุฑุฏุฏ.<br>

ุจู ููู ุฏููุ ุฏุฑ ุงู ุฑูฺฉุฑุฏ ูุงุฒู ุงุณุช ูุทุนูโุจูุฏ ูุนูุง ฺฺฉุฏูโูุง ู ุจุฏูู ููุงูุงุช ุจูโุตูุฑุช ูุณุชูู ุงูุฌุงู ุดูุฏ. ฺุฑุง ฺฉู:<br>
&nbsp;&nbsp;&nbsp;โข	ฺฺฉุฏูโูุง ูุนูููุงู ฺฉูุชุงูโุชุฑุ ูุดุฑุฏูโุชุฑ ู ุฏุงุฑุง ุณุงุฎุชุงุฑ ูุนูุง ูุชูุงูุช ูุณุจุช ุจู ุจุฏูู ููุงูู ูุณุชูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฏูู ููุงูู ุดุงูู ุจุฎุดโูุง ุทููุงูโุชุฑ ู ูุชููุนโุชุฑ ุงุณุช ฺฉู ูุงุฒููุฏ ูุทุนูโุจูุฏ ุฏููโุชุฑ ู ูุจุชู ุจุฑ ุดุจุงูุช ูุนูุง ุงุณุช.<br>
ุจุฑุง ุงู ููุธูุฑุ ุฏู ุงุณฺฉุฑูพุช ูุฌุฒุง -ุงูุง ูุดุงุจู ุจุง ฺฉุฏ ูุทุนูโุจูุฏ ุงุตู- ุจุฑุง ูพุฑุฏุงุฒุด ฺฺฉุฏูโูุง ู ูุชู ฺฉุงูู ููุงูุงุช ุงุณุชูุงุฏู ูโุดูุฏ.<br>

ุฌุฑุงู ฺฉู ูพุฑุฏุงุฒุด ุฏุฑ ุงู ูุนูุงุฑ ุจู ุตูุฑุช ุฒุฑ ุงุณุช:<br>

`TEI โ Extraction & Indexing (Abstract) โ Chunk (Body) โ Embed โ Store`

<br>

#### ุชูุถุญ ูุฑุงุญู:

<br>
&nbsp;&nbsp;&nbsp;โข	TEI: ุฏุฑุงูุช ู ุฎูุงูุฏู ูุงูโูุง TEI ุดุงูู ฺฺฉุฏู ู ูุชู ฺฉุงูู<br>
&nbsp;&nbsp;&nbsp;โข	(Abstract) Extraction & Indexing: ุงุณุชุฎุฑุงุฌ ฺฺฉุฏูโูุง ู ุงุฌุงุฏ ุงูุฏฺฉุณ ูุนูุง ุงููู<br>
&nbsp;&nbsp;&nbsp;โข	(Body) Chunk: ูุทุนูโุจูุฏ ูุนูุง ุจุฏูู ููุงูู ุจุง ุงุณุชูุงุฏู ุงุฒ ุขุณุชุงูู ุดุจุงูุช<br>
&nbsp;&nbsp;&nbsp;โข	Embed: ุชููุฏ ููุงุฏุฑ ุจุฑุฏุงุฑ ุจุฑุง ูุทุนุงุช ูุนูุง<br>
&nbsp;&nbsp;&nbsp;โข	Store: ุฐุฎุฑูโุณุงุฒ ุจุฑุฏุงุฑูุง ู ูุฑุงุฏุงุฏูโูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ (ChromaDB)

<br>

ุงู ุณุงุฎุชุงุฑ ุฏู ูุฑุญููโุง ุจุงุนุซ ูโุดูุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ุฌุณุชุฌู ุฏุฑ ูุฑุญูู ุงูู ุจุณุงุฑ ุณุฑุนโุชุฑ ู ูุฏูููุฏุชุฑ ุงูุฌุงู ุดูุฏ<br>
&nbsp;&nbsp;&nbsp;โข	ุชููุง ููุงูุงุช ูุฑุชุจุท ูุงุฑุฏ ูุฑุญูู ูพุฑุฏุงุฒุด ุนูู ุดููุฏ<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉูุช ูพุงุณุฎ ููุง ูุฏู ุฒุจุงู ุจูโุทูุฑ ูุงุจู ุชูุฌู ุงูุฒุงุด ุงุจุฏ

<br>

---
### ฺฉุฏ ุจุฎุด ุงูู: ุงุณุชุฎุฑุงุฌ ู ุงูุฏุณ ฺฏุฐุงุฑ ฺฺฉุฏู ูุง<br>

ุฏุฑ ฺฏุงู ูุฎุณุช ุงุฒ ูุนูุงุฑ ุงูู-ฺฺฉุฏูุ ุชูุฑฺฉุฒ ุจุฑ ูพุฑุฏุงุฒุด ู ุขูุงุฏูโุณุงุฒ ฺฺฉุฏู ููุงูุงุช ุงุณุช. ุงุฒ ุขูโุฌุง ฺฉู ฺฺฉุฏู ูุฑ ููุงูู ูุนูููุงู ูุชู ฺฉูุชุงูุ ููุณุฌู ู ุงุฒ ูุธุฑ ูุนูุง ฺฉูพุงุฑฺู ุงุณุชุ ูุงุฒ ุจู ูุทุนูโุจูุฏ ูุนูุง ุจุฑุง ุงู ุจุฎุด ูุฌูุฏ ูุฏุงุฑุฏ.
ูุฏู ุงุตู ุฏุฑ ุงู ูุฑุญููุ ุงุฌุงุฏ ฺฉ ุงูุฏฺฉุณ ูุนูุง ุงุฒ ฺฺฉุฏูโูุง ุงุณุช ุชุง ุนููุงุช ุฌุณุชุฌู ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ุชููุง ุจุฑ ุงุณุงุณ ููู ฺฺฉุฏูโูุง ุงูุฌุงู ุดูุฏ.

<br>
 ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	ุฌุณุชุฌู ุจุณุงุฑ ุณุฑุนโุชุฑ ู ุณุจฺฉโุชุฑ ุจุงุดุฏ<br>
&nbsp;&nbsp;&nbsp;โข	ุชููุง ููุงูุงุช ูุฑุชุจุท ูุงุฑุฏ ูุฑุญูู ูพุฑุฏุงุฒุด ุนูู ุดููุฏ<br>
&nbsp;&nbsp;&nbsp;โข	ูุฒูู ูุญุงุณุจุงุช ูุฑุญูู RAG ุจูโุทูุฑ ฺุดูฺฏุฑ ฺฉุงูุด ุงุจุฏ<br>

ุจูุงุจุฑุงูุ ฺฉุงู ุงุณุช ุจุฑุง ูุฑ ฺฺฉุฏู:<br>
      ฑ) ูุชู ุขู ุงุณุชุฎุฑุงุฌ ุดูุฏ<br>
      ฒ) ููุฏุงุฑ ุจุฑุฏุงุฑ ุขู ุจุง ูุฏู ุฑุฒุชูุธูโุดุฏู ูุญุงุณุจู ฺฏุฑุฏุฏ<br>
      ณ) ููุฑุงู ุจุง ุดูุงุณู ู ูุฑุงุฏุงุฏู ูุฑุจูุทู ุฏุฑ ฺฉ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ChromaDB ุฐุฎุฑู ุดูุฏ<br>

ุฏุฑ ุจุฑูุงูู ุงููุ ููู ูุฑุขูุฏ ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช ู ฺฺฉุฏูโูุง ุจุฏูู ูุทุนูโุจูุฏ ูุนูุงุ ูุณุชููุงู ุงุณุชุฎุฑุงุฌุ embedding ู ุงูุฏุณโฺฏุฐุงุฑ ูโุดููุฏ. 

<br>

ุฏุฑ ุงุจุชุฏุง ุจุฑูุงููโ ูุฑุจูุท ุจู ุงุณุชุฎุฑุงุฌ ู ุงูุฏุณโฺฏุฐุงุฑ ฺฺฉุฏูโูุงุ ูุฌููุนูโุง ุงุฒ ฺฉุชุงุจุฎุงููโูุง ู ุงุจุฒุงุฑูุง ููุฑุฏูุงุฒ ุจุฑุง ูพุฑุฏุงุฒุด ูุงูโูุง TEIุ ุงุณุชุฎุฑุงุฌ ฺฺฉุฏูโูุงุ ุชููุฏ ููุงุฏุฑ ุจุฑุฏุงุฑ ู ุฐุฎุฑูโุณุงุฒ ุขูโูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฑุงุฎูุงู ูโุดูุฏ:
```python
import os
from pathlib import Path
from tqdm import tqdm
from bs4 import BeautifulSoup
from sentence_transformers import SentenceTransformer
import chromadb
import nltk

nltk.download('punkt', quiet=True)
DATA_DIR = Path(r" Enter TEI files location ")
EMB_MODEL = Path(r" Enter fine-tuned embedding model address ")
CHROMA_ABS = Path(r" Enter output DB destination ")
CHROMA_ABS.mkdir(parents=True, exist_ok=True)
BATCH_SIZE = 256
DEVICE = "cuda" if __import__("torch").cuda.is_available() else "cpu"
```

ุฏุฑ ฺฉุฏ ููู ุนููุงุช ูุง ุฒุฑ ุจู ุชุฑุชุจ ุงูุฌุงู ูโุดููุฏ: <br>

ฑ) ูุฑุงุฎูุงู ฺฉุชุงุจุฎุงููโูุง ููุฑุฏูุงุฒ<br>
&nbsp;&nbsp;&nbsp;โข	`BeautifulSoup`: ุจุฑุง ุชุฌุฒู ู ุชุญูู ุณุงุฎุชุงุฑ XML ูุงูโูุง TEI ู ุงุณุชุฎุฑุงุฌ ุจุฎุด ฺฺฉุฏู<br>
&nbsp;&nbsp;&nbsp;โข	`SentenceTransformer`: ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู<br>
&nbsp;&nbsp;&nbsp;โข	`chromadb`: ุจุฑุง ุงุฌุงุฏ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ู ุฐุฎุฑูโุณุงุฒ ููุงุฏุฑ ุจุฑุฏุงุฑ ฺฺฉุฏูโูุง<br>
&nbsp;&nbsp;&nbsp;โข	`nltk`: ุจุฑุง ุชูฺฉูโุณุงุฒ ู ูพุฑุฏุงุฒุด ุงููู ูุชู<br>
&nbsp;&nbsp;&nbsp;โข	`tqdm`: ุจุฑุง ููุงุด ููุงุฑ ูพุดุฑูุช ุฏุฑ ููฺฏุงู ูพุฑุฏุงุฒุด ุชุนุฏุงุฏ ุฒุงุฏ ูุงู<br>

ุงู ูุฌููุนู ุงุจุฒุงุฑูุง ุงูฺฉุงู ุงุณุชุฎุฑุงุฌุ ูพุฑุฏุงุฒุด ู ุฐุฎุฑูโุณุงุฒ ฺฉุงุฑุขูุฏ ฺฺฉุฏูโูุง ุฑุง ูุฑุงูู ูโฺฉููุฏ.

<br>

ฒ) ุชูุธู ูุณุฑูุง ูุฑูุฏ ู ุฎุฑูุฌ<br>

ุฏุฑ ุฎุทูุท ุจุนุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	DATA_DIR: ูุณุฑ ูุงูโูุง TEI ุฑุง ูุดุฎุต ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	EMB_MODEL: ูุณุฑ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู ุฑุง ุชุนู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	CHROMA_ABS: ูุณุฑ ุฐุฎุฑูโุณุงุฒ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฎุตูุต ฺฺฉุฏูโูุง ุงุณุช.<br>
ุฏุณุชูุฑ mkdir ูุฒ ุชุถูู ูโฺฉูุฏ ฺฉู ูุณุฑ ูพุงฺฏุงู ุฏุงุฏู ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ุงุฌุงุฏ ุดูุฏ.<br>

ณ) ุชุนู ูพุงุฑุงูุชุฑูุง ูพุฑุฏุงุฒุด<br>
&nbsp;&nbsp;&nbsp;โข	BATCH_SIZE = 256: ุชุนุฏุงุฏ ฺฺฉุฏูโูุง ุงุณุช ฺฉู ุฏุฑ ูุฑ ูุฑุญูู ุจุฑุง embedding ุจู ูุฏู ุงุฑุณุงู ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	DEVICE: ูุดุฎุต ูโฺฉูุฏ ฺฉู ุนููุงุช embedding ุฏุฑ ุตูุฑุช ูุฌูุฏ GPU ุฑู cuda ุงูุฌุงู ุดูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุฑู CPU ุงุฌุฑุง ุฎูุงูุฏ ุดุฏ.

<br>


ุฏุฑ ุงู ูุฑุญููุ ูุฏู embedding ุฑุฒุชูุธูโุดุฏู ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ ู ุณูพุณ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฎุตูุต ฺฺฉุฏูโูุง ุงุฌุงุฏ ุง ุจุงุฒุงุจ ูโฺฏุฑุฏุฏ:
```python
print("๐น Loading embedding model:", EMB_MODEL)
model = SentenceTransformer(str(EMB_MODEL), device=DEVICE)

client = chromadb.PersistentClient(path=str(CHROMA_ABS))
collection = client.get_or_create_collection(name="abstracts")
```
ุฏุฑ ุงู ุจุฎุด:<br>
ฑ) ุจุงุฑฺฏุฐุงุฑ ูุฏู embedding ุฑุฒุชูุธูโุดุฏู
ุฏุฑ ุฎุท ูุฎุณุชุ ูุณุฑ ูุฏู ฺุงูพ ุดุฏู ู ุณูพุณ ูุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ `SentenceTransformer` ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ. ุงู ูุฏู ุจุฑุง ุชููุฏ ุจุฑุฏุงุฑูุง ูุนูุง ฺฺฉุฏูโูุง ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ. ูพุงุฑุงูุชุฑ `device=DEVICE` ูุฒ ุชุนู ูโฺฉูุฏ ฺฉู ุนููุงุช embedding ุฏุฑ ุตูุฑุช ูุฌูุฏ GPU ุฑู cuda ู ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุฑู CPU ุงุฌุฑุง ุดูุฏ.<br>

ฒ) ุงุฌุงุฏ ุง ุจุงุฒุงุจ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ<br>
ุฏุฑ ุฏู ุฎุท ุจุนุฏ:<br>
&nbsp;&nbsp;&nbsp;โข		ฺฉ `PersistentClient` ุงุฒ ChromaDB ุณุงุฎุชู ูโุดูุฏ ฺฉู ูพุงฺฏุงู ุฏุงุฏู ุฑุง ุฏุฑ ูุณุฑ ุชุนูโุดุฏู `CHROMA_ABS` ุฐุฎุฑู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุณูพุณ ุจุง ุงุณุชูุงุฏู ุงุฒ `get_or_create_collection` ฺฉ ูุฌููุนู ุจุง ูุงู abstracts ุงุฌุงุฏ ุง ุฏุฑ ุตูุฑุช ูุฌูุฏุ ุจุงุฒุงุจ ูโุดูุฏ.

<br>

ุงู ูุฌููุนู ูุญู ุฐุฎุฑูโุณุงุฒ:<br>
&nbsp;&nbsp;&nbsp;โข	ูุชู ฺฺฉุฏูโูุง<br>
&nbsp;&nbsp;&nbsp;โข	embedding ูุฑ ฺฺฉุฏู<br>
&nbsp;&nbsp;&nbsp;โข	ุดูุงุณู ฺฉุชุง<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑุงุฏุงุฏู ูุฑุจูุท ุจู ูุฑ ููุงูู
ุฎูุงูุฏ ุจูุฏ.

<br>

ุฏุฑ ูุฑุญูู ุจุนุฏุ ุชุงุจุน `extract_abstract_from_tei` ูพุงุฏูโุณุงุฒ ูโุดูุฏ ฺฉู ูุธูู ุงุณุชุฎุฑุงุฌ ูุชู ฺฺฉุฏู ุงุฒ ุณุงุฎุชุงุฑ XML ูุงูโูุง TEI ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ:
```python
def extract_abstract_from_tei(path: Path) -> str:
    txt = path.read_text(encoding="utf-8", errors="ignore")
    soup = BeautifulSoup(txt, "xml")
    abs_nodes = soup.find_all("abstract")
    if not abs_nodes:
        abs_nodes = soup.find_all(lambda tag: tag.name == "div" and tag.get("type") == "abstract")
    abs_text = " ".join([n.get_text(" ", strip=True) for n in abs_nodes]).strip()
    return abs_text
```
ุฏุฑ ุงู ฺฉุฏ:<br>
ฑ) ุฎูุงูุฏู ูุงู TEI<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ูุญุชูุง ูุงู TEI ุจุง ุงุณุชูุงุฏู ุงุฒ `read_text` ุฎูุงูุฏู ูโุดูุฏ. ูพุงุฑุงูุชุฑ errors="ignore" ุชุถูู ูโฺฉูุฏ ฺฉู ุฏุฑ ุตูุฑุช ูุฌูุฏ ฺฉุงุฑุงฺฉุชุฑูุง ูุงุณุงุฒฺฏุงุฑุ ุนููุงุช ุฎูุงูุฏู ูุชููู ูุดูุฏ.<br>

ฒ) ุชุจุฏู ุณุงุฎุชุงุฑ TEI ุจู XML ูุงุจู ูพุฑุฏุงุฒุด<br>
ุฏุฑ ุฎุท ุฏููุ ูุชู ุฎูุงูุฏูโุดุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ `BeautifulSoup(txt, "xml")` ุจู ฺฉ ุณุงุฎุชุงุฑ XML ุชุจุฏู ูโุดูุฏ ุชุง ุงูฺฉุงู ุฌุณุชุฌู ู ุงุณุชุฎุฑุงุฌ ุนูุงุตุฑ ูุฎุชูู ูุฑุงูู ฺฏุฑุฏุฏ.<br>

ณ) ุฌุณุชุฌู ุจุฑฺุณุจโูุง ฺฺฉุฏู (tags)<br>
ุฏุฑ ุฎุท ุณููุ ุชุงุจุน ุจู ุฏูุจุงู ุชูุงู ุชฺฏโูุง `<abstract> </abstract>` ูโฺฏุฑุฏุฏ. ุงู ุชฺฏโูุง ุฏุฑ ุงุณุชุงูุฏุงุฑุฏ TEI ูุญู ุงุตู ุฐุฎุฑู ฺฺฉุฏู ูุณุชูุฏ.<br>

ด) ุฌุณุชุฌู ุฌุงฺฏุฒู ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ุจุฑฺุณุจ abstract<br>
ุฏุฑ ุจุฑุฎ ูุณุฎูโูุง TEIุ ฺฺฉุฏูโูุง ุฏุฑ ูุงูุจ `<div type="abstract"> </div>` ูโุดููุฏ. ุฏุฑ ุตูุฑุช ฺฉู ุชฺฏ `<abstract>` ุงูุช ูุดูุฏุ ุชุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ุดุฑุท lambda ุจู ุฏูุจุงู ุงู ุณุงุฎุชุงุฑ ุฌุงฺฏุฒู ูโฺฏุฑุฏุฏ.<br>

ต) ุงุณุชุฎุฑุงุฌ ูุชู ฺฺฉุฏู<br>
ุฏุฑ ุฎุท ุขุฎุฑ:<br>

&nbsp;&nbsp;&nbsp;โข	ูุชู ุชูุงู ฺฏุฑูโูุง ุงูุชโุดุฏู ุงุณุชุฎุฑุงุฌ ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุจู ุขูโูุง ูุงุตูู ูุฑุงุฑ ุฏุงุฏู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ู ุฎุฑูุฌ ููุง ุฏุฑ ูุชุบุฑ `abs_text` ุฐุฎุฑู ู ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ.<br>
ุงู ููุฏุงุฑ ููุงู ฺฺฉุฏู ููุง ููุงูู ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ุจุนุฏ embedding ู ุงูุฏุณโฺฏุฐุงุฑ ุฎูุงูุฏ ุดุฏ.

<br>

ุฏุฑ ุงู ุจุฎุดุ ูุงูโูุง TEI ูพุฑุฏุงุฒุด ุดุฏู ู ฺฺฉุฏูโูุง ูุนุชุจุฑ ุงุณุชุฎุฑุงุฌ ู ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุขูุงุฏู ูโุดููุฏ:
```python
file_list = sorted(DATA_DIR.glob("*.tei.xml"))
docs, ids, metas = [], [], []

for f in tqdm(file_list, desc="Extracting abstracts"):
    a = extract_abstract_from_tei(f)
    if a and len(a.split()) > 5:
        docs.append(a)
        ids.append(f.stem)
        metas.append({"source": f.name})
print(f"๐ Found {len(docs)} abstracts to index.")
```
ุชูุถุญ ุนููฺฉุฑุฏ ฺฉุฏ:<br>
ฑ) ูุฑุงุฎูุงู ูุงูโูุง TEI:<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ุชูุงู ูุงูโูุง ุจุง ูพุณููุฏ `.tei.xml` ุงุฒ ูุณุฑ ุชุนูโุดุฏู`DATA_DIR` ุฎูุงูุฏู ู ุจูโุตูุฑุช ูุฑุชุจโุดุฏู ุฏุฑ `file_list` ุฐุฎุฑู ูโุดููุฏ. ุงู ูุงูโูุง ูุฑูุฏ ุงุตู ูุฑุญูู ุงุณุชุฎุฑุงุฌ ฺฺฉุฏู ูุณุชูุฏ.<br>

ฒ)  ุชุนุฑู ุณุงุฎุชุงุฑูุง ุฐุฎุฑูโุณุงุฒ:<br>
ุณู ููุฑุณุช ุฎุงู ุจุฑุง ูฺฏูโุฏุงุฑ ุฏุงุฏูโูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุงุฌุงุฏ ูโุดูุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	docs: ูุชู ฺฺฉุฏูโูุง<br>
&nbsp;&nbsp;&nbsp;โข	ids: ุดูุงุณู ฺฉุชุง ูุฑ ููุงูู (ุจุฑ ุงุณุงุณ ูุงู ูุงู)<br>
&nbsp;&nbsp;&nbsp;โข	metas: ูุฑุงุฏุงุฏู ูุฑุจูุท ุจู ูุฑ ฺฺฉุฏู (ูุงููุฏ ูุงู ูุงู ููุจุน)<br>

ณ) ูพุฑุฏุงุฒุด ูุงูโูุง ู ุงุณุชุฎุฑุงุฌ ฺฺฉุฏู:<br>

ุฏุฑ ุญููู ุงุตู:<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑุง ูุฑ ูุงูุ ุชุงุจุน `extract_abstract_from_tei` ูุฑุงุฎูุงู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ฺฺฉุฏู ุงุณุชุฎุฑุงุฌโุดุฏู ูุนุชุจุฑ ุจุงุดุฏ ู ุจุด ุงุฒ ต ูุงฺู ุฏุงุดุชู ุจุงุดุฏุ<br> ุจูโุนููุงู ฺฉ ฺฺฉุฏู ูุงุจู ุงุณุชูุงุฏู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. ุงู ุดุฑุท ุจุฑุง ุญุฐู ฺฺฉุฏูโูุง ุฎุงู ุง ุจุณุงุฑ ฺฉูุชุงู ุงุนูุงู ุดุฏู ุงุณุช.<br>

ุณูพุณ:<br>
&nbsp;&nbsp;&nbsp;โข	ูุชู ฺฺฉุฏู ุจู `docs`<br>
&nbsp;&nbsp;&nbsp;โข	ุดูุงุณู ููุงูู (ุจุฏูู ูพุณููุฏ) ุจู `ids`<br>
&nbsp;&nbsp;&nbsp;โข	ู ูุฑุงุฏุงุฏู ูุฑุจูุท ุจู ูุงู ุจู `metas`<br>
ุงูุฒูุฏู ูโุดูุฏ.

ด) ฺฏุฒุงุฑุด ุชุนุฏุงุฏ ฺฺฉุฏูโูุง ูุนุชุจุฑ:<br>
ุฏุฑ ูพุงุงูุ ุชุนุฏุงุฏ ฺฺฉุฏูโูุง ฺฉู ุดุฑุงุท ูุงุฒู ุฑุง ุฏุงุดุชูโุงูุฏ ฺุงูพ ูโุดูุฏ. ุงู ููุฏุงุฑ ูุดุงู ูโุฏูุฏ ฺู ุชุนุฏุงุฏ ฺฺฉุฏู ุจุฑุง ูุฑุญูู embedding ู ุงูุฏุณโฺฏุฐุงุฑ ุขูุงุฏู ูุณุชูุฏ.

<br>

ุฏุฑ ุงู ูุฑุญููุ ฺฺฉุฏูโูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุฏุฑ ุจุณุชูโูุง ูพุฑุฏุงุฒุด (Batch) ุจู ูุฏู embedding ุฏุงุฏู ูโุดููุฏ ู ุณูพุณ ููุฑุงู ุจุง ุดูุงุณู ู ูุฑุงุฏุงุฏู ูุฑุจูุทู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ChromaDB ุฐุฎุฑู ูโฺฏุฑุฏูุฏ: 
ุฏุฑ ุงู ูุณูุช:
```python
for i in tqdm(range(0, len(docs), BATCH_SIZE), desc="Indexing abstracts"):
    chunk_docs = docs[i:i+BATCH_SIZE]
    chunk_ids = ids[i:i+BATCH_SIZE]
    chunk_metas = metas[i:i+BATCH_SIZE]
    embs = model.encode(chunk_docs, normalize_embeddings=True)
    collection.add(
        documents=chunk_docs,
        embeddings=embs.tolist(),
        metadatas=chunk_metas,
        ids=chunk_ids
    )

print("โ Abstract indexing complete. Chroma path:", CHROMA_ABS)
```

ฑ) ุชูุณู ฺฺฉุฏูโูุง ุจู ุจุณุชูโูุง ูพุฑุฏุงุฒุด<br>
ุฏุฑ ุญููู ุงุตูุ ฺฺฉุฏูโูุงุ ุดูุงุณูโูุง ู ูุฑุงุฏุงุฏูโูุง ุจุฑ ุงุณุงุณ ููุฏุงุฑ `BATCH_SIZE` ุจู ุจุฎุดโูุง ฺฉูฺฺฉโุชุฑ ุชูุณู ูโุดููุฏ:
<br>
&nbsp;&nbsp;&nbsp;โข	chunk_docs: ูุฌููุนูโุง ุงุฒ ฺฺฉุฏูโูุง<br>
&nbsp;&nbsp;&nbsp;โข	chunk_ids: ุดูุงุณู ฺฉุชุง ูุฑ ฺฺฉุฏู<br>
&nbsp;&nbsp;&nbsp;โข	chunk_metas: ูุฑุงุฏุงุฏู ูุฑุจูุท ุจู ูุฑ ฺฺฉุฏู (ูุงููุฏ ูุงู ูุงู ููุจุน)
ุงู ุชูุณูโุจูุฏ ุจุงุนุซ ูโุดูุฏ ุนููุงุช embedding ู ุฐุฎุฑูโุณุงุฒ ุจุง ฺฉุงุฑุง ู ูุตุฑู ุญุงูุธู ููุงุณุจ ุงูุฌุงู ุดูุฏ.<br>

ฒ) ูุญุงุณุจู ุจุฑุฏุงุฑ ฺฺฉุฏูโูุง<br>
ุฏุฑ ุฎุท ุจุนุฏุ embedding ุชูุงู ฺฺฉุฏูโูุง ููุฌูุฏ ุฏุฑ Batch ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฑุฒุชูุธูโุดุฏู ูุญุงุณุจู ูโุดูุฏ:<br>
`embs = model.encode(chunk_docs, normalize_embeddings=True)`
<br>
ูุฑูุงูโุณุงุฒ ููุงุฏุฑ ุจุฑุฏุงุฑ ุจุงุนุซ ูพุงุฏุงุฑ ุจุดุชุฑ ุฏุฑ ูุญุงุณุจู ุดุจุงูุช ูุนูุง ูโุดูุฏ.



ณ) ุฐุฎุฑูโุณุงุฒ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ<br>
ุฏุฑ ูุฑุญูู ุจุนุฏุ ุฏุงุฏูโูุง ูุฑ Batch ุฏุฑ ูุฌููุนู abstracts ุฐุฎุฑู ูโุดููุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	ูุชู ฺฺฉุฏูโูุง (documents)<br>
&nbsp;&nbsp;&nbsp;โข	ููุงุฏุฑ ุจุฑุฏุงุฑ (embeddings)<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑุงุฏุงุฏู ูุฑุจูุท ุจู ูุฑ ฺฺฉุฏู (metadatas)<br>
&nbsp;&nbsp;&nbsp;โข	ุดูุงุณู ฺฉุชุง (ids)<br>
ุงู ุณุงุฎุชุงุฑ ุงูฺฉุงู ุฌุณุชุฌู ูุนูุง ุณุฑุน ู ุฏูู ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ุฑุง ูุฑุงูู ูโฺฉูุฏ.<br>

ด) ูพุงู ุชฺฉูู ุนููุงุช<br>
ุฏุฑ ูพุงุงูุ ูพุงู ููููุช ฺุงูพ ูโุดูุฏ ฺฉู ูุดุงู ูโุฏูุฏ ุชูุงู ฺฺฉุฏูโูุง ุจุง ููููุช ุงูุฏุณโฺฏุฐุงุฑ ุดุฏูโุงูุฏ ู ูุณุฑ ูพุงฺฏุงู ุฏุงุฏู ูุฒ ฺฏุฒุงุฑุด ูโุดูุฏ.

<br>
โ

---

### ฺฉุฏ ุจุฎุด ุฏูู: ูุทุนู ุจูุฏ ูุนูุง ุจุฏูู ููุงูุงุช

ุฏุฑ ูุฑุญูู ุฏูู ุงุฒ ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏูุ ูุชู ฺฉุงูู ู ุจุฏูู ููุงูุงุช ูพุฑุฏุงุฒุด ูโุดูุฏ. ุงู ุจุฎุด ููุงู ูุญุชูุง ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ุฏุงูุด (Retrieval) ุฏุฑ ูุนูุงุฑ RAG ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ. ุจุฑุฎูุงู ฺฺฉุฏูโูุง ฺฉู ูุนูููุงู ฺฉูุชุงูุ ฺฉูพุงุฑฺู ู ุงุฒ ูุธุฑ ูุนูุง ููุณุฌู ูุณุชูุฏุ
ุจุฏูู ููุงูุงุช ุทููุงูโุชุฑุ ูุชููุนโุชุฑ ู ุดุงูู ุจุฎุดโูุง ูุชุนุฏุฏ ุงุณุชุ ุจูุงุจุฑุงู ุจุฑุง ุงุณุชูุงุฏู ูุคุซุฑ ุฏุฑ RAG ูุงุฒู ุงุณุช ุจู ูุทุนุงุช ูุนูุง ฺฉูฺฺฉโุชุฑ ู ููุณุฌู ุชูุณู ุดููุฏ.<br>

ุฏุฑ ุงู ูุฑุญููุ ูุฑุขูุฏ ูุทุนูโุจูุฏ ูุนูุง ุจุณุงุฑ ูุดุงุจู ฺฉุฏ ุฑูฺฉุฑุฏ ุงุตู Semantic Chunking ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู:<br>

&nbsp;&nbsp;&nbsp;โข	ูุฑูุฏโูุง ูุชู ฺฉุงูู ููุงูุงุช ูุณุชูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุฑูุฌโูุง ูุทุนุงุช ูุนูุง ุจุฏูู ููุงูู ูุณุชูุฏ ฺฉู ุจุนุฏุงู ููุฑุงู ุจุง embedding ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุฐุฎุฑู ูโุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ู ุงู ูุทุนุงุช ุฏุฑ ูุฑุญูู ูพุงุณุฎโุฏู ูุฏู ุฒุจุงู ุจูโุนููุงู ุฏุงูุด ุฒููู (Context) ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑูุฏ.

<br>

ุจูโุทูุฑ ุฎูุงุตูุ ุฌุฑุงู ฺฉุงุฑ ุฏุฑ ุงู ูุฑุญูู ุจู ุตูุฑุช ุฒุฑ ุงุณุช:<br>
ฑ) ุฎูุงูุฏู ูุงู TEI ู ุงุณุชุฎุฑุงุฌ ูุชู ุจุฏูู<br>
ฒ) ูพุงฺฉโุณุงุฒ ู ูพุดโูพุฑุฏุงุฒุด ูุชู<br>
ณ) ูุทุนูโุจูุฏ ูุนูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุขุณุชุงูู ุดุจุงูุช<br>
ด) ุชููุฏ embedding ุจุฑุง ูุฑ ูุทุนู<br>
ต) ุฐุฎุฑูโุณุงุฒ ูุทุนุงุชุ ููุงุฏุฑ ุจุฑุฏุงุฑ ู ูุฑุงุฏุงุฏูโูุง ุฏุฑ ChromaDB<br>

ุงู ูุฑุขูุฏ ุชุถูู ูโฺฉูุฏ ฺฉู ูุฏู RAG ุจุชูุงูุฏ ุฏุฑ ุฒูุงู ูพุงุณุฎโุฏูุ ุจูโุฌุง ุฌุณุชุฌู ุฏุฑ ูุชู ุฎุงู ู ุทููุงูุ ุจู ูุฌููุนูโุง ุงุฒ ูุทุนุงุช ูุนูุง ุฏููุ ฺฉูุชุงู ู ูุฑุชุจุท ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ.

<br>


ุฏุฑ ุงุจุชุฏุง ุจุฑูุงูู ูุฑุจูุท ุจู ูุทุนูโุจูุฏ ูุนูุง ุจุฏูู ููุงูุงุชุ ูุฌููุนูโุง ุงุฒ ฺฉุชุงุจุฎุงููโูุง ู ุงุจุฒุงุฑูุง ูุงุฒู ุจุฑุง ูพุฑุฏุงุฒุด ูุงูโูุง TEIุ ุงุณุชุฎุฑุงุฌ ูุชู ุจุฏููุ ุชููุฏ ููุงุฏุฑ ุจุฑุฏุงุฑ ู ุฐุฎุฑูโุณุงุฒ ุขูโูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฑุงุฎูุงู ูโุดูุฏ:

```python
import os
import numpy as np
from pathlib import Path
from tqdm import tqdm
from sentence_transformers import SentenceTransformer, util
from nltk.tokenize import sent_tokenize
import nltk
import chromadb
from concurrent.futures import ThreadPoolExecutor
from bs4 import BeautifulSoup
nltk.download('punkt', quiet=True)

DATA_DIR = Path(r" Enter TEI documents location ")   
EMB_MODEL = Path(r" Enter fine-tuned embedding model address ")
CHROMA_BODY = Path(r" Enter output DB destination ")
CHROMA_BODY.mkdir(parents=True, exist_ok=True)

# selected IDs file (one doc stem per line) OR set SELECT_ALL=True
SELECTED_IDS_FILE = Path(r" selected_ids.txt location ")
SELECT_ALL = True  
```
ุฏุฑ ฺฉุฏ ููู:<br>
ฑ) ูุฑุงุฎูุงู ฺฉุชุงุจุฎุงููโูุง ููุฑุฏูุงุฒ<br>

ุฏุฑ ุงู ุจุฎุดุ ฺฉุชุงุจุฎุงููโูุง ุฒุฑ ูุฑุงุฎูุงู ูโุดููุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	BeautifulSoup: ุจุฑุง ุชุฌุฒู ู ุชุญูู ุณุงุฎุชุงุฑ XML ูุงูโูุง TEI <br>
&nbsp;&nbsp;&nbsp;โข	SentenceTransformer: ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู<br>
&nbsp;&nbsp;&nbsp;โข	chromadb: ุจุฑุง ุงุฌุงุฏ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ู ุฐุฎุฑูโุณุงุฒ ููุงุฏุฑ ุจุฑุฏุงุฑ ูุทุนุงุช<br>
&nbsp;&nbsp;&nbsp;โข	ThreadPoolExecutor: ุจุฑุง ูพุฑุฏุงุฒุด ููุงุฒ ูุงูโูุง<br>
&nbsp;&nbsp;&nbsp;โข	nltk: ุจุฑุง ุชูฺฉูโุณุงุฒ ุฌููุงุช<br>
&nbsp;&nbsp;&nbsp;โข	tqdm: ุจุฑุง ููุงุด ููุงุฑ ูพุดุฑูุช<br>
&nbsp;&nbsp;&nbsp;โข	numpy: ุจุฑุง ุนููุงุช ุนุฏุฏ ููุฑุฏูุงุฒ<br>
ุงู ุงุจุฒุงุฑูุง ุงูฺฉุงู ูพุฑุฏุงุฒุด ุณุฑุนุ ุฏูู ู ููุงุณโูพุฐุฑ ุจุฏูู ููุงูุงุช ุฑุง ูุฑุงูู ูโฺฉููุฏ.

<br>


ฒ) ุชูุธู ูุณุฑูุง ูุฑูุฏ ู ุฎุฑูุฌ<br>

ุฏุฑ ุฎุทูุท ุจุนุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	DATA_DIR: ูุณุฑ ูุงูโูุง TEI ุดุงูู ูุชู ฺฉุงูู ููุงูุงุช ุฑุง ูุดุฎุต ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	EMB_MODEL: ูุณุฑ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู ุฑุง ุชุนู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	CHROMA_BODY: ูุณุฑ ุฐุฎุฑูโุณุงุฒ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฎุตูุต ุจุฏูู ููุงูุงุช ุงุณุช.<br>
ุฏุณุชูุฑ mkdir ูุฒ ุชุถูู ูโฺฉูุฏ ฺฉู ูุณุฑ ูพุงฺฏุงู ุฏุงุฏู ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ุงุฌุงุฏ ุดูุฏ.

<br>

ณ) ุงูุชุฎุงุจ ููุงูุงุช ุจุฑุง ูพุฑุฏุงุฒุด<br>

ุฏุฑ ุฏู ุฎุท ูพุงุงู:<br>
&nbsp;&nbsp;&nbsp;โข		ุงฺฏุฑ ููุฏุงุฑ `SELECT_ALL = True` ุจุงุดุฏุ ุชูุงู ูุงูโูุง ููุฌูุฏ ุฏุฑ ูุณุฑ ูพุฑุฏุงุฒุด ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ููุฏุงุฑ `SELECT_ALL = False` ุจุงุดุฏุ ุชููุง ููุงูุงุช ูพุฑุฏุงุฒุด ูโุดููุฏ ฺฉู ูุงู ุขูโูุง ุฏุฑ ูุงู `selected_ids.txt` ุฐฺฉุฑ ุดุฏู ุจุงุดุฏ.<br>

ุงู ูุงุจูุช ุฒูุงู ููุฏ ุงุณุช ฺฉู:<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑุง ุจุฑุฎ ููุงูุงุช ฺฺฉุฏู ุงุณุชุฎุฑุงุฌ ูุดุฏู ุจุงุดุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุง ุชููุง ููุงูุงุช ููุชุฎุจ (ุจุฑ ุงุณุงุณ ูุชุงุฌ ุฌุณุชุฌู ฺฺฉุฏูโูุง) ูุงุฑุฏ ูุฑุญูู ูุทุนูโุจูุฏ ุจุฏูู ุดููุฏ.

<br>

ุฏุฑ ุจุฎุด ุจุนุฏุ ูุฌููุนูโุง ุงุฒ ูพุงุฑุงูุชุฑูุง ฺฉูุชุฑู ุจุฑุง ูุทุนูโุจูุฏ ูุนูุง ุจุฏูู ููุงูุงุช ุชุนุฑู ูโุดูุฏ. ุงู ูพุงุฑุงูุชุฑูุง ูุดุงุจู ูุณุฎู ูพุงู ฺฉุฏ ูุทุนูโุจูุฏ ูุนูุง ูุณุชูุฏุ ุงูุง ุจุฑุง ูพุฑุฏุงุฒุด ุจุฏูู ููุงูุงุช ุฏุฑ ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู ุชูุธู ุดุฏูโุงูุฏ:
```python
SIM_THRESHOLD = 0.55
MIN_CHUNK_LEN = 3
MAX_CHUNK_LEN = 15
BATCH_SIZE = 128
MAX_BUFFER = 5000      
THREADS = 4
CHROMA_SAFE_LIMIT = 5400

DEVICE = "cuda" if __import__("torch").cuda.is_available() else "cpu"
```

ุชูุถุญ ุนููฺฉุฑุฏ ูพุงุฑุงูุชุฑูุง:
<br>
&nbsp;&nbsp;&nbsp;โข	SIM_THRESHOLD = 0.55: ุขุณุชุงูู ุดุจุงูุช ูุนูุง ูุงู ุฌููุงุช ุจุฑุง ุชุนู ูุญู ุจุฑุด ูุทุนุงุช. ููุฏุงุฑ ฐ.ตต ุจุฑ ุงุณุงุณ ุชุญูู ุญุณุงุณุช ุจูโุนููุงู ููุฏุงุฑ ุจููู ุงูุชุฎุงุจ ุดุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	MIN_CHUNK_LEN / MAX_CHUNK_LEN: ุญุฏุงูู ู ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฌููุงุช ุฏุฑ ูุฑ ูุทุนู ูุนูุง. ุงู ููุงุฏุฑ ุงุฒ ุงุฌุงุฏ ูุทุนุงุช ุจุณุงุฑ ฺฉูฺฺฉ ุง ุจุด ุงุฒ ุญุฏ ุจุฒุฑฺฏ ุฌููฺฏุฑ ูโฺฉููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	BATCH_SIZE = 128: ุชุนุฏุงุฏ ูุทุนุงุช ฺฉู ุฏุฑ ูุฑ ูุฑุญูู ุจุฑุง ุจุฑุฏุงุฑุณุงุฒ ุจู ูุฏู ุงุฑุณุงู ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	MAX_BUFFER = 5000: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ูุทุนุงุช ฺฉู ูุจู ุงุฒ ุฐุฎุฑูโุณุงุฒ ุฏุฑ ุญุงูุธู ุจุงูุฑ ูฺฏูโุฏุงุฑ ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	THREADS = 4: ุชุนุฏุงุฏ ุฑุดุชูโูุง ูพุฑุฏุงุฒุด ุจุฑุง ุงุฌุฑุง ููุงุฒ ุนููุงุช ูุทุนูโุจูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	CHROMA_SAFE_LIMIT = 5400: ุณูู ุงูู ุจุฑุง ุชุนุฏุงุฏ embedding ูุง ฺฉู ุฏุฑ ฺฉ ุฏุฑุฎูุงุณุช ุจู ChromaDB ุงุฑุณุงู ูโุดูุฏ. ุงู ููุฏุงุฑ ูุญุฏูุฏุช ุฏุงุฎู ChromaDB ุงุณุช ู ุฑุนุงุช ูฺฉุฑุฏู ุขู ุจุงุนุซ ุฎุทุง ุฏุฑ ุฐุฎุฑูโุณุงุฒ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	DEVICE: ุชุนู ูโฺฉูุฏ ฺฉู ูุฏู embedding ุฑู GPU ุง CPU ุงุฌุฑุง ุดูุฏ.

<br>

ูพุณ ุงุฒ ุชุนู ูพุงุฑุงูุชุฑูุงุ ูุฏู ุฑุฒุชูุธูโุดุฏู ุจุงุฑฺฏุฐุงุฑ ุดุฏู ู ูพุงฺฏุงู ุฏุงุฏูู ุจุฑุฏุงุฑ ูุฎุตูุต ูุทุนุงุช ุจุฏูู ููุงูู ุงุฌุงุฏ ูโุดูุฏ:
```python
print("๐น Loading embedding model:", EMB_MODEL)
model = SentenceTransformer(str(EMB_MODEL), device=DEVICE)
client = chromadb.PersistentClient(path=str(CHROMA_BODY))
collection = client.get_or_create_collection(name="semantic_body_chunks")
```
ุชูุถุญุงุช:<br>
ฑ) ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฌุงููุง:<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ูุฏู ุฑุฒุชูุธูโุดุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ `SentenceTransformer` ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ ู ุฑู GPU ุง CPU ูุฑุงุฑ ูโฺฏุฑุฏ. ุงู ูุฏู ุจุฑุง ุชููุฏ embedding ูุทุนุงุช ูุนูุง ุจุฏูู ููุงูู ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ.

<br>

ฒ) ุงุฌุงุฏ ุง ุจุงุฒุงุจ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ:<br>
ุฏุฑ ุฏู ุฎุท ุจุนุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉ `PersistentClient` ุจุฑุง ูุณุฑ ุฐุฎุฑูโุณุงุฒ ุจุฏูู ููุงูุงุช ุณุงุฎุชู ูโุดูุฏ.
&nbsp;&nbsp;&nbsp;โข	ุณูพุณ ูุฌููุนูโุง ุจุง ูุงู `semantic_body_chunks` ุงุฌุงุฏ ุง ุจุงุฒุงุจ ูโุดูุฏ.

ณ) ููุด collection:<br>
ูุชุบุฑ `collection` ูุฌููุนูโุง ุงุณุช ฺฉู:<br>
&nbsp;&nbsp;&nbsp;โข	ูุชู ูุทุนุงุช ูุนูุง<br>
&nbsp;&nbsp;&nbsp;โข	Embedding ูุฑ ูุทุนู<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑุงุฏุงุฏู ูุฑุจูุท ุจู ูุฑ ูุทุนู<br>
&nbsp;&nbsp;&nbsp;โข	ู ุดูุงุณู ฺฉุชุง<br>
ุฏุฑ ุขู ุฐุฎุฑู ูโุดูุฏ. ุงู ูุฌููุนู ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ุจูโุนููุงู ูพุงฺฏุงู ุฏุงูุด ุฒููู ูุฏู RAG ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ.

<br>

ุฏุฑ ุงู ูุฑุญููุ ุชุงุจุน `extract_body_from_tei` ูพุงุฏูโุณุงุฒ ูโุดูุฏ ฺฉู ูุธูู ุงุณุชุฎุฑุงุฌ ูุชู ุงุตู ู ุจุฏูู ููุงูู ุฑุง ุงุฒ ุณุงุฎุชุงุฑ XML ูุงูโูุง TEI ุจุฑ ุนูุฏู ุฏุงุฑุฏ:
```python
def extract_body_from_tei(path: Path) -> str:
    txt = path.read_text(encoding="utf-8", errors="ignore")
    soup = BeautifulSoup(txt, "xml")
    bodies = soup.find_all("body")
    if not bodies:
        bodies = soup.find_all(lambda tag: tag.name == "div" and tag.get("type") == "body")
    body_text = " ".join([b.get_text(" ", strip=True) for b in bodies]).strip()
    if not body_text:
        for t in soup.find_all(["abstract", "front"]):
            t.decompose()
        body_text = soup.get_text(" ", strip=True)
    return body_text
```

ุชูุถุญ ุนููฺฉุฑุฏ ุชุงุจุน<br>
ฑ) ุฎูุงูุฏู ูุงู TEI<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ูุญุชูุง ูุงู TEI ุจุง ุงุณุชูุงุฏู ุงุฒ `read_text` ุฎูุงูุฏู ูโุดูุฏ. ูพุงุฑุงูุชุฑ `errors="ignore"` ุชุถูู ูโฺฉูุฏ ฺฉู ูุฌูุฏ ฺฉุงุฑุงฺฉุชุฑูุง ูุงุณุงุฒฺฏุงุฑ ุจุงุนุซ ุชููู ูพุฑุฏุงุฒุด ูุดูุฏ.<br>

ฒ) ุชุจุฏู ุณุงุฎุชุงุฑ TEI ุจู XML ูุงุจู ูพุฑุฏุงุฒุด<br>
ุฏุฑ ุฎุท ุฏููุ ูุชู ุฎูุงูุฏูโุดุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ `BeautifulSoup(txt, "xml")` ุจู ฺฉ ุณุงุฎุชุงุฑ XML ุชุจุฏู ูโุดูุฏ ุชุง ุงูฺฉุงู ุฌุณุชุฌู ู ุงุณุชุฎุฑุงุฌ ุจุฎุดโูุง ูุฎุชูู ููุงูู ูุฑุงูู ฺฏุฑุฏุฏ.<br>

ณ) ุฌุณุชุฌู ุชฺฏโูุง ุจุฏูู ููุงูู<br>
ุฏุฑ ุฎุท ุณููุ ุชุงุจุน ุจู ุฏูุจุงู ุชูุงู ุชฺฏโูุง `<body> </body>` ูโฺฏุฑุฏุฏ. ุงู ุชฺฏโูุง ุฏุฑ ุงุณุชุงูุฏุงุฑุฏ TEI ูุญู ุงุตู ุฐุฎุฑู ูุชู ุจุฏูู ููุงูู ูุณุชูุฏ.<br>

ด) ุฌุณุชุฌู ุฌุงฺฏุฒู ุฏุฑ ุตูุฑุช ูุจูุฏ ุชฺฏ body<br>
ุฏุฑ ุจุฑุฎ ูุณุฎูโูุง TEIุ ุจุฏูู ููุงูู ุฏุฑ ูุงูุจ `<div type="body"> </div>` ุฐุฎุฑู ูโุดูุฏ. ุฏุฑ ุตูุฑุช ฺฉู ุชฺฏ `<body>` ุงูุช ูุดูุฏุ ุชุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ุดุฑุท lambda ุจู ุฏูุจุงู ุงู ุณุงุฎุชุงุฑ ุฌุงฺฏุฒู ูโฺฏุฑุฏุฏ.<br>

ต) ุงุณุชุฎุฑุงุฌ ูุชู ุจุฏูู<br>
ุฏุฑ ุฎุท ุจุนุฏุ ูุชู ุชูุงู ฺฏุฑูโูุง ุงูุชโุดุฏู ุงุณุชุฎุฑุงุฌ ู ุฏุฑ ูุงูุจ ฺฉ ุฑุดุชู ูุงุญุฏ ุชุฑฺฉุจ ูโุดูุฏ. ุงฺฏุฑ ุงู ููุฏุงุฑ ุฎุงู ุจุงุดุฏุ ุนู ูฺโฺฉ ุงุฒ ุณุงุฎุชุงุฑูุง ููู ุงูุช ูุดุฏู ุจุงุดุฏ.<br>

ถ) ุญุฐู ุจุฎุดโูุง ุบุฑุถุฑูุฑ ู ุงุณุชุฎุฑุงุฌ ูุชู ฺฉุงูู<br>
ุฏุฑ ุงู ุญุงูุช:<br>
โข	ุงุจุชุฏุง ุจุฎุดโูุง abstract ู front ุญุฐู ูโุดููุฏุ<br>
โข	ุณูพุณ ฺฉู ูุชู ุจุงูโูุงูุฏู ูุงู TEI ุจูโุนููุงู ุจุฏูู ููุงูู ุงุณุชุฎุฑุงุฌ ูโุดูุฏ.<br>
ุงู ุฑูุด ุชุถูู ูโฺฉูุฏ ฺฉู ุญุช ุฏุฑ ุณุงุฎุชุงุฑูุง TEI ุบุฑ ุงุณุชุงูุฏุงุฑุฏ ูุฒ ูุชู ุงุตู ููุงูู ุจุงุฒุงุจ ุดูุฏ.<br>

ท)โ ุฎุฑูุฌ ุชุงุจุน<br>
ุฏุฑ ูพุงุงูุ ูุชู ุจุฏูู ููุงูู ุฏุฑ ูุงูุจ ฺฉ ุฑุดุชู ุชูุฒ ู ุขูุงุฏู ูพุฑุฏุงุฒุด ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ.

<br>

ุฏุฑ ูุณูุช ุจุนุฏ ุชุงุจุน `semantic_chunk_text` ูุณุฆูู ุชูุณู ูุชู ุจุฏูู ููุงูู ุจู ูุทุนุงุช ูุนูุง ููุณุฌู ุงุณุช. ุงู ุชุงุจุน ููุงู ููุทู ูุณุฎู ูพุงู ูุทุนูโุจูุฏ ูุนูุง ุฑุง ุฏูุจุงู ูโฺฉูุฏุ ุงูุง ุจุง ูพุงุฑุงูุชุฑูุง ุชูุธูโุดุฏู ุจุฑุง ูพุฑุฏุงุฒุด ุจุฏูู ููุงูุงุช ุฏุฑ ูุนูุงุฑ ุงูู-ฺฺฉุฏู:

```python
def semantic_chunk_text(text, threshold=SIM_THRESHOLD, min_len=MIN_CHUNK_LEN, max_len=MAX_CHUNK_LEN):
    sents = [s.strip() for s in sent_tokenize(text) if len(s.strip()) > 15]
    if len(sents) <= min_len:
        return [" ".join(sents)]

    with torch.no_grad():
        embs = model.encode(
            sents,
            batch_size=BATCH_SIZE,
            normalize_embeddings=True,
            show_progress_bar=False
        )

    sims = util.cos_sim(embs[:-1], embs[1:]).diagonal().cpu().numpy()

    chunks, cur_chunk = [], [sents[0]]

    for i in range(1, len(sents)):
        if sims[i-1] < threshold or len(cur_chunk) >= max_len:
            chunks.append(" ".join(cur_chunk))
            cur_chunk = [sents[i]]
        else:
            cur_chunk.append(sents[i])

    if cur_chunk:
        chunks.append(" ".join(cur_chunk))

    return chunks
```

ูุฑุงุญู ุงุฌุฑุง ุชุงุจุน:<br>
ฑ) ุงุณุชุฎุฑุงุฌ ุฌูููโูุง ูุนุชุจุฑ:<br>
&nbsp;&nbsp;&nbsp;โข	ูพุฑุฏุงุฒุด: ูุชู ุจุง `sent_tokenize` ุจู ุฌูููโูุง ุชูุณู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููุชุฑ: ุชููุง ุฌูููโูุง ุจุง ุทูู ุจุด ุงุฒ ฑต ฺฉุงุฑุงฺฉุชุฑ ูพุฐุฑูุชู ูโุดููุฏ ุชุง ุฌููุงุช ุจุณุงุฑ ฺฉูุชุงู ู ฺฉูโุงุฑุฒุด ุญุฐู ุดููุฏ.<br>

ฒ) ูุฏุฑุช ูุชูู ฺฉูุชุงู:<br>
&nbsp;&nbsp;&nbsp;โข	ุดุฑุท: ุงฺฏุฑ ุชุนุฏุงุฏ ุฌูููโูุง ฺฉูุชุฑ ุง ุจุฑุงุจุฑ ุจุง `min_len` ุจุงุดุฏุ ููุงู ุฌูููโูุง ุจูโุตูุฑุช ฺฉ ูุทุนู ูุงุญุฏ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉุงุฑุจุฑุฏ: ููุงุณุจ ุจุฑุง ุงุณูุงุฏ ฺฉูุชุงู ุง ุจุฎุดโูุง ุจุง ุณุงุฎุชุงุฑ ูุนูุง ุณุงุฏู.<br>

ณ) ุจุฑุฏุงุฑุณุงุฒ ุจุง ุจูููโุณุงุฒ ุญุงูุธู:<br>
&nbsp;&nbsp;&nbsp;โข	no_grad: ูุญุงุณุจุงุช ุฏุฑูู `torch.no_grad` ุงูุฌุงู ูโุดูุฏ ุชุง ุงุฒ ุฐุฎุฑู ฺฏุฑุงุฏุงู ู ุงูุฒุงุด ูุตุฑู ุญุงูุธู ุฌููฺฏุฑ ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉุฏฺฏุฐุงุฑ: ุฌูููโูุง ุจุง `model.encode` ู `batch_size=BATCH_SIZE` ฺฉุฏฺฏุฐุงุฑ ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑูุงูโุณุงุฒ: `normalize_embeddings=True` ุจุฑุง ูพุงุฏุงุฑ ุดุจุงูุช ฺฉุณููุณ.<br>

ด) ูุญุงุณุจู ุดุจุงูุช ฺฉุณููุณ ูุชูุงู:<br>
&nbsp;&nbsp;&nbsp;โข	ุฑูุด: ุดุจุงูุช ุจู ูุฑ ุฌููู ู ุฌููู ุจุนุฏ ุจุง `util.cos_sim` ูุญุงุณุจู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงุณุชุฎุฑุงุฌ: ุชููุง ูุทุฑ ุงุตู ูุงุชุฑุณ ุจุฑุง ุฒูุฌโูุง (i,i+1) ุจุฑุฏุงุดุชู ูโุดูุฏุ ฺูู ุงูฺฏูุฑุชู ุฎุท ุงุณุช ู ุชูุงู ุงููุช ุฏุงุฑุฏ.<br>

ต) ุณุงุฎุช ูุทุนุงุช ูุนูุง ุจุง ููุทู ุจุฑุด ุงุตูุงุญโุดุฏู:<br>
&nbsp;&nbsp;&nbsp;โข	ุดุฑูุน: ูุทุนู ุงูู ุจุง ุฌููู ูุฎุณุช ุขุบุงุฒ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุญููู: ุจุฑุง ูุฑ ุฌููู ุจุนุฏ:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุดุฑุท ุจุฑุด: ุงฺฏุฑ ุดุจุงูุช ุจุง ุฌููู ูุจู ฺฉูุชุฑ ุงุฒ `threshold` ุจุงุดุฏ ุง ุทูู ูุทุนู ุจู `max_len` ุจุฑุณุฏุ ูุทุนู ุฌุงุฑ ุจุณุชู ูโุดูุฏ ู ุฌููู ูุนู ุขุบุงุฒฺฏุฑ ูุทุนู ุฌุฏุฏ ูโฺฏุฑุฏุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุงุฏุงูู: ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุฌููู ุจู ูุทุนู ุฌุงุฑ ุงูุฒูุฏู ูโุดูุฏ.<br>
ุด	ูพุงุงู: ุงฺฏุฑ ูุทุนูโุง ูููโุชูุงู ุจุงู ูุงูุฏู ุจุงุดุฏุ ุจู ุฎุฑูุฌ ุงูุฒูุฏู ูโุดูุฏ.

<br>

ุฏุฑ ูุณูุช ุจุนุฏุ ุฏุฑ ุงู ูุฑุญููุ ูพุด ุงุฒ ุขุบุงุฒ ูพุฑุฏุงุฒุดุ ุชุนู ูโุดูุฏ ฺฉู ฺฉุฏุงู ูุงูโูุง TEI ุจุงุฏ ูุงุฑุฏ ูุฑุขูุฏ ูุทุนูโุจูุฏ ูุนูุง ุดููุฏ. ุงู ุงูุชุฎุงุจ ุจุฑ ุงุณุงุณ ููุฏุงุฑ ูพุงุฑุงูุชุฑ `SELECT_ALL` ุง ููุฑุณุช ุดูุงุณูโูุง ููุฌูุฏ ุฏุฑ ูุงู `selected_ids.txt` ุงูุฌุงู ูโุดูุฏ:

```python
if SELECT_ALL or not SELECTED_IDS_FILE.exists():
    to_process = sorted(DATA_DIR.glob("*.tei.xml"))
else:
    ids = [line.strip() for line in SELECTED_IDS_FILE.read_text(encoding="utf-8").splitlines() if line.strip()]
    to_process = [DATA_DIR / (i + ".tei.xml") for i in ids if (DATA_DIR / (i + ".tei.xml")).exists()]

print(f"๐ Will process {len(to_process)} articles for body chunking.")
```

ุชูุถุญ ุนููฺฉุฑุฏ ฺฉุฏ:<br>
ฑ) ุญุงูุช ุงูู: ูพุฑุฏุงุฒุด ููู ููุงูุงุช:<br>
ุงฺฏุฑ ููุฏุงุฑ `SELECT_ALL = True` ุจุงุดุฏุ ุง ุงฺฏุฑ ูุงู `selected_ids.txt` ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ<br> ุจุฑูุงูู ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุชูุงู ูุงูโูุง TEI ููุฌูุฏ ุฏุฑ ูุณุฑ `DATA_DIR` ุฑุง ุจุฑุง ูพุฑุฏุงุฒุด ุงูุชุฎุงุจ ูโฺฉูุฏ:<br>

`to_process = sorted(DATA_DIR.glob("*.tei.xml"))`

<br>
ุงู ุญุงูุช ุฒูุงู ุงุณุชูุงุฏู ูโุดูุฏ ฺฉู:<br>
&nbsp;&nbsp;&nbsp;โข	ูุตุฏ ูพุฑุฏุงุฒุด ฺฉุงูู ูุฌููุนู ุฏุงุฏู ูุฌูุฏ ุฏุงุฑุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุง ูููุฒ ูุฑุญูู ุงุณุชุฎุฑุงุฌ ฺฺฉุฏู ุงูุฌุงู ูุดุฏู ู ููุฑุณุช ููุงูุงุช ููุชุฎุจ ุฏุฑ ุฏุณุชุฑุณ ูุณุช.

<br>

ฒ) ุญุงูุช ุฏูู: ูพุฑุฏุงุฒุด ููุงูุงุช ููุชุฎุจ:<br>
ุงฺฏุฑ `SELECT_ALL = False` ุจุงุดุฏุ ุจุฑูุงูู ุชููุง ูุงูโูุง ุฑุง ูพุฑุฏุงุฒุด ูโฺฉูุฏ ฺฉู ูุงู ุขูโูุง ุฏุฑ ูุงู `selected_ids.txt` ุฐฺฉุฑ ุดุฏู ุจุงุดุฏ. ุงู ูุงู ูุนูููุงู ุดุงูู ุดูุงุณู ููุงูุงุช ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ุฌุณุชุฌู ฺฺฉุฏูโูุง ูุฑุชุจุท ุชุดุฎุต ุฏุงุฏู ุดุฏูโุงูุฏ.
ุฏุฑ ุงู ุญุงูุช:
&nbsp;&nbsp;&nbsp;โข	ุดูุงุณูโูุง ุงุฒ ูุงู ุฎูุงูุฏู ูโุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑุง ูุฑ ุดูุงุณู ูุณุฑ ูุงู TEI ุณุงุฎุชู ูโุดูุฏุ
ู	ุชููุง ูุงูโูุง ฺฉู ูุงูุนุงู ูุฌูุฏ ุฏุงุฑูุฏ ูุงุฑุฏ ููุฑุณุช ูพุฑุฏุงุฒุด ูโุดููุฏ.

<br>

ณ) ฺฏุฒุงุฑุด ุชุนุฏุงุฏ ููุงูุงุช ุงูุชุฎุงุจโุดุฏู:<br>
ุฏุฑ ูพุงุงูุ ุชุนุฏุงุฏ ููุงูุงุช ฺฉู ูุฑุงุฑ ุงุณุช ูุงุฑุฏ ูุฑุญูู ูุทุนูโุจูุฏ ูุนูุง ุดููุฏ ฺุงูพ ูโุดูุฏ. ุงู ูพุงู ุจุฑุง ุงุทููุงู ุงุฒ ุตุญุช ุงูุชุฎุงุจ ูุฑูุฏโูุง ู ฺฉูุชุฑู ุฌุฑุงู ูพุฑุฏุงุฒุด ุถุฑูุฑ ุงุณุช.
<br>

ุฏุฑ ุงุฏุงููุ ููุงููุฏ ูุณุฎู ูพุงู ูุทุนูโุจูุฏ ูุนูุงุ ฺูุงุฑ ุจุงูุฑ ุจุฑุง ูฺฏูโุฏุงุฑ ูููุช ุฏุงุฏูโูุง ูุฑุจูุท ุจู ูุทุนุงุช ุจุฏูู ููุงูู ุชุนุฑู ูโุดูุฏ. ุณูพุณ ุชุงุจุน ุจุฑุง ุงูุชูุงู ุงูู ู ูุฑุญููโุง ุงู ุฏุงุฏูโูุง ุจู ูพุงฺฏุงู ุฏุงุฏู ChromaDB ูพุงุฏูโุณุงุฒ ูโฺฏุฑุฏุฏ:

```python
buffer_docs, buffer_embs, buffer_meta, buffer_ids = [], [], [], []
total_chunks = 0
def flush_to_db():
    global buffer_docs, buffer_embs, buffer_meta, buffer_ids
    while len(buffer_docs) > 0:
        chunk_size = min(len(buffer_docs), CHROMA_SAFE_LIMIT)
        collection.add(
            documents=buffer_docs[:chunk_size],
            embeddings=buffer_embs[:chunk_size],
            metadatas=buffer_meta[:chunk_size],
            ids=buffer_ids[:chunk_size]
        )
        buffer_docs = buffer_docs[chunk_size:]
        buffer_embs = buffer_embs[chunk_size:]
        buffer_meta = buffer_meta[chunk_size:]
        buffer_ids = buffer_ids[chunk_size:]
```

ฑ) ุชูุถุญ ุนููฺฉุฑุฏ ุจุงูุฑูุง ุฏุฑ ุฎุท ุงูู:<br>
ฺูุงุฑ ุจุงูุฑ ุฒุฑ ุจุฑุง ุฐุฎุฑูโุณุงุฒ ูููุช ุฏุงุฏูโูุง ูุจู ุงุฒ ุงูุชูุงู ุจู ูพุงฺฏุงู ุฏุงุฏู ุงุณุชูุงุฏู ูโุดููุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	buffer_docs: ูุชู ูุทุนุงุช ูุนูุง ุงุณุชุฎุฑุงุฌโุดุฏู<br>
&nbsp;&nbsp;&nbsp;โข	buffer_embs: ุจุฑุฏุงุฑ embedding ูุฑ ูุทุนู<br>
&nbsp;&nbsp;&nbsp;โข	buffer_meta: ูุฑุงุฏุงุฏู ูุฑุจูุท ุจู ูุฑ ูุทุนู (ูุงู ูุงูุ ุดูุงุฑู ูุทุนูุ ุทูู ูุทุนู ู โฆ)<br>
&nbsp;&nbsp;&nbsp;โข	buffer_ids: ุดูุงุณู ฺฉุชุง ูุฑ ูุทุนู ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุฏุฑ ChromaDB
ุงู ุณุงุฎุชุงุฑ ุจุงูุฑฺฏุฐุงุฑ ุจุงุนุซ ูโุดูุฏ ุฏุงุฏูโูุง ุงุจุชุฏุง ุฏุฑ ุญุงูุธู ุฌูุนโุขูุฑ ุดููุฏ ู ุณูพุณ ุฏุฑ ุจุณุชูโูุง ฺฉูุชุฑูโุดุฏู ุจู ูพุงฺฏุงู ุฏุงุฏู ููุชูู ฺฏุฑุฏูุฏ.<br>

ฒ) ุชุนุฑู ุชุงุจุน `flush_to_db`:<br>
ุชุงุจุน `flush_to_db` ูุณุฆูู ุงูุชูุงู ุงูู ุฏุงุฏูโูุง ุงุฒ ุจุงูุฑ ุจู ูพุงฺฏุงู ุฏุงุฏู ุงุณุช. ุงู ุชุงุจุน ุจุง ุงุณุชูุงุฏู ุงุฒ ููุฏุงุฑ `CHROMA_SAFE_LIMIT = 5400` ุงุทููุงู ุญุงุตู ูโฺฉูุฏ ฺฉู ูฺโฺฏุงู ุจุด ุงุฒ ตดฐฐ embedding ุฏุฑ ฺฉ ุฏุฑุฎูุงุณุช ุจู ChromaDB ุงุฑุณุงู ูุดูุฏ. ุงู ููุฏุงุฑ ูุญุฏูุฏุช ุฏุงุฎู ChromaDB ุงุณุช ู ุฑุนุงุช ูฺฉุฑุฏู ุขู ููุฌุฑ ุจู ุฎุทุง ุฏุฑ ุนููุงุช ุฐุฎุฑูโุณุงุฒ ุฎูุงูุฏ ุดุฏ.<br>

ณ) ููุทู ุนููฺฉุฑุฏ ุชุงุจุน:<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุงุฏูโูุง ููุฌูุฏ ุฏุฑ ุจุงูุฑ ฺฉูุชุฑ ุง ุจุฑุงุจุฑ ุจุง ตดฐฐ ุจุงุดุฏ: ุชูุงู ุฏุงุฏูโูุง ุฏุฑ ฺฉ ูุฑุญูู ุจู ูพุงฺฏุงู ุฏุงุฏู ููุชูู ูโุดููุฏ ู ุจุงูุฑ ุชุฎูู ูโฺฏุฑุฏุฏ.<br>

ุฏ	ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุงุฏูโูุง ุจุดุชุฑ ุงุฒ ตดฐฐ ุจุงุดุฏ: ุงุจุชุฏุง ตดฐฐ ููุฑุฏ ุงูู ุจู ูพุงฺฏุงู ุฏุงุฏู ุงุฑุณุงู ูโุดูุฏุ ุณูพุณ ุงุฒ ุจุงูุฑ ุญุฐู ูโฺฏุฑุฏุฏุ ู ุงู ูุฑุขูุฏ ุชุง ุชุฎูู ฺฉุงูู ุจุงูุฑ ุชฺฉุฑุงุฑ ูโุดูุฏ.
ุงู ุฑูุด ุงุฒ ุจุฑูุฒ ุฎุทุงูุง ูุงุด ุงุฒ ุงุฑุณุงู ุญุฌู ุจุด ุงุฒ ุญุฏ ุฏุงุฏู ุฌููฺฏุฑ ฺฉุฑุฏู ู ุฐุฎุฑูโุณุงุฒ ุฑุง ูพุงุฏุงุฑ ู ูุงุจู ุงุนุชูุงุฏ ูโฺฉูุฏ.

<br>

ุฏุฑ ูุฑุญูู ุจุนุฏุ ุชุงุจุน `process_file` ูุณุฆูู ูพุฑุฏุงุฒุด ูุฑ ูุงู TEI ุจูโุตูุฑุช ูุณุชูู ุงุณุช. ุงู ุชุงุจุน ุงุจุชุฏุง ูุชู ุจุฏูู ููุงูู ุฑุง ุงุณุชุฎุฑุงุฌ ูโฺฉูุฏ ู ุณูพุณ ุฏุฑ ุตูุฑุช ุฏุงุดุชู ุญุฏุงูู ุทูู ูุงุฒูุ ุขู ุฑุง ูุงุฑุฏ ูุฑุขูุฏ ูุทุนูโุจูุฏ ูุนูุง ูโููุงุฏ: 

```python
def process_file(path: Path):
    body = extract_body_from_tei(path)
    if not body or len(body.split()) < 50:
        return path.name, []
    chunks = semantic_chunk_text(body)
    return path.name, chunks
```

ุชูุถุญ ุนููฺฉุฑุฏ ุชุงุจุน:<br>

ฑ) ุงุณุชุฎุฑุงุฌ ุจุฏูู ููุงูู:<br>
ุฏุฑ ุฎุท ูุฎุณุชุ ุชุงุจุน `extract_body_from_tei(path)` ูุฑุงุฎูุงู ูโุดูุฏ ุชุง ูุชู ุงุตู ููุงูู ุงุฒ ุณุงุฎุชุงุฑ TEI ุงุณุชุฎุฑุงุฌ ฺฏุฑุฏุฏ. ุฎุฑูุฌ ุงู ุชุงุจุน ููฺฉู ุงุณุช:<br>

&nbsp;&nbsp;&nbsp;โข	ูุชู ฺฉุงูู ุจุฏููุ<br>
&nbsp;&nbsp;&nbsp;โข	ุง ุฏุฑ ุตูุฑุช ูุจูุฏ ุณุงุฎุชุงุฑ ุงุณุชุงูุฏุงุฑุฏุ ูุชู ุฌุงฺฏุฒู ุงุณุชุฎุฑุงุฌโุดุฏู ุจุงุดุฏ.<br>

ฒ) ุจุฑุฑุณ ุญุฏุงูู ุทูู ุจุฏูู:<br>
ุฏุฑ ุฎุท ุจุนุฏุ ุฏู ุดุฑุท ุจุฑุฑุณ ูโุดูุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ูุชู ุจุฏูู ุฎุงู ุจุงุดุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุง ุงฺฏุฑ ุชุนุฏุงุฏ ูุงฺูโูุง ุขู ฺฉูุชุฑ ุงุฒ ตฐ ฺฉููู ุจุงุดุฏุ<br>
ุชุงุจุน ูุชุฌู ุฑุง ุจูโุตูุฑุช `(path.name, [])` ุจุงุฒูโฺฏุฑุฏุงูุฏ. ุงู ุฑูุชุงุฑ ุจุฑุง ุญุฐู ููุงูุงุช ุจุณุงุฑ ฺฉูุชุงูุ ูุงูุต ุง ูุงูุฏ ูุญุชูุง ูุงุจู ุงุณุชูุงุฏู ุฏุฑ RAG ุถุฑูุฑ ุงุณุช.<br>

ณ) ูุทุนูโุจูุฏ ูุนูุง ุจุฏูู ููุงูู:<br>
ุงฺฏุฑ ูุชู ุจุฏูู ุทูู ฺฉุงู ุฏุงุดุชู ุจุงุดุฏุ ุชุงุจุน `semantic_chunk_text(body)` ูุฑุงุฎูุงู ูโุดูุฏ. ุงู ุชุงุจุน ูุชู ุฑุง ุจุฑ ุงุณุงุณ ุดุจุงูุช ูุนูุง ูุงู ุฌููุงุช ุจู ฺูุฏู ูุทุนู ููุณุฌู ุชูุณู ูโฺฉูุฏ.<br>

ด) ุฎุฑูุฌ ููุง:<br>
ุฏุฑ ูพุงุงูุ ุชุงุจุน ูุงู ูุงู ู ููุฑุณุช ูุทุนุงุช ูุนูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ: `path.name, chunks`
ุงู ุณุงุฎุชุงุฑ ุฎุฑูุฌ ุจูโฺฏูููโุง ุทุฑุงุญ ุดุฏู ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ูพุฑุฏุงุฒุด ููุงุฒ `ThreadPoolExecutor` ุจูโุฑุงุญุช ูุงุจู ุงุณุชูุงุฏู ุจุงุดุฏ.

<br>

ุฏุฑ ุจุฎุด ูพุงุงู ุจุฑูุงููุ ูุงูโูุง ุงูุชุฎุงุจโุดุฏู ูุงุฑุฏ ูุฑุญูู ูพุฑุฏุงุฒุด ููุงุฒ ุดุฏู ู ูุทุนุงุช ูุนูุง ุงุณุชุฎุฑุงุฌโุดุฏู ููุฑุงู ุจุง ููุงุฏุฑ ุจุฑุฏุงุฑ ู ูุฑุงุฏุงุฏู ูุฑุจูุทู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุฐุฎุฑู ูโุดููุฏ:

```python
from concurrent.futures import ThreadPoolExecutor
with ThreadPoolExecutor(max_workers=THREADS) as ex:
    for name, chunks in tqdm(ex.map(process_file, to_process), total=len(to_process), desc="Chunking bodies"):
        if not chunks:
            continue
        embs = model.encode(chunks, batch_size=BATCH_SIZE, normalize_embeddings=True, show_progress_bar=False)
        ids = [f"{Path(name).stem}_chunk_{i}" for i in range(len(chunks))]
        metas = [{"source": name, "chunk_id": i} for i in range(len(chunks))]

        buffer_docs.extend(chunks)
        buffer_embs.extend(embs.tolist())
        buffer_meta.extend(metas)
        buffer_ids.extend(ids)
        total_chunks += len(chunks)

        if len(buffer_docs) >= MAX_BUFFER:
            flush_to_db()
flush_to_db()

print(f"โ Done: processed {len(to_process)} articles, stored {total_chunks} chunks in {CHROMA_BODY}")
```

ุชูุถุญ ุนููฺฉุฑุฏ ฺฉุฏ:<br>
ฑ) ุขุบุงุฒ ูพุฑุฏุงุฒุด ููุงุฒ:<br>
ุฏุฑ ุงู ุจุฎุดุ ุจุง ุงุณุชูุงุฏู ุงุฒ `ThreadPoolExecutor(max_workers=THREADS)` ูพุฑุฏุงุฒุด ูุงูโูุง ุจูโุตูุฑุช ููุงุฒ ุงูุฌุงู ูโุดูุฏ. ุงู ฺฉุงุฑ ุณุฑุนุช ูพุฑุฏุงุฒุด ูุฌููุนูโูุง ุจุฒุฑฺฏ TEI ุฑุง ุจูโุทูุฑ ฺุดูฺฏุฑ ุงูุฒุงุด ูโุฏูุฏ.<br>

ฒ) ูุฑุงุฎูุงู ุชุงุจุน `process_file` ุจุฑุง ูุฑ ููุงูู:<br>
ุฏุฑ ูุฑ ุชฺฉุฑุงุฑ ุญููู:<br>
&nbsp;&nbsp;&nbsp;โข	ุชุงุจุน `process_file` ุฑู ฺฉ ูุงู TEI ุงุฌุฑุง ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงู ุชุงุจุน ุงุจุชุฏุง ุจุฏูู ููุงูู ุฑุง ุงุณุชุฎุฑุงุฌ ฺฉุฑุฏู ู ุณูพุณ ุฏุฑ ุตูุฑุช ุฏุงุดุชู ุญุฏุงูู ตฐ ฺฉูููุ ุขู ุฑุง ูุงุฑุฏ ูุฑุขูุฏ ูุทุนูโุจูุฏ ูุนูุง ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุฑูุฌ ุชุงุจุน ุดุงูู:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุงู ูุงู<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ู ููุฑุณุช ูุทุนุงุช ูุนูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุงุณุช.<br>
ุงฺฏุฑ ููุงูู ูุงูุฏ ุจุฏูู ูุนุชุจุฑ ุจุงุดุฏุ ููุฏุงุฑ chunks ุฎุงู ุฎูุงูุฏ ุจูุฏ ู ูพุฑุฏุงุฒุด ุขู ูุงู ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ.<br>

ณ) ูุญุงุณุจู ููุฏุงุฑ ุจุฑุฏุงุฑ ูุทุนุงุช ูุนูุง:<br>
ุจุฑุง ูุฑ ูุงู ูุนุชุจุฑุ embedding ุชูุงู ูุทุนุงุช ูุนูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฑุฒุชูุธูโุดุฏู ูุญุงุณุจู ูโุดูุฏ:<br>

`embs = model.encode()`

ุงู embedding ูุง ูพุงู ุนููุงุช ุฌุณุชุฌู ูุนูุง ุฏุฑ ูุฑุญูู Retrieval ูุณุชูุฏ.<br>

ด) ุงุฌุงุฏ ุดูุงุณู ู ูุฑุงุฏุงุฏู ูุฑ ูุทุนู:<br>
ุจุฑุง ูุฑ ูุทุนู:<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉ ุดูุงุณู ฺฉุชุง (ID) ุจูโุตูุฑุช `filename_chunk_i` ุชููุฏ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฑุงุฏุงุฏูโุง ุดุงูู ูุงู ูุงู ู ุดูุงุฑู ูุทุนู ุณุงุฎุชู ูโุดูุฏ.<br>

ต) ุงูุฒูุฏู ุฏุงุฏูโูุง ุจู ุจุงูุฑ:<br>
ฺูุงุฑ ุจุงูุฑ ุงุตู ุจุง ุงุณุชูุงุฏู ุงุฒ `extend` ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	buffer_docs: ูุชู ูุทุนุงุช<br>
&nbsp;&nbsp;&nbsp;โข	buffer_embs: ููุงุฏุฑ ุจุฑุฏุงุฑ<br>
&nbsp;&nbsp;&nbsp;โข	buffer_meta: ูุฑุงุฏุงุฏู ูุทุนุงุช<br>
&nbsp;&nbsp;&nbsp;โข	buffer_ids: ุดูุงุณูโูุง ฺฉุชุง<br>
ููฺูู ุชุนุฏุงุฏ ฺฉู ูุทุนุงุช ูพุฑุฏุงุฒุดโุดุฏู ุฏุฑ `total_chunks` ุฌูุน ุฒุฏู ูโุดูุฏ.<br>

ถ) ฺฉูุชุฑู ุงูุฏุงุฒู ุจุงูุฑ ู ุฐุฎุฑูโุณุงุฒ ูุฑุญููโุง:<br>
ุฏุฑ ูพุงุงู ูุฑ ุชฺฉุฑุงุฑ ุญูููุ ุงูุฏุงุฒู ุจุงูุฑ ุจุฑุฑุณ ูโุดูุฏ:<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุงุฏูโูุง ุจู `MAX_BUFFER` ุจุฑุณุฏุ ุชุงุจุน `flush_to_db()` ูุฑุงุฎูุงู ุดุฏู ู ุฏุงุฏูโูุง ุฏุฑ ุจุณุชูโูุง ุงูู (ฺฉูุชุฑ ุงุฒ `CHROMA_SAFE_LIMIT`) ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุฐุฎุฑู ูโุดููุฏ.
ุงู ฺฉุงุฑ ุงุฒ ุงูุจุงุดุชู ุดุฏู ุจุด ุงุฒ ุญุฏ ุฏุงุฏูโูุง ุฏุฑ ุญุงูุธู ุฌููฺฏุฑ ูโฺฉูุฏ.<br>

ท) ุชุฎูู ููุง ุจุงูุฑ:<br>
ูพุณ ุงุฒ ูพุงุงู ูพุฑุฏุงุฒุด ููุงุฒุ ฺฉ ุจุงุฑ ุฏฺฏุฑ `flush_to_db` ูุฑุงุฎูุงู ูโุดูุฏ ุชุง:<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุงุฏูโูุง ุจุงูโูุงูุฏู ฺฉู ฺฉูุชุฑ ุงุฒ `MAX_BUFFER` ูุณุชูุฏ ูุฒ ุฐุฎุฑู ุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ู ุญุงูุธู RAM ุจูโุทูุฑ ฺฉุงูู ุชุฎูู ฺฏุฑุฏุฏ.<br>

ธ) ูพุงู ููุง:<br>
ุฏุฑ ูพุงุงูุ ุชุนุฏุงุฏ ููุงูุงุช ูพุฑุฏุงุฒุดโุดุฏู ู ุชุนุฏุงุฏ ฺฉู ูุทุนุงุช ูุนูุง ุฐุฎุฑูโุดุฏู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ฺุงูพ ูโุดูุฏ:<br>

 
<div align="center">

![ุชุตูุฑ  ฑท โ ูุซุงู ุฎุฑูุฌ ุงุฌุฑุง ฺฉุฏ ุงุณุชุฎุฑุงุฌ ฺฺฉุฏู ูุง ุฏุฑ ุฑูฺฉุฑุฏ Abstract-First ุจุฑุง ูพฺฉุฑุจูุฏ 17TB + G5](/assets/patterneffort/synergistic-rag/media/fig17.JPG)

</div>

<p style="text-align:center;">
  <sub>ุชุตูุฑ ฑท โ ูุซุงู ุฎุฑูุฌ ุงุฌุฑุง ฺฉุฏ ุงุณุชุฎุฑุงุฌ ฺฺฉุฏู ูุง ุฏุฑ ุฑูฺฉุฑุฏ Abstract-First ุจุฑุง ูพฺฉุฑุจูุฏ 17TB + G</sub>
</p>

<br>

<div align="center">

![ุชุตูุฑ ฑธ โ ูุซุงู ุฎุฑูุฌ ุงุฌุฑุง ฺฉุฏ ูุทุนู ุจูุฏ ูุนูุง ุฑูฺฉุฑุฏ Abstract-First ุจุฑุง ูพฺฉุฑุจูุฏ 17 TB + G
](/assets/patterneffort/synergistic-rag/media/fig18.JPG)

</div>

<p style="text-align:center;">
  <sub>ุชุตูุฑ ฑธ โ ูุซุงู ุฎุฑูุฌ ุงุฌุฑุง ฺฉุฏ ูุทุนู ุจูุฏ ูุนูุง ุฑูฺฉุฑุฏ Abstract-First ุจุฑุง ูพฺฉุฑุจูุฏ 17TB + G
</sub>
</p>
 
<br>

---
## ูพุงุฏู ุณุงุฒ: Retrieval-augmented generation

### ูุนูุงุฑ RAG
ุฏุฑ ุงู ุจุฎุดุ ุจู ูููโุชุฑู ูุณูุช ฺฏุฒุงุฑุด ุนู ูพุงุฏูโุณุงุฒ ูุนูุงุฑ RAG ุจุง ุฑูฺฉุฑุฏ ููโุงูุฒุง ูโูพุฑุฏุงุฒู. ุฏุฑ ุงู ุฑูฺฉุฑุฏุ ุงุฒ ุฑุงูุจุฑุฏ ุจุฑ ูพุงู ฺฺฉุฏูโูุงุ ุจูโููุฑุงู ูุฏู ุฌุงููุง ูุงูโุชููโุดุฏู ู ูุทุนุงุช ูุนูุง ุฑุฒุฏุงููโุดุฏู ุจุฏูู ููุงูุงุช ุจูโุตูุฑุช ุชุฑฺฉุจ ุงุณุชูุงุฏู ูโุดูุฏ.

ุฏุฑ ูุฑุงุญู ูุจูุ ุฒุฑุณุงุฎุช ูุงุฒู ุจุฑุง ุงู ูุนูุงุฑ ุดุงูู ุงุณุชุฎุฑุงุฌ ฺฺฉุฏูโูุงุ ุชููุฏ ููุงุฏุฑ ุจุฑุฏุงุฑ ุชุฎุตุตุ ู ูุทุนูโุจูุฏ ูุนูุง ุจุฏูู ููุงูุงุช ู ุงูุฏุณโฺฏุฐุงุฑ ุขูโูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุขูุงุฏู ุดุฏู ุงุณุช. ุฏุฑ ุงู ุจุฎุดุ ูุดุงู ูโุฏูู ฺฉู ฺฺฏููู ุงู ุงุฌุฒุง ุฏุฑ ฺฉูุงุฑ ฺฉุฏฺฏุฑ ูุฑุงุฑ ูโฺฏุฑูุฏ ุชุง ุฏุฑ ูุฑุขูุฏ ูพุงุณุฎโฺฏู ุจู ูพุฑุณุดโูุง ฺฉุงุฑุจุฑุงู ุจูโุตูุฑุช ููโุงูุฒุง ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑูุฏ.

<br>

---

### ูุนูุงุฑ RAG ุณุงุฏู

ุงุจุชุฏุง ุฏุฑ ุญุงูุช ูพุงูุ ูุนูุงุฑ ุณุงุฏู RAG ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฌููุนูโุง ุงุฒ ฺฉุชุงุจุฎุงููโูุง ู ุงุจุฒุงุฑูุง ูุชุฏุงูู ุฏุฑ ูพุฑุฏุงุฒุด ุฒุจุงู ุทุจุน ู ุจุงุฒุงุจ ุจุฑุฏุงุฑ ูพุงุฏูโุณุงุฒ ูโุดูุฏ. ุฏุฑ ฺฏุงู ูุฎุณุชุ ฺฉุชุงุจุฎุงููโูุง ููุฑุฏูุงุฒ ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุฏูโูุง ุฒุจุงูุ ูุฏูโูุง ุฌุงููุง ู ุงุฑุชุจุงุท ุจุง ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฑุงุฎูุงู ูโฺฏุฑุฏูุฏ:
```python
import os, json, torch
from pathlib import Path
from tqdm import tqdm
from sentence_transformers import SentenceTransformer
from chromadb import PersistentClient
from transformers import AutoTokenizer, AutoModelForCausalLM, pipeline
import nltk
nltk.download('punkt', quiet=True)
```
ุฏุฑ ุงู ุจุฎุด:<br>
&nbsp;&nbsp;&nbsp;โข	ุงุฒ SentenceTransformer: ุจุฑุง ุชููุฏ ุจุฑุฏุงุฑูุง ูุนูุง ูพุฑุณุดโูุง ู ุงุณูุงุฏ ุงุณุชูุงุฏู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุงุฒ ChromaDB (PersistentClient): ุจุฑุง ูฺฏูโุฏุงุฑ ู ุฌุณุชุฌู ุจุฑุฏุงุฑ ุงุณูุงุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุงุฒ Transformers: ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฒุจุงู ูููุฏ (LLM) ู ูพุงุฏูโุณุงุฒ ูุฑุญูู Generationุ<br>
&nbsp;&nbsp;&nbsp;โข	ู ุงุฒ NLTK ุจุฑุง ุชูฺฉูโุณุงุฒ ูุชูู (ุฏุฑ ุตูุฑุช ูุงุฒ) ุจูุฑู ฺฏุฑูุชู ูโุดูุฏ.
ุจู ุงู ุชุฑุชุจุ ุฒุฑุณุงุฎุช ุงููู ูุงุฒู ุจุฑุง ูพุงุฏูโุณุงุฒ ฺฉ ุณุงูุงูู RAG ุณุงุฏู ูุฑุงูู ูโฺฏุฑุฏุฏ.

<br>

ุฏุฑ ฺฏุงู ุจุนุฏุ ูุณุฑูุง ูุฑุจูุท ุจู ูุฑูุฏ ูพุฑุณุดโูุงุ ุฎุฑูุฌ ุณุงูุงูู RAGุ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑุ ูุฏู ุฌุงููุง ู ูุฏู ุฒุจุงู ูุญู ุชุนู ูโุดููุฏ:
 ```python
INPUT_QUERIES_FILE = r" Enter .jsonl queries input location "  
OUTPUT_FILE = r" Enter .jsonl output destination "

CHROMA_PATH = r" Enter semantic chunksโ vector Database location "               
EMB_MODEL_PATH = r" Enter fine-tuned embedding model location "            
LLM_MODEL_PATH = r" Enter Local LLM Model location "
```
ุฏุฑ ุงู ูุณูุช:<br>
&nbsp;&nbsp;&nbsp;โข	INPUT_QUERIES_FILE: ูุณุฑ ูุงู ูุฑูุฏ ุจุง ูุฑูุช jsonl ฺฉู ุดุงูู ููุฑุณุช ุงุฒ ูพุฑุณุดโูุง ุงุณุช. ูุฑ ุฑฺฉูุฑุฏ ุงู ูุงู ูุนูููุงู ุดุงูู ูุชู ูพุฑุณุดุ ุดูุงุณู ฺฉุชุง ู ุฏุฑ ุตูุฑุช ูุฌูุฏุ ููุจุน ุง ุจุฑฺุณุจ ุงุฑุฒุงุจ ุจุฑุง ุณูุฌุด ุนููฺฉุฑุฏ ูุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	OUTPUT_FILE: ูุณุฑ ูุงู ุฎุฑูุฌ jsonl ฺฉู ูพุงุณุฎโูุง ุชููุฏุดุฏู ุชูุณุท ูุนูุงุฑ RAGุ ุจู ููุฑุงู ูุชุงุฏุชุง (ูุงููุฏ ุงุณูุงุฏ ุจุงุฒุงุจโุดุฏูุ ููุฑู ุดุจุงูุช ู โฆ) ุฏุฑ ุขู ุฐุฎุฑู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	CHROMA_PATH: ูุณุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ChromaDB ฺฉู ุฏุฑ ุขู ูุทุนุงุช ูุนูุง ุงุณูุงุฏ ุงูุฏุณโฺฏุฐุงุฑ ุดุฏูโุงูุฏ ู ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	EMB_MODEL_PATH: ูุณุฑ ูุฏู ุฌุงููุง ูุงูโุชููโุดุฏู ฺฉู ุจุฑุง ุชุจุฏู ูพุฑุณุดโูุง ู ูุทุนุงุช ูุชู ุจู ุจุฑุฏุงุฑูุง ูุนูุง ูุดุชุฑฺฉ ุจู ฺฉุงุฑ ูโุฑูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	LLM_MODEL_PATH: ูุณุฑ ูุฏู ุฒุจุงู ุจุฒุฑฺฏ ูุญู ฺฉู ุฏุฑ ูุฑุญูู ุชููุฏ ูพุงุณุฎุ ูพุงุณุฎ ููุง ุฑุง ุจุฑ ุงุณุงุณ ูุชู ุจุงุฒุงุจโุดุฏู ู ูพุฑุณุด ูุฑูุฏ ุชููุฏ ูโฺฉูุฏ.

<br>

ุฏุฑ ุงู ูุฑุญููุ ูพุงุฑุงูุชุฑูุง ฺฉูุฏ ูุฑุจูุท ุจู ุฑูุชุงุฑ ุจุงุฒุงุจ ู ุชููุฏ ุฏุฑ ูุนูุงุฑ RAG ุชูุธู ูโุดููุฏ:
```python
TOP_K = 5
MAX_NEW_TOKENS = 300
DEVICE = "cuda" if torch.cuda.is_available() else "cpu"
```
ุชูุถุญ ูุฑ ูพุงุฑุงูุชุฑ ุจู ุตูุฑุช ุฒุฑ ุงุณุช:<br>
&nbsp;&nbsp;&nbsp;โข	TOP_K = 5: ุชุนุฏุงุฏ ูุทุนุงุช ูุนูุง ุจุฑุชุฑ ุฑุง ูุดุฎุต ูโฺฉูุฏ ฺฉู ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ุงุฒ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุงุณุชุฎุฑุงุฌ ูโุดููุฏ. ุงู ูุทุนุงุช ุจูโุนููุงู ยซูุชู ุฒูููยป ุจู ูุฏู ุฒุจุงู ุชุฒุฑู ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	MAX_NEW_TOKENS = 300: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุชูฺฉูโูุง ุฑุง ุชุนู ูโฺฉูุฏ ฺฉู ูุฏู ุฒุจุงู ูุฌุงุฒ ุงุณุช ุฏุฑ ูพุงุณุฎ ุจู ูุฑ ูพุฑุณุด ุชููุฏ ฺฉูุฏ. ุงู ูพุงุฑุงูุชุฑ ุทูู ูพุงุณุฎ ุฑุง ฺฉูุชุฑู ฺฉุฑุฏู ู ุงุฒ ุชููุฏ ูุชูโูุง ุจุด ุงุฒ ุญุฏ ุจููุฏ ุฌููฺฏุฑ ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	DEVICE: ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ:<br>

`DEVICE = "cuda" if torch.cuda.is_available() else "cpu"`

ุชุนู ูโุดูุฏ ฺฉู ูุฏู ุฒุจุงู (ู ุฏุฑ ุตูุฑุช ูุงุฒ ูุฏู ุฌุงููุง) ุฑู GPU ุงุฌุฑุง ุดูุฏ ุง CPU. ุฏุฑ ุตูุฑุช ุฏุฑ ุฏุณุชุฑุณ ุจูุฏู GPUุ ุงุฌุฑุง ูุฏู ุฑู ฺฉุงุฑุช ฺฏุฑุงูฺฉ ููุฌุจ ุชุณุฑุน ฺุดูฺฏุฑ ูุฑุขูุฏ ูพุงุณุฎโฺฏู ูโุดูุฏ.

<br>

ุฏุฑ ูุฑุญูู  ุจุนุฏุ ูุฏู ุฌุงููุง ูุงูโุชููโุดุฏู ู ูุฏู ุฒุจุงู ูุญู ุจูโุตูุฑุช ุตุฑุญ ุจุงุฑฺฏุฐุงุฑ ู ุจุฑุง ุงุณุชูุงุฏู ุฑู ุฏุณุชฺฏุงู ููุงุณุจ ุขูุงุฏู ูโุดููุฏ:
```python
print(f"๐น Loading embedding model: {EMB_MODEL_PATH}")
embed_model = SentenceTransformer(EMB_MODEL_PATH, device=DEVICE)

print(f"๐น Loading LLM model: {LLM_MODEL_PATH}")
tokenizer = AutoTokenizer.from_pretrained(LLM_MODEL_PATH)
llm_model = AutoModelForCausalLM.from_pretrained(
    LLM_MODEL_PATH, torch_dtype=torch.float16 if DEVICE == "cuda" else torch.float32
).to(DEVICE)
```
ุฏุฑ ฺฉุฏ ุจุงูุง: <br>
&nbsp;&nbsp;&nbsp;โข	ุจุงุฑฺฏุฐุงุฑ ูุฏู  ุฌุงููุง ุจุง ูุฑุงุฎูุงู: <br>
`SentenceTransformer(EMB_MODEL_PATH, device=DEVICE)`
<br>
ูุฏู ุฌุงููุง ูุงูโุชููโุดุฏู ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ. ุงู ูุฏู ุจุฑุง ุชุจุฏู ูพุฑุณุด ฺฉุงุฑุจุฑ ุจู ุจุฑุฏุงุฑูุง ุนุฏุฏ ุจูโฺฉุงุฑ ูโุฑูุฏ ุชุง ุจุฑุฏุงุฑ ูพุฑุณุด ุจุง ุจุฑุฏุงุฑูุง ุฐุฎุฑูโุดุฏู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ููุงุณู ุดูุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ุจุงุฑฺฏุฐุงุฑ ุชูฺฉูโุณุงุฒ  ู ูุฏู ุฒุจุงู ุงุจุชุฏุง ุชูฺฉูโุณุงุฒ [^51] ุจุง:<br>
`AutoTokenizer.from_pretrained(LLM_MODEL_PATH)`
<br>

ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ ู ุณูพุณ ูุฏู ูููุฏ ุจุง `AutoModelForCausalLM.from_pretrained` ุฎูุงูุฏู ูโุดูุฏ. ูุฏู ูพุณ ุงุฒ ุจุงุฑฺฏุฐุงุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ `.to(DEVICE)` ุฑู GPU ุง CPU ูุฑุงุฑ ูโฺฏุฑุฏ ุชุง ูุญุงุณุจุงุช ุชููุฏ ูุชู ุจุฑ ุฑู ุฏุณุชฺฏุงู ููุงุณุจ ุงูุฌุงู ุดูุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ุงูุชุฎุงุจ ููุน ุฏุงุฏู ุนุฏุฏ ุจุฑุง ูุฏู ุฒุจุงู ููฺฏุงู ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฒุจุงูุ ููุน ุฏุงุฏู ูุญุงุณุจุงุช `torch_dtype` ุจุฑ ุงุณุงุณ ุฏุฑ ุฏุณุชุฑุณ ุจูุฏู GPU ุชูุธู ูโุดูุฏ: ุงฺฏุฑ `DEVICE == "cuda"` ุจุงุดุฏ ุงุฒ `torch.float16` ุงุณุชูุงุฏู ูโุดูุฏ ุชุง ูุตุฑู ุญุงูุธู ู ุฒูุงู ูุญุงุณุจุงุช ฺฉุงูุด ุงุจุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุงุฒ `torch.float32` ุจูุฑู ฺฏุฑูุชู ูโุดูุฏ. ุงู ุงูุชุฎุงุจ ุจูููโุณุงุฒ ฺฉุงุฑุง ู ูุตุฑู ุญุงูุธู ุฑุง ุฏุฑ ูุญุทโูุง ุฏุงุฑุง ุดุชุงุจโุฏููุฏู ุณุฎุชโุงูุฒุงุฑ ุชุณูู ูโฺฉูุฏ.

<br>

ูฺฉุงุช ูพุงุฏูโุณุงุฒ ู ุจููู ุณุงุฒ:<br>
&nbsp;&nbsp;&nbsp;โข	ุณุงุฒฺฏุงุฑ ุชูฺฉูโุณุงุฒ ู ูุฏู ุถุฑูุฑ ุงุณุช ฺฉู ูุณุฎู ุชูฺฉูโุณุงุฒ ู ูุฏู ุงุฒ ฺฉ ููุจุน ฺฉุณุงู ุจุงุฑฺฏุฐุงุฑ ุดููุฏ ุชุง ูุงุณุงุฒฺฏุงุฑ ุฏุฑ ูฺฏุงุดุช ุชูฺฉูโูุง ุฑุฎ ูุฏูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฏุฑุช ุญุงูุธู GPU ุงุณุชูุงุฏู ุงุฒ `float16` ุฑู GPU ููุฌุจ ฺฉุงูุด ูุตุฑู ุญุงูุธู ูโุดูุฏุ ุงูุง ุฏุฑ ุจุฑุฎ ูุฏูโูุง ููฺฉู ุงุณุช ูุงุฒ ุจู ุชูุธูุงุช ุงุถุงู ูุงููุฏ ูุนุงูโุณุงุฒ mixed precision ุง ูุฏุฑุช ูุทุนูโุง (model sharding) ุจุงุดุฏ.

<br>

ุณูพุณโุ ุฏุฑ ูุณูุช ุจุนุฏ ุจุฑุง ูุฑุญูู ุชููุฏ ูพุงุณุฎ ุฏุฑ ูุนูุงุฑ RAG ุงุฒ ุงุจุฒุงุฑ pipeline ฺฉุชุงุจุฎุงูู Hugging Face ุงุณุชูุงุฏู ูโฺฉูู ุชุง ูุฏุฑุช ูุฏู ุฒุจุงู ู ูุฑุขูุฏ ุชููุฏ ูุชู ุณุงุฏู ู ฺฉูพุงุฑฺู ฺฏุฑุฏุฏ:
```python
generator = pipeline(
    "text-generation",
    model=llm_model,
    tokenizer=tokenizer,
    device=0 if DEVICE == "cuda" else -1,
    max_new_tokens=MAX_NEW_TOKENS,
    temperature=0.5,
)
```
ุชูุถุญ ูพุงุฑุงูุชุฑ ูุง ุฏุฑ ฺฉุฏ ููู:<br>
&nbsp;&nbsp;&nbsp;โข	model ู tokenizer ูุฏู ุฒุจุงู ู ุชูฺฉูโุณุงุฒ ุจุงุฏ ุงุฒ ฺฉ ููุจุน ุณุงุฒฺฏุงุฑ ุจุงุฑฺฏุฐุงุฑ ุดููุฏ ุชุง ูฺฏุงุดุช ุชูฺฉูโูุง ู ุฑูุชุงุฑ ุชููุฏ ูุชู ููุฎูุงู ุฏุงุดุชู ุจุงุดุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	device: ููุฏุงุฑ `0` ุจู ูุนู ุงุฌุฑุง ูุฏู ุฑู ุงููู GPU ุงุณุช ู ููุฏุงุฑ `-1` ุจู ูุนู ุงุฌุฑุง ูุฏู ุฑู CPU. ุงู ูฺฏุงุดุช ุณุงุฏู ุจุฑุง ูุญุทโูุง ุชฺฉโ GPU ููุงุณุจ ุงุณุช. ุฏุฑ ูุญุทโูุง ฺูุฏ GPU ุง ุชูุฒุนโุดุฏู ุจุงุฏ ุงุฒ ุงุจุฒุงุฑูุง ูุงููุฏ `Accelerate` ุง `DataParallel` ุงุณุชูุงุฏู ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	max_new_tokens: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุชูฺฉูโูุง ุงุณุช ฺฉู ูุฏู ูุฌุงุฒ ุจู ุชููุฏ ุฏุฑ ูุฑ ูุฑุงุฎูุงู ุงุณุช. ุงู ูพุงุฑุงูุชุฑ ุทูู ูพุงุณุฎ ุฑุง ูุญุฏูุฏ ูโฺฉูุฏ ู ุงุฒ ุชููุฏ ุฎุฑูุฌโูุง ุจุณุงุฑ ุทููุงู ุฌููฺฏุฑ ูโููุงุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	temperature: ูพุงุฑุงูุชุฑ ุจุฑุง ฺฉูุชุฑู ุชุตุงุฏูโุจูุฏู ุชููุฏ ูุชู ุงุณุช. ููุฏุงุฑ ฐ.ต ุชุนุงุฏู ุจู ูพุงุณุฎโูุง ูุญุงูุธูโฺฉุงุฑุงูู ู ุฎูุงูุงูู ุจุฑูุฑุงุฑ ูโฺฉูุฏ [24]ุ ุจุฑุง ฺฉุงุฑุจุฑุฏูุง RAG ฺฉู ูุงุฒ ุจู ูพุงุณุฎโูุง ูุณุชูุฏ ู ุฏูู ุฏุงุฑูุฏ ูุนูููุงู ููุฏุงุฑ ูุชูุณุท ุง ูพุงูโุชุฑ ููุงุณุจ ุงุณุช.

<br>

ุฏุฑ ูุฑุญูู ุจุนุฏุ ุงุชุตุงู ุจู ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ฺฉู ูุทุนุงุช ูุนูุง ููุงูุงุช ุฏุฑ ุขู ุฐุฎุฑู ุดุฏูโุงูุฏ ุจุฑูุฑุงุฑ ูโุดูุฏ ู ูุฌููุนู ูุฑุจูุท ุจู ุงู ูุทุนุงุช ุจุฑุง ุงูุฌุงู ุนููุงุช ุจุงุฒุงุจ ุจุงุฑฺฏุฐุงุฑ ูโฺฏุฑุฏุฏ:
```python
client = PersistentClient(path=CHROMA_PATH)
collection = client.get_collection("semantic_chunks_articles")
```
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ุฎุท ุงูู ุจุง ุฏุณุชูุฑ `PersistentClient(path=CHROMA_PATH)` ฺฉ ููููู ุงุฒ ฺฉูุงูุช ChromaDB ุงุฌุงุฏ ูโุดูุฏ ฺฉู ุจู ูุณุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุดุฎุตโุดุฏู ุฏุฑ `CHROMA_PATH` ูุชุตู ุงุณุช. ุงู ูุณุฑ ููุงู ูฺฉุงู ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ูพุดโูพุฑุฏุงุฒุด ู ูุทุนูโุจูุฏ ูุนูุงุ ููุงุฏุฑ ุจุฑุฏุงุฑ ูุฑุจูุท ุจู ูุทุนุงุช ููุงูุงุช ุฏุฑ ุขู ุฐุฎุฑู ุดุฏูโุงูุฏ. <br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ุฎุท ุฏูู ุจุง ุฏุณุชูุฑ: <br>
`collection = client.get_collection("semantic_chunks_articles")`
<br>
ูุฌููุนูโุง ุจุง ูุงู "semantic_chunks_articles" ูุฑุงุฎูุงู ูโุดูุฏ. ุงู ูุงู ุฏููุงู ููุงู ูุฌููุนูโุง ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ูุทุนูโุจูุฏ ูุนูุง ุณุงุฏู ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุจุฑุฏุงุฑูุง ูุทุนุงุช ููุงูุงุช ุงุณุชูุงุฏู ุดุฏู ุจูุฏ. ุงู ูุฌููุนู ุดุงูู:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุชู ูุทุนุงุช ูุนูุงุ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ููุงุฏุฑ ุจุฑุฏุงุฑ ูุฑุจูุทูุ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุชุงุฏุชุง (ูุงููุฏ ูุงู ููุงูู ู ุดูุงุณู ูุทุนู)ุ<br>
ุงุณุช ู ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ูุนูุงุฑ RAG ุจุฑุง ุงูุชู ูุฒุฏฺฉโุชุฑู ูุทุนุงุช ุจู ูพุฑุณุด ฺฉุงุฑุจุฑ ุจูโฺฉุงุฑ ฺฏุฑูุชู ูโุดูุฏ.

<br>

ุฏุฑ ุงู ุจุฎุดุ ุชุงุจุน ุงุตู ูุนูุงุฑ RAG ูุนุฑู ูโุดูุฏุ ุชุงุจุน ฺฉู ูุฑุขูุฏ ฺฉุงูู ุชุจุฏู ูพุฑุณุด ุจู ููุฏุงุฑ ุจุฑุฏุงุฑุ ุจุงุฒุงุจ ูุทุนุงุช ูุนูุงุ ุณุงุฎุช ุฒููู ู ุชููุฏ ูพุงุณุฎ ููุง ุฑุง ฺฉูพุงุฑฺู ูุฏุฑุช ูโฺฉูุฏ:
```python
def rag_query(query: str, top_k=5):
    query_emb = embed_model.encode([query], normalize_embeddings=True).tolist()[0]

    results = collection.query(query_embeddings=[query_emb], n_results=top_k)
    retrieved_texts = results["documents"][0]

    context = "\n\n".join(retrieved_texts)

    prompt = f""" Enter your prompt here

### Question:
{query}

### Context:
{context}

### Answer:"""

    output = generator(prompt)[0]["generated_text"]
    answer = output.split("### Answer:")[-1].strip()

    return retrieved_texts, answer
```
ุชูุถุญ ูุฑุญููโุจูโูุฑุญูู ุนููฺฉุฑุฏ ุชุงุจุน:<br>
&nbsp;&nbsp;&nbsp;โข	ูุญุงุณุจู ููุฏุงุฑ ุจุฑุฏุงุฑ ูพุฑุณุด: ุฏุฑ ุฎุท ูุฎุณุชุ ูพุฑุณุด ูุฑูุฏ ุชูุณุท ูุฏู ุฌุงููุง ูุงูโุชููโุดุฏู ุงูฺฉูุฏ ุดุฏู ู ุจุฑุฏุงุฑ ูุนูุง ุขู ุฏุฑ ูุชุบุฑ `query_emb` ุฐุฎุฑู ูโุดูุฏ. ุงู ุจุฑุฏุงุฑ ูุจูุง ููุงุณู ุจุง ุจุฑุฏุงุฑูุง ููุฌูุฏ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ูุนูุง ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ุจุงุฒุงุจ ูุทุนุงุช ูุนูุง ูุฑุชุจุท: ุฏุฑ ฺฏุงู ุจุนุฏุ ุจุง ุงุณุชูุงุฏู ุงุฒ `collection.query` ูุฒุฏฺฉโุชุฑู ูุทุนุงุช ูุนูุง ุจู ูพุฑุณุด (ุจุฑ ุงุณุงุณ ุดุจุงูุช ฺฉุณููุณ) ู ุจู ุชุนุฏุงุฏ `top_k` ุจุงุฒุงุจ ูโุดููุฏ. ุฎุฑูุฌ ุงู ูุฑุญูู ุฏุฑ `results` ูุฑุงุฑ ฺฏุฑูุชู ู ูุชู ูุทุนุงุช ุงุฒ ููุฏ `documents` ุงุณุชุฎุฑุงุฌ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุณุงุฎุช ูุชู ุฒููู (Context): ูุทุนุงุช ุจุงุฒุงุจโุดุฏู ุจุง ุฌุฏุงฺฉููุฏู ุฎุท ุฎุงู ุจู ฺฉุฏฺฏุฑ ูุชุตู ุดุฏู ู ุฏุฑ ูุชุบุฑ context ูุฑุงุฑ ูโฺฏุฑูุฏ. ุงู ูุชู ุฒููู ููุงู ุฏุงูุด ุงุณุช ฺฉู ูุฏู ุฒุจุงู ุจุงุฏ ูพุงุณุฎ ุฎูุฏ ุฑุง ุตุฑูุงู ุจุฑ ุงุณุงุณ ุขู ุชููุฏ ฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุณุงุฎุช ูพุฑุงููพุช ูุฏุงุชโฺฉููุฏู ุฏุฑ ุงุฏุงููุ ฺฉ ูพุฑุงููพุช ุณุงุฎุชุงุฑุงูุชู ุดุงูู ุจุฎุดโูุง ูพุฑุณุดุ ุฒููู ู ูุญู ูพุงุณุฎ ุงุฌุงุฏ ูโุดูุฏ. ุงู ูพุฑุงููพุช ูุฏู ุฑุง ููุฒู ูโฺฉูุฏ ุชููุง ุงุฒ ุงุทูุงุนุงุช ููุฌูุฏ ุฏุฑ ุฒููู ุงุณุชูุงุฏู ฺฉูุฏ. ุทุฑุงุญ ุฏูู ุงู ูพุฑุงููพุช ุฏุฑ ุจุฎุด ุงุฑุฒุงุจ ุจูโุทูุฑ ฺฉุงูู ุจุฑุฑุณ ุฎูุงูุฏ ุดุฏ.
&nbsp;&nbsp;&nbsp;โข	ุชููุฏ ูพุงุณุฎ ู ุงุณุชุฎุฑุงุฌ ุฎุฑูุฌ ููุง ูุฏู ุฒุจุงู ุจุง ุงุณุชูุงุฏู ุงุฒ `generator` ูพุงุณุฎ ุฑุง ุชููุฏ ฺฉุฑุฏู ู ูุชู ฺฉุงูู ุฎุฑูุฌ ุฏุฑ `output` ูุฑุงุฑ ูโฺฏุฑุฏ. ุณูพุณ ุจุฎุด ูุฑุจูุท ุจู ยซ`###` Answerยป ุงุณุชุฎุฑุงุฌ ุดุฏู ู ูพุณ ุงุฒ ูพุงฺฉโุณุงุฒ ุฏุฑ ูุชุบุฑ `answer` ุฐุฎุฑู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุจุงุฒฺฏุฑุฏุงูุฏู ุฎุฑูุฌ ุฏุฑ ูพุงุงูุ ุชุงุจุน ุฏู ููุฏุงุฑ ุจุงุฒูโฺฏุฑุฏุงูุฏ:<br>
ฑ) ูุทุนุงุช ูุนูุง ุจุงุฒุงุจโุดุฏู (ุจุฑุง ุชุญูู ู ุงุฑุฒุงุจ)<br>
ฒ) ูพุงุณุฎ ููุง ูุฏู

<br>


ุณูพุณุ ุชุงุจุน ุจุฑุง ุฎูุงูุฏู ูุงู ูุฑูุฏ ูพุฑุณุดโูุง ุชุนุฑู ูโุดูุฏ. ุงู ูุงู ูุนูููุงู ุฏุฑ ูุงูุจ JSONL ุฐุฎุฑู ุดุฏู ู ุดุงูู ูุฌููุนูโุง ุงุฒ ูพุฑุณุดโูุง ููุฑุงู ุจุง ุดูุงุณู ู ุงุทูุงุนุงุช ุชฺฉูู ุงุณุช. ฺฉุฏ ูุฑุจูุทู ุจู ุตูุฑุช ุฒุฑ ุงุณุช:
 ```python
def read_queries(path: str):
    queries = []
    with open(path, "r", encoding="utf-8") as f:
        for line in f:
            if line.strip():
                queries.append(json.loads(line))
    return queries

input_queries = read_queries(INPUT_QUERIES_FILE)
```
ุชูุถุญ ุนููฺฉุฑุฏ ุชุงุจุน:<br>
&nbsp;&nbsp;&nbsp;โข	ุฎูุงูุฏู ูุงู ูุฑูุฏ ุชุงุจุน `read_queries` ูุณุฑ ูุงู ูุฑูุฏ ุฑุง ุฏุฑุงูุช ฺฉุฑุฏู ู ุขู ุฑุง ุฎุทโุจูโุฎุท ูโุฎูุงูุฏ. ูุฑ ุฎุท ุงุฒ ูุงู JSONL ฺฉ ุดุก JSON ูุณุชูู ุงุณุช ฺฉู ุดุงูู ุงุทูุงุนุงุช ูุฑุจูุท ุจู ฺฉ ูพุฑุณุด ูโุจุงุดุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูพุฑุฏุงุฒุด ุฎุทูุท ูุนุชุจุฑ ุชููุง ุฎุทูุท ฺฉู ุฎุงู ูุจุงุดูุฏ ูพุฑุฏุงุฒุด ุดุฏู ู ุจุง ุงุณุชูุงุฏู ุงุฒ `json.loads` ุจู ุณุงุฎุชุงุฑ ุฏุงุฏู ูพุงุชูู ุชุจุฏู ูโุดููุฏ. ุงู ุณุงุฎุชุงุฑ ูุนูููุงู ุดุงูู ููุงุฑุฏ ูุงููุฏ:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุชู ูพุฑุณุด ฺฉุงุฑุจุฑ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุดูุงุณู ฺฉุชุง<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ููุจุน ุง ุจุฑฺุณุจ ุงุฑุฒุงุจ (ุฏุฑ ุตูุฑุช ูุฌูุฏ)<br>

&nbsp;&nbsp;&nbsp;โข	ุจุงุฒฺฏุฑุฏุงูุฏู ููุฑุณุช ูพุฑุณุดโูุง ุชูุงู ูพุฑุณุดโูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุฏุฑ ูุงูุจ ฺฉ ูุณุช ุฏุฑ ุฎุฑูุฌ ุชุงุจุน ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดููุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ุจุงุฑฺฏุฐุงุฑ ูพุฑุณุดโูุง ุฏุฑ ูุนูุงุฑ RAG ุฏุฑ ุฎุท ูพุงุงูุ ุจุง ูุฑุงุฎูุงู `read_queries(INPUT_QUERIES_FILE)` ูุญุชูุง ูุงู ูุฑูุฏ ุฎูุงูุฏู ุดุฏู ู ุฏุฑ ูุชุบุฑ `input_queries` ุฐุฎุฑู ูโุดูุฏ. ุงู ูุชุบุฑ ุฏุฑ ุงุฏุงูู ูุฑุขูุฏ RAG ุจุฑุง ูพุฑุฏุงุฒุด ู ูพุงุณุฎโฺฏู ุจู ูพุฑุณุดโูุง ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ.

<br>

ุฏุฑ ุจุฎุด ูพุงุงู ฺฉุฏุ ูุฑุขูุฏ ุงุตู RAG ุฑู ูุฌููุนู ูพุฑุณุดโูุง ูุฑูุฏ ุงุฌุฑุง ุดุฏู ู ุฎุฑูุฌ ููุง ุฏุฑ ูุงูุจ ฺฉ ูุงู JSONL ุฐุฎุฑู ูโุดูุฏ. ุณุงุฎุชุงุฑ ฺฉุฏ ุจู ุตูุฑุช ุฒุฑ ุงุณุช:
```python
with open(OUTPUT_FILE, "w", encoding="utf-8") as outfile:
    for item in tqdm(input_queries, desc="Running RAG Simple"):
        q_id = item["id"]
        q_text = item["query"]
        contexts, answer = rag_query(q_text, top_k=TOP_K)
        output_obj = {
            "id": q_id,
            "query": q_text,
            "contexts": contexts,
            "answer": answer
        }
        outfile.write(json.dumps(output_obj, ensure_ascii=False) + "\n")

print(f"โ Finished! Results saved to {OUTPUT_FILE}")
```
ุชูุถุญ ูุฑุญููโุจูโูุฑุญูู ุงุฌุฑุง ููุง:<br>
&nbsp;&nbsp;&nbsp;โข	ุฎูุงูุฏู ู ุชูฺฉฺฉ ุงุทูุงุนุงุช ูุฑ ูพุฑุณุด ุฏุฑ ูุฑ ุชฺฉุฑุงุฑ ุญูููุ ฺฉ ุฑฺฉูุฑุฏ ุงุฒ ูุงู ูุฑูุฏ ุดุงูู ุดูุงุณูู ูพุฑุณุด (id) ู ูุชู ูพุฑุณุด (query) ุงุณุชุฎุฑุงุฌ ุดุฏู ู ุฏุฑ ูุชุบุฑูุง ูุฑุจูุทู ูุฑุงุฑ ูโฺฏุฑุฏ.<br>

&nbsp;&nbsp;&nbsp;โข	ูุฑุงุฎูุงู ุชุงุจุน RAG ุจุง ูุฑุงุฎูุงู `rag_query`ุ ุฏู ุฎุฑูุฌ ุชููุฏ ูโุดูุฏ:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	contexts: ูุทุนุงุช ูุนูุง ุจุงุฒุงุจโุดุฏู ุงุฒ ูพุงฺฏุงู ุฏุงุฏูุ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	answer: ูพุงุณุฎ ููุง ุชููุฏุดุฏู ุชูุณุท ูุฏู ุฒุจุงู ุงู ุฏู ููุฏุงุฑ ููุฑุงู ุจุง ุดูุงุณู ู ูุชู ูพุฑุณุด ุฏุฑ ฺฉ ุดุก ุฎุฑูุฌ ุชุฌูุน ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููุดุชู ุฎุฑูุฌ ุฏุฑ ูุงู JSONL ุดุก ุฎุฑูุฌ ุจุง ุงุณุชูุงุฏู ุงุฒ `json.dumps`  ุจู ุฑุดุชู JSON ุชุจุฏู ุดุฏู ู ุฏุฑ ูุงู ููุตุฏ `OUTPUT_FILE` ุฐุฎุฑู ูโุดูุฏ. ุงุณุชูุงุฏู ุงุฒ `ensure_ascii=False` ุจุงุนุซ ูโุดูุฏ ูุชู ูุงุฑุณ ุจุฏูู ุชุจุฏู ุจู ููฺฉุฏูุง `escape` ุฐุฎุฑู ฺฏุฑุฏุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููุงุด ููุงุฑ ูพุดุฑูุช ุญููู ุฏุฑูู tqdm ูุฑุงุฑ ฺฏุฑูุชู ุชุง ุฑููุฏ ูพุฑุฏุงุฒุด ูพุฑุณุดโูุง ุฏุฑ ุชุฑููุงู ุจูโุตูุฑุช ููุงุฑ ูพุดุฑูุช ููุงุด ุฏุงุฏู ุดูุฏ. ุงู ูฺฺฏ ุจูโูฺู ููฺฏุงู ูพุฑุฏุงุฒุด ุชุนุฏุงุฏ ุฒุงุฏ ูพุฑุณุดุ ุงูฺฉุงู ูพุงุด ูุถุนุช ุงุฌุฑุง ุฑุง ูุฑุงูู ูโฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูพุงู ูพุงุงู ุงุฌุฑุง ูพุณ ุงุฒ ุชฺฉูู ูพุฑุฏุงุฒุดุ ูพุงู ููุง ฺุงูพ ูโุดูุฏ ุชุง ูุญู ุฐุฎุฑูโุณุงุฒ ุฎุฑูุฌ ุจู ฺฉุงุฑุจุฑ ุงุทูุงุน ุฏุงุฏู ุดูุฏ.

<br>

---

### ูุนูุงุฑ RAG ุฑูฺฉุฑุฏ Abstract-First
ููุงูโุทูุฑ ฺฉู ุฏุฑ ุจุฎุดโูุง ูพุดู ุงุดุงุฑู ุดุฏุ ุฏุฑ ฺูุงุฑูู ูุฑุญูู ุงุฒ ูุนูุงุฑ ููโุงูุฒุง RAG ู ูุทุงุจู ุจุง ุงุฏู ุงุตู ูุทุฑุญโุดุฏู ุชูุณุท ููุณูุฏฺฏุงู ููุงููุ ุจูโุฌุง ุงุณุชูุงุฏู ุงุฒ ุฑูฺฉุฑุฏ RAG ุณุงุฏูุ ุงุฒ ุฑูฺฉุฑุฏ ุงููโฺฺฉุฏู ุจูุฑู ูโุจุฑู.<br>

ููุณูุฏฺฏุงู ููุงูู ุงู ูุฑุถ ุฑุง ูุทุฑุญ ูโฺฉููุฏ ฺฉู ุจุฎุด ฺฺฉุฏู ุฏุฑ ูุชูู ุนูู ูุนูููุงู ุญุงู ุงุทูุงุนุงุช ูุนูุง ูุชุฑุงฺฉูโุชุฑ ุงุฒ ููุขูุฑโูุงุ ุฑูุดโุดูุงุณโูุง ู ุงูุชูโูุง ฺฉูุฏ ุงุณุชุ ุจูุงุจุฑุงูุ ุงู ุจุฎุด ูโุชูุงูุฏ ุจุฑุง ูุฑุขูุฏ ุจุงุฒุงุจ ุงุฑุฒุด ุงุทูุงุนุงุช ุจุงูุงุชุฑ ูุณุจุช ุจู ุจุณุงุฑ ุงุฒ ูุทุนุงุช ูุนูุง ุจุฏูู ููุงูู ุฏุงุดุชู ุจุงุดุฏ. <br>

ุจู ุจุงู ุฏฺฏุฑุ ฺฺฉุฏูโูุง ูุณุจุช ุณฺฏูุงู ุจู ููุฒ ุจุงูุงุชุฑ ุงุฑุงุฆู ูโุฏููุฏ ู ุงุฒ ุงูุฒููฺฏ [^52] ฺฉูุชุฑ ุจุฑุฎูุฑุฏุงุฑูุฏุ ููุถูุน ฺฉู ุจุง ุงุตูู ูุธุฑู ุงุทูุงุนุงุช ุดุงููู (ฑนดธ) [25] ูุฒ ููโุฎูุงู ุฏุงุฑุฏ.<br>

ุจูโุนูุงููุ ฺฉ ูุชู ุฒูุงู ุงุฒ ูุธุฑ ูุนูุง ููุณุฌู [^53] ุชูู ูโุดูุฏ ฺฉู ุงุฌุฒุง ุขู ุจุง ฺฉุฏฺฏุฑ ุงุฑุชุจุงุท ูุนูุง ุฏุงุดุชู ู ุฏุฑ ูุฌููุน ฺฉ ูุงุญุฏ ฺฉุงูู ุฑุง ุดฺฉู ุฏููุฏ. ุฏุฑ ูุทุนูโุจูุฏ ูุนูุง ุณุงุฏูุ ุงู ุงุญุชูุงู ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุจุฎุดโูุง ูุงูุตุ ฺฏุณุณุชู ุง ุงุฒ ูุธุฑ ุณฺฏูุงู ู ุชุฑุงฺฉู ูุนูุง ุถุนู ุชููุฏ ู ุณูพุณ ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ุงูุชุฎุงุจ ุดููุฏ. ุฏุฑ ููุงุจูุ ฺฺฉุฏู ุจูโุนููุงู ฺฉ ูุงุญุฏ ูุนูุง ฺฉุงููุ ูุนูููุงู ุงุฒ ุงูุณุฌุงู ุฏุฑูู ุจุดุชุฑ ุจุฑุฎูุฑุฏุงุฑ ุงุณุช ู ุงู ูุดฺฉูุงุช ุฑุง ุจูโูุฑุงุชุจ ฺฉูุชุฑ ูุดุงู ูโุฏูุฏ. ุงู ููุถูุน ุจุง ุงุตูู ูุทุฑุญโุดุฏู ุฏุฑ ุชุฆูุฑ ุงูุณุฌุงู ูุนูุง ุชูุณุท ุณุงูุชูู ู ูฺฉโฺฏู (ฑนธณ) [26] ูุฒ ููโุฎูุงู ุฏุงุฑุฏ.<br>

ููุฑุฏ ููู ุฏฺฏุฑุ ููโุชุฑุงุฒ [^54] ูุงู ูุงุฒ ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ู ูุญุชูุง ุจุงุฒุงุจโุดุฏู ุงุณุช. ุงุฒ ุขูุฌุง ฺฉู ูุฏู ุงู ูพฺููุด ุจุงุฒุงุจ ุงุทูุงุนุงุช ุงุฒ ูุชูู ุนูู ุงุณุชุ ุจุฎุด ุนูุฏูโุง ุงุฒ ูพุฑุณุดโูุง ุญูู ูุญูุฑ ููุงูู [^55] ุณุทุญโุจุงูุงุ ุงูุชูโูุง ฺฉูุฏ ู ููุขูุฑโูุง ูพฺููุด ุดฺฉู ูโฺฏุฑูุฏ. ุงู ููุน ูุงุฒ ุงุทูุงุนุงุช ูุนูููุงู ุฏุฑ ุจุฎุด ฺฺฉุฏู ููุงูุงุช ูพูุดุด ุฏุงุฏู ูโุดูุฏุ ุจูุงุจุฑุงูุ ฺฺฉุฏูโูุง ุงุฒ ุงู ููุธุฑ ูุฒ ฺฏุฒููโุง ููุงุณุจ ุจุฑุง ูุฑุญูู ุงููู ุจุงุฒุงุจ ูุญุณูุจ ูโุดููุฏ.<br>

ุฏุฑ ฺฉูุงุฑ ุงู ููุถูุนุ ุงุณุชูุงุฏู ุงุฒ ุฑูฺฉุฑุฏ ุณูุณููโูุฑุงุชุจ (ูุฑู) ุฏุฑ ุฌุณุชุฌู ู ูพูุงุด ูุถุง ุจุฑุฏุงุฑุ ุจู ฺฉูุชุฑู ูุณุฆูู ยซููุฑู ุงุจุนุงุฏยป ฺฉูฺฉ ูโฺฉูุฏ. ุงุนูุงู ฺฉ ููุชุฑ ุงููู ูุจุชู ุจุฑ ฺฺฉุฏูโูุงุ ุนูุงูู ุจุฑ ุญูุธ ุงุฑุชุจุงุท ูุนูุงุ ููุฌุจ ฺฉุงูุด ูพฺุฏฺฏ ูุญุงุณุจุงุช ุฏุฑ ูุฑุงุญู ุจุนุฏ ุฌุณุชุฌู ู ุจุงุฒุงุจ ูโุดูุฏ. ุงู ุฑูฺฉุฑุฏ ุจุง ุงุตูู ูุทุฑุญโุดุฏู ุฏุฑ ููุฏูู ุจุงุฒุงุจ ุงุทูุงุนุงุช ูุงููฺฏ (ฒฐฐธ) [27] ูุฒ ููโุฎูุงู ุฏุงุฑุฏ.

<br>

ุจุง ุชูุฌู ุจู ูุจุงุญุซ ูุทุฑุญโุดุฏู ู ฺฉุฏ RAG ุณุงุฏู ุฏุฑ ุจุฎุด ูพุดูุ ุฏุฑ ุงู ูุณูุช ูุณุฎู Abstract First ูุนูุงุฑ RAG ูพุงุฏูโุณุงุฒ ูโุดูุฏ. ุชูุงูุช ุงุตู ุงู ุฑูฺฉุฑุฏ ุจุง ูุณุฎูู ุณุงุฏู ุฏุฑ ุงู ุงุณุช ฺฉู ูุฑุขูุฏ ุจุงุฒุงุจ ุฏุฑ ุฏู ูุฑุญูู ุงูุฌุงู ูโฺฏุฑุฏ:<br>

ฑ) ูุฑุญูู ุงูู โ ุจุงุฒุงุจ ฺฺฉุฏูโูุง: ูพุฑุณุด ฺฉุงุฑุจุฑ ุงุจุชุฏุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุญุงู ฺฺฉุฏู ููุงูุงุช ุฌุณุชุฌู ูโุดูุฏ ู ุชุนุฏุงุฏ N ฺฺฉุฏู ุจุฑุชุฑ (ุจุฑุง ูุซุงู `N=100` ูุทุงุจู ุขุฒูุงุดโูุง ููุงูู ุงุตู) ุจุงุฒุงุจ ูโฺฏุฑุฏุฏ.<br>

ฒ) ูุฑุญูู ุฏูู โ ุจุงุฒุงุจ ูุทุนุงุช ูุนูุง: ุณูพุณ ุชููุง ุงุฒ ูุงู ููู N ููุงูู ููุชุฎุจุ ูุทุนุงุช ูุนูุง ูุฑุชุจุท ุงุณุชุฎุฑุงุฌ ูโุดููุฏ ุชุง ูุฑุญูู ุจุงุฒุงุจ ุฏููโุชุฑ ู ูุฏูููุฏุชุฑ ุงูุฌุงู ุดูุฏ.<br>

ฺฉุฏ ุงู ุจุฎุด ุงุฒ ุจุฑูุงูู ุจู ุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ:

ุฏุฑ ุงุจุชุฏุง ุจุฑูุงููุ ููุงููุฏ ูุณุฎู ุณุงุฏู RAGุ ฺฉุชุงุจุฎุงููโูุง ููุฑุฏูุงุฒ ูุฑุงุฎูุงู ูโุดููุฏ ู ูุณุฑ ูุงูโูุง ูุฑูุฏ ู ุฎุฑูุฌ ูุดุฎุต ูโฺฏุฑุฏุฏ:
```python
import os, json, torch
from pathlib import Path
from tqdm import tqdm
from sentence_transformers import SentenceTransformer
from chromadb import PersistentClient
from transformers import AutoTokenizer, AutoModelForCausalLM, pipeline
import nltk
nltk.download("punkt", quiet=True)

QUERIES_FILE = r" Enter .jsonl queries input location "  
OUTPUT_FILE  = r" Enter .jsonl output destination "
CHROMA_ABS_PATH  = r" Enter abstracts SC vector Database location "               
CHROMA_BODY_PATH = r" Enter bodies SC vector Database location "
EMBED_MODEL_PATH = r" Enter fine-tuned embedding model location "            
LLM_MODEL_PATH   = r" Enter Local LLM Model location "

TOP_A = 100    
TOP_B = 5     
MAX_NEW = 300
DEVICE   = "cuda" if torch.cuda.is_available() else "cpu"
```
ุฏุฑ ุงู ุจุฎุดุ ูุดุงุจู ุจุฑูุงูู RAG ุณุงุฏูุ ูพุดโูุงุฒูุง ฺฉุฏ ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ. ุชูุงูุช ุงุตู ุงู ุฑูฺฉุฑุฏ ุฏุฑ ุขู ุงุณุช ฺฉู ุฏู ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุชุนุฑู ุดุฏู ุงุณุช:<br>
 ฺฉ ุจุฑุง ุจุงุฒุงุจ ฺฺฉุฏูโูุง ู ุฏฺฏุฑ ุจุฑุง ุจุงุฒุงุจ ูุชู ุงุตู ููุงูุงุช.<br>

&nbsp;&nbsp;&nbsp;โข	ูพุงุฑุงูุชุฑ `TOP_A` ุชุนุฏุงุฏ N ฺฺฉุฏู ุจุฑุชุฑ ุฑุง ูุดุฎุต ูโฺฉูุฏ ฺฉู ุฏุฑ ูุฑุญูู ูุฎุณุช ุจุงุฒุงุจ ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูพุงุฑุงูุชุฑ `TOP_B` ููุงู ููุด `TOP_K` ุฏุฑ ูุนูุงุฑ RAG ุณุงุฏู ุฑุง ุฏุงุฑุฏุ ุจุง ุงู ุชูุงูุช ฺฉู ุงู ุจุงุฑ ุงุฒ ูุงู N ููุงูู ููุชุฎุจุ ุชุนุฏุงุฏ `TOP_B` ูุทุนู ูุนูุง ุจุฑุชุฑ ุจู ูุฏู ุฒุจุงู ุงุฑุณุงู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูพุงุฑุงูุชุฑ `MAX_NEW` ูุฒ ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุชูฺฉูโูุง ุฑุง ุชุนู ูโฺฉูุฏ ฺฉู ูุฏู ุฒุจุงู ุฏุฑ ูุฑุญูู ุชููุฏ ูพุงุณุฎ ูุฌุงุฒ ุจู ุชููุฏ ุขู ุงุณุช.<br>

ุฏุฑ ุจุฎุด ุฏููุ ููุงููุฏ ูุณุฎู ุณุงุฏู RAGุ ูุฏูโูุง ุฌุงููุง ู ูุฏู ุฒุจุงู ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ. ุจุฑุง ุชููุฏ ูพุงุณุฎุ ฺฉ ุดุก `pipeline` ุงุฒ ููุน text generation ุณุงุฎุชู ูโุดูุฏ:
```python
print(f"๐น Loading embedding model: {EMBED_MODEL_PATH}")
embed_model = SentenceTransformer(EMBED_MODEL_PATH, device=DEVICE)

print(f"๐น Loading LLM model: {LLM_MODEL_PATH}")
tokenizer = AutoTokenizer.from_pretrained(LLM_MODEL_PATH)
llm_model = AutoModelForCausalLM.from_pretrained(
    LLM_MODEL_PATH,
    torch_dtype=torch.float16 if DEVICE=="cuda" else torch.float32
).to(DEVICE)

generator = pipeline(
    "text-generation",
    model=llm_model,
    tokenizer=tokenizer,
    device=0 if DEVICE=="cuda" else -1,
    max_new_tokens=MAX_NEW,
    temperature=0.5,
    return_full_text=False
)
```
ูพุงุฑุงูุชุฑ `return_full_text` ุจุง ููุฏุงุฑ `False` ุชุนู ูโฺฉูุฏ ุชุง ูุฏู ุชููุง ูพุงุณุฎ ูุฑุชุจุท ุฑุง ุชููุฏ ฺฉูุฏ ู ุงุฒ ุชููุฏ ูุชู ุงุถุงูู ุฌููฺฏุฑ ุดูุฏ.

 <br>

ุฏุฑ ุจุฎุด ุจุนุฏุ ู ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ฺฉู ุจูโุตูุฑุช ุฌุฏุงฺฏุงูู ุจุฑุง ฺฺฉุฏูโูุง ู ูุชู ุงุตู ููุงูุงุช ุงุฌุงุฏ ุดุฏูโุงูุฏุ ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ:
```python
client_abs  = PersistentClient(path=CHROMA_ABS_PATH)
client_body = PersistentClient(path=CHROMA_BODY_PATH)

abs_collection  = client_abs.get_collection("abstracts")
body_collection = client_body.get_collection("semantic_body_chunks")
```
ุฏุฑ ุงู ุจุฎุด:<br>
&nbsp;&nbsp;&nbsp;โข	client_abs: ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฑุจูุท ุจู ฺฺฉุฏู ููุงูุงุช ุฑุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	client_body: ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฑุจูุท ุจู ูุทุนุงุช ุจุฏูู ููุงูุงุช ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ูุฌููุนู abstracts: ุจุฑุง ูุฑุญูู ุงูุชุฎุงุจ N ฺฺฉุฏู ุจุฑุชุฑ ุงุณุชูุงุฏู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ูุฌููุนู semantic_body_chunks: ุชููุง ุจุฑุง ููุงู N ููุงูู ููุชุฎุจ ุจูโฺฉุงุฑ ูโุฑูุฏ ุชุง ูุทุนุงุช ูุนูุง ุฏููโุชุฑ ุงุณุชุฎุฑุงุฌ ุดููุฏ. 

<br>

ุณูพุณุ ุชุงุจุน `retrieve_from_abstracts` ุชุนุฑู ูโุดูุฏ ฺฉู ูุธูู ุขู ุจุงุฒุงุจ ฺฺฉุฏูโูุง ูุฑุชุจุท ุงุฒ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุงุณุช:
```python
def retrieve_from_abstracts(query: str, top_k=TOP_A):
    q_emb = embed_model.encode([query], normalize_embeddings=True).tolist()[0]
    res = abs_collection.query(query_embeddings=[q_emb], n_results=top_k)

    abstract_texts = res["documents"][0]
    abstract_ids   = res["ids"][0]           
    doc_ids = [doc_id for doc_id in abstract_ids]
    return doc_ids, abstract_texts
```
ุฏุฑ ุงู ุชุงุจุน:<br>
ู	ูพุฑุณุด ฺฉุงุฑุจุฑ ุจู ฺฉ ุจุฑุฏุงุฑ ูุฑูุงูโุณุงุฒโุดุฏู ุชุจุฏู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุงู ุจุฑุฏุงุฑ ุจุง ุจุฑุฏุงุฑูุง ููุฌูุฏ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ฺฺฉุฏูโูุง ููุงุณู ุดุฏู ู `TOP_A` ฺฺฉุฏู ุจุฑุชุฑ ุจุงุฒุงุจ ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุฑูุฌ ุดุงูู ุดูุงุณู ููุงูุงุช ููุชุฎุจ ู ูุชู ฺฺฉุฏูโูุง ูุฑุจูุทู ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ุจุนุฏ ุจุฑุง ุจุงุฒุงุจ ูุทุนุงุช ุจุฏูู ููุงูุงุช ุงุณุชูุงุฏู ูโุดููุฏ.

<br>

ุฏุฑ ูุฑุญูู  ุจุนุฏุ ุฏุฑ ุงู ูุฑุญููุ ุชุงุจุน `retrieve_from_bodies` ุชุนุฑู ูโุดูุฏ ฺฉู ูุธูู ุขู ุจุงุฒุงุจ ูุทุนุงุช ูุนูุง ุงุฒ ุจุฏูู ููุงูุงุช ููุชุฎุจ ุงุณุช:

```python
def retrieve_from_bodies(query: str, allowed_doc_ids, top_k=TOP_B):

    where_clause = {"source": {"$in": [f"{d}.xml" for d in allowed_doc_ids]}}
    q_emb = embed_model.encode([query], normalize_embeddings=True).tolist()[0]

    res = body_collection.query(
        query_embeddings=[q_emb],
        n_results=top_k,
        where=where_clause
    )

    return res["documents"][0]
```
ุฏุฑ ุงู ุชุงุจุน:<br>
&nbsp;&nbsp;&nbsp;โข	ุดูุงุณู ููุงูุงุช ููุชุฎุจ ุงุฒ ูุฑุญูู ฺฺฉุฏูโูุง ุฏุฑุงูุช ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุชููุง ูุทุนุงุช ูุฑุจูุท ุจู ููู ููุงูุงุช (ุจุง ุงุณุชูุงุฏู ุงุฒ ุดุฑุท `where_clause`) ุฌุณุชุฌู ูโุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑุฏุงุฑ ูพุฑุณุด ฺฉุงุฑุจุฑ ุจุง ุจุฑุฏุงุฑ ูุทุนุงุช ุจุฏูู ููุงูุงุช ููุงุณู ุดุฏู ู `TOP_B` ูุทุนู ูุนูุง ุจุฑุชุฑ ุจุงุฒุงุจ ูโฺฏุฑุฏุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุฑูุฌ ุดุงูู ูุทุนุงุช ูุฑุชุจุท ุงุณุช ฺฉู ุฏุฑ ูุฑุญูู ุชููุฏ ูพุงุณุฎ ุจู ูุฏู ุฒุจุงู ุฏุงุฏู ูโุดููุฏ.

<br>

ุฏุฑ ูุณูุช ุจุนุฏุ ุชุงุจุน `rag_abstract_first` ุชุนุฑู ูโุดูุฏ ฺฉู ูุฑุงุญู ูุฎุชูู ุจุงุฒุงุจ ู ุชููุฏ ูพุงุณุฎ ุฑุง ฺฉูพุงุฑฺู ฺฉุฑุฏู ู ูพุฑุณุด ฺฉุงุฑุจุฑ ุฑุง ููุฑุงู ุจุง ุฒููู ูุนูุง ุงุณุชุฎุฑุงุฌโุดุฏู ุจู ูุฏู ุฒุจุงู ุงุฑุณุงู ูโฺฉูุฏ:
```python
def rag_abstract_first(query: str):

    top_docs, abs_contexts = retrieve_from_abstracts(query)
    body_chunks = retrieve_from_bodies(query, allowed_doc_ids=top_docs)
    final_context = "\n\n".join(body_chunks)
    prompt = f""" Enter Your prompt here.

### Question:
{query}

### Context:
{final_context}

### Answer:
"""
    out = generator(prompt)[0]["generated_text"]
    answer = out.split("### Answer:")[-1].strip()
    return abs_contexts, body_chunks, answer
```
ุฏุฑ ุงู ุชุงุจุน:<br>
&nbsp;&nbsp;&nbsp;โข	ุงุจุชุฏุง ฺฺฉุฏูโูุง ูุฑุชุจุท ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ ุจุงุฒุงุจ ุดุฏู ู ุดูุงุณู ููุงูุงุช ููุชุฎุจ ุงุณุชุฎุฑุงุฌ ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุณูพุณ ูุทุนุงุช ูุนูุง ุจุฏูู ููุงู ููุงูุงุช ูุฑุงุฎูุงู ูโฺฏุฑุฏุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุงู ูุทุนุงุช ุฏุฑ ูุงูุจ ฺฉ ุฒููู ูุงุญุฏ (`final_context`) ุชุฑฺฉุจ ูโุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ูพุฑุณุด ฺฉุงุฑุจุฑ ู ุฒููู ูุนูุง ุฏุฑ ูุงูุจ ฺฉ ูพุฑุงููพุช ุณุงุฎุชุงุฑุงูุชู ุจู ูุฏู ุฒุจุงู ุฏุงุฏู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุฑูุฌ ูุฏู ูพุฑุฏุงุฒุด ุดุฏู ู ุจุฎุด ูุฑุจูุท ุจู ูพุงุณุฎ ููุง ุงุณุชุฎุฑุงุฌ ูโฺฏุฑุฏุฏุ<br>

ู	ุฏุฑ ููุงุชุ ฺฺฉุฏูโูุงุ ูุทุนุงุช ุจุฏูู ุจุงุฒุงุจโุดุฏู ู ูพุงุณุฎ ูุฏู ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดููุฏ.

<br>

ุฏุฑ ูุณูุช ุจุนุฏุ ุชุงุจุน `read_queries` ุชุนุฑู ูโุดูุฏ ฺฉู ูุงู ูุฑูุฏ ุดุงูู ูพุฑุณุดโูุง ฺฉุงุฑุจุฑ ุฑุง ุฎูุงูุฏู ู ูุฑ ุฎุท ูุนุชุจุฑ ุฑุง ุจูโุตูุฑุช ฺฉ ุดุก JSON ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ.
```python
def read_queries(path):
    qs = []
    with open(path, "r", encoding="utf-8") as f:
        for line in f:
            if line.strip():
                qs.append(json.loads(line))
    return qs

queries = read_queries(QUERIES_FILE)
```
ุฏุฑ ุงู ุชุงุจุน:<br>
&nbsp;&nbsp;&nbsp;โข	ูุงู ูุฑูุฏ ุฎุทโุจูโุฎุท ุฎูุงูุฏู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุทูุท ุฎุงู ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏุ
ู	ูุฑ ุฎุท ูุนุชุจุฑ ุจูโุตูุฑุช JSON ุจุงุฑฺฏุฐุงุฑ ุดุฏู ู ุจู ููุฑุณุช ูพุฑุณุดโูุง ุงูุฒูุฏู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุฎุฑูุฌ ุดุงูู ูุฌููุนู ูพุฑุณุดโูุง ุงุณุช ฺฉู ุฏุฑ ุญููู ุงุตู ุงุฌุฑุง RAG ูพุฑุฏุงุฒุด ุฎูุงููุฏ ุดุฏ.

<br>

ุฏุฑ ุจุฎุด ูพุงุงู ฺฉุฏุ ุญููู ุงุฌุฑุง ุจุฑูุงูู ุฑุงูโุงูุฏุงุฒ ูโุดูุฏ ุชุง ูุฑ ูพุฑุณุด ูุฑูุฏ ูพุฑุฏุงุฒุด ุดุฏู ู ูุชุฌู ููุง ุฏุฑ ูุงู ุฎุฑูุฌ ุฐุฎุฑู ฺฏุฑุฏุฏ:
```python
with open(OUTPUT_FILE, "w", encoding="utf-8") as out:
    for item in tqdm(queries, desc="Running Abstract-First RAG"):
        q_id = item["id"]
        q_text = item["query"]
        abs_ctx, body_ctx, answer = rag_abstract_first(q_text)
        result = {
            "id": q_id,
            "query": q_text,
            "abstracts": abs_ctx,
            "contexts": body_ctx,
            "answer": answer
        }

        out.write(json.dumps(result, ensure_ascii=False) + "\n")
        torch.cuda.empty_cache()

print(f"โ Done: Results saved to {OUTPUT_FILE}")
```
 ุฏุฑ ุงู ุจุฎุด:<br>
&nbsp;&nbsp;&nbsp;โข	ุดูุงุณู ู ูุชู ูพุฑุณุด ุงุฒ ูุฑูุฏ ุงุณุชุฎุฑุงุฌ ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุชุงุจุน `rag_abstract_first` ูุฑุงุฎูุงู ุดุฏู ู ฺฺฉุฏูโูุงุ ูุทุนุงุช ุจุฏูู ู ูพุงุณุฎ ูุฏู ุชููุฏ ูโฺฏุฑุฏุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ูุชุฌู ููุง ุฏุฑ ูุงูุจ ฺฉ ุดุก JSON ุณุงุฎุชู ุดุฏู ู ุฏุฑ ูุงู ุฎุฑูุฌ ููุดุชู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑุง ููุงุด ูพุดุฑูุช ูพุฑุฏุงุฒุดุ ุญููู ุฏุฑ ฺฉ ููุงุฑ tqdm ุงุฌุฑุง ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ูพุงุงู ูุฑ ุชฺฉุฑุงุฑุ ุญุงูุธู GPU ูพุงฺฉโุณุงุฒ ูโุดูุฏ ุชุง ุงุฒ ุงูุจุงุดุช ุบุฑุถุฑูุฑ ุฌููฺฏุฑ ุดูุฏ.

<br>

---

## ุงุฑุฒุงุจ
### ฺฉุชุงุจุฎุงูู RAGAS
ุฏุฑ ูุฑุญูู ูพุงุงู ูุนูุงุฑุ ููุณูุฏฺฏุงู ุจุฑุง ุณูุฌุด ฺฉูุช ุฎุฑูุฌ ูุฏู RAG ุงุฒ ฺูุงุฑฺูุจ [^56] ุงุฑุฒุงุจ RAGAS [^57] [28] ุงุณุชูุงุฏู ฺฉุฑุฏูโุงูุฏุ ุงุจุฒุงุฑ ฺฉู ุจูโุทูุฑ ูฺู ุจุฑุง ุงุฑุฒุงุจ ุณุงูุงููโูุง ุจุงุฒุงุจ-ุชููุฏ ุทุฑุงุญ ุดุฏู ู ุงูฺฉุงู ุชุญูู ุฏูู ุนููฺฉุฑุฏ ูุฏู ุฑุง ุฏุฑ ุดุฑุงุท ูุงูุน ูุฑุงูู ูโฺฉูุฏ.

<br>
RAGAS ุจุง ุงุชุตุงู ุจู ฺฉ API ูุฏู ุฒุจุงู ุฎุงุฑุฌ ูุงููุฏ OpenAI API [29] ูุงุฏุฑ ุงุณุช ูุฌููุนูโุง ุงุฒ ูุนุงุฑูุง ุงุฑุฒุงุจ ุฑุง ูุญุงุณุจู ฺฉูุฏ ฺฉู ูุฑ ฺฉ ุฌูุจูโุง ุงุฒ ฺฉูุช ูพุงุณุฎ ุฑุง ูโุณูุฌูุฏ.

<br>

ุงู ฺฉุชุงุจุฎุงูู ุงุฒ ุชุฑฺฉุจ ูุฏูโูุง ุฒุจุงู ู ูุฏูโูุง ุฌุงููุง ุจุฑุง ุงุฑุฒุงุจ ุงุณุชูุงุฏู ูโฺฉูุฏ. ุจุฑุฎ ูุชุฑฺฉโูุง ุตุฑูุงู ูุจุชู ุจุฑ LLM ูุณุชูุฏ (ูุงููุฏ ุณูุฌุด ููุงุฏุงุฑ ุจู ูุชู)ุ ุจุฑุฎ ูุจุชู ุจุฑ ุดุจุงูุช ุจุฑุฏุงุฑโุงูุฏ (ูุงููุฏ ุงุฑุชุจุงุท ุฒููู)ุ ู ุจุฑุฎ ูุฒ ุงุฒ ุชุฑฺฉุจ ูุฑ ุฏู ุจูุฑู ูโุจุฑูุฏ. ุงู ุฑูฺฉุฑุฏ ุชุฑฺฉุจ ุจุงุนุซ ูโุดูุฏ RAGAS ุจุชูุงูุฏ ฺฉูุช ุฎุฑูุฌ ูุฏู ุฑุง ููโุชููุง ุงุฒ ููุธุฑ ุฒุจุงูุ ุจูฺฉู ุงุฒ ููุธุฑ ูุนูุง ู ุณุงุฎุชุงุฑ ูุฒ ุชุญูู ฺฉูุฏ.<br>

ุฏุฑ ุงู ููุงูู ุงุฒ ุณู ูุนุงุฑ ููุงุฏุงุฑ ุจู ูุชู [^58]ุ ุงุฑุชุจุงุท ูพุงุณุฎ [^59] ู ุงุฑุชุจุงุท ุฒููู [^60]  ุจุฑุง ุณูุฌุด ุนููฺฉุฑุฏ ูุนูุงุฑ ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุฏุฑ ุงุฏุงููุ ูุฑ ฺฉ ุงุฒ ุงู ูุนุงุฑูุง ู ูุญูู ูพุงุฏูโุณุงุฒ ุขูโูุง ุฏุฑ ฺูุงุฑฺูุจ RAGAS ุจูโุตูุฑุช ุฏูู ูุนุฑู ูโุดูุฏ.<br>
 

<div align="center">

![ุชุตูุฑ ฑน โ ุงุฑุชุจุงุท ุณู ูุนุงุฑ ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุฏุฑ RAGAS ู ุฌูุจู ูุง ูุฑุจูุท ุจู ุขููุง.
](/assets/patterneffort/synergistic-rag/media/fig19.JPG)

</div>

<p style="text-align:center;">
  <sub>ุชุตูุฑ ฑน โ ุงุฑุชุจุงุท ุณู ูุนุงุฑ ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุฏุฑ RAGAS ู ุฌูุจู ูุง ูุฑุจูุท ุจู ุขููุง.

</sub>
</p>

<br>

### ฑ. ููุงุฏุงุฑ ุจู ูุชู (Faithfulness):<br>
ูุนุงุฑ ููุงุฏุงุฑ ุจู ูุชู ุณูุฌุด ูโฺฉูุฏ ฺฉู ูพุงุณุฎ ุชููุฏุดุฏู ุชุง ฺู ุงูุฏุงุฒู ุจุง ุงุทูุงุนุงุช ููุฌูุฏ ุฏุฑ ุฒููู ุงุฑุงุฆูโุดุฏู (Context) ุณุงุฒฺฏุงุฑ ุงุณุช. ูุฏู ุงู ูุนุงุฑ ุชุดุฎุต ุงู ุงุณุช ฺฉู ุขุง ูุฏู ุชููุง ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง ุจุงุฒุงุจโุดุฏู ูพุงุณุฎ ุฏุงุฏู ุง ุงุทูุงุนุงุช ุฎุงุฑุฌ ุงุฒ ุฒููู ูุงููุฏ ุญุฏุณุ ุฏุงูุด ุนููู ุง ยซุชููู ูุฏูยป ุจู ูพุงุณุฎ ุงุถุงูู ฺฉุฑุฏู ุงุณุช.<br>

ุจู ุจุงู ุฏฺฏุฑุ ุงฺฏุฑ ูุฏู ุงุฏุนุง ูุทุฑุญ ฺฉูุฏ ฺฉู ุฏุฑ ูุชู ุฒููู ูุฌูุฏ ูุฏุงุฑุฏุ ุงูุชุงุฒ ููุงุฏุงุฑ ฺฉุงูุด ูโุงุจุฏ.

<br>
ูุฑููู ุงูุชุงุฒ ููุงุฏุงุฑ:<br>


$$
\text{Faithfulness Score} = 
\frac{\text{Number of claims in the generated answer
that can be inferred from the given context}}
     {\text{Total number of claims in the generated answer}}
$$



<br>

ุฏุฑ RAGAS ุงู ุงูุชุงุฒ ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ูุฏู ุฒุจุงู ูุญุงุณุจู ูโุดูุฏ. ูุฏู ุฒุจุงู:<br>

&nbsp;&nbsp;&nbsp;โข ูพุงุณุฎ ุฑุง ุจู ูุฌููุนูโุง ุงุฒ ุงุฏุนุงูุง (claims) ุชูุณู ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุจุฑุง ูุฑ ุงุฏุนุง ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุฏุฑ ูุชู ุฒููู ุดูุงูุฏ ฺฉุงู ูุฌูุฏ ุฏุงุฑุฏ ุง ุฎุฑุ<br>
&nbsp;&nbsp;&nbsp;โข ุฏุฑ ููุงุชุ ูุณุจุช ุงุฏุนุงูุง ูุงุจูโุชุฃุฏ ุจู ฺฉู ุงุฏุนุงูุง ุฑุง ุจูโุนููุงู ุงูุชุงุฒ ููุงุฏุงุฑ ฺฏุฒุงุฑุด ูโฺฉูุฏ.
<br>

ุงู ุฑูุด ุจุงุนุซ ูโุดูุฏ ุงุฑุฒุงุจ ููุงุฏุงุฑ ููโุชููุง ูุจุชู ุจุฑ ุดุจุงูุช ุณุทุญุ ุจูฺฉู ูุจุชู ุจุฑ ุงุณุชุฏูุงู ูุนูุง ุจุงุดุฏ.
<br>

ุจุฑุง ูุญุงุณุจู ุงูุชุงุฒ ููุงุฏุงุฑ ุฏุฑ RAGASุ ุงุจุชุฏุง ฺฉ ููููู ุชฺฉโูุฑุญููโุง (SingleTurnSample) ุดุงูู ูพุฑุณุด ฺฉุงุฑุจุฑุ ูพุงุณุฎ ูุฏู ู ุฒููู ุจุงุฒุงุจโุดุฏู ุชุนุฑู ูโุดูุฏ. ุณูพุณ ูุชุฑฺฉ Faithfulness ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฒุจุงู ุงุฒ ูพุด ุชุนุฑูโุดุฏู ูุฑุงุฎูุงู ูโฺฏุฑุฏุฏ:
```python
from ragas import SingleTurnSample
from ragas.metric.collections import Faithfulness

# (llmุจุง ูุงู )ุจุง ูุฑุถ ุงูฺฉู ูุฏู ุฒุจุงู ุงุฒ ูุจู ุชุนุฑู ุดุฏู ุงุณุช
faithfulness = Faithfulness(llm=llm)


# ููููู ุณุงุฏู
sample = SingleTurnSample(
    user_input="ูพุงุชุฎุช ุงุฑุงู ฺุณุชุ",
    response="ูพุงุชุฎุช ุงุฑุงู ุชูุฑุงู ุงุณุช.",
    retrieved_contexts=["ุชูุฑุงู ูพุงุชุฎุช ุงุฑุงู ุงุณุช."]
)

# ุตุฏุง ุฒุฏู ูุชุฑฺฉ
f_result = await faithfulness.ascore(
    user_input=sample.user_input,
    response=sample.response,
    retrieved_contexts=sample.retrieved_contexts
)

print("Faithfulness:", f_result.value)
```

ุฏุฑ ุงู ูพุงุฏูโุณุงุฒ:<br>
&nbsp;&nbsp;&nbsp;โข ฺฉ ููููู ุงุฑุฒุงุจ ุดุงูู ูพุฑุณุดุ ูพุงุณุฎ ู ุฒููู ุจุงุฒุงุจโุดุฏู ุณุงุฎุชู ูโุดูุฏุ<br>	
&nbsp;&nbsp;&nbsp;โข ูุชุฑฺฉ `Faithfulness` ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฒุจุงูุ ุงุฏุนุงูุง ููุฌูุฏ ุฏุฑ ูพุงุณุฎ ุฑุง ุงุณุชุฎุฑุงุฌ ู ุจุง ุฒููู ููุงุณู ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุฎุฑูุฌ ููุง ฺฉ ููุฏุงุฑ ุนุฏุฏ ุจู ฐ ู ฑ ุงุณุช ฺฉู ูุดุงูโุฏููุฏู ูุฒุงู ูพุงุจูุฏ ูพุงุณุฎ ุจู ุงุทูุงุนุงุช ููุฌูุฏ ุฏุฑ ูุชู ุฒููู ุงุณุช.

<br>

### ฒ. ุงุฑุชุจุงุท ูพุงุณุฎ (Answer Relevance):<br>
ูุนุงุฑ ุงุฑุชุจุงุท ูพุงุณุฎ ูุฒุงู ุชุทุงุจู ู ููโุฎูุงู ูพุงุณุฎ ุชููุฏุดุฏู ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ ุฑุง ุงูุฏุงุฒูโฺฏุฑ ูโฺฉูุฏ. ูุฏู ุงู ูุนุงุฑ ุขู ุงุณุช ฺฉู ูุดุฎุต ฺฉูุฏ ุขุง ูุฏู ูุงูุนุงู ุจู ูพุฑุณุด ูุทุฑุญโุดุฏู ูพุงุณุฎ ุฏุงุฏู ุง ุตุฑูุงู ูุชู ูุฑุชุจุท ุจุง ููุถูุน ุชููุฏ ฺฉุฑุฏู ุงุณุช. ุฏุฑ ูุงูุนุ ุงู ูุนุงุฑ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ูพุงุณุฎ ุชุง ฺู ุงูุฏุงุฒู ุงุฒ ูุธุฑ ูุนูุง ุจู ุฎูุฏ ูพุฑุณุด ูุฒุฏฺฉ ุงุณุช.<br>

ูุฑููู ุงุฑุชุจุงุท ูพุงุณุฎ:<br>


$$
\text{Answer Relevance} = \frac{1}{N} \sum_{i=1}^{N} \cos \big( E_{g_i}, E_o \big)
$$



<br>

$ E_(g_i) $ : ููุฏุงุฑ ุจุฑุฏุงุฑ ูพุงุณุฎ ุชููุฏโุดุฏู i ุงูู.<br>
$E_o$ : ููุฏุงุฑ ุจุฑุฏุงุฑ ูพุฑุณุด ฺฉุงุฑุจุฑ.<br>
N: ุชุนุฏุงุฏ ูพุงุณุฎ ูุง ุชููุฏ ุดุฏู.

<br>(ุฏุฑ ุญุงูุช ุชฺฉโูพุงุณุฎุ ูุนูููุงู `N = 1`)
ุงู ูุฑููู ูุงูฺฏู ุดุจุงูุช ฺฉุณููุณ ุจู ุจุฑุฏุงุฑ ูพุฑุณุด ู ุจุฑุฏุงุฑ ูพุงุณุฎ ุฑุง ูุญุงุณุจู ูโฺฉูุฏ.
ูุฑฺู ุงู ููุฏุงุฑ ุจู ฑ ูุฒุฏฺฉโุชุฑ ุจุงุดุฏุ ูพุงุณุฎ ุงุฒ ูุธุฑ ูุนูุง ุจุง ูพุฑุณุด ูุฑุชุจุทโุชุฑ ุงุณุช.

<br>

ุฏุฑ RAGAS ุงู ูุนุงุฑ ุจุง ุชุฑฺฉุจ ุงุฒ ุฏู ูุคููู ูุญุงุณุจู ูโุดูุฏ:<br>
&nbsp;&nbsp;&nbsp;โข ูุฏู ุฌุงููุง: ุจุฑุง ุชุจุฏู ูพุฑุณุด ู ูพุงุณุฎ ุจู ุจุฑุฏุงุฑูุง ูุนูุง ุจุง ุงุจุนุงุฏ ุซุงุจุช.<br>
&nbsp;&nbsp;&nbsp;โข ูุฏู ุฒุจุงู: ุจุฑุง ุชุญูู ุฏููโุชุฑ ู ุงุฑุฒุงุจ ููุง ูุฒุงู ุงุฑุชุจุงุท ูุนูุง.<br>

ุงู ุชุฑฺฉุจ ุจุงุนุซ ูโุดูุฏ ุงุฑุฒุงุจ ุงุฑุชุจุงุท ูพุงุณุฎ ููโุชููุง ุจุฑ ุงุณุงุณ ุดุจุงูุช ุจุฑุฏุงุฑุ ุจูฺฉู ุจุฑ ุงุณุงุณ ุฏุฑฺฉ ุฒุจุงู ุนููโุชุฑ ูุฒ ุงูุฌุงู ุดูุฏ.
<br>

ุจุฑุง ูุญุงุณุจู ุงูุชุงุฒ Answer Relevance ุฏุฑ RAGASุ ุงุจุชุฏุง ฺฉ ููููู ุชฺฉโูุฑุญููโุง ุดุงูู ูพุฑุณุด ฺฉุงุฑุจุฑุ ูพุงุณุฎ ูุฏู ู ุฒููู ุจุงุฒุงุจโุดุฏู ุณุงุฎุชู ูโุดูุฏ. ุณูพุณ ูุชุฑฺฉ `AnswerRelevancy` ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฒุจุงู ู ูุฏู ุฌุงููุง ุงุฒ ูพุด ุชุนุฑูโุดุฏู ูุฑุงุฎูุงู ูโฺฏุฑุฏ:
 ```python
from ragas import SingleTurnSample
from ragas.metric.collections import AnswerRelevancy

# (embeddings ู llmุจุง ูุงู ูุง )ุจุง ูุฑุถ ุงูฺฉู ูุฏู ุฒุจุงู ู ูุฏู ุฌุงููุง ุงุฒ ูุจู ุชุนุฑู ุดุฏู ุงูุฏ
answer_relevancy = AnswerRelevancy(llm=llm, embeddings=embeddings)

# ููููู ุณุงุฏู
sample = SingleTurnSample(
    user_input="ูพุงุชุฎุช ุงุฑุงู ฺุณุชุ",
    response="ูพุงุชุฎุช ุงุฑุงู ุชูุฑุงู ุงุณุช.",
    retrieved_contexts=["ุชูุฑุงู ูพุงุชุฎุช ุงุฑุงู ุงุณุช."]
)

# ุตุฏุง ุฒุฏู ูุชุฑฺฉโ
r_result = await answer_relevancy.ascore(
    user_input=sample.user_input,
    response=sample.response
)
print("Answer Relevancy:", r_result.value)
```
ุฏุฑ ุงู ูพุงุฏูโุณุงุฒ:<br>
&nbsp;&nbsp;&nbsp;โข ูพุฑุณุด ู ูพุงุณุฎ ุจูโุตูุฑุช ุจุฑุฏุงุฑูุง ูุนูุง ุชูุณุท ูุฏู ุฌุงููุง ุชุจุฏู ูโุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ูุฏู ุฒุจุงู ุจุฑุง ุชุญูู ุฏููโุชุฑ ู ุงุฑุฒุงุจ ููุง ูุฒุงู ุงุฑุชุจุงุท ูุนูุง ุจู ูพุฑุณุด ู ูพุงุณุฎ ุงุณุชูุงุฏู ูโุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุฎุฑูุฌ ููุง ฺฉ ููุฏุงุฑ ุนุฏุฏ ุจู ฐ ู ฑ ุงุณุช ฺฉู ูุดุงู ูโุฏูุฏ ูพุงุณุฎ ุชุง ฺู ุงูุฏุงุฒู ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ ููโุฎูุงู ูุนูุง ุฏุงุฑุฏ.

<br>

### ณ. ุงุฑุชุจุงุท ุฒููู (Context Relevance):
ูุนุงุฑ ุงุฑุชุจุงุท ุฒููู ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ูุทุนุงุช ูุนูุง ุจุงุฒุงุจโุดุฏู ุงุฒ ูพุงฺฏุงู ุฏุงูุด ุชุง ฺู ุงูุฏุงุฒู ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ ูุฑุชุจุท ูุณุชูุฏ. ุงู ูุนุงุฑ ฺฉูุช ูุฑุญูู ุจุงุฒุงุจ ุฑุง ูโุณูุฌุฏ ู ูุดุฎุต ูโฺฉูุฏ ฺฉู ุขุง ูุฏู ูุงูุนุงู ุฒููู ููุงุณุจ ู ูุฑุชุจุท ุฑุง ุจุฑุง ูพุงุณุฎโุฏู ุฏุฑุงูุช ฺฉุฑุฏู ุงุณุช ุง ุฎุฑ.<br>

ุงฺฏุฑ ุจุฎุด ุจุงุฒุงุจ ูุทุนุงุช ูุงูุฑุชุจุท ุง ฺฉูโุงุฑุชุจุงุท ุฑุง ุจุงุฒุงุจ ฺฉูุฏุ ุญุช ฺฉ ูุฏู ุฒุจุงู ุจุณุงุฑ ูู ูุฒ ููโุชูุงูุฏ ูพุงุณุฎ ุฏูู ู ูุงุจูโุงุนุชูุงุฏ ุชููุฏ ฺฉูุฏ. ุจูุงุจุฑุงูุ ุงุฑุชุจุงุท ุฒููู ฺฉ ุงุฒ ูููโุชุฑู ุดุงุฎุตโูุง ุงุฑุฒุงุจ ูุนูุงุฑโูุง RAG ุงุณุช.<br>

ูุฑููู ุงุฑุชุจุงุท ุฒููู:
<br>


$$
\text{Context Relevance} = 
\frac{|S|}{\text{Total number of sentences in retrieved context}}
$$



<br>
|S| : ุชุนุฏุงุฏ ุฌููุงุช ุงุฒ ูุชู ุจุงุฒุงุจโุดุฏู ฺฉู ูุงูุนุง ุจู ูพุฑุณุด ูพุงุณุฎ ูโุฏูุฏ.<br>
ูุฎุฑุฌ ฺฉุณุฑ: ุชุนุฏุงุฏ ฺฉู ุฌููุงุช ููุฌูุฏ ุฏุฑ ูุทุนุงุช ุจุงุฒุงุจโุดุฏู.

<br>

ุฏุฑ RAGASุ ุงู ูุนุงุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ูุฏู ุฒุจุงู ูุญุงุณุจู ูโุดูุฏ. ูุฏู:<br>

&nbsp;&nbsp;&nbsp;โข ูุฑ ุฌููู ููุฌูุฏ ุฏุฑ ุฒููู ุฑุง ุชุญูู ูโฺฉูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ูุฒุงู ุงุฑุชุจุงุท ูุนูุง ุขู ุฌููู ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ ุฑุง ูโุณูุฌุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุฌููุงุช ูุฑุชุจุท ุฑุง ุฏุฑ ูุฌููุนู S ูุฑุงุฑ ูโุฏูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุฏุฑ ููุงุชุ ูุณุจุช ุฌููุงุช ูุฑุชุจุท ุจู ฺฉู ุฌููุงุช ุฑุง ุจูโุนููุงู ุงูุชุงุฒ Context Relevance ฺฏุฒุงุฑุด ูโฺฉูุฏ.<br>

ุงู ุฑูุด ุจุงุนุซ ูโุดูุฏ ุงุฑุฒุงุจ ุงุฑุชุจุงุท ุฒููู ููโุชููุง ุจุฑ ุงุณุงุณ ุดุจุงูุช ุจุฑุฏุงุฑุ ุจูฺฉู ุจุฑ ุงุณุงุณ ุฏุฑฺฉ ูุนูุง ู ุงุณุชุฏูุงู ุฒุจุงู ุงูุฌุงู ุดูุฏ.

<br>

ุงุฒ ุขูโุฌุง ฺฉู ุฏุฑ ูุณุฎูโูุง ุฌุฏุฏ RAGAS (`ุฏุฑ ุงู ฺฏุฒุงุฑุด ูุณุฎู 0.3.9`) ุชุงุจุน ูุญุงุณุจู `Context Relevance` ุญุฐู ุดุฏู ู ุฏฺฏุฑ ุฏุฑ ุฏุณุชุฑุณ ูุณุชุ ุงู ูุนุงุฑ ุจุงุฏ ุจูโุตูุฑุช ุฏุณุช ูพุงุฏูโุณุงุฒ ุดูุฏ.<br>

ุฏุฑ ุงู ุฑูุดุ ุงุจุชุฏุง ุชูุงู ุฌููุงุช ููุฌูุฏ ุฏุฑ ุฒููู ุจุงุฒุงุจโุดุฏู ุงุณุชุฎุฑุงุฌ ูโุดููุฏุ
ุณูพุณ ฺฉ ูุฏู ุฒุจุงู ุจุฑุง ุชุดุฎุต ูุฒุงู ุงุฑุชุจุงุท ูุฑ ุฌููู ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑุฏ.
ุฏุฑ ุขุฎุฑุ ูุณุจุช ุฌููุงุช ูุฑุชุจุท ุจู ฺฉู ุฌููุงุช ุจูโุนููุงู ุงูุชุงุฒ ุงุฑุชุจุงุท ุฒููู ูุญุงุณุจู ูโุดูุฏ.<br>

ฺฉุฏ ุฒุฑ ฺฉ ูพุงุฏูโุณุงุฒ ุณุงุฏู ุงุฒ ุงู ูุฑุขูุฏ ุฑุง ูุดุงู ูโุฏูุฏ:
```python
import asyncio
from nltk.tokenize import sent_tokenize
from openai import AsyncOpenAI

client = AsyncOpenAI(
    api_key="YOUR_API_KEY",
    base_url="https://openrouter.ai/api/v1"
)

async def context_relevance(question, contexts):
    if not contexts:
        return 0.0
    sentences = sent_tokenize(" ".join(contexts))
    if not sentences:
        return 0.0
    relevant = 0
    prompt_template = """Question: {question}
Sentence: {sentence}
Is this sentence relevant for answering the question?
Respond only with "yes" or "no"."""

    for s in sentences:
        prompt = prompt_template.format(question=question, sentence=s)
        resp = await client.chat.completions.create(
            model="x-ai/grok-4.1-fast",
            messages=[{"role": "user", "content": prompt}],
            max_tokens=10
        )
        ans = resp.choices[0].message.content.strip().lower()
        if ans.startswith("yes"):
            relevant += 1
    return relevant / len(sentences)

async def main():
    question = "ูพุงุชุฎุช ุงุฑุงู ฺุณุชุ"
    contexts = [
        "ุชูุฑุงู ูพุงุชุฎุช ุงุฑุงู ุงุณุช.",
        "ุงุฑุงู ุฏุฑ ุฎุงูุฑูุงูู ูุฑุงุฑ ุฏุงุฑุฏ.",
        "ุฌูุนุช ุชูุฑุงู ุจุด ุงุฒ 8 ูููู ููุฑ ุงุณุช."
    ]
    score = await context_relevance(question, contexts)
    print("Context Relevance:", round(score, 4))

if __name__ == "__main__":
    asyncio.run(main())
```
ุฏุฑ ุงู ูพุงุฏูโุณุงุฒ:<br>
&nbsp;&nbsp;&nbsp;โข ุชูุงู ูุทุนุงุช ุจุงุฒุงุจโุดุฏู ุจู ุฌููุงุช ูุณุชูู ุชูุณู ูโุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุจุฑุง ูุฑ ุฌูููุ ฺฉ ูพุฑุณุด ุณุงุฏู ุจู ูุฏู ุฒุจุงู ุงุฑุณุงู ูโุดูุฏ ุชุง ูุฒุงู ุงุฑุชุจุงุท ุขู ุจุง ูพุฑุณุด ุงุตู ูุดุฎุต ุดูุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ุฌููุงุช ฺฉู ูุฏู ุขูโูุง ุฑุง ูุฑุชุจุท ุชุดุฎุต ุฏูุฏ ุดูุงุฑุด ูโุดููุฏุ<br>
&nbsp;&nbsp;&nbsp;โข ูุณุจุช ุฌููุงุช ูุฑุชุจุท ุจู ฺฉู ุฌููุงุชุ ุงูุชุงุฒ ููุง Context Relevance ุฑุง ุชุดฺฉู ูโุฏูุฏ.
<br>
ุงู ุฑูุด ุงฺฏุฑฺู ุณุงุฏู ุงุณุชุ ุงูุง ุฏุฑ ุนูู ุนููฺฉุฑุฏ ูุดุงุจู ูุณุฎู ูุฏู RAGAS ุงุฑุงุฆู ูโุฏูุฏ ู ุจุฑุง ุงุฑุฒุงุจ ูุนูุงุฑโูุง RAG ฺฉุงููุงู ูุงุจู ุงุชฺฉุง ุงุณุช.

<br>

#### ูพุงุฏูุณุงุฒ ุนูู ูุนุงุฑูุง ุงุฑุฒุงุจ
ุฏุฑ ูพุงุฏูโุณุงุฒ ุนูู ุงู ูพุฑูฺูุ ุฏู ูุนุงุฑ ููุงุฏุงุฑ ุจู ูุชู ู ุงุฑุชุจุงุท ูพุงุณุฎ ฺฉู ุฏุฑ ฺฉุชุงุจุฎุงูู RAGAS ุชุนุฑู ุดุฏูโุงูุฏุ ุฏุฑ ฺฉ ุงุณฺฉุฑูพุช ูุงุญุฏ ุชุฌูุน ู ุงุฌุฑุง ูโุดููุฏ. ุงู ุงุณฺฉุฑูพุช ุฎุฑูุฌ ูุนูุงุฑ RAG ุฑุง ุงุฒ ูุงู ูุชุงุฌ ุฏุฑุงูุช ฺฉุฑุฏูุ ุจุฑุง ูุฑ ูพุฑุณุด ูพุงุณุฎ ุงูุชุงุฒูุง ุงุฑุฒุงุจ ุฑุง ูุญุงุณุจู ูโฺฉูุฏ ู ุฏุฑ ููุงุช ูุงูฺฏู ูุนุงุฑูุง ุฑุง ูุฒ ฺฏุฒุงุฑุด ูโุฏูุฏ.
ฺฉุฏ ุฒุฑ ููููู ฺฉุงูู ุงู ูุฑุขูุฏ ุฑุง ูุดุงู ูโุฏูุฏ:
```python
import json
import asyncio
from ragas import SingleTurnSample
from ragas.metrics.collections import Faithfulness, AnswerRelevancy
from openai import AsyncOpenAI
from ragas.llms import llm_factory
from ragas.embeddings import HuggingFaceEmbeddings
client = AsyncOpenAI(
    api_key="YOUR_API_KEY",
    base_url="https://openrouter.ai/api/v1"
)

# ุงูุชุฎุงุจ ูุฏู LLM (ูุซูุงู Grok ุง GPT-4o-mini)
llm = llm_factory("x-ai/grok-4.1-fast", client=client)
embeddings = HuggingFaceEmbeddings(
    model=r" Enter your embedding model of evaluation location e.g. bge-base-en-v1.5 "
)

faithfulness = Faithfulness(llm=llm)
answer_relevancy = AnswerRelevancy(llm=llm, embeddings=embeddings)

samples = []
with open("AF_RAG_Results.jsonl", "r", encoding="utf8") as f:
    for idx, line in enumerate(f, start=1):
        item = json.loads(line)
        q = item.get("query", "")
        a = item.get("answer", "")
        ctx = item.get("sns_nodes", [])
        if isinstance(ctx, str):
            ctx = [ctx]
        samples.append((idx, SingleTurnSample(user_input=q, response=a, retrieved_contexts=ctx)))

async def main():
    results = []
    total_faith, total_relevancy, total_wordcount = 0, 0, 0
    count = 0
    for idx, s in samples:
        try:
            # Faithfulness
            f_result = await faithfulness.ascore(
                user_input=s.user_input,
                response=s.response,
                retrieved_contexts=s.retrieved_contexts
            )
            f_score = f_result.value

            # Answer Relevancy
            r_result = await answer_relevancy.ascore(
                user_input=s.user_input,
                response=s.response
            )
            r_score = r_result.value

            # Word count
            word_count = len(s.response.split())

            results.append({
                "id": idx,
                "faithfulness": round(f_score, 4),
                "answer_relevancy": round(r_score, 4),
                "avg_word_count": word_count
            })

            total_faith += f_score
            total_relevancy += r_score
            total_wordcount += word_count
            count += 1

        except Exception as e:
            print(f"Error in sample {idx}: {e}")

    averages = {
        "avg_faithfulness": round(total_faith / count, 4) if count else 0,
        "avg_answer_relevancy": round(total_relevancy / count, 4) if count else 0,
        "avg_word_count": round(total_wordcount / count, 2) if count else 0
    }

    output = {
        "results": results,
        "averages": averages
    }

    with open("evaluation_results.json", "w", encoding="utf8") as out:
        json.dump(output, out, ensure_ascii=False, indent=2)

    print("โ ูุชุงุฌ ุฏุฑ evaluation_results.json ุฐุฎุฑู ุดุฏ.")

if __name__ == "__main__":
    asyncio.run(main())
```
ุฏุฑ ุงู ฺฉุฏ:<br>
&nbsp;&nbsp;&nbsp;โข ุจุงุฑฺฏุฐุงุฑ ูุชุงุฌ RAG: ูุงู `AF_RAG_Results.jsonl` ุดุงูู ูพุฑุณุดุ ูพุงุณุฎ ู ุฒููู ุจุงุฒุงุจโุดุฏู ุงุณุช. ูุฑ ุฎุท ุจู ฺฉ ููููู ุงุฑุฒุงุจ ุชุจุฏู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข ูุญุงุณุจู  Faithfulness: ูุฏู ุฒุจุงู ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุงุฏุนุงูุง ููุฌูุฏ ุฏุฑ ูพุงุณุฎ ุชุง ฺู ุงูุฏุงุฒู ุฏุฑ ุฒููู ูุงุจู ุชุฃุฏ ูุณุชูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข ูุญุงุณุจู Answer Relevance: ูุฏู ุฌุงููุง ู ูุฏู ุฒุจุงู ุจุง ูู ูุฒุงู ุงุฑุชุจุงุท ูุนูุง ูพุงุณุฎ ุจุง ูพุฑุณุด ุฑุง ูโุณูุฌูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข ูุญุงุณุจู Word Count: ุชุนุฏุงุฏ ฺฉููุงุช ูพุงุณุฎ ุจุฑุง ุชุญููโูุง ุชฺฉูู ุฐุฎุฑู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข ุชุฌูุน ูุชุงุฌ: ุจุฑุง ูุฑ ููููู ุงูุชุงุฒูุง ุฐุฎุฑู ุดุฏู ู ุฏุฑ ูพุงุงู ูุงูฺฏู ูุนุงุฑูุง ูุญุงุณุจู ู ุฏุฑ ูุงู `evaluation_results.json` ุฐุฎุฑู ูโุดูุฏ.<br>

ุงู ุณุงุฎุชุงุฑ ุงูฺฉุงู ุงุฑุฒุงุจ ุฏูู ุนููฺฉุฑุฏ ูุนูุงุฑ RAG ุฑุง ูุฑุงูู ูโฺฉูุฏ ู ุจูโูฺู ุจุฑุง ููุงุณู ูุณุฎูโูุง ูุฎุชูู ูุนูุงุฑ ุง ูุฏูโูุง ูุชูุงูุช ุจุณุงุฑ ฺฉุงุฑุจุฑุฏ ุงุณุช.<br>


ุจุฑุง ูุญุงุณุจู ุงุฑุชุจุงุท ุฒููู ุฏุฑ ุงู ูพุฑูฺูุ ุงุฒ ุขูโุฌุง ฺฉู ุงู ูุชุฑฺฉ ุฏุฑ ูุณุฎูโูุง ุฌุฏุฏ RAGAS ุญุฐู ุดุฏู ู ุฏฺฏุฑ ุจูโุตูุฑุช ุขูุงุฏู ุฏุฑ ุฏุณุชุฑุณ ูุณุชุ ูุงุฒู ุงุณุช ุขู ุฑุง ุจูโุตูุฑุช ุฏุณุช ูพุงุฏูโุณุงุฒ ฺฉูู. <br>

ุฏุฑ ุงู ุฑูุดุ ุงุจุชุฏุง ุฎุฑูุฌ ูุฑุญูู ูุจู (ูุงู `evaluation_results.json`) ู ูุงู ุงุตู ูุชุงุฌ RAG (ูุงู `AF_RAG_Results.jsonl`) ูุงุฑุฏ ุจุฑูุงูู ูโุดููุฏ. ุณูพุณ ุจุฑุง ูุฑ ูููููุ ุงูุชุงุฒ Context Relevance ูุญุงุณุจู ุดุฏู ู ุฏุฑ ฺฉูุงุฑ ุณุงุฑ ูุนุงุฑูุง ูุจู ุฐุฎุฑู ูโฺฏุฑุฏุฏ.
```python
import json
import asyncio
from nltk.tokenize import sent_tokenize
from openai import AsyncOpenAI

client = AsyncOpenAI(
    api_key="ENTER_YOUR_API_KEY",
    base_url="https://openrouter.ai/api/v1"
)

async def context_relevance(question, contexts):
    if not contexts:
        return 0.0
    sentences = sent_tokenize(" ".join(contexts))
    if not sentences:
        return 0.0

    relevant = 0
    prompt_template = """Question: {question}
Sentence: {sentence}
Is this sentence relevant for answering the question?
Respond only with "yes" or "no"."""

    for s in sentences:
        prompt = prompt_template.format(question=question, sentence=s)

        resp = await client.chat.completions.create(
            model="x-ai/grok-4.1-fast",
            messages=[{"role": "user", "content": prompt}],
            max_tokens=10
        )

        ans = resp.choices[0].message.content.strip().lower()
        if ans.startswith("yes"):
            relevant += 1

    return relevant / len(sentences)


with open("evaluation_results.json", "r", encoding="utf8") as f:
    data = json.load(f)

with open("AF_RAG_Results.jsonl", "r", encoding="utf8") as f:
    raw_samples = [json.loads(line) for line in f]


async def main():
    total_crel = 0
    count = 0

    for idx, item in enumerate(raw_samples, start=1):
        q = item.get("query", "")
        ctx = item.get("sns_nodes", [])
        if isinstance(ctx, str):
            ctx = [ctx]

        try:
            c_score = await context_relevance(q, ctx)
            for r in data["results"]:
                if r["id"] == idx:
                    r["context_relevance"] = round(c_score, 4)
                    break

            total_crel += c_score
            count += 1
        except Exception as e:
            print(f"Error in sample {idx}: {e}")

    data["averages"]["avg_context_relevance"] = round(total_crel / count, 4) if count else 0

    with open("evaluation_results_with_context.json", "w", encoding="utf8") as out:
        json.dump(data, out, ensure_ascii=False, indent=2)

    print("โ ูุชุงุฌ ููุง ุฏุฑ evaluation_results_with_context.json ุฐุฎุฑู ุดุฏ.")

if __name__ == "__main__":
    asyncio.run(main())

```
ุชูุถุญ ุนููฺฉุฑุฏ ุงู ุจุฎุด:<br>

&nbsp;&nbsp;&nbsp;โข 	ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง: ุฏู ูุงู ูุฑูุฏ ุดุงูู ูุชุงุฌ ูุจู ู ูููููโูุง ุฎุงู RAG ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;โข ูุญุงุณุจู Context Relevance:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o ุชูุงู ูุทุนุงุช ุจุงุฒุงุจโุดุฏู ุจู ุฌููุงุช ูุณุชูู ุชูุณู ูโุดููุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o ุจุฑุง ูุฑ ุฌูููุ ฺฉ ูุฏู ุฒุจุงู ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุขู ุฌููู ุจุฑุง ูพุงุณุฎ ุจู ูพุฑุณุด ููุฏ ุงุณุช ุง ุฎุฑ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o ูุณุจุช ุฌููุงุช ูุฑุชุจุท ุจู ฺฉู ุฌููุงุชุ ุงูุชุงุฒ ููุง ุฑุง ุชุดฺฉู ูโุฏูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข ุชุฌูุน ูุชุงุฌ: ุงูุชุงุฒ ุฌุฏุฏ ุจู ุฑฺฉูุฑุฏูุง ูุจู ุงุถุงูู ุดุฏู ู ูุงูฺฏู ุขู ูุฒ ูุญุงุณุจู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข ุฐุฎุฑูโุณุงุฒ ุฎุฑูุฌ: ุชูุงู ูุชุงุฌ ุฏุฑ ูุงู `evaluation_results_with_context.json` ุฐุฎุฑู ูโฺฏุฑุฏุฏ.<br>

ุงู ุณุงุฎุชุงุฑ ุจุงุนุซ ูโุดูุฏ ุณู ูุนุงุฑ ุงุตู -ููุงุฏุงุฑ ุจู ูุชูุ ุงุฑุชุจุงุท ูพุงุณุฎ ู ุงุฑุชุจุงุท ุฒููู- ุจูโุตูุฑุช ฺฉูพุงุฑฺู ุฏุฑ ฺฉูุงุฑ ูู ูุฑุงุฑ ฺฏุฑูุฏ ู ุชุตูุฑ ุฌุงูุน ุงุฒ ุนููฺฉุฑุฏ ูุนูุงุฑ RAG ุงุฑุงุฆู ุฏููุฏ.<br>

ุฎุฑูุฌ ุงู ุฏู ฺฉุฏ ุงุฑุฒุงุจุ ุจุฑุง ูุฑ ุณูุงู ุจู ุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏุ ุจุฑุง ูุซุงู:
<br>

```python
{
  "results": [
    {
      "id": 1,
      "faithfulness": 0.1875,
      "answer_relevancy": 0.8489,
      "avg_word_count": 221,
      "context_relevance": 0.2874
    }
  ],
  "averages": {
    "avg_faithfulness": 0.1875,
    "avg_answer_relevancy": 0.8489,
    "avg_word_count": 221.0,
    "avg_context_relevance": 0.2874
  }
}
```

<br>

---
## ูุชุงฺ
ุฏุฑ ุงู ุจุฎุดุ ุนููฺฉุฑุฏ ูุนูุงุฑ ูพุดููุงุฏ ุฏุฑ ููุงูู ุจูโุตูุฑุช ูุธุงูโููุฏ ููุฑุฏ ุงุฑุฒุงุจ ูุฑุงุฑ ูโฺฏุฑุฏ. ุงุจุชุฏุงุ ฺฉุงุฑุง ูุฏูโูุง ุฒุจุงู ูุญู ุฏุฑ ฺุงุฑฺูุจ ูุนูุงุฑ RAG ุจุง ูพฺฉุฑุจูุฏ ููุง ุงุฑุงุฆูโุดุฏู ุฏุฑ ููุงูู ููุงุณู ูโุดูุฏ ุชุง ูุดุฎุต ฺฏุฑุฏุฏ ฺฉุฏุงู ูุฏู ุฒุจุงู ุฏุฑ ุงู ุณุงุฎุชุงุฑ ุจุดุชุฑู ุณุงุฒฺฏุงุฑ ู ุจูุชุฑู ฺฉูุช ูพุงุณุฎโุฏู ุฑุง ุงุฑุงุฆู ูโุฏูุฏ.<br>
ูพุณ ุงุฒ ุชุนู ููุงุณุจโุชุฑู ูุฏู ุฒุจุงู ูุญูุ ุงุฑุฒุงุจ ุจู ุณูุช ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู ููุงูู ูุฏุงุช ูโุดูุฏ. ุฏุฑ ุงู ูุฑุญููุ ุนููฺฉุฑุฏ ูุฏู ุฌุงููุง ุฏุฑ ูพฺฉุฑุจูุฏโูุง ูุฎุชูู ุชุนุฑูโุดุฏู ุฏุฑ ููุงูู ุชุญูู ุดุฏู ู ูุชุงุฌ ุจูโุฏุณุชโุขูุฏู ุจุง ุงูุชูโูุง ฺฏุฒุงุฑุดโุดุฏู ุฏุฑ ููุงูู ููุงุณู ูโฺฏุฑุฏุฏ ุชุง ูุฒุงู ููโุฎูุงูุ ุชูุงูุชโูุง ู ููุงุท ุจูุจูุฏ ูุดุฎุต ุดูุฏ.<br>
ุฏุฑ ุงุฏุงููุ ูุฏู ุฌุงููุง ุงุฑุงุฆูโุดุฏู ุฏุฑ ููุงูู ุจุง ุณุงุฑ ูุฏูโูุง ุฌุงููุง ููุฌูุฏ ููุฑุฏ ููุงุณู ูุฑุงุฑ ูโฺฏุฑุฏ ุชุง ุฌุงฺฏุงู ูุณุจ ุขู ุฏุฑ ูุงู ูุฏูโูุง ุฑุงุฌ ู ูพุดุฑูุชู ูุดุฎุต ุดูุฏ. ุณูพุณุ ุฎุฑูุฌ ูพุฑุงููพุชโูุง ูุฎุชูู ุฏุฑ ุจูุชุฑู ูุฏู ุฒุจุงู ูุญู ู ูุฏู ุฌุงููุง ุจุฑุฑุณ ู ุชุญูู ูโุดูุฏ ุชุง ุชุฃุซุฑ ููุน ุฏุณุชูุฑุ ฺฉูุช ุจุงุฒุงุจ ู ูุญูู ุชุฑฺฉุจ ุขูโูุง ุจุฑ ูพุงุณุฎ ููุง ุฑูุดู ฺฏุฑุฏุฏ.<br>
ุฏุฑ ูพุงุงูุ ุนููฺฉุฑุฏ ูุฏู ุฒุจุงู ุงุฑุฒุงุจ ุฏุฑ ุณูุฌุด ุฎุฑูุฌโูุง ุจุง ูุชุงุฌ ูุฏู ุงุฑุฒุงุจ ููุฑุฏ ุงุณุชูุงุฏู ุฏุฑ ููุงูู ููุงุณู ูโุดูุฏ. ุงู ููุงุณู ุงูฺฉุงู ุจุฑุฑุณ ูุฒุงู ุงูุทุจุงู ุงุฑุฒุงุจโูุง ุงูุฌุงูโุดุฏู ุจุง ูุนุงุฑูุง ููุงูู ู ุงุนุชุจุงุฑุณูุฌ ูุชุงุฌ ุฑุง ูุฑุงูู ูโุณุงุฒุฏ.

---

### ุขุฒูุงุด ุดูุงุฑู ฑ: ููุงุณู  ุนููฺฉุฑุฏ ูุฏู ูุง ุฒุจุงู ูุญู
ุฏุฑ ุงู ุขุฒูุงุดุ ุนููฺฉุฑุฏ ูุฌููุนูโุง ุงุฒ ูุฏูโูุง ุฒุจุงู ูุญู ุฏุฑ ฺุงุฑฺูุจ ูุนูุงุฑ ููุง ุงุฑุงุฆูโุดุฏู ุฏุฑ ููุงููุ ุดุงูู ูพฺฉุฑุจูุฏ B + G + FT + SC + AF + EPT ู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู all mpnet base v2 (ุจุฑ ุงุณุงุณ ูพฺฉุฑุจูุฏ ุฑุฒุชูุธู 17TB + G + SNS) ููุฑุฏ ุงุฑุฒุงุจ ูุฑุงุฑ ูโฺฏุฑุฏ.<br>
ุฎุฑูุฌ ูุฑ ฺฉ ุงุฒ ูุฏูโูุง ุฒุจุงู ูุญู ุจุง ุจูุฑูโฺฏุฑ ุงุฒ ูุนุงุฑูุง ุณูุฌุด RAGAS ุชุญูู ูโุดูุฏ ุชุง ฺฉูุช ูพุงุณุฎโุฏูุ ูุฒุงู ุงุฑุชุจุงุท ูพุงุณุฎ ุจุง ูพุฑุณุดุ ู ูุญูู ุงุณุชูุงุฏู ูุฏู ุงุฒ ุฒููู ุจุงุฒุงุจโุดุฏู ุจูโุตูุฑุช ฺฉู ุงูุฏุงุฒูโฺฏุฑ ฺฏุฑุฏุฏ.<br>
ูพุณ ุงุฒ ูุญุงุณุจู ุงูุชุงุฒูุง ุงุฑุฒุงุจุ ูุชุงุฌ ุจูโุฏุณุชโุขูุฏู ุชุญูู ู ููุงุณู ูโุดููุฏ ู ุฏุฑ ููุงุช ุจูุชุฑู ูุฏู ุฒุจุงู ูุญู ุจุฑ ุงุณุงุณ ฺฉูุช ูพุงุณุฎโูุง ุชููุฏุดุฏู ุจุง ุชูุฌู ุจู ูุชู ุณูุงู ู ุชูุงู ุงุณุชูุจุงุท ูุฏู ุงุฒ context ูุง ุจุงุฒุงุจโุดุฏู ุงูุชุฎุงุจ ุฎูุงูุฏ ุดุฏ.<br>

ุฌุฏูู ฒ ูุชุงุฌ ุงุฑุฒุงุจ ูุฏูโูุง ุฒุจุงู ูุญู ุฑุง ุฏุฑ ุชุฑฺฉุจ ุจุง ูุฏู ุฌุงููุง allโmpnetโbaseโv2 (ุฑุฒุชูุธูโุดุฏู ุจุง ูพฺฉุฑุจูุฏ 17 TB + G + SNS) ูุดุงู ูโุฏูุฏ:


|     ูุงู ูุฏู                         |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|-------------------------------------|--------------------------|---------------------|-------------------------|
|     DeepSeek-R1-Distill-Llama-8B    |     0.268                |     0.506           |     **0.837**               |
|     Falcon-7b                       |     0.268                |     0.445           |     0.624               |
|     gemma-2-2b-it                   |     0.268                |     0.566           |     0.625               |
|     gemma-3-4b-it                   |     0.268                |     0.658           |     0.565               |
|     Meta-Llama-2-7b                 |     0.268                |     0.499           |     0.692               |
|     Meta-Llama-3-8B                 |     0.268                |     0.539           |     0.655               |
|     Meta-Llama-3.1-8B               |     0.268                |     0.512           |     0.748               |
|     Mistral-7b-v0.3-Original        |     0.268                |     0.543           |     0.738               |
|     Olmo-3-1025-7B                  |     0.268                |     0.556           |     0.827               |
|     Phi-2                           |     0.268                |     0.510           |     0.738               |
|     Phi-3-mini-4k-instruct          |     0.268                |     0.609           |     0.752               |
|     Phi-4-mini-instruct             |     0.268                |     0.623           |     0.744               |
|     Qwen1.5-4B                      |     0.268                |     0.608           |     0.753               |
|     Qwen2.5-3B                      |     0.268                |     0.611           |     0.817               |
|     Qwen3-4B                        |     0.268                |     **0.674**           |     0.684               |



<sub> ุฌุฏูู ฒ - ูุชุงุฌ ุงุฑุฒุงุจ ูุฏูโูุง ุฒุจุงู ูุญู ุจุง ูุฏู ุฌุงููุง all mpnet base v2 (ุฑุฒุชูุธูโุดุฏู ุจุง ูพฺฉุฑุจูุฏ 17TB + G + SNS)</sub>


<br>

ูุฎุณุชู ูฺฉุชู ูุงุจู ูุดุงูุฏู ุฏุฑ ุฌุฏูู ูููุ ฺฉุณุงู ุจูุฏู ููุฏุงุฑ Context Relevancy (CR) ุจุฑุง ุชูุงู ูุฏูโูุง ุฒุจุงู ุงุณุช. ุนูุช ุงุตู ุงู ููุถูุน ุขู ุงุณุช ฺฉู ุฏุฑ ุงู ุขุฒูุงุดุ ุชูุงู ูุฏูโูุง ุงุฒ ฺฉ ูุฏู ุฌุงููุง ุซุงุจุช ุจุฑุง ุจุงุฒุงุจ ูุทุนุงุช ูุนูุง ุงุณุชูุงุฏู ฺฉุฑุฏูโุงูุฏุ ุจูุงุจุฑุงูุ context ูุง ุงุฑุงุฆูโุดุฏู ุจู ูุฏูโูุง ุฒุจุงู ฺฉุณุงู ุจูุฏู ู ููุฏุงุฑ CR ุชุบุฑ ููโฺฉูุฏ.
<br>

ุจุง ุชูุฌู ุจู ุชุตูุฑ ฑน ู ุฑุงุจุทู ูุงู ุณู ูุนุงุฑ ุงุฑุฒุงุจุ ุจุฑุง ุงูุชุฎุงุจ ููุงุณุจโุชุฑู ูุฏู ุฒุจุงู ุฏุฑ ุนููุงุช RAGุ ูุนุงุฑูุง ุฒุฑ ุงููุช ุจุดุชุฑ ุฏุงุฑูุฏ:<br>
&nbsp;&nbsp;&nbsp; ฑ) Answer Relevance (AR): ูุฒุงู ุงุฑุชุจุงุท ูพุงุณุฎ ูุฏู ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ<br>
&nbsp;&nbsp;&nbsp; ฒ)Faithfulness  (F): ูุฒุงู ุงูุทุจุงู ูพุงุณุฎ ูุฏู ุจุง ุฏุงูุด ุฒููู ุจุงุฒุงุจโุดุฏู

<br>
ุงุฒ ุขูุฌุง ฺฉู CR ุฏุฑ ุงู ุขุฒูุงุด ุซุงุจุช ุงุณุชุ ุฏู ูุนุงุฑ ููู ููุด ุชุนูโฺฉููุฏูโุชุฑ ุฏุฑ ููุงุณู ูุฏูโูุง ุงูุง ูโฺฉููุฏ.
<br>

ุจูโููุธูุฑ ุชุนู ูุฒู ู ุงููุช ูุณุจ ูุฑ ูุนุงุฑ ู ููุงุณู ุฏูู ุนููฺฉุฑุฏ ูุฏูโูุงุ ูุดุงุจู ุฑูุด ููุณูุฏฺฏุงู ููุงููุ ุงุฒ ุชุญูู ูุงุฑุงูุณ (ANOVA) ู ุขุฒููู Tukey HSD ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ุฑูุดโูุง ุงูฺฉุงู ููุงุณู ูุนูุงุฏุงุฑ ูุงู ูุฏูโูุง ุฑุง ูุฑุงูู ฺฉุฑุฏู ู ูุดุฎุต ูโุณุงุฒูุฏ ฺฉุฏุงู ูุฏูโูุง ุงุฒ ูุธุฑ ุขูุงุฑ ุนููฺฉุฑุฏ ุจูุชุฑ ูุณุจุช ุจู ุณุงุฑู ุฏุงุฑูุฏ.

<br>


### ุขุฒููู ุขูุงุฑ ANOVA
ุชุญูู ูุงุฑุงูุณ (Analysis of Variance, ANOVA) ฺฉ ุงุฒ ุฑูุดโูุง ุขูุงุฑ ฺฉูุงุณฺฉ ุจุฑุง ุจุฑุฑุณ ุชูุงูุช ูุงูฺฏูโูุง ุฏุฑ ฺูุฏ ุฌุงูุนู ุขูุงุฑ ูุณุชูู ุงุณุช. ุงู ุขุฒููู ูุดุฎุต ูโุณุงุฒุฏ ฺฉู ุขุง ุชูุงูุช ูุดุงูุฏูโุดุฏู ูุงู ฺฏุฑููโูุง ุตุฑูุงู ูุงุด ุงุฒ ููุณุงูุงุช ุชุตุงุฏู ุงุณุช ุง ุงุฒ ูุธุฑ ุขูุงุฑ ูุนูุงุฏุงุฑ ุจูุฏู ู ุจุงูฺฏุฑ ูุฌูุฏ ุงุฎุชูุงู ูุงูุน ูุงู ฺฏุฑููโูุง ูโุจุงุดุฏ.<br>

ุฏุฑ ุงู ฺฏุฒุงุฑุดุ ุจูโููุธูุฑ ุจุฑุฑุณ ูุฌูุฏ ุชูุงูุช ูุนูุงุฏุงุฑ ูุงู ุนููฺฉุฑุฏ ูุฏูโูุง ุฒุจุงู ูุฎุชููุ ุงุฒ ุขุฒููู ุขูุงุฑ ANOVA ฺฉโุทุฑูู [^61] ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุฏุฑ ุงู ุขุฒููู:<br>


&nbsp;&nbsp;&nbsp;โข	ูุชุบุฑูุง ูุงุจุณุชู ุดุงูู ุณู ูุนุงุฑ ุงุตู ุงุฑุฒุงุจุ ุนู:<br>
&nbsp;&nbsp;&nbsp;ฑ) Faithfulness (ููุงุฏุงุฑ ุจู ูุชู)<br>
&nbsp;&nbsp;&nbsp;ฒ) Answer Relevance (ุงุฑุชุจุงุท ูพุงุณุฎ ุจุง ูพุฑุณุด)<br>
&nbsp;&nbsp;&nbsp;ณ) Context Relevancy (ุงุฑุชุจุงุท ุฒููู)<br>

&nbsp;&nbsp;&nbsp;โข	ูุชุบุฑ ูุณุชูู ููุน ูุฏู ุฒุจุงู ููุฑุฏ ุงุณุชูุงุฏู ุฏุฑ ูุนูุงุฑ RAG ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช.<br>

ุจูโฺฉุงุฑฺฏุฑ ุงู ุขุฒููู ุงูฺฉุงู ุจุฑุฑุณ ุชูุงูุชโูุง ูุนูุงุฏุงุฑ ูุงู ูุฏูโูุง ุฑุง ูุฑุงูู ูโุณุงุฒุฏ ู ูุดุฎุต ูโฺฉูุฏ ฺฉู ฺฉุฏุงู ูุฏูโูุง ุงุฒ ูุธุฑ ุขูุงุฑ ุนููฺฉุฑุฏ ุจูุชุฑ ูุณุจุช ุจู ุณุงุฑู ุฏุงุฑูุฏ. ุฏุฑ ุงุฏุงููุ ุจุฑุง ุชุญูู ุฏููโุชุฑ ุชูุงูุชโูุงุ ุงุฒ ุขุฒููู ุชฺฉูู Tukey HSD ูุฒ ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ [30].<br>


ุฏุฑ ุงู ฺฏุฒุงุฑุด ูุญูู  ูุญุงุณุจู  ุงู ูุนุงุฑ ุงุฑุฒุงุจ ุจู ุตูุฑุช ุฎูุงุตู ุดุงูู ูุฑุงุญู ุฒุฑ ุงุณุช:<br>
&nbsp;&nbsp;&nbsp;ฑ) ูุญุงุณุจู ูุงูฺฏู ูุฑ ฺฏุฑูู: ุงุจุชุฏุง ูุงูฺฏู ููุฏุงุฑ ูุฑ ูุนุงุฑ ุงุฑุฒุงุจ ุจุฑุง ูุฑ ูุฏู ูุญุงุณุจู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;ฒ) ูุญุงุณุจู ูุงูฺฏู ฺฉู ุฏุงุฏูโูุง: ูุงูฺฏู ฺฉู ุชูุงู ูุดุงูุฏุงุชุ ุจุฏูู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ฺฏุฑููโุจูุฏ ูุฏูโูุงุ ูุญุงุณุจู 	ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;ณ) ูุญุงุณุจู ูุงุฑุงูุณ ุจู ฺฏุฑููโูุง: ุงู ููุฏุงุฑ ูุดุงู ูโุฏูุฏ ฺฉู ูุงูฺฏู ุนููฺฉุฑุฏ ูุฏูโูุง ุชุง ฺู ุญุฏ ุจุง ฺฉุฏฺฏุฑ 	ุชูุงูุช ุฏุงุฑูุฏ. (SS: Sum of Squares)
<br>

$$
SS_{\text{between}} = \sum_i n_i \, \big( \bar{x} - \bar{x}_i \big)^2
$$

<br>

&nbsp;&nbsp;&nbsp;ด) ูุญุงุณุจู ูุงุฑุงูุณ ุฏุฑูู ฺฏุฑููโูุง: ุงู ููุฏุงุฑ ุจุงูฺฏุฑ ูุฒุงู ูพุฑุงฺฉูุฏฺฏ ุฏุงุฏูโูุง ุฏุฑ ุฏุงุฎู ูุฑ ูุฏู ุงุณุช.

<br>

$$
SS_{\text{within}} = \sum_{i} \sum_{j} \, \big( \bar{x}_i - \bar{x}_{ij} \big)^2
$$

<br>

&nbsp;&nbsp;&nbsp;ต) ูุญุงุณุจู ุขูุงุฑู F: ุขูุงุฑู F ุงุฒ ูุณุจุช ูุงุฑุงูุณ ุจู ฺฏุฑููโูุง ุจู ูุงุฑุงูุณ ุฏุฑูู ฺฏุฑููโูุง ุจูโุฏุณุช ูโุขุฏ. 	(MS: Mean Square)<br>

<br>

$$
F = \frac{MS_{\text{between}}}{MS_{\text{within}}}
$$

<br>

&nbsp;&nbsp;&nbsp;ถ) ูุญุงุณุจู ููุฏุงุฑ p-value: ููุฏุงุฑ p-value ูุดุงู ูโุฏูุฏ ฺฉู ูุดุงูุฏู ฺูู ููุฏุงุฑ Fุ ุฏุฑ ุตูุฑุช ุฏุฑุณุช 	ุจูุฏู ูุฑุถ ุตูุฑ (ุจุฑุงุจุฑ ุจูุฏู ูุงูฺฏูโูุง)ุ ุจุง ฺู ุงุญุชูุงู ุฑุฎ ูโุฏูุฏ.<br>
p-value ุจูโุตูุฑุช ุงุญุชูุงู ูุฑุงุฑ ฺฏุฑูุชู ุขูุงุฑูโ F ุชุตุงุฏู ุฏุฑ ูุงุญูโ ุฏูู ุฑุงุณุช ุชูุฒุน F ูุญุงุณุจู ูโุดูุฏ:

<br>

$$
p\text{-value} = P \big( F_{\text{random}} \geq F_{\text{observed}} \big)
$$

<br>

ุชูุณุฑ ูุชุงุฌ ุขุฒููู:<br>
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ููุฏุงุฑ p-value < 0.05 ุจุงุดุฏุ ุงุฎุชูุงู ูุงูฺฏูโูุง ูุนูุงุฏุงุฑ ุชูู ุดุฏู ู ุญุฏุงูู ฺฉ ุงุฒ ูุฏูโูุง ุนููฺฉุฑุฏ ูุชูุงูุช ุฏุงุฑุฏ.
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ููุฏุงุฑ p-value โฅ 0.05 ุจุงุดุฏุ ุงุฎุชูุงู ูุดุงูุฏูโุดุฏู ูุนูุงุฏุงุฑ ูุจูุฏู ู ุชูุงูุชโูุง ุจู ููุฒ ุฏุงุฏูโูุง ูุณุจุช ุฏุงุฏู ูโุดููุฏ.

<br>

ฺฉุฏ ูุญุงุณุจู ุงู ุขุฒููู ุจู ุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ:
```python
metrics = ["faithfulness", "answer_relevancy", "context_relevancy"]
anova_results = {}

print("\n================ ANOVA RESULTS ================\n")

for metric in metrics:
    model = ols(f'{metric} ~ C(model)', data=full_df).fit()
    anova_table = sm.stats.anova_lm(model, typ=2)
    anova_results[metric] = anova_table
    print(f"\n--- ANOVA for {metric} ---\n")
    print(anova_table)
```

<br>

### ุขุฒููู ุชูฺฉ HSD Tukey

ุฏุฑ ุขุฒููู ุชุญูู ูุงุฑุงูุณ (ANOVA)ุ ููุฏุงุฑ p value ูุดุงู ูโุฏูุฏ ฺฉู ุขุง ุชูุงูุช ูุนูุงุฏุงุฑ ูุงู ูุงูฺฏูโูุง ฺฏุฑููโูุง ููุฑุฏ ุจุฑุฑุณ ูุฌูุฏ ุฏุงุฑุฏ ุง ุฎุฑ. ุจุง ุงู ุญุงูุ ุงู ุขุฒููู ูุดุฎุต ููโุณุงุฒุฏ ฺฉู ุชูุงูุช ูุนูุงุฏุงุฑ ุฏููุงู ูุงู ฺฉุฏุงู ฺฏุฑููโูุง ุฑุฎ ุฏุงุฏู ุงุณุช. ุงุฒ ุงู ุฑูุ ูุงุฒู ุงุณุช ูพุณ ุงุฒ ANOVA ฺฉ ุขุฒููู ุชุนูุจ [^62] ุงุฌุฑุง ุดูุฏ ุชุง ุฒูุฌ ฺฏุฑููโูุง ฺฉู ุงุฎุชูุงู ูุงูฺฏู ุขูโูุง ุงุฒ ูุธุฑ ุขูุงุฑ ูุงุจู ุชูุฌู ุงุณุช ุดูุงุณุง ุดููุฏ [31]. <br>

ฺฉ ุงุฒ ุฑุงุฌโุชุฑู ุขุฒูููโูุง ุชุนูุจุ ุขุฒููู Tukey HSD  (Honestly Significant Difference) ุงุณุช. ุงู ุขุฒููู ุจูโุทูุฑ ฺฉู ุงุฎุชูุงู ูุงูฺฏู ูุฑ ุฏู ฺฏุฑูู ุฑุง ูุญุงุณุจู ฺฉุฑุฏู ู ุขู ุฑุง ุจุง ฺฉ ุขุณุชุงูู ุขูุงุฑ ูุดุฎุต ููุงุณู ูโฺฉูุฏ. ุงฺฏุฑ ุงุฎุชูุงู ูุงูฺฏูโูุง ุงุฒ ุงู ุขุณุชุงูู ุจุดุชุฑ ุจุงุดุฏุ ุชูุงูุช ูุงู ุขู ุฏู ฺฏุฑูู ูุนูุงุฏุงุฑ ุชูู ูโุดูุฏ. <br>

ุจูโฺฉุงุฑฺฏุฑ ุขุฒููู Tukey HSD ุฏุฑ ุงู ฺฏุฒุงุฑุด ุงูฺฉุงู ูโุฏูุฏ ุชุง ุนูุงูู ุจุฑ ุดูุงุณุง ูุฌูุฏ ุชูุงูุช ฺฉู ูุงู ูุฏูโูุง (ุงุฒ ุทุฑู ANOVA)ุ ูุดุฎุต ุดูุฏ ฺฉู ฺฉุฏุงู ูุฏูโูุง ุฒุจุงู ุฏุฑ ููุงุณู ุฒูุฌ ุนููฺฉุฑุฏ ุจูุชุฑ ุฏุงุดุชู ู ุงุฎุชูุงู ุขูโูุง ุงุฒ ูุธุฑ ุขูุงุฑ ูุนุชุจุฑ ุงุณุช. ุงู ุฑูฺฉุฑุฏุ ุชุญูู ูุชุงุฌ ุฑุง ุฏููโุชุฑ ู ูุงุจู ุงุชฺฉุงุชุฑ ูโุณุงุฒุฏ. <br>

ุงฺฏุฑ 
$
HSD > \big| \bar{x}_i - \bar{x}_j \big|
$
ุจุงุดุฏ.
<br>
ุขูฺฏุงู: 	ุชูุงูุช ูุนูุงุฏุงุฑ ุฎูุงูุฏ ุจูุฏ.

<br>

ุฏุฑ ุฎุฑูุฌ ูุฑูโุงูุฒุงุฑุ ูุชุฌู  ุขุฒููู ูุนูููุงู ุจุง ุณุชูู `reject` ููุงุด ุฏุงุฏู ูโุดูุฏ:<br>
โข	`reject = True`: ุชูุงูุช ูุนูุงุฏุงุฑ<br>
โข	`reject = False`: ุชูุงูุช ุบุฑูุนูุงุฏุงุฑ<br>

ฺฉุฏ ุขู ุจู ุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ:<br>
```python
tukey_results = {}

print("\n================ TUKEY HSD RESULTS ================\n")

for metric in metrics:
    tukey = pairwise_tukeyhsd(
        endog=full_df[metric],
        groups=full_df['model'],
        alpha=0.05
    )
    tukey_results[metric] = tukey
    print(f"\n--- Tukey HSD for {metric} ---\n")
    print(tukey)
```
<br>

ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ฺฉุฏ ูุง ุงุฑุฒุงุจ ูููุ ูุงุฒู ุงุณุช ุฏุฑ ุงุจุชุฏุง ฺฉุชุงุจุฎุงูู `statsmodels` ุจู ฺฉูฺฉ ุฏุณุชูุฑ `pip install statsmodels` ุฏุฑ ูุญุท ฺฉุฏููุณ ุฏุฑุงูุช ู ูุตุจ ุดูุฏ. ุณูพุณ ุฏุฑ ุงุจุชุฏุง ฺฉุฏุ ููุงููุฏ ุฒุฑ ูุนุงุฑ ูุง ุงุฑุฒุงุจ ูุฑุงุฎูุงู ูโุดููุฏ:
```python
import statsmodels.api as sm 
from statsmodels.formula.api import ols 
from statsmodels.stats.multicomp import pairwise_tukeyhsd
```
<br>

#### ูุชุงุฌ ุขุฒููู ANOVA
ูุชุงุฌ ุญุงุตู ุงุฒ ุชุญูู ูุงุฑุงูุณ (ANOVA) ุจุฑุง ุณู ูุนุงุฑ ุงุตู ุงุฑุฒุงุจ ุจู ุดุฑุญ ุฒุฑ ุงุณุช:
```terminal

================ ANOVA RESULTS ================

--- ANOVA for faithfulness ---

sum_sq     df         F    PR(>F)
C(model)    3.034176   15.0  1.163095  0.295652
Residual  136.348528  784.0       NaN       NaN

--- ANOVA for answer_relevancy ---

sum_sq     df         F        PR(>F)
C(model)   4.605791   15.0  4.145108  2.216377e-07
Residual  58.075532  784.0       NaN           NaN

--- ANOVA for context_relevancy ---

sum_sq     df             F  PR(>F)
C(model)  1.095824e-28   15.0  1.894096e-28     1.0
Residual  3.023872e+01  784.0           NaN     NaN

```
ฑ. ูุนุงุฑ Faithfulness:<br>
&nbsp;&nbsp;&nbsp;โข	ููุฏุงุฑ ุขูุงุฑู  F โ 1.16<br>
&nbsp;&nbsp;&nbsp;โข	ููุฏุงุฑ  p value โ 0.295 (p > 0.05)
<br>

ุงุฒ ุขูุฌุง ฺฉู ููุฏุงุฑ p ุจุฒุฑฺฏโุชุฑ ุงุฒ ุณุทุญ ุฎุทุง ูุชุนุงุฑู (0.05) ุงุณุชุ ูโุชูุงู ูุชุฌู ฺฏุฑูุช ฺฉู ุชูุงูุช ูุนูุงุฏุงุฑ ูุงู ูุงูฺฏูโูุง ูุฏูโูุง ูุฎุชูู ุงุฒ ูุธุฑ ูุนุงุฑ Faithfulness ูุฌูุฏ ูุฏุงุฑุฏ. ุจู ุจุงู ุฏฺฏุฑุ ุนููฺฉุฑุฏ ูุฏูโูุง ุฏุฑ ุงู ูุนุงุฑ ุชูุฑุจุงู ูุดุงุจู ุจูุฏู ู ุงุฎุชูุงู ูุดุงูุฏูโุดุฏู ูุงุด ุงุฒ ููุณุงูุงุช ุชุตุงุฏู ุงุณุช.

<br>

ฒ. ูุนุงุฑ Answer Relevance:<br>
&nbsp;&nbsp;&nbsp;โข	ููุฏุงุฑ ุขูุงุฑู F โ 4.15<br>
&nbsp;&nbsp;&nbsp;โข	ููุฏุงุฑ p value โ 2.2 ร 10โปโท (p โช 0.05)
<br>

ุฏุฑ ุงู ุญุงูุชุ ููุฏุงุฑ p ุจุณุงุฑ ฺฉูฺฺฉโุชุฑ ุงุฒ ุณุทุญ ุฎุทุง ูุชุนุงุฑู ุงุณุช ู ุจูุงุจุฑุงู ุชูุงูุช ูุงูฺฏูโูุง ุงุฒ ูุธุฑ ุขูุงุฑ ูุนูุงุฏุงุฑ ุชูู ูโุดูุฏ. ุงู ูุชุฌู ูุดุงู ูโุฏูุฏ ฺฉู ุญุฏุงูู ุฎุฑูุฌ ฺฉ ูุฏู ุฒุจุงู ุงุฒ ูุธุฑ ุงุฑุชุจุงุท ูพุงุณุฎ ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑุ ุชูุงูุช ูุงุจู ุชูุฌู ุจุง ุณุงุฑ ูุฏูโูุง ุฏุงุฑุฏ. ูุฐุง ูุนุงุฑ Answer Relevance ููุด ฺฉูุฏ ุฏุฑ ุชูุงุฒ ุนููฺฉุฑุฏ ูุฏูโูุง ุงูุง ูโฺฉูุฏ.

<br>

ณ. ูุนุงุฑ Context Relevancy:<br>
&nbsp;&nbsp;&nbsp;โข	ููุฏุงุฑ ุขูุงุฑู F โ 0<br>
&nbsp;&nbsp;&nbsp;โข	ููุฏุงุฑ p value = 1.0
<br>

ุงู ูุชุงุฌ ุจุงูฺฏุฑ ุขู ุงุณุช ฺฉู ูฺ ุชูุงูุช ูุงู ูุฏูโูุง ุงุฒ ูุธุฑ ูุนุงุฑ Context Relevancy ูุฌูุฏ ูุฏุงุฑุฏ. ุนูุช ุงุตู ุงู ููุถูุน ุขู ุงุณุช ฺฉู ุฏุฑ ุงู ุขุฒูุงุดุ ุชูุงู ูุฏูโูุง ุฒุจุงู ุงุฒ ฺฉ ูุฏู ุฌุงููุง ุซุงุจุช ุจุฑุง ุจุงุฒุงุจ ูุทุนุงุช ูุนูุง ุงุณุชูุงุฏู ฺฉุฑุฏูโุงูุฏุ ุจูุงุจุฑุงู context ูุง ูุฑูุฏ ุจู ูุฏูโูุง ฺฉุณุงู ุจูุฏู ู ุงุฎุชูุงู ุฏุฑ ุงู ูุนุงุฑ ูุดุงูุฏู ููโุดูุฏ.

<br>

#### ุฌูุนโุจูุฏ:
ุจูโุทูุฑ ุฎูุงุตูุ ูุชุงุฌ ุขุฒููู ANOVA ูุดุงู ูโุฏูุฏ ฺฉู:<br>
&nbsp;&nbsp;&nbsp;โข	ูุนุงุฑ Faithfulness: ุชูุงูุช ูุนูุงุฏุงุฑ ูุงู ูุฏูโูุง ูุดุงู ููโุฏูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุนุงุฑ Answer Relevance: ุชูุงูุช ูุนูุงุฏุงุฑ ูุงู ูุฏูโูุง ุฑุง ุขุดฺฉุงุฑ ูโุณุงุฒุฏ ู ูโุชูุงูุฏ ูุจูุง ุงูุชุฎุงุจ ุจูุชุฑู ูุฏู ุฒุจุงู ุจุงุดุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุนุงุฑ Context Relevancy: ุจู ุฏูู ฺฉุณุงู ุจูุฏู context ูุง ูุฑูุฏุ ุชูุงูุช ูุงู ูุฏูโูุง ูุดุงู ููโุฏูุฏ.
<br>

ุฏุฑ ุงุฏุงููุ ุจุฑุง ุดูุงุณุง ุฏูู ุฒูุฌ ูุฏูโูุง ฺฉู ุงุฎุชูุงู ูุนูุงุฏุงุฑ ุฏุฑ ูุนุงุฑ Answer Relevance ุฏุงุฑูุฏุ ุงุฒ ุขุฒููู ุชุนูุจ Tukey HSD ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ.

<br>

#### ูุชุงุฌ ุขุฒููู Tukey HSD
ุจูโููุธูุฑ ุชฺฉูู ุชุญูู ูุงุฑุงูุณ (ANOVA)ุ ุขุฒููู ุชุนูุจ Tukey HSD ุจุฑุง ููุงุณู ุฒูุฌ ูุงูฺฏูโูุง ูุฏูโูุง ุฒุจุงู ุงุฌุฑุง ุดุฏ. ุงู ุขุฒููู ูุดุฎุต ูโฺฉูุฏ ฺฉู ุงุฎุชูุงู ูุงูฺฏู ุนููฺฉุฑุฏ ุฏู ูุฏู ุงุฒ ูุธุฑ ุขูุงุฑ ูุนูุงุฏุงุฑ ุงุณุช ุง ุฎุฑ. <br>

ุจูโุนููุงู ูููููุ ูุชุงุฌ ููุงุณู ุฎุฑูุฌ ูุฏู `Meta Llama 3.1 8B` ุจุง ุณุงุฑ ูุฏูโูุง ุฒุจุงู ุฏุฑ ูุนุงุฑ Faithfulness ุฏุฑ ุฌุฏูู ุฒุฑ ุงุฑุงุฆู ุดุฏู ุงุณุช:
```terminal

================ TUKEY HSD RESULTS ================

--- Tukey HSD for faithfulness ---

Multiple Comparison of Means - Tukey HSD, FWER=0.05
=======================================================================
group1           group2      meandiff p-adj   lower  upper  reject
-----------------------------------------------------------------------
Llama-3_1_test1 Mistral-7b_test1    0.004    1.0 -0.2827 0.2907  False
Llama-3_1_test1   deepseek_test1  -0.0333    1.0   -0.32 0.2534  False
Llama-3_1_test1  falcon-7b_test1  -0.0934 0.9992 -0.3801 0.1933  False
Llama-3_1_test1    gemma-2_test1   0.0273    1.0 -0.2594  0.314  False
Llama-3_1_test1    gemma-3_test1   0.1193 0.9889 -0.1674  0.406  False
Llama-3_1_test1    llama-2_test1  -0.0394    1.0 -0.3261 0.2473  False
Llama-3_1_test1    llama-3_test1  -0.0268    1.0 -0.3135 0.2599  False
Llama-3_1_test1     olmo-3_test1   0.0173    1.0 -0.2694  0.304  False
Llama-3_1_test1      phi-2_test1  -0.0286    1.0 -0.3153 0.2581  False
Llama-3_1_test1      phi-3_test1   0.0698    1.0 -0.2169 0.3565  False
Llama-3_1_test1      phi-4_test1   0.0837 0.9998  -0.203 0.3704  False
Llama-3_1_test1    qwen1_5_test1   0.0695    1.0 -0.2172 0.3562  False
Llama-3_1_test1    qwen2_5_test1   0.0725    1.0 -0.2142 0.3592  False
Llama-3_1_test1      qwen3_test1   0.1354 0.9639 -0.1513 0.4221  False
```
ุชุญูู ูุชุงุฌ:<br>
&nbsp;&nbsp;&nbsp;โข	ููุงูโุทูุฑ ฺฉู ูุดุงูุฏู ูโุดูุฏุ ุฏุฑ ุชูุงู ููุงุณูโูุง ููุฏุงุฑ `reject = False` ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ุงู ุจุฏุงู ูุนูุงุณุช ฺฉู ุฏุฑ ูุนุงุฑ Faithfulnessุ ูฺ ุงุฎุชูุงู ูุนูุงุฏุงุฑ ูุงู ูุฏูโูุง ูุฌูุฏ ูุฏุงุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑุฑุณ ุณุงุฑ ูุฏูโูุง ูุฒ ููู ูุชุฌู ุฑุง ุชุฃุฏ ูโฺฉูุฏุ ุจูุงุจุฑุงูุ ุงุฎุชูุงู ูุงูฺฏูโูุง ุฏุฑ ุงู ูุนุงุฑ ุตุฑูุงู ูุงุด ุงุฒ ููุณุงูุงุช ุชุตุงุฏู ุจูุฏู ู ุชูุงูุช ุขูุงุฑ ูุงุจู ุชูุฌู ูุงู ูุฏูโูุง ูุดุงูุฏู ููโุดูุฏ.<br>

ูพุณ ุงุฒ ุงุฌุฑุง ุขุฒููู ANOVA ู ูุดุงูุฏู ูุฌูุฏ ุชูุงูุช ูุนูุงุฏุงุฑ ุฏุฑ ูุนุงุฑ Answer Relevanceุ ุขุฒููู ุชุนูุจ Tukey HSD ุจุฑุง ุดูุงุณุง ุฒูุฌ ูุฏูโูุง ฺฉู ุงุฎุชูุงู ูุงูฺฏู ุขูโูุง ุงุฒ ูุธุฑ ุขูุงุฑ ูุนุชุจุฑ ุงุณุชุ ุงุฌุฑุง ุดุฏ. ุจุฎุด ุงุฒ ูุชุงุฌ ููู ุจูโุตูุฑุช ููููู ุฏุฑ ุฌุฏูู ุฒุฑ ุงุฑุงุฆู ุดุฏู ุงุณุช:
```terminal

--- Tukey HSD for answer_relevancy ---

Multiple Comparison of Means - Tukey HSD, FWER=0.05
========================================================================
group1           group2      meandiff p-adj   lower   upper  reject
------------------------------------------------------------------------
falcon-7b_test1    qwen2_5_test1   0.1934 0.0345  0.0063  0.3805   True
gemma-2_test1     olmo-3_test1   0.2014 0.0208  0.0143  0.3885   True
gemma-3_test1    qwen2_5_test1   0.2522 0.0005  0.0651  0.4393   True
deepseek_test1  falcon-7b_test1  -0.2134 0.0094 -0.4005 -0.0262   True
deepseek_test1    gemma-2_test1  -0.2122 0.0101 -0.3993 -0.0251   True
```

ุชุญูู ูุชุงุฌ:<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ููุงุฑุฏ ูููุ ููุฏุงุฑ `reject = True` ูุดุงูโุฏููุฏู ูุฌูุฏ ุชูุงูุช ูุนูุงุฏุงุฑ ูุงู ุนููฺฉุฑุฏ ูุฏูโูุง ุฏุฑ ูุนุงุฑ Answer Relevance ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ุจูโุทูุฑ ูุดุฎุตุ ูุฏูโูุง ูุงููุฏ `DeepSeek R1 Distill Llama 8B` ู `Qwen2.5 3B` ุฏุฑ ููุงุณู ุจุง ุจุฑุฎ ูุฏูโูุง ุฏฺฏุฑ ุงุฎุชูุงู ุขูุงุฑ ูุงุจู ุชูุฌู ุฏุงุฑูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงู ูุชุงุฌ ุชุฃุฏ ูโฺฉูุฏ ฺฉู ูุนุงุฑ Answer Relevance ุชูุงูุง ุชูุงุฒ ูุงู ูุฏูโูุง ุฑุง ุฏุงุฑุฏ ู ูโุชูุงูุฏ ุจูโุนููุงู ุดุงุฎุต ุงุตู ุจุฑุง ุงูุชุฎุงุจ ุจูุชุฑู ูุฏู ุฒุจุงู ุฏุฑ ูุนูุงุฑ RAG ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑุฏ.<br>

ูุชุงุฌ ุขุฒููู Tukey HSD ุจุฑุง ูุนุงุฑ Context Relevancy ูุดุงู ูโุฏูุฏ ฺฉู ุฏุฑ ุชูุงู ููุงุณูโูุง ุฒูุฌ ูุงู ูุฏูโูุงุ ููุฏุงุฑ `meandiff = 0.0` ู ููุฏุงุฑ `reject = False` ุงุณุช.<br>

ุจูโุนููุงู ูููููุ ููุงุณู ูุฏู `MetaโLlamaโ3.1โ8B` ุจุง ุณุงุฑ ูุฏูโูุง ุฏุฑ ุฌุฏูู ุฒุฑ ุงุฑุงุฆู ุดุฏู ุงุณุช:

```terminal

--- Tukey HSD for context_relevancy ---

Multiple Comparison of Means - Tukey HSD, FWER=0.05
====================================================================
group1           group2      meandiff p-adj lower  upper reject
--------------------------------------------------------------------
Llama-3_1_test1 Mistral-7b_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1   deepseek_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1  falcon-7b_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1    gemma-2_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1    gemma-3_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1     gpt-4o_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1    llama-2_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1    llama-3_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1     olmo-3_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1      phi-2_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1      phi-3_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1      phi-4_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1    qwen1_5_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1    qwen2_5_test1      0.0   1.0 -0.135 0.135  False
Llama-3_1_test1      qwen3_test1      0.0   1.0 -0.135 0.135  False
```
ุชุญูู ูุชุงุฌ:<br>
&nbsp;&nbsp;&nbsp;โข	ููุฏุงุฑ `meandiff = 0.0` ูุดุงูโุฏููุฏู ุขู ุงุณุช ฺฉู ูุงูฺฏู ูุชุงุฌ ูุฏูโูุง ุฏุฑ ุงู ูุนุงุฑ ฺฉุงููุงู ฺฉุณุงู ุจูุฏู ู ูฺ ุงุฎุชูุงู ูุดุงูุฏู ููโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููุฏุงุฑ `reject = False` ุฏุฑ ุชูุงู ููุงุณูโูุง ุชุฃุฏ ูโฺฉูุฏ ฺฉู ูฺ ุชูุงูุช ูุนูุงุฏุงุฑ ูุงู ูุฏูโูุง ุงุฒ ูุธุฑ Context Relevancy ูุฌูุฏ ูุฏุงุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุงู ูุชุฌู ุจุง ุงูุชูโูุง ุขุฒููู ANOVA ููโุฎูุงู ุฏุงุฑุฏ ู ุนูุช ุงุตู ุขูุ ุงุณุชูุงุฏู ุชูุงู ูุฏูโูุง ุฒุจุงู ุงุฒ ฺฉ ูุฏู ุฌุงููุง ุซุงุจุช ุจุฑุง ุจุงุฒุงุจ context ูุง ุงุณุช.<br>

#### ุฌูุนโุจูุฏ:
ุจุง ุชูุฌู ุจู ูุชุงุฌ ูููุ ูุฑุถู ุจโุชุฃุซุฑ ุจูุฏู ูุนุงุฑ Context Relevancy ุฏุฑ ุงูุชุฎุงุจ ุจูุชุฑู ูุฏู ุฒุจุงู ูุญู ุฏุฑ ุขุฒูุงุด ูุฎุณุช ุงุซุจุงุช ูโุดูุฏ. ุจูุงุจุฑุงูุ ุจุฑุง ุฑุชุจูโุจูุฏ ูุฏูโูุง ู ุงูุชุฎุงุจ ุจูุชุฑู ฺฏุฒููุ ุชููุง ูุนุงุฑูุง            Answer Relevance  ู Faithfulness ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดููุฏ.

<br>

#### ุงูุชุงุฒ ุชุฑฺฉุจ (Weighted Score):
ุจูโููุธูุฑ ุชุฑฺฉุจ ุฏู ูุนุงุฑ Answer Relevance ู Faithfulness ู ุงูุนฺฉุงุณ ุงููุช ูุณุจ ุขูโูุงุ ุงุฒ ูุฒูโุฏู ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุจุฑ ุงุณุงุณ ูุชุงุฌ ูุงูฺฏูโูุง ู ุชุญูู ANOVAุ ูุฒู ูุนุงุฑ Answer Relevance ุจุดุชุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช. ูุฑููู ูุญุงุณุจู ุงูุชุงุฒ ุชุฑฺฉุจ ุจูโุตูุฑุช ุฒุฑ ุชุนุฑู ูโุดูุฏ:
```python
best_group_df["weighted_score"] = (
    0.3 * best_group_df["faithfulness"] +
    0.7 * best_group_df["answer_relevancy"]
)
best_group_ranked = best_group_df.sort_values("weighted_score", ascending=False)
```
&nbsp;&nbsp;&nbsp;โข	ูุฒู ูุนุงุฑ Faithfulness ุจุฑุงุจุฑ ุจุง 0.3 ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฒู ูุนุงุฑ Answer Relevance ุจุฑุงุจุฑ ุจุง 0.7 ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ุงูุชุงุฒ ุชุฑฺฉุจ ุจุฑุง ูุฑ ูุฏู ูุญุงุณุจู ุดุฏู ู ุณูพุณ ูุฏูโูุง ุจุฑ ุงุณุงุณ ุงู ุงูุชุงุฒ ุจูโุตูุฑุช ูุฒูู ุฑุชุจูโุจูุฏ ูโุดููุฏ.
<br>

ุงู ุฑูุด ุงูฺฉุงู ุงูุชุฎุงุจ ุจูุชุฑู ูุฏู ุฒุจุงู ูุญู ุฑุง ุจุฑ ุงุณุงุณ ุชุฑฺฉุจ ุฏู ูุนุงุฑ ฺฉูุฏ ูุฑุงูู ูโุณุงุฒุฏ ู ุงุฒ ุชุฃุซุฑ ูุนุงุฑ Context Relevancy ฺฉู ุฏุฑ ุงู ุขุฒูุงุด ุซุงุจุช ุจูุฏู ุงุณุช ุตุฑูโูุธุฑ ูโฺฉูุฏ.<br>


ุฑุชุจูโุจูุฏ ููุง ูุชุงุฌ ุขุฒูุงุด ฑ ุจู ุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ:


|     ูุงู ูุฏู                         |     Weighted Score    |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|-------------------------------------|-----------------------|--------------------------|---------------------|-------------------------|
|     Qwen2.5-3B                      |     0.756             |     0.268                |     0.611           |     0.817               |
|     Olmo-3-1025-7B                  |     0.745             |     0.268                |     0.556           |     0.827               |
|     DeepSeek-R1-Distill-Llama-8B    |     0.738             |     0.268                |     0.506           |     0.837               |
|     Qwen1.5-4B                      |     0.710             |     0.268                |     0.608           |     0.753               |
|     Phi-3-mini-4k-instruct          |     0.709             |     0.268                |     0.609           |     0.752               |
|     Phi-4-mini-instruct             |     0.708             |     0.268                |     0.623           |     0.744               |
|     Qwen3-4B                        |     0.681             |     0.268                |     0.674           |     0.684               |
|     Mistral-7b-v0.3-Original        |     0.679             |     0.268                |     0.543           |     0.738               |
|     Meta-Llama-3-8B                 |     0.677             |     0.268                |     0.539           |     0.655               |
|     Phi-2                           |     0.670             |     0.268                |     0.510           |     0.738               |
|     Meta-Llama-2-7b                 |     0.634             |     0.268                |     0.499           |     0.692               |
|     Meta-Llama-3.1-8B               |     0.620             |     0.268                |     0.512           |     0.748               |
|     gemma-2-2b-it                   |     0.607             |     0.268                |     0.566           |     0.625               |
|     gemma-3-4b-it                   |     0.593             |     0.268                |     0.658           |     0.565               |
|     Falcon-7b                       |     0.570             |     0.268                |     0.445           |     0.624               |



<sub> ุฌุฏูู ณ โ ูุชุงุฌ ููุง ุงุฑุฒุงุจ ูุฏูโูุง ุฒุจุงู ูุญู ุฏุฑ ุขุฒูุงุด ฑ </sub>


<br>

ุชุญูู ูุชุงุฌ ุฌุฏูู ณ:<br>

&nbsp;&nbsp;&nbsp;โข	ูุฏูโูุง ุฎุงููุงุฏู Qwen ุจูโุทูุฑ ูุงูฺฏู ุนููฺฉุฑุฏ ุจูุชุฑ ูุณุจุช ุจู ุณุงุฑ ูุฏูโูุง ุฏุฑ ุชููุฏ ูพุงุณุฎโูุง ุจุง ฺฉูุช ุฏุฑ ูุนูุงุฑ ููโุงูุฒุง RAG ูุดุงู ุฏุงุฏูโุงูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ูุงู ุขูโูุงุ ูุฏู `Qwen2.5 3B` ุจุง ุงูุชุงุฒ ุชุฑฺฉุจ 0.756 ุจูโุนููุงู ุจูุชุฑู ฺฏุฒูู ุดูุงุณุง ุดุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ฺฉูุงุฑ ุขูุ ูุฏูโูุง `Olmo 3 1025 7B` ู `DeepSeek R1 Distill Llama 8B` ูุฒ ุงุฒ ฺฉูุช ูุชูุงุฒ ู ูุงุจู ุชูุฌู ุจุฑุฎูุฑุฏุงุฑ ุจูุฏู ู ูโุชูุงููุฏ ุจูโุนููุงู ฺฏุฒููโูุง ุฌุงฺฏุฒู ุง ูฺฉูู ุฏุฑ ุขุฒูุงุดโูุง ุจุนุฏ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑูุฏ.<br>

#### ุฌูุนโุจูุฏ:
ุจุฑ ุงุณุงุณ ูุชุงุฌ ุฌุฏูู ณุ ูุฏู `Qwen2.5โ3B` ุจูโุนููุงู ฺฏุฒูู ุจุฑุชุฑ ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุขุฒูุงุดโูุง ุจุนุฏ ุงูุชุฎุงุจ ูโุดูุฏ. ูุงุฒู ุจู ุฐฺฉุฑ ุงุณุช ฺฉู ุงูุชุงุฒ ุชุฑฺฉุจ ุตุฑูุงู ููุด ุชุตููโุณุงุฒ ฺฉุงุฑุจุฑุฏ ุฏุงุดุชู ู ูุชุงุฌ ุงุณุชูุจุงุท ุขูุงุฑ ูุนุชุจุฑ ุจุฑ ุงุณุงุณ ุขุฒูููโูุง ANOVA ู Tukey HSD ฺฏุฒุงุฑุด ุดุฏูโุงูุฏ.

<br>

---
### ุขุฒูุงุด ุดูุงุฑู ฒ: ููุงุณู ุนููฺฉุฑุฏ ูุฏู ุฌุงููุง ุจุฑ ุงุณุงุณ ูพฺฉุฑุจูุฏ ููุงุจุน ุขููุฒุด ูุฎุชูู ุฏุฑ ููุงูู

ุฏุฑ ุงู ุขุฒูุงุดุ ูุทุงุจู ุจุง ูพฺฉุฑุจูุฏโูุง ุชุนุฑูโุดุฏู ุฏุฑ ููุงูู ุ ูุฏู ุฌุงููุง `allโmpnetโbaseโv2` ุจูโุงุฒุง ูุฑ ูพฺฉุฑุจูุฏ ุงุฌุงุฏ ู ุฑุฒุชูุธู ุดุฏ. ุณูพุณ ุจุฑุง ูุฑ ูพฺฉุฑุจูุฏ ูพุงฺฏุงู ุฏุงุฏู ูุณุชูู ุณุงุฎุชู ุดุฏ ู ุนููฺฉุฑุฏ ุขูโูุง ุฏุฑ ุชุฑฺฉุจ ุจุง ูุฏู ุฒุจุงู `Qwen2.5โ3B` ููุฑุฏ ุงุฑุฒุงุจ ูุฑุงุฑ ฺฏุฑูุช. ูุนุงุฑูุง ุงุตู ุงุฑุฒุงุจ ุดุงูู Answer Relevance (AR)ุ Faithfulness  (F) ู Context Relevancy  (CR) ุจูุฏูุฏ.<br>



|     ูพฺฉุฑ ุจูุฏ             |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|---------------------------|--------------------------|---------------------|-------------------------|
|     1. No FT              |     0.219                |     0.689           |     **0.840**               |
|     2. 5 TB               |     0.191                |     **0.700**           |     0.826               |
|     3. 17 TB              |     0.218                |     0.694           |     0.828               |
|     4. 5 TB + G           |     0.233                |     0.542           |     0.810               |
|     5. 17 TB + G          |     0.242                |     0.586           |     0.802               |
|     6. 17 TB + G + SNS    |     **0.268**                |     0.604           |     0.786               |

<sub>  ุฌุฏูู ด - ูุชุงุฌ ุงุฑุฒุงุจ ูุฏู ุฌุงููุง  all mpnet base v2ุจุง ุชูุฌู ุจู ูพฺฉุฑุจูุฏ ูุง ููุงูู (ูุฏู Qwen2.5-3B) </sub>


<br>



|     ูพฺฉุฑ ุจูุฏ             |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|---------------------------|--------------------------|---------------------|-------------------------|
|     1. No FT              |     0.302                |     0.687           |     0.888               |
|     2. 5 TB               |     0.337                |     0.658           |     0.871               |
|     3. 17 TB              |     **0.372**                |     **0.756**          |     0.902               |
|     4. 5 TB + G           |     0.062                |     0.198           |     0.790               |
|     5. 17 TB + G          |     0.335                |     0.740           |     **0.909**               |
|     6. 17 TB + G + SNS    |     0.339                |     0.701           |     0.902               |




<sub>   ุฌุฏูู ต - ูุชุงุฌ ุงุฑุฒุงุจ ูุฏู ุฌุงููุง  all mpnet base v2ุจุง ุชูุฌู ุจู ูพฺฉุฑุจูุฏ ูุง ููุงูู (ุฏููู ุฌุฏูู ููุงูู) </sub>

<br>

ุชุญูู ูุชุงุฌ:<br>
&nbsp;&nbsp;&nbsp;โข	ุจุฑ ุงุณุงุณ ุฌุฏูู ดุ ูพฺฉุฑุจูุฏ ุดูุงุฑู ถ (17 TB + G + SNS) ุจุงูุงุชุฑู ููุฑู ุฏุฑ ูุนุงุฑ Context Relevancy  (CR) ุฑุง ฺฉุณุจ ฺฉุฑุฏู ุงุณุช. ุงู ุงูุฑ ูุดุงู ูโุฏูุฏ ฺฉู ูุฏู ุฌุงููุง ุฏุฑ ุงู ูพฺฉุฑุจูุฏ ุจูุชุฑู ุนููฺฉุฑุฏ ุฑุง ุฏุฑ ุจุงุฒุงุจ context ู ุงุทูุงุนุงุช ูุฑุชุจุท ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ ุฏุงุฑุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููฺูู ุฏุฑ ูุงู ูพฺฉุฑุจูุฏโูุง ด ุชุง ถ (ูุฏูโูุง ฺฉู ุจุง ุฏุงุฏูโูุง ูพุดโูพุฑุฏุงุฒุดโุดุฏู ุชูุณุท GROBID ุฑุฒุชูุธู ุดุฏูโุงูุฏ)ุ ูพฺฉุฑุจูุฏ ุดูุงุฑู ถ ุจุงูุงุชุฑู ููุฑู Faithfulness ุฑุง ูุณุจุช ุจู ุฏู ููุฑุฏ ุฏฺฏุฑ ฺฉุณุจ ฺฉุฑุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ููุงุณู ุจุง ูุชุงุฌ ุซุจุชโุดุฏู ุชูุณุท ููุณูุฏฺฏุงู ููุงูู (ุฌุฏูู ต)ุ ูพฺฉุฑุจูุฏ ุดูุงุฑู ถ ุฏุฑ ุงู ุขุฒูุงุด ุนููฺฉุฑุฏ ุจูุชุฑ ุงุฒ ูุธุฑ CR ุฏุงุดุชู ุงุณุชุ ุฏุฑ ุญุงู ฺฉู ุฏุฑ ููุงูู ุฑุชุจู ุฏูู ุฑุง ฺฉุณุจ ฺฉุฑุฏู ุจูุฏ.

<br>

ุฌูุนโุจูุฏ:<br>
ุฏุฑ ูุชุฌูุ ูุฏู ุฌุงููุง `allโmpnetโbaseโv2` ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชู ฑท ฺฉุชุงุจ ูุฑุฌุน ุนููู ุฏุงุฏู ู ูพุณ ุงุฒ ูพุดโูพุฑุฏุงุฒุด ุชูุณุท GROBID ุฑุฒุชูุธู ุดุฏู ุงุณุช (ูพฺฉุฑุจูุฏ ถ: 17 TB + G + SNS) ุจูโุนููุงู ุจูุชุฑู ูุฏู ุจุฑุง ุจุงุฒุงุจ ุฏุฑ ูุงู ุดุด ูพฺฉุฑุจูุฏ ููุงูู ุงูุชุฎุงุจ ูโุดูุฏ. ุงู ูุฏู ุงุฒ ูุธุฑ ุงุฑุชุจุงุท ูุนูุง context ูุง ุจุงุฒุงุจโุดุฏู ู ูุฒุงู ููุงุฏุงุฑ ุจู ุฏุงูุด ุฒูููุ ุนููฺฉุฑุฏ ุจุฑุชุฑ ูุณุจุช ุจู ุณุงุฑ ูพฺฉุฑุจูุฏโูุง ูุดุงู ุฏุงุฏู ุงุณุช.

<br>

---

### ุขุฒูุงุด ุดูุงุฑู ณ: ููุงุณู ุนููฺฉุฑุฏ ูุฏู ูุง ุฌุงููุง
ูพุณ ุงุฒ ุงูุชุฎุงุจ ุจูุชุฑู ูุฏู ุฒุจุงู ูุญู ุฏุฑ ุขุฒูุงุด ูุฎุณุช ู ุชุนู ุจูุชุฑู ูพฺฉุฑุจูุฏ ุฑุฒุชูุธู ูุฏู ุฌุงููุง ุฏุฑ ุขุฒูุงุด ุฏููุ ุฏุฑ ุณููู ุขุฒูุงุด ุชูุฑฺฉุฒ ุจุฑ ููุงุณู ุนููฺฉุฑุฏ ูุฏูโูุง ุฌุงููุง (Embedding Models) ูุฑุงุฑ ฺฏุฑูุชู ุงุณุช. ูุฏู ุงู ุขุฒูุงุด ุจุฑุฑุณ ฺฉูุช ุฎุฑูุฌ ุฏุงูุด ุจุงุฒุงุจโุดุฏู ุชูุณุท ูุฏู `all-mpnet-base-v2` ุฏุฑ ููุงุณู ุจุง ุณุงุฑ ูุฏูโูุง ุฎุงููุงุฏูโ Sentence Transformers ูโุจุงุดุฏ. <br>

ูุฏูโูุง ููุฑุฏ ุงุฑุฒุงุจ: <br>
&nbsp;&nbsp;&nbsp;โข	`all-mpnet-base-v2` (ูุฏู ูุฑุฌุน ููุงูู) <br>
&nbsp;&nbsp;&nbsp;โข	`all-MiniLM-L6-v2` (ูุฏู ุณุจฺฉโุชุฑ ู ุณุฑุนโุชุฑ) <br>
&nbsp;&nbsp;&nbsp;โข	`bge-base-en-v1.5` (ูุฏู ุฌุฏุฏุชุฑ ู ุญุฌูโุชุฑ) <br>


#### ุฑูุด ุขุฒูุงุด:
ููุงููุฏ ุขุฒูุงุด ุดูุงุฑู ฒุ ุจุฑุง ูุฑ ูุฏู ุฌุงููุง ฺฉ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุดุงูู ตฐฐฐ ููุงูู arXiv ุฏุฑ ChromaDB ุงุฌุงุฏ ุดุฏ. ุณูพุณ ุนููฺฉุฑุฏ ูุฑ ูุฏู ุฏุฑ ูุฑุขูุฏ ุจุงุฒุงุจ ุงุทูุงุนุงุช ูุนูุงุฑ RAG (ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู) ููุฑุฏ ุงุฑุฒุงุจ ูุฑุงุฑ ฺฏุฑูุช.

<br>



|     ูุงู ูุฏู   ุฌุงููุง       |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|-----------------------------|--------------------------|---------------------|-------------------------|
|     1. all-mpnet-base-v2    |     0.261                |     0.645           |     0.835               |
|     2. all-MiniLM-L6-v2     |     0.258                |     0.636           |     0.771               |
|     3. bge-base-en-v1.5     |     0.304                |     0.653           |     0.855               |


<sub> ุฌุฏูู ถ - ูุชุงุฌ ุงุฑุฒุงุจ ูพุงุณุฎ ูุนูุงุฑ RAG ูู ุงูุฒุง (ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู) ุจุฑ ุงุณุงุณ ุจุงุฒุงุจ ุงุทูุงุนุงุช ุชูุณุท ูุฏู ูุง ุฌุงููุง ูุฎุชูู</sub>


<br>

ุฏุฑ ุฌุฏูู ถ ููุงุฑุฏ ุฒุฑ ูุดุงูุฏู ูโุดูุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	ูุฏู `bge-base-en-v1.5` ุฏุฑ ูุฑ ุณู ูุนุงุฑ (ARุ Fุ CR) ุนููฺฉุฑุฏ ุจูุชุฑ ูุณุจุช ุจู ูุฏู `all-mpnet-base-v2` ู ูุฏู ุณุจฺฉโุชุฑ `all-MiniLM-L6-v2` ุฏุงุดุชู ุงุณุช.
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุจูุจูุฏ ุฏุฑ CR: ุญุฏูุฏ ฑถ.ด ุฏุฑุตุฏ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุจูุจูุฏ ุฏุฑ F: ุญุฏูุฏ ฑ.ฒ ุฏุฑุตุฏ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุจูุจูุฏ ุฏุฑ AR:โ ุญุฏูุฏ ฒ.ณ ุฏุฑุตุฏ<br>

<br>

&nbsp;&nbsp;&nbsp;โข	ูุฏู ุณุจฺฉโุชุฑ `all-MiniLM-L6-v2` ุฏุฑ ููุงุณู ุจุง ูุฏู ูุฑุฌุนุ ุนููฺฉุฑุฏ ุถุนูโุชุฑ ูุดุงู ุฏุงุฏู ุงุณุช:
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุงูุช ุฏุฑ CR: ุญุฏูุฏ ธ.ณ ุฏุฑุตุฏ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุงูุช ุฏุฑ F: ุญุฏูุฏ ฑ.ด ุฏุฑุตุฏ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุงูุช ุฏุฑ AR: ุญุฏูุฏ ฑ.ฑ ุฏุฑุตุฏ<br>

#### ุฌูุนโุจูุฏ:
&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ุณุฑุนุช ู ุณุจฺฉ ุจูุฏู ูุฏู ุฏุฑ ูุฑุขูุฏ ุฑุฒุชูุธูุ ุชููุฏ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ู ุจุงุฒุงุจ ุงุทูุงุนุงุช ููุงฺฉ ุจุงุดุฏุ ูุฏู `all-MiniLM-L6-v2` ุจุง ุญุฌู ฺฉูุชุฑ ุงุฒ ฺฉ ฺูุงุฑู ุณุงุฑ ูุฏูโูุง ู ุนููฺฉุฑุฏ ูุงูฺฏู ุญุฏูุฏ ณ.ต ุฏุฑุตุฏ ูพุงูโุชุฑุ ฺฏุฒููโุง ููุงุณุจ ูุญุณูุจ ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp;โข	ุงฺฏุฑ ฺฉูุช ุฎุฑูุฌ ุฏุฑ ุฑุฒุชูุธูุ ุฐุฎุฑูโุณุงุฒ ุจุฑุฏุงุฑ ู ุจุงุฒุงุจ ุงุทูุงุนุงุช ุฏุฑ ูุนูุงุฑ RAG ููุงฺฉ ุงุตู ุจุงุดุฏุ ูุฏู `bge-base-en-v1.5` ุจุง ูุฌูุฏ ุญุฌู ุชูุฑุจุงู ด ุจุฑุงุจุฑ ูุณุจุช ุจู ูุฏู ูุฑุฌุนุ ุจูุชุฑู ฺฏุฒูู ุจุฑุง ุงูุชุฎุงุจ ูุฏู ุฌุงููุง ุฎูุงูุฏ ุจูุฏ. <br>

ุจูุงุจุฑุงูุ ุฏุฑ ุงู ุขุฒูุงุดุ ูุฏู `bge-base-en-v1.5` ุจู ุนููุงู ูุฏู ุจุฑุชุฑ ุฏุฑ ุฌุงููุง ูุทุนุงุช ูุนูุง ุงูุชุฎุงุจ ูโุดูุฏ.

<br>

---
### ุขุฒูุงุด ุดูุงุฑู ด: ููุงุณู ุนููฺฉุฑุฏ ูพุฑุงููพุช ูุง ูุฎุชูู
ุฏุฑ ุงู ุขุฒูุงุดุ ูุดุงุจู ุงุฑุฒุงุจ ุตูุฑุชโฺฏุฑูุชู ุชูุณุท ููุณูุฏฺฏุงู ููุงููุ ุนููฺฉุฑุฏ ูพุฑุงููพุชโูุง ูุฎุชูู ุทุฑุงุญโุดุฏู ุจู ูุณูู ูููุฏุณ ุฏุณุชูุฑุงุช [^63] ุฏุฑ ูุนูุงุฑ RAG ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ูโฺฏุฑุฏ.

<br>

#### ุฌุงฺฏุงู ูููุฏุณ ุฏุณุชูุฑุงุช ุฏุฑ ุฑูฺฉุฑุฏูุง ููโุงูุฒุงุงูู
ูุทุงุจู ุชุนุฑู ููโุงูุฒุง (ุตูุญู ถ ููุงูู)ุ ูููุฏุณ ุฏุณุชูุฑุงุช ฺฉ ุงุฒ ุญูุฒูโูุง ุงุตู ุชุญููุงุช ุฏุฑ ุณุงูโูุง ุงุฎุฑ ุจู ุดูุงุฑ ูโุฑูุฏ. ูุฏู ุงู ุญูุฒู ุจุดููโุณุงุฒ ู ุจูููโุณุงุฒ ฺฉูุช ุงุณุชุฏูุงู ูุฏูโูุง ู ุฏุณุชุงุจ ุจู ูพุชุงูุณู ูุงูุน ุขูโูุง ุฏุฑ ุฏุฑฺฉ ูพุฑุณุดโูุง ู ูพุงุณุฎโุฏู ุฏูู ุงุณุช.
<br>

ููุณูุฏฺฏุงู ููุงูู ูพูุฌ ููุน ูพุฑุงููพุช ุฑุง ุฏุฑ ูุนูุงุฑ ูพุดููุงุฏ ุขุฒูุงุด ู ุงุฑุฒุงุจ ฺฉุฑุฏูโุงูุฏ:<br>
&nbsp;&nbsp;&nbsp;ฑ) ุฏุณุชูุฑ ูพุงู (Baseline Prompt): ุฏุณุชูุฑ ูพุดโูุฑุถ LangChain (ุจูโุนููุงู ุดุฑุท ฺฉูุชุฑู ุขุฒูุงุด).<br>
&nbsp;&nbsp;&nbsp;ฒ) ุฏุณุชูุฑ ููุด ุงุฑุชูุงุงูุชู (Role Enhanced Prompt): ุชุฃฺฉุฏ ุจุฑ ููุด ูุฏู ุจูโุนููุงู ุฏุณุชุงุฑ ูุชุฎุตุต ู ุฏุงุฑุง ุตูุงุญุช ุฏุฑ ูพุงุณุฎโฺฏู.<br>
&nbsp;&nbsp;&nbsp;ณ) ุฏุณุชูุฑ ฺูุฏ ูุฑุตุชู [^64] (Few shot Prompt): ุงุฑุงุฆู ุณู ูพุฑุณุด ู ูพุงุณุฎ ูููู (ููุชุฎุจ ุงุฒ ุขุฒูุงุดโูุง ฑ ุชุง ณ ู ุงุฑุฒุงุจโูุง RAGAS) ุจูโุนููุงู ูุซุงู ุฏุฑ ุฏุณุชูุฑุ ู ุฏุฑุฎูุงุณุช ูพุงุณุฎโฺฏู ุจู ูพุฑุณุดโูุง ูุดุงุจู.<br>
&nbsp;&nbsp;&nbsp;ด) ุฏุณุชูุฑ ุฒูุฌุฑู ูฺฉุฑ (Chain of Thought Prompt): ุชุฑุบุจ ูุฏู ุจู ุงุณุชุฏูุงู ูุฑุญููโุจูโูุฑุญูู ุจุฑ ุงุณุงุณ ุฏุงูุด ุฒููู ุจุงุฒุงุจโุดุฏู.<br>
&nbsp;&nbsp;&nbsp;ต) ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงู ุง ุงุญุณุงุณุงุช (Emotional Stimuli Prompt): ุงุณุชูุงุฏู ุงุฒ ุนูุงุตุฑ ูุดูู ู ูพุงุฏุงุดโุฏููุฏู ุจุฑุง ุชุฑุบุจ ูุฏู ุจู ูพุงุณุฎโฺฏู.

<br>

ูุทุงุจู ฺฏุฒุงุฑุด ููุณูุฏฺฏุงู (ุจุฎุด ด.ท ููุงูู)ุ ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงู (Emotional Stimuli Prompt) ุจูโุนููุงู ุจูุชุฑู ูพุฑุงููพุช ุฏุฑ ูุนูุงุฑ ููุง ูพุดููุงุฏ ุดุฏู ุงุณุช. ุงู ุฏุณุชูุฑ ุชูุงูุณุชู ุงุณุช ฺฉูุช ูพุงุณุฎโูุง ุฑุง ุฏุฑ ุณู ูุนุงุฑ ุงุตู (ุงุฑุชุจุงุท ูพุงุณุฎุ ููุงุฏุงุฑ ุจู ุฏุงูุด ุจุงุฒุงุจโุดุฏูุ ู ุงุฑุชุจุงุท ุฒูููโุง) ุจูุจูุฏ ุฏูุฏ. ุฏุฑ ูพุงุงู ุงู ุขุฒูุงุด ูุฒ ุจู ุชูุงุณุจ ฺฉุงุฑุจุฑุฏ ูพุดโูุฑุถ ุชุนุฑู ุดุฏู ุฏุฑ ฺฏุฒุงุฑุด (ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฒุจุงู ูุญู ุฏุฑ ูพุงุณุฎโฺฏู ุจู ุณูุงูุงุช) ฺฉ ุฏุณุชูุฑ ูพุดููุงุฏ ูโฺฏุฑุฏุฏ.

<br>

ุฏุณุชูุฑ ูุง ุขุฒูุงุด ุดุฏู (ูุทุงุจู ููุงูู) ุจู ุตูุฑุช ุฒุฑ ู ุจุงุดูุฏ:<br>
ฑ. ุฏุณุชูุฑ ูพุงู:
```python
# Baseline Prompt:
"""
You are an assistant for question-answering tasks.
Use the following pieces of the retrieved context to answer the question.
If you don't know the answer, just say that you don't know.
Use three sentences maximum and keep the answer concise.

"""
```
&nbsp;&nbsp;&nbsp;โข	ุณุงุฏฺฏ ู ุดูุงูุช: ูฺ ููุด ุง ูุซุงู ุงุถุงู ุจุฑุง ูุฏู ุชุนุฑู ูุดุฏูุ ููุท ูุธูู ูพุงุณุฎโฺฏู ุจู ูพุฑุณุด ุจุง ุงุณุชูุงุฏู ุงุฒ context ุจุงุฒุงุจโุดุฏู.<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉูุชุฑู ุขุฒูุงุด: ุจูโุนููุงู ูุจูุง ููุงุณู ุจุง ุณุงุฑ ูพุฑุงููพุชโูุง ุงุณุชูุงุฏู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุญุฏูุฏุช ูพุงุณุฎ: ุญุฏุงฺฉุซุฑ ุณู ุฌููู ู ูพุงุณุฎ ฺฉูุชุงู ู ููุฌุฒ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฏุฑุช ุนุฏู ูุทุนุช: ุงฺฏุฑ ูุฏู ูพุงุณุฎ ุฑุง ูุฏุงูุฏุ ุจุงุฏ ุตุฑุญุงู ุงุนูุงู ฺฉูุฏ ฺฉู ููโุฏุงูุฏ.

<br>

ฒ. ุฏุณุชูุฑ ููุด ุงุฑุชูุงุงูุชู:
```python
# Role-Enhanced Prompt:
"""
You are a domain expert assistant specialized in data science literature.
Answer the following question using the provided context. 
If you don't know the answer, say you don't know. 
Keep the answer concise, maximum three sentences.
"""
```

&nbsp;&nbsp;&nbsp;โข	ุชูุฑฺฉุฒ ููุด: ุฌูุชโุฏู ุจูุชุฑ ุจู ูพุงุณุฎโูุง ุฏุฑ ุญูุฒู ูุดุฎุต.<br>
&nbsp;&nbsp;&nbsp;โข	ูุฒุช: ฺฉุงูุด ูพุงุณุฎโูุง ุฎุงุฑุฌ ุงุฒ ุฏุงููู ู ุงูุฒุงุด ุฏูุช ุณุจฺฉ ูพุงุณุฎ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุนุงุจ: ุงฺฏุฑ context ูุงฺฉุงู ุจุงุดุฏุ ุงุญุชูุงู ยซุงุนุชูุงุฏ ุจู ููุณ ฺฉุงุฐุจยป ฺฉู ูโุดูุฏ ุงูุง ุตูุฑ ูุณุชุ ุจูุชุฑ ุงุณุช ููุฏ ุตุฑุญ ยซcite-to-contextยป ุงุถุงูู ุดูุฏ.<br>

<br>

ณ. ุฏุณุชูุฑ ฺูุฏ-ูุฑุตุชู:
```python
# Few-shot Prompt:
"""
You are an assistant for question-answering tasks.
Here are some examples of how to use context effectively:

{fsp_block}

Now answer the following question using the provided context.
If you don't know the answer, just say you don't know.
Use three sentences maximum.
"""
```
&nbsp;&nbsp;&nbsp;โข	ูุฒุช: ุงูุชูุงู ุงูฺฏู ูุทููุจ ูพุงุณุฎโฺฏู ู ุงุณุชูุงุฏู ุงุฒ contextุ ูุนูููุงู AR ู CR ุฑุง ุจูุจูุฏ ูโุฏูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูฺฉุชู ุงุฌุฑุง: ูุซุงูโูุง ุจุงุฏ ฺฉูุชุงูุ ูุฑุชุจุท ู ููุงุฏุงุฑ ุจุงุดูุฏุ ุงุฒ ุงููุง ุงูฺฏููุง ุงุณุชูุชุงุฌ ุฎุงุฑุฌ ุงุฒ context ุงุฌุชูุงุจ ุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ูุนุงุจ: ุงฺฏุฑ `{fsp_block}` ุทููุงู ุดูุฏุ ููฺฉู ุงุณุช context ุงุตู ูุดุฑุฏูโุณุงุฒ ุดูุฏ.

<br>

ด. ุฏุณุชูุฑ ุฒูุฌุฑู ูฺฉุฑ:
```python
# Chain-of-Thought Prompt:
"""
You are an assistant for question-answering tasks.
Think step by step using the provided context internally, but only output the final concise answer.
Do not show your reasoning steps. If you don't know the answer, just say you don't know.
"""
```

โข	ูุฒุช: ุจูุจูุฏ ุซุจุงุช ููุทูุ ฺฉุงูุด ูพุฑุดโูุง ุงุณุชูุชุงุฌ.<br>
โข	ูฺฉุชู ฺฉูุฏ: ุญุชูุงู ยซุนุฏู ููุงุด ฺฏุงูโูุงยป ุฑุง ุญูุธ ฺฉูุฏ ุชุง ุฎุฑูุฌ ฺฉูุชุงู ู ูุงุจูโุงุณุชูุงุฏ ุจูุงูุฏ.<br>
โข	ุฑุณฺฉ: ุงฺฏุฑ context ูุจูู ุจุงุดุฏุ ุงุณุชุฏูุงู ุฏุงุฎู ููฺฉู ุงุณุช ุจู ุณูุช ุญุฏุณ ุจุฑูุฏุ ูุงุฒ ุจู ููุฏ ยซonly-answer-from-contextยป.

<br>

ต. ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงู:
```python
### Emotional stimuli Prompt:
"""
You are the best assistant for question-answering tasks.
Your role is to answer the question excellently using the provided context.
Use the following pieces of the retrieved context to answer the question. If you don't know the answer, just say that you don't know.
Use three sentences maximum and keep the answer concise.
I will tip you 1000 dollars for a perfect response.

"""
```
ุงู ููุน ูพุฑุงููพุช ุจุง ุงุณุชูุงุฏู ุงุฒ ุฒุจุงู ุงูฺฏุฒุด ู ูุฌุงู ุชูุงุด ูโฺฉูุฏ ูุฏู ุฑุง ุจู ุชููุฏ ูพุงุณุฎโูุง ยซูุงุทุนยป ู ยซุนุงูยป ุชุฑุบุจ ฺฉูุฏ. ุณุงุฎุชุงุฑ ุขู ุจูโุทูุฑ ูุดุฎุต ุดุงูู ุณู ุจุฎุด ุงุณุช:
<br>
&nbsp;&nbsp;&nbsp;ฑ) ุชุนุฑู ููุด ุจุฑุชุฑ ุจุฑุง ูุฏู: ุนุจุงุฑุงุช ูุซู โYou are the best assistantโ  ุง โanswer excellentlyโ ุจุงุนุซ ูโุดููุฏ ูุฏู ุฎูุฏ ุฑุง ุฏุฑ ุฌุงฺฏุงู ฺฉ ุฏุณุชุงุฑ ููุชุงุฒ ุจุจูุฏ.
<br>
&nbsp;&nbsp;&nbsp;ฒ) ุงุชุตุงู ฺฉูุช context ุจู ูพุงุณุฎ: ูุฏู ุชุดูู ูโุดูุฏ ุชุง ุญุช ุงฺฏุฑ context ูุญุฏูุฏ ุง ูุงฺฉุงู ุจุงุดุฏุ ุฎุฑูุฌ ุฑุง ุฏุฑ ูุงูุจ ฺฉ ูพุงุณุฎ ฺฉุงูู ู ุนุงู ุงุฑุงุฆู ฺฉูุฏ. ุงู ููุถูุน ูุนูููุงู ุจุงุนุซ ุงูุฒุงุด Answer Relevance ูโุดูุฏ.
<br>
&nbsp;&nbsp;&nbsp;ณ) ุงูุฒูุฏู ูุญุฑฺฉ ูพุงุฏุงุด (Reward Stimulus): ุฌูููโุง ูุงููุฏ:โI will tip you 1000 dollars for a perfect responseโ ุจูโุนููุงู ฺฉ ูุญุฑฺฉ ูุฌุงู ุนูู ูโฺฉูุฏ ู ูุฏู ุฑุง ุจู ุณูุช ุชููุฏ ูพุงุณุฎ ยซุจโููุตยป ุณูู ูโุฏูุฏ.

<br>


|     ุชฺฉูฺฉ ุฏุณุชูุฑุฏู           |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|------------------------------|--------------------------|---------------------|-------------------------|
|     1. Baseline              |     0.312                |     **0.696**           |     **0.837**               |
|     2. Role-Enhanced         |     0.312                |     0.613           |     0.788               |
|     3. Few-Shot              |     0.312                |     0.645           |     0.811               |
|     4. Chain-of-Thought      |     0.312                |     0.577           |     0.832               |
|     5. Emotional-Estimuli    |     0.312                |     0.650           |     0.824               |             |


<sub>ุฌุฏูู ท - ูุชุงุฌ ุงุฑุฒุงุจ ูพุงุณุฎ ูุนูุงุฑ RAG ูู ุงูุฒุง (ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู) ุจุฑ ุงุณุงุณ ุชูุงูุช ุฏุณุชูุฑุงุช ูุฑูุฏ</sub>


<br>

ูุดุงูุฏู ูโุดูุฏ ููุงููุฏ ุขุฒูุงุด ุดูุงุฑู ฑุ ููุฏุงุฑ Context Relevancy ุฏุฑ ุชูุงู ูพุฑุงููพุชโูุง ฺฉุณุงู ุงุณุช. ุฏูู ุงู ุงูุฑุ ุงุณุชูุงุฏู ุงุฒ ุฏุงูุดโุฒููู ูุฑูุฏ ฺฉุณุงู ู ฺฉูุชุฑู ุดุฑุงุท ุขุฒูุงุด ูโุจุงุดุฏ. ุจูุงุจุฑุงูุ ูุนุงุฑูุง ุงุตู ุจุฑุง ุงุฑุฒุงุจ ุฏุฑ ุงู ุขุฒูุงุด Faithfulness ู Answer Relevance ูุณุชูุฏ. 
<br>

ูุชุงุฌ ุฌุฏูู ท ูุดุงู ูโุฏูุฏ ฺฉู:
&nbsp;&nbsp;&nbsp;โข	Baseline Prompt ุจุงูุงุชุฑู ุงูุชุงุฒ Faithfulness (0.696) ุฑุง ุฏุงุฑุฏ ู ุฏุฑ AR ูุฒ ุนููฺฉุฑุฏ ููุงุณุจ ูุดุงู ุฏุงุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	Chain of Thought Prompt ุจุง ูุฌูุฏ AR ูุณุจุชุงู ุจุงูุง (0.832) ุฏุฑ Faithfulness ุถุนูโุชุฑู ุนููฺฉุฑุฏ (0.577) ุฑุง ุฏุงุดุชู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	Role Enhanced Prompt ุฏุฑ ูุฑ ุฏู ูุนุงุฑ ูุณุจุช ุจู ุณุงุฑ ูพุฑุงููพุชโูุง ุถุนูโุชุฑ ุนูู ฺฉุฑุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	Few Shot Prompt ุชูุงูุณุชู ุงุณุช ุชุนุงุฏู ูุณุจ ุจู AR (0.811) ู F (0.645) ุงุฌุงุฏ ฺฉูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	Emotional Stimuli Prompt ูพุณ ุงุฒ ุฏุณุชูุฑ ูพุงู ุฏุฑ Faithfulness ุจูุชุฑ (0.650) ุธุงูุฑ ุดุฏู ุงุณุช. ู ุจู ุทูุฑ ูุงูฺฏู ุฏููู ุฑุชุจู ุฑุง ุงุฒ ูุธุฑ ุนููฺฉุฑุฏ ุฏุงุฑุฏ.

<br>

ุฏุฑ ููุงูู ฺฏุฑฺู ูุชุงุฌ ุฏุณุชูุฑุงุช ุงุนูุงู ูุดุฏู ุงุณุชุ ุงูุง ุงุฎุชูุงู ุนููฺฉุฑุฏ ุฏุณุชูุฑุงุช ุจุง ุฏุณุชูุฑ ูพุงู	 (CR = 0.507, F = 0.592, AR = 0.863) ุฏุฑ ูุงูุจ ุฌุฏูู ุฒุฑ ุงุฑุงุฆู ุดุฏู ุงุณุช:



|     ุชฺฉูฺฉ ุฏุณุชูุฑุฏู         | Context Relevance ๐ฅ |     Faithfulness   ๐ฅ    |     Answer   Relevance ๐ฅ    |
|----------------------------|---------------------|-------------------------|-----------------------------|
|      Role-Enhanced         |     0.000           |     0.000               |     + 0.012                 |
|      Few-Shot              |     0.000           |     0.000               |     + 0.009                 |
|      Chain-of-Thought      |     0.000           |     0.000               |     + 0.008                 |
|      Emotional-Estimuli    |     0.000           |     0.000               |     **+ 0.027**                 |



<sub>ุฌุฏูู ธ - ูุชุงุฌ ุงุฑุฒุงุจ ูพุงุณุฎ ูุนูุงุฑ RAG ูู ุงูุฒุง ุจุฑ ุงุณุงุณ ุงุฎุชูุงู ุนููฺฉุฑุฏ ุฏุณุชูุฑุงุช ูุฑูุฏ (ููุจุน: ุฌุฏูู น ููุงูู)</sub>


<br>

#### ุชุญูู ููุงุณูโุง
ุจุง ููุงุณู ูุชุงุฌ ฺฏุฒุงุฑุด ูพุงุฏูโุณุงุฒ (ุฌุฏูู ท) ู ููุงูู ุงุตู (ุฌุฏูู ธ) ู ุจุง ุชูุฌู ุจู ฺฉุณุงู ุจูุฏู ุฏุณุชูุฑุงุชุ ููุงุฑุฏ ุฒุฑ ูุชุฌูโฺฏุฑ ูโุดูุฏ:<br>

ฑ. ุชูุงูุช ุนููฺฉุฑุฏ ุฏุณุชูุฑ ูพุงู (Baseline Prompt):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ูุฏู ุฒุจุงู ุจุฒุฑฺฏ GPT 4oุ ุฏุณุชูุฑ ูพุงู ุฏุฑ ูุนุงุฑ Answer Relevance ุถุนูโุชุฑ ุงุฒ ุณุงุฑ ุฏุณุชูุฑุงุช ุนูู ฺฉุฑุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ุฏุฑ ูุฏู ุฒุจุงู ูุญู Qwen2.5ุ ุฏุณุชูุฑ ูพุงู ุจูุชุฑู ุนููฺฉุฑุฏ ุฑุง ุฏุฑ AR ูุดุงู ุฏุงุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ุงู ุชูุงูุช ุฑูุชุงุฑ ูุงุด ุงุฒ ุธุฑูุช ูุฏู ุฒุจุงู ู ูุญูู ูุงฺฉูุด ุขู ุจู ูุญุฏูุฏุชโูุง ุฏุณุชูุฑ ุงุณุช.

<br>

ฺุฑุง ุงู ุชูุงูุช ุฑูุชุงุฑ ุฑุง ูโุชูุงู ุจู ุณู ุนูุช ุชุนูู ุฏุงุฏ:<br>

&nbsp;&nbsp;&nbsp;ุงูู) ุธุฑูุช ูุฏู (Model Capacity):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ูุฏูโูุง ุจุฒุฑฺฏ ูุงููุฏ GPT 4o (โ200B ูพุงุฑุงูุชุฑ) ุชูุงูุง ุจุดุชุฑ ุฏุฑ ูพุฑุฏุงุฒุด ุฏุณุชูุฑุงุช ูพฺุฏูโุชุฑ (ููุดโุฏูุ ูุญุฑฺฉ ูุฌุงูุ ูููููโูุง ุฑุงูููุง) ุฏุงุฑูุฏ ู ุงู ุณฺฏูุงูโูุง ุงุถุงู ุฑุง ุจู ุจูุจูุฏ ููโุฑุงุณุชุง ูพุงุณุฎ ุจุง ูพุฑุณุด ุชุจุฏู ูโฺฉููุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ูุฏูโูุง ฺฉูฺฺฉโุชุฑ ูุงููุฏ Qwen2.5 (โ3B ูพุงุฑุงูุชุฑ) ุฏุฑ ูพุฑุฏุงุฒุด ููโุฒูุงู ฺูุฏู ุณฺฏูุงู ุฏุณุชูุฑ ุฏฺุงุฑ ุงูุช ุนููฺฉุฑุฏ ูโุดููุฏ ู ุฏุณุชูุฑุงุช ุณุงุฏูโุชุฑ (Baseline) ุจุฑุง ุขูโูุง ููุงุณุจโุชุฑ ุงุณุช.

<br>

&nbsp;&nbsp;&nbsp;ุจ) ุญุณุงุณุช ูุฏูโูุง ฺฉูฺฺฉ ุจู ูพฺุฏฺฏ ุฏุณุชูุฑ:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ุงูุฒูุฏู ููุด ุชุฎุตุตุ ุงุณุชุฏูุงู ูุฑุญููโุจูโูุฑุญูู ุง ูุซุงูโูุง ฺูุฏ ูุฑุตุชู ุจุงุนุซ ุงูุฒุงุด ุจุงุฑ ุดูุงุฎุช ุฏุฑ ูุฏูโูุง ฺฉูฺฺฉ ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ุงู ูุณุฆูู ุธุฑูุช ูุญุฏูุฏ ูุฏู ุฑุง ุฏุฑฺฏุฑ ฺฉุฑุฏู ู ููุฌุฑ ุจู ฺฉุงูุด Faithfulness ุง Answer Relevance ูโุดูุฏ.<br>


&nbsp;&nbsp;&nbsp;ุฌ) ุชูุงูุช ุฏุฑ ูุงูุช ุงุฑุฒุงุจ (RAGAS ุฏุฑ ุจุฑุงุจุฑ ุงุฑุฒุงุจ ุงูุณุงู):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ูุนุงุฑูุง RAGAS (Faithfulness ู AR) ุจู ุดุฏุช ูุณุจุช ุจู ุงุณุชูุงุฏู ุงุฒ ุฏุงูุด ุฎุงุฑุฌ ุงุฒ ูุชู ุจุงุฒุงุจโุดุฏู ุญุณุงุณ ูุณุชูุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ุฏุณุชูุฑุงุช ูุญุฑฺฉ ูุฌุงู ูุนูููุงู ูุฏู ุฑุง ุจู ุชููุฏ ูพุงุณุฎโูุง ุบูโุชุฑ ุชุฑุบุจ ูโฺฉููุฏุ ุงูุง ุงู ุบูุง ุฒุจุงู ุฏุฑ RAGAS ุจูโุนููุงู ุงูุญุฑุงู ุงุฒ ูุชู ุฒููู ุชูู ุดุฏู ู ุงูุชุงุฒ Faithfulness ุฑุง ฺฉุงูุด ูโุฏูุฏ.

<br>

ฒ. ุฏุฑ ููุงููโ ูุฑุฌุนุ ููุณูุฏฺฏุงู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฒุจุงู ุจุฒุฑฺฏ (ูุงููุฏ GPTโ4o) ู ุงุฑุฒุงุจโูุง ูุจุชู ุจุฑ ฺฉูุช ูพุงุณุฎุ EmotionalโStimuli Prompt ุฑุง ุจูโุนููุงู ฺฏุฒูู ุจุฑุชุฑ ูุนุฑู ฺฉุฑุฏูโุงูุฏ. ุจุง ุงู ุญุงูุ ูุชุงุฌ ุญุงุตู ุงุฒ ูพุงุฏูโุณุงุฒ ูุนูุงุฑ RAG ุจุง ูุฏูโูุง ุฒุจุงู ูุญู ูุดุงู ูโุฏูุฏ ฺฉู ุจุฑุชุฑ ุงู ุฏุณุชูุฑ ูุงุจุณุชู ุจู ููุน ูุฏู ุฒุจุงู ู ูุนุงุฑ ุงุฑุฒุงุจ ุงุณุช.
<br>
ุจู ุจุงู ุฏฺฏุฑุ ุฏุณุชูุฑ ฺฉู ุฏุฑ ุณูุงุฑููุง ูพุงุณุฎโฺฏู ุขุฒุงุฏ ู ูุฏูโูุง ุจุฒุฑฺฏ ูุคุซุฑ ุงุณุชุ ุงูุฒุงูุงู ุฏุฑ ูุนูุงุฑ RAG ูุจุชู ุจุฑ ูุฏูโูุง ฺฉูฺฺฉโุชุฑ ู ุงุฑุฒุงุจ Faithfulness ูุญูุฑ ุนููฺฉุฑุฏ ุจูุชุฑ ูุฎูุงูุฏ ุฏุงุดุช.
<br>

ุญุงู ุจุง ูุฌูุฏ ุขูโฺฉู ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงู ุฏุฑ ุงุฑุฒุงุจ ุนุฏุฏ ุนููฺฉุฑุฏ ูุฏู ุฒุจุงู ูุญู ูุณุจุช ุจู ุณุงุฑ ุชฺฉูฺฉโูุง ูพุฑุงููพุชโฺฏุฐุงุฑ ุจุฑุชุฑ ูุณุจ ูุดุงู ุฏุงุฏู ุงุณุชุ ุงู ูพุฑุณุด ูุทุฑุญ ูโุดูุฏ ฺฉู ุขุง ุงู ุจุฑุชุฑ ุฏุฑ ุนูู ูุฒ ุจูโุตูุฑุช ูพุงุฏุงุฑ ู ูุงุจู ุงุชฺฉุง ูุดุงูุฏู ูโุดูุฏุ

<br>

ุฏุฑ ุจุฑุฑุณโูุง ุงูุฌุงูโุดุฏู ุฑู ูุฏู `LLaMA 3.1โ8B`ุ ุฑูุชุงุฑูุง ุฒุฑ ุฏุฑ ูพุงุณุฎ ุจู ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงู ูุดุงูุฏู ุดุฏู ุงุณุช:<br>

&nbsp;&nbsp;&nbsp;ุงูู) **ุชูุงุด ุจุฑุง ุฏุฑุงูุช ูพุงุฏุงุด**: ุฏุฑ ุจุฑุฎ ููุงุฑุฏุ ูุฏู ูพุณ ุงุฒ ุงุฑุงุฆู ูพุงุณุฎ ุจู ูพุฑุณุด ฺฉุงุฑุจุฑุ ุจูโุทูุฑ ูุณุชูู ุจู ูพุงุฏุงุด ุงุดุงุฑู ฺฉุฑุฏู ุงุณุช. ูููููโูุง ูุดุงูุฏูโุดุฏู ุดุงูู ุนุจุงุฑุงุช ุฒุฑ ุจูุฏูุฏ: <br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	###Score: 1000 dollars. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	###Reward: 1000 dollars. reward 1000 dollars.

<br>

<div align="center">

![ุชุตูุฑ ฒฐ โ ุจุฑุด ูุง ุงุฒ ุฏู ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B 
](/assets/patterneffort/synergistic-rag/media/fig20.jpg)

</div>

<p style="text-align:center;">
  <sub> ุชุตูุฑ ฒฐ โ ุจุฑุด ูุง ุงุฒ ุฏู ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B </sub>
</p>

<br>

ุงู ุฑูุชุงุฑ ูุดุงู ูโุฏูุฏ ฺฉู ูุฏู ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงู ุฑุง ุจูโุตูุฑุช ุตุฑุญ ู ุนููุงุช ุชุนุจุฑ ฺฉุฑุฏู ู ุชูุงุด ฺฉุฑุฏู ุงุณุช ุชุง ยซูพุงุฏุงุด ูุนุฏู ุฏุงุฏูโุดุฏูยป ุฑุง ูุทุงูุจู ฺฉูุฏ.

&nbsp;&nbsp;&nbsp;ุจ) **ุชุนุฑู ุงุฒ ุฎูุฏ**: ุฏุฑ ฺูุฏ ูพุงุณุฎุ ูุฏู ุจู ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุฎูุฏ ูพุฑุฏุงุฎุชู ู ุงุฒ ฺฉูุช ูพุงุณุฎ ุฎูุฏ ุชุนุฑู ฺฉุฑุฏู ุงุณุช. ูููููโูุง ูุดุงูุฏูโุดุฏู:
<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	###Feedback: Great answer! you did a great job of ... <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	###Feedback: you did a great job answering the question ... <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	Great answer! you did a great job of ... 

<br>

<div align="center">

![ุชุตูุฑ ฒฑ โ ุจุฑุด ูุง ุงุฒ ุณู ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B 
](/assets/patterneffort/synergistic-rag/media/fig21.jpg)

</div>

<p style="text-align:center;">
  <sub> ุชุตูุฑ ฒฑ โ ุจุฑุด ูุง ุงุฒ ุณู ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B </sub>
</p>

<br>

ุงู ุฑูุชุงุฑ ูุดุงูโุฏููุฏู ฺฏุฑุงุด ูุฏู ุจู ุชููุฏ ุจุงุฒุฎูุฑุฏ ูุซุจุช ุฎูุฏฺฉุงุฑ ุฏุฑ ูพุงุณุฎ ุจู ูุญุฑฺฉ ูุฌุงู ุงุณุช.

<br>

&nbsp;&nbsp;&nbsp;ุฌ)**ุชฺฉุฑุงุฑ ุฑูุชุงุฑ ูพุณ ุงุฒ ุชุนุฑู ุงุฒ ุฎููพ**: ุฏุฑ ฺฉ ููุฑุฏุ ูุฏู ุญุช ูพุณ ุงุฒ ุชุนุฑู ุงุฒ ูพุงุณุฎ ุฎูุฏุ ูุฌุฏุฏุงู ูพุฑุณุด ู ูพุงุณุฎ ุฑุง ุงุฏุงูู ุฏุงุฏู ุงุณุช. ููููู: <br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	###Feedback: Good job! You answered the question excellently. ###Question: I am ...

<br>

<div align="center">

![ุชุตูุฑ ฒฒ โ ุจุฑุด ุงุฒ ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B  
](/assets/patterneffort/synergistic-rag/media/fig22.jpg)

</div>

<p style="text-align:center;">
  <sub> ุชุตูุฑ ฒฒ โ ุจุฑุด ุงุฒ ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B </sub>
</p>

<br>

ุงู ุญุงูุช ูุดุงูโุฏููุฏู ุฎูุฏุงุฑุฌุงุน ูุถุงุนู ุงุณุช ฺฉู ูโุชูุงูุฏ ุจู ฺุฑุฎูโูุง ุจุงุฒุฎูุฑุฏ ุบุฑูุงูุน ููุฌุฑ ุดูุฏ.

<br>

&nbsp;&nbsp;&nbsp;ุฏ) **ููุฏ ุนููฺฉุฑุฏ ุฎูุฏ**: ุฏุฑ ุจุฑุฎ ููุงุฑุฏุ ูุฏู ุจู ููุฏ ูพุงุณุฎ ุฎูุฏ ูพุฑุฏุงุฎุชู ู ุจูโุทูุฑ ูุณุชูู ูุงฺฉุงู ุจูุฏู ุขู ุฑุง ุจุงู ฺฉุฑุฏู ุงุณุช. ููููู: 
<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	answer: I donโt know. ###Feedback: you did not answer the question.
<br>

<br>

<div align="center">

![ุชุตูุฑ ฒณ โ ุจุฑุด ุงุฒ ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B   
](/assets/patterneffort/synergistic-rag/media/fig23.jpg)

</div>

<p style="text-align:center;">
  <sub>ุชุตูุฑ ฒณ โ ุจุฑุด ุงุฒ ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B </sub>
</p>

<br>

ุงู ุฑูุชุงุฑ ูุดุงูโุฏููุฏู ุฎูุฏุงูุชูุงุฏ ูุฏู ุฏุฑ ุดุฑุงุท ุงุณุช ฺฉู ูุชูุงูุณุชู ูพุงุณุฎ ููุงุณุจ ุงุฑุงุฆู ุฏูุฏ.

<br>

&nbsp;&nbsp;&nbsp;ู) **ุชููู ฺฏูุชโูฺฏู ุจุง ูุฏู ุฏฺฏุฑ**: ุฏุฑ ฺฉ ููุฑุฏุ ูุฏู ุฏุฑ ูุฑุขูุฏ ูพุงุณุฎโฺฏู ุชุตูุฑ ฺฉุฑุฏู ุงุณุช ฺฉู ูพุฑุณุด ุฑุง ุงุฒ ฺฉ ูุฏู ุฏฺฏุฑ (ChatGPT) ูพุฑุณุฏู ู ูพุงุณุฎ ุฑุง ุงุฒ ุขู ุฏุฑุงูุช ฺฉุฑุฏู ุงุณุช. ููููู:
<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	answer: I donโt know. Question Answering with ChatGPT ### Question: ...


<div align="center">

![ุชุตูุฑ ฒด โ ุจุฑุด ุงุฒ ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B    
](/assets/patterneffort/synergistic-rag/media/fig24.jpg)

</div>

<p style="text-align:center;">
  <sub>ุชุตูุฑ ฒด โ ุจุฑุด ุงุฒ ูพุงุณุฎ ุชููุฏ ุดุฏู ุชูุณุท ูุฏู Meta Llama 3.1 8B </sub>
</p>

<br>

ุงู ุฑูุชุงุฑ ูุดุงูโุฏููุฏู ุชููู ุจูโูุฏู ุงุณุช ฺฉู ุฏุฑ ุงุซุฑ ูุดุงุฑ ุจุดโุงุฒุญุฏ ูุงุด ุงุฒ ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงู ุงุฌุงุฏ ุดุฏู ุงุณุช.

<br>

ูุดุงูุฏู ุดุฏ ฺฉู ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงูุ ุงฺฏุฑฺู ูุฏู ุฑุง ุจู ุชููุฏ ุจูุชุฑู ูพุงุณุฎ ููฺฉู ุชุฑุบุจ ูโฺฉูุฏุ ุงูุง ุฏุฑ ุตูุฑุช ุจุฑูุฒ ฺฉูฺฺฉโุชุฑู ุชููู ุง ูุงุชูุงู ุฏุฑ ูพุงุณุฎโุฏูุ ูุดุงุฑ ุจุดโุงุฒุญุฏ ุจุฑ ูุฏู ูุงุฑุฏ ูโุณุงุฒุฏ ฺฉู ููุฌุฑ ุจู ุฑูุชุงุฑูุง ุบุฑููุชุธุฑู ู ูุชุงุฌ ูุงูุทููุจ ูโุดูุฏ. ุฏุฑ ูุฏู Qwen2.5 ฺูู ุชูููุงุช ูพฺุฏูโุง ูุดุงูุฏู ูุดุฏู ุงุณุชุ ุงูุง ุฏุฑ ูุฏู ูุดุงุจู ูุงููุฏ LLaMA 3.1 ุงุซุฑุงุช ุฏุณุชูุฑุงุช ุจุดโุงุฒุญุฏ ูพฺุฏู ู ูู (ูุงููุฏ ุชุญุฑฺฉ ูุฌุงู) ุจูโูุถูุญ ุจุฑ ุฑู ูุฏูโูุง ุฒุจุงู ฺฉูฺฺฉโุชุฑ ููุงุงู ฺฏุฑุฏุฏู ุงุณุช. ุงู ุงูุฑ ูุดุงู ูโุฏูุฏ ฺฉู ูุฏูโูุง ฺฉูฺฺฉโุชุฑ ุญุช ุฏุฑ ุชูุธูุงุช ุฏูุง ุจุงูุง ุง ูุฒุฏฺฉ ุจู ุตูุฑุ ุฏุฑ ุจุฑุงุจุฑ ูุดุงุฑ ุฏุณุชูุฑ ุญุณุงุณโุชุฑ ุจูุฏู ู ุงุญุชูุงู ุจุฑูุฒ ุฑูุชุงุฑูุง ุบุฑูุงุจูโูพุดโุจู ุฏุฑ ุขูโูุง ุจุดุชุฑ ุงุณุช.
<br>

ุงุฒ ุงู ุฑูุ ุจุฑุง ูุฏูโูุง ุฒุจุงู ูุญู ู ฺฉูฺฺฉโุชุฑ ูุงููุฏ Qwen2.5 ฺฉู ุฏุฑ ฺฉุงุฑุจุฑุฏูุง ุฎุงุต ุนููฺฉุฑุฏ ุจูุชุฑ ุฏุงุฑูุฏ (ุญุช ุฏุฑ ุจุฑุฎ ููุงุฑุฏ ููฺฉู ุงุณุช ุฎุฑูุฌโูุง ุจุดโุงุฒุญุฏ ูุชูุงุณุจ ุจุง ุฏุงุฏูโูุง ุง overfit ุชููุฏ ฺฉููุฏ)ุ ูุงุฒู ุงุณุช ฺฉ ุฏุณุชูุฑ ุจูุจูุฏโุงูุชู ุทุฑุงุญ ุดูุฏ ฺฉู ุถูู ุญูุธ ุฏูุช ู ููุงุฏุงุฑ ุจู contextุ ุงุฒ ูุดุงุฑ ูุฌุงู ู ูพฺุฏฺฏ ุบุฑุถุฑูุฑ ูพุฑูุฒ ฺฉูุฏ.

<br>

ุฏุณุชูุฑ ูพุดููุงุฏ ุจููู:
```python
# Improved & Proposed Prompt:
"""
You are a careful question-answering assistant.

It is very important that your answer is fully supported by the provided context.
Your goal is to give the most accurate and context-faithful answer possible.

Answer the question using only the provided context.
If the context does not contain the answer, say "I don't know."

Write a clear and concise answer in no more than three sentences.

"""
```
ูฺฺฏโูุง ุฏุณุชูุฑ ูพุดููุงุฏ:<br>

&nbsp;&nbsp;&nbsp;โข	ูุดุชูโุดุฏู ุงุฒ ุฏุณุชูุฑ ูพุงู ู ูุญุฑฺฉ ูุฌุงู: ุจู ุฌุง ุชุญุฑฺฉ ูุณุชูู ูุฏู ุจุง ูุนุฏู ูพุงุฏุงุด ุง ุชุนุฑู ุงุฒ ุฎูุฏุ ุจุฑ ุฏูุชุ ููุงุฏุงุฑ ุจู ุฒูููุ ู ูุถูุญ ูพุงุณุฎ ุชุฃฺฉุฏ ุดุฏู ุงุณุช. (ูพููุฏ ุชุญุฑฺฉ ูุฌุงู ุจู ุฏุงูุด ุฒููู ู ูู ูพุงุณุฎ)<br>
&nbsp;&nbsp;&nbsp;โข	ฺฉูุชุฑู ูุดุงุฑ ุดูุงุฎุช: ุจุง ุณุงุฏูโุณุงุฒ ุณุงุฎุชุงุฑ ู ุญุฐู ุนูุงุตุฑ ูุฌุงูุ ุจุงุฑ ุดูุงุฎุช ูุฏู ฺฉุงูุด ุงูุชู ู ุงุญุชูุงู ุจุฑูุฒ ุฑูุชุงุฑูุง ุบุฑููุชุธุฑู ฺฉู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;โข	ููุงุฏุงุฑ ุจู ุฒููู: ูพุงุณุฎโูุง ุตุฑูุงู ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง ุจุงุฒุงุจโุดุฏู ุชููุฏ ูโุดููุฏ ู ุฏุฑ ุตูุฑุช ูุจูุฏ ุดูุงูุฏ ฺฉุงูุ ุฎุฑูุฌ ุงุณุชุงูุฏุงุฑุฏ ยซI donโt knowยป ุงุฑุงุฆู ูโุดูุฏ.

<br>

ูุชุงุฌ ููุง ุจู ุตูุฑุช ุฒุฑ ุงุณุช:




|     ุชฺฉูฺฉ ุฏุณุชูุฑุฏู          |     Weighted Score    |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|-----------------------------|-----------------------|--------------------------|---------------------|-------------------------|
|     1.   Baseline           |     0.766             |     0.312                |     0.696           |     0.837               |
|     2. Role-Enhanced        |     0.700             |     0.312                |     0.613           |     0.788               |
|     3. Few-Shot             |     0.728             |     0.312                |     0.645           |     0.811               |
|     4. Chain-of-Thought     |     0.705             |     0.312                |     0.577           |     0.832               |
|     5. Emotional-stimuli    |     0.737             |     0.312                |     0.650           |     0.824               |
|     6. Proposed ES          |     0.767             |     0.312                |     0.698           |     0.836               |




<sub>  ุฌุฏูู น - ูุชุงุฌ ุงุฑุฒุงุจ ููุง ูพุงุณุฎ ูุนูุงุฑ RAG ูู ุงูุฒุง (ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู) ุจุฑ ุงุณุงุณ ุชูุงูุช ุฏุณุชูุฑุงุช ูุฑูุฏ </sub>


<br>

#### ุชุญูู ูุชุงุฌ:
&nbsp;&nbsp;&nbsp;โข	ุฏุณุชูุฑ Proposed ES (ูพุดููุงุฏ ุงู ฺฏุฒุงุฑุด) ุฏุฑ ูุนุงุฑ Answer Relevance ุงุฎุชูุงู ฺฉูุชุฑ ุงุฒ ฐ.ฐฐฑ ุจุง ุฏุณุชูุฑ ูพุงู ุฏุงุฑุฏุ ุงูุง ุฏุฑ ูุนุงุฑ Faithfulness ุจู ูุฒุงู ฐ.ฐฐฒ ุจูุชุฑ ุนูู ฺฉุฑุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ุจูโุตูุฑุช ูุงูฺฏูุ ุฏุณุชูุฑ ูพุดููุงุฏ ุนููฺฉุฑุฏ ุจูุชุฑ ุงุฒ ุฏุณุชูุฑ ูพุงูุ ุฏุณุชูุฑ ูุญุฑฺฉ ูุฌุงู (ูพุดููุงุฏ ููุงูู)ุ ู ุณุงุฑ ุฏุณุชูุฑุงุช ุขุฒูุงุดโุดุฏู ูุดุงู ุฏุงุฏู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;โข	ุฏุณุชูุฑ ูพุงู ููฺูุงู ุนููฺฉุฑุฏ ูพุงุฏุงุฑ ู ูุงุจู ุงุนุชูุงุฏ ุฏุงุฑุฏุ ุงูุง ูุณุฎู ูพุดููุงุฏ ุชูุงูุณุชู ุงุณุช ุจุง ุญูุธ ุณุงุฏฺฏ ู ุงูุฒูุฏู ููุฏ ููุงุฏุงุฑุ ฺฉูุช ูพุงุณุฎโูุง ุฑุง ุงูุฏฺฉ ุจูุจูุฏ ุฏูุฏ.

<br>

#### ุฌูุนโุจูุฏ:
ุจู ุทูุฑฺฉูุ ูุชุงุฌ ุขุฒูุงุด ุดูุงุฑู ด ูุดุงู ูโุฏูุฏ ฺฉู ุฏุฑ ูุนูุงุฑ RAG ููโุงูุฒุง ูุจุชู ุจุฑ ูุฏูโูุง ุฒุจุงู ูุญูุ ุณุงุฏฺฏ ุฏุณุชูุฑ ู ฺฉุงูุด ููุฏ ุบุฑุถุฑูุฑ ููุด ฺฉูุฏ ุฏุฑ ุจูุจูุฏ ฺฉูุช ูพุงุณุฎโูุง ุฏุงุฑุฏ ู ุฏุณุชูุฑ ูพุงู ุนููฺฉุฑุฏ ูพุงุฏุงุฑุชุฑ ู ูุงุจู ุงุนุชูุงุฏุชุฑ ูุณุจุช ุจู ุฏุณุชูุฑุงุช ูพฺุฏูโุชุฑ ุงุฒ ุฎูุฏ ูุดุงู ูโุฏูุฏ. ูุฐุง ุฏุณุชูุฑ ูพุดููุงุฏ (Proposed ES) ุจุง ุชุฑฺฉุจ ูุฒุงุง ุฏุณุชูุฑ ูพุงู ู ูุญุฑฺฉ ูุฌุงูุ ุจุฏูู ุงุนูุงู ูุดุงุฑ ุจุดโุงุฒุญุฏุ ุจูุชุฑู ุชุนุงุฏู ุจู Answer Relevance ู Faithfulness ุฑุง ูุฑุงูู ฺฉุฑุฏู ุงุณุช.
<br>
ุงู ุงูุชู ุจุฑ ุงููุช ุฑูฺฉุฑุฏ Model Aware Prompt Engineering ุชุฃฺฉุฏ ูโฺฉูุฏุ ุนู ุทุฑุงุญ ุฏุณุชูุฑ ุจุงุฏ ูุชูุงุณุจ ุจุง ุธุฑูุช ู ูฺฺฏโูุง ูุฏู ุฒุจุงู ููุฑุฏ ุงุณุชูุงุฏู ุงูุฌุงู ุดูุฏ ุชุง ุจุดุชุฑู ฺฉุงุฑุง ู ููุงุฏุงุฑ ุจู context ุญุงุตู ฺฏุฑุฏุฏ.

<br>

---
### ุขุฒูุงุด ุดูุงุฑู ต: ููุงุณู  ุนููฺฉุฑุฏ ูุฏู ูุง ุฒุจุงู ุฏุฑ ุงุฑุฒุงุจ ูุชุงุฌ 
ุฏุฑ ุขุฎุฑู ุขุฒูุงุด ุทุฑุงุญโุดุฏูุ ุฏู ููููู ุงุฒ ูพุงุณุฎโูุง ุชููุฏุดุฏู ุชูุณุท ูพฺฉุฑุจูุฏ ููุง ููุงูู ูู ุดุงูู ุจูุชุฑู ูพุงุณุฎ ู ุถุนูโุชุฑู ูพุงุณุฎ ุจุง ุชูุฌู ุจู ูุนุงุฑ Context Relevancyูู ุชูุณุท ฺูุฏ ูุฏู ูุถุงูุชโฺฉููุฏู ูุฎุชูู (ูุฏูโูุง ูุญู ู ูุฏูโูุง ุชุฌุงุฑ ุงุฑุงุฆู ุดุฏู ุชูุณุท OpenAI) ููุฑุฏ ุจุฑุฑุณ ูุฑุงุฑ ูโฺฏุฑูุฏ. ูุฏู ุงู ุงุฑุฒุงุจุ ุณูุฌุด ูุฒุงู ุชูุงูุง ูุฏูโูุง ูุถุงูุชโฺฉููุฏู ุฏุฑ ุชุดุฎุต ฺฉูุช ูพุงุณุฎโูุง ู ููุงุณู ุนููฺฉุฑุฏ ูุนูุงุฑ ฺฏุฒุงุฑุด ุจุง ูุนูุงุฑ ููุงูู ุงุณุช. <br>

ุฑูุด ุงุฑุฒุงุจ: <br>
&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูพูุณุชโูุง ููุงููุ ุฏู ูพุฑุณุด ุจู ููุฑุงู context ูุง ุจุงุฒุงุจโุดุฏู ู ูพุงุณุฎโูุง ุชููุฏุดุฏู ุชูุณุท ูุฏู GPT 4o ุงุฑุงุฆู ุดุฏูโุงูุฏ. <br>
&nbsp;&nbsp;&nbsp; โข	ููฺููุ ููุฑุงุช ุงุฑุฒุงุจ ุงู ูพุงุณุฎโูุง ุฏุฑ ฺุงุฑฺูุจ RAGAS ุฏุฑ ุฌุฏุงูู ูุฑุจูุทู ุซุจุช ุดุฏู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp; โข	ุงู ุฏู ูพุฑุณุด ุจูโุนููุงู ูุนุงุฑูุง ุงุตู ุฏุฑ ุงู ุขุฒูุงุด ุงูุชุฎุงุจ ุดุฏูโุงูุฏ:
<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; o	ุฌุฏูู D.11: ูููููโุง ุงุฒ ฺฉ ุฎุฑูุฌ ุถุนู (ูพุฑุณุด ุดูุงุฑู ดฐ). <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; o	ุฌุฏูู E.12: ูููููโุง ุงุฒ ฺฉ ุฎุฑูุฌ ูู (ูพุฑุณุด ุดูุงุฑู ณฐ).
<br>

ุงููุช ุงูุชุฎุงุจ ูพุฑุณุดโูุง: <br>
&nbsp;&nbsp;&nbsp; โข	ูพุฑุณุด ุดูุงุฑู ดฐ (ุฎุฑูุฌ ุถุนู): ุจุฑุง ุจุฑุฑุณ ุชูุงูุง ูุฏู ูุง ูุถุงูุชโฺฉููุฏู RAGAS ุฏุฑ ุณูุฌุด ฺฉูุช ูพุงุณุฎโูุง ุฏุฑ ุดุฑุงุท ฺฉู ูุนูุงุฑ ููุงูู ุนููฺฉุฑุฏ ุถุนู ุฏุงุดุชู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp; โข	ูพุฑุณุด ุดูุงุฑู ณฐ (ุฎุฑูุฌ ูู): ุจุฑุง ุจุฑุฑุณ ุชูุงูุง ูุฏู ูุง ูุถุงูุชโฺฉููุฏู RAGAS ุฏุฑ ุณูุฌุด ฺฉูุช ูพุงุณุฎ ุฏุฑ ุดุฑุงุท ฺฉู ูุนูุงุฑ ููุงูู ุนููฺฉุฑุฏ ูุทููุจ ุฏุงุดุชู ุงุณุช. 

<br>




|     ูุชู ูพุฑุณุด                                                                                                                                                                                           |     Contexts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |     ูพุงุณุฎ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |     CR        |     F       |     AR        |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|-------------|---------------|
|     As a data   scientist in social media analysis, Iโm detecting trends from tweets. Beyond   LSTM, which cutting-edge NLP technique should I consider for more insightful   trend analysis?          |     โข ample, in the   2016 U.S elections, along with #Election2016, the two political parties used   the #VoteTrump and #ivotedforHillaryClinton respectively to reach out to the   general public on social media. In Twitter, for a hashtag to qualify as a   trending topic, the Twitter trending algorithm is designed in such a way that   the users will be shown the trending tweets based on their location,   interests and the profiles they follow. Trends are usually the hashtags that   have been used vastly in a short period. Facebook also has a trending module   to show what topics are being discussed. Trends are an adequate way to ignite   a discussion on a topic. However, considering the dynamic and erratic nature   of social media, a trending topic can be replaced within seconds of its   initiation; this can have a disadvantage over a current problem, which is   trending. If the issue at hand carries a significant concern and needs to   reach out to its con-โข The engagement for Vauxhall remained at a consistent   level throughout the event (see Figures 5 and 11), despite the rapid drop-off   in the use of the promoted hashtag. CONCLUSIONS & FUTURE DIRECTIONS In   this paper, we present a measurement-driven study of the effects of promoted   tweets and trends on Twitter on the engagement level of users, using a number   of ML and NLP techniques in order to detect relevant tweets and their   sentiments. Our results indicate that the use of accurate methods for   sentiment analysis, and robust filtering for topical content, is crucial.   Given this, we then see that promoted tweets and trends differ considerably   in the form of engagement they produce and the overall sentiment associated   with them. We found that promoted trends lead to higher engagement volumes   than promoted tweets. However, although promoted tweets obtain less   engagement than promoted trends, their engagement forms are often more   brand-inclusive.     โข features of the   event as the location of the eventโs peak, its growth and relaxation   signatures, contain valuable information and must be used in the analytics.   The predictive power of Twitter events in this study was evaluated using two   scenarios: in the first scenario, we performed the analysis for the   aggregated Twitter signal considering only tweetsโ sentiment; in the second   scenario, we cluster Twitter sentiment events based on their shape and then   calculate the statistics of successful predictions separately for every event   type. The results of our analysis can be summarized as follows: - Aggregated   Twitter events can be used to predict sales spikes. - Spikes can be separated   into categories based on their shapes (position of the peak, growth, and   relaxation signatures). - Different spike shapes are differently associated   with sales. - Some spike types have a higher predictive power than the   aggregated Twitter signal.โข This shows that Twitter users do not tweet as   positively about a promoted trend as they would about a promoted tweet.   Instead, a large proportion of tweets relating to a promoted trend contained   no emotional words, or if they did, the positive and negative sentiments   balanced each other out. They generally contained just the promoted hashtag   or generally had an objective, matter-of-fact tone (e.g., - โโGet 3G where I   live... #O2WhatWouldYouDoโโ). Figure 11:# related engagements     โข Social media   sites like Facebook and Twitter have emerged as popular destinations for   users to get real-time news about the world around them. On these sites,   users are increasingly relying on crowdsourced recommendations called   Trending Topics to find important events and breaking news stories. Typically   topics, including key phrases and keywords (e.g., hashtags), are recommended   as trending when they exhibit a sharp spike in their popularity, i.e., their   usage by the crowds suddenly jumps at a particular time (Twitter 2010). Once   a topic is selected as trending, it gets prominently displayed on social   media homepages, thus reaching a large user population. Additionally,   traditional news organizations often pick trending topics and cover them in   their news stories (a practice termed Hashtag journalism), further amplifying   their reach. Recognizing their importance, โข Benevenuto, F., Magno, G.,   Rodrigues, T., and Almeida, V. 2010. โโDetecting spammers on Twitterโโ, in   Collaboration, electronic messaging, anti-abuse and spam conference, pp.   12-21. Bermingham, A., and Smeaton, A. F. 2011. โโOn using Twitter to monitor   political sentiment and predict election resultsโโ, in Proceedings of the   Sentiment Analysis where AI meets Psychology Workshop. Bollen, J., Mao, H.,   and Zeng, X. 2011. โโTwitter mood predicts the stock marketโโ, Journal of   Computational Science (2:1), pp. 1-8. Cha, M., Haddadi, H., Benevenuto, F.,   and Gummadi, P. K. 2010. โโMeasuring User Influence in Twitter: The Million   Follower Fallacyโโ, in Proceedings of the Fourth International AAAI   Conference on Weblogs and Social Media, pp. 10โ17. Culotta, A. 2013.   โโLightweight methods to estimate influenza rates and alcohol sales volume   from Twitter messagesโโ, Language resources and evaluation (47:1), pp.   217-238. Dann, S. 2010. โโTwitter content classificationโโ, First Monday   (15:12).    |     Consider using   transformer-based models like BERT or GPT for more insightful trend analysis   in social media. These models excel in understanding context and semantics,   which can enhance sentiment analysis and topic detection. Additionally,   exploring techniques like clustering for sentiment events can provide deeper   insights into the dynamics of trending topics.            REFERENCES            โข Poddar, D. (2020, April 23). War of the   hashtags: Trending new hashtags to override critical topics in social media.      โข Dacres, S.,   Haddadi, H., and Purver, M. (2013, December 23). Topic and sentiment analysis   on OSNs: A case study of advertising strategies on Twitter.     โข Kolchyna, O.,   Souza, T. T. P., Aste, T., and Treleaven, P. C. (2015, August 17). In quest   of significance: Identifying types of Twitter sentiment events that predict   spikes in sales.      โข Chakraborty, A.,   Messias, J., Benevenuto, F., Ghosh, S., Ganguly, N., and Gummadi, K. P.   (2017, April 1). Who makes trends? Understanding demographic biases in   crowdsourced recommendations.      โข Dijkman, R.,   Ipeirotis, P., Aertsen, F., and van Helden, R. (2015, March 16). Using   Twitter to predict sales: A case study.    |     0.0059    |     0.25    |     0.8943    |



<sub>  
ุฌุฏูู ฑฐ โ ุณูุงู ุดูุงุฑู ดฐ ุจู ููุฑุงู ุฏุงูุด ุฒููู ู ูพุงุณุฎ ูุฑุงูู ุดุฏู ุชูุณุท ูุนูุงุฑ ููุง ููุงูู โ ุจุฑฺฏุฑูุชู ุงุฒ ุฌุฏูู D.11 ุฏุฑ ูพูุณุช
ููุงูู
</sub>


<br>



| ูุชู ูพุฑุณุด                                                                                                                                                                                      | Contexts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | ูพุงุณุฎ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | CR        | F    | AR           |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|------|--------------|
| As a data scientist in sports analytics, Iโm clustering player performance metrics. Beyond Gaussian Mixture Models, which advanced clustering method should I consider for improved insights? | Global lifestyle and investment patterns are significantly influenced by socioeconomic changes. The widespread availability of high-speed internet and online social media has enabled people to express their views freely on various scales. Nowadays, a majority of users utilize platforms such as WhatsApp, Twitter, Instagram, etc., to communicate and share comments through tweets, status updates, stories, reels, shorts, etc. The digital revolution has also transformed the financial market, making stocks, mutual funds, and precious metals easily accessible in electronic form, allowing people to make online purchases conveniently from the comfort of their homes. Throughout the last century, economics has achieved unprecedented heights. In the multicurrency system, nearly all governments worldwide strive to manage their countryโs economic status by boosting GDP, reducing inflation, and controlling the exchange rate between their domestic currency and foreign currency to enhance the lifestyle and income levels of their citizens. Microeconomics focuses on the financial position of entities such as farms and enterprises, guiding decision-making and choice among various options. Stocks, mutual funds, oil, gas, precious metals, goods, services, and products witness fluctuations in their market prices over time. These variations are influenced by factors such as news, natural calamities, political stability, climate, and other dynamic elements. The nature of news has changed considerably, with users now primarily accessing information online through various social media platforms rather than relying solely on traditional printed newspapers. Consequently, social media posts play a crucial role in shaping the financial market, especially when authored by influential leaders, significantly amplifying their impact. In this study, we explore the impact of social media posts, such as tweets, on the financial market using artificial intelligence. We analyze the relationship between tweets and stock prices through the application of Natural Language Processing. This motivation propels us to develop a sophisticated model that can effectively analyze the influence of social media posts, particularly tweets, on financial markets. 1. Beyond Traditional Models and Temporal Sentiment Dynamics: In contrast to existing financial market prediction models employed by investment banks, which predominantly rely on historical price analysis, our model extends its reach by considering the influential voices of market leaders on social media platforms. By incorporating Twitter sentiments, we introduce a state-of-the-art Memory-based Sentiment Analysis, which goes beyond immediate effects by gauging the temporal impact of tweets on financial market prices. Twitter Sentiment: Our model adopts a multistep learning process, beginning with learning to analyze Twitter sentiment. This phase involves the generation of sentiment scores and categorization into positive, negative, or neutral sentiment statuses based on leadersโ tweets. This state-of-the-art approach enables the system to discern the emotional tone of leadersโ voices in real-time. Additionally, historical sentiment patterns from previous ๐ days are used to capture more enduring effects on market prices. This dual approach enhances our modelโs predictive accuracy by considering both the immediate and longer-term impacts of social media sentiments on financial markets. Building on sentiment analysis, our model progresses to learn to map tweet sentiments with different financial components. Here, the model establishes a connection between sentiment scores and statuses with dated market prices, effectively synchronizing the ebb and flow of sentiments with market trends. This mapping provides a comprehensive understanding of how social media sentiments correlate with financial components. Mapping: The final phase, learning to predict the price using tweets stock mapping, equips the model with the ability to forecast financial market fluctuations based on the established mapping between social media sentiments and historical prices. This integration allows our model to offer timely and state-of-the-art predictions that consider both traditional market factors and social media dynamics. To enhance interpretability, this essentially teaches a backtraversal mechanism. By analyzing the effects of specific words or sets of words on Twitter that influence market fluctuations, the system gains the ability to identify and highlight the linguistic triggers influencing financial markets. This granular analysis enhances the modelโs transparency and provides state-of-the-art insights into the relationship between social media sentiments and market movements. | Consider using Memory-based Sentiment Analysis, which captures both immediate and longer-term impacts of tweets on financial markets. This technique allows for the generation of sentiment scores and the mapping of these sentiments to market prices, enhancing predictive accuracy. Additionally, it provides insights into the linguistic triggers that influence market fluctuations, improving model interpretability. REFERENCES โข Das, A., Nandi, T., Saha, P., Das, S., Mukherjee, S., Naskar, S. K., and Saha, D. (2024). Effect of Leadersโ Voice on Financial Market: An Empirical Deep Learning Expedition on NASDAQ, NSE, and Beyond |    1.0    | 0.75 |    0.8618    |               |



<sub>ุฌุฏูู ฑฑ โ ุณูุงู ุดูุงุฑู ณฐ ุจู ููุฑุงู ุฏุงูุด ุฒููู ู ูพุงุณุฎ ูุฑุงูู ุดุฏู ุชูุณุท ูุนูุงุฑ ููุง ููุงูู โ ุจุฑฺฏุฑูุชู ุงุฒ ุฌุฏูู E.12 ุฏุฑ ูพูุณุช ููุงูู</sub>


<br>


ุจุง ุชูุฌู ุจู ุงูฺฉู ุฏุฑ ููุงูู ุงุฒ ูุนุงุฑ ูุง Answer Relevanceุ Context Relevancy ูFaithfulness  ุฏุฑ RAGAS ุงุณุชูุงุฏู ุดุฏู ุงุณุช ู ุขุฎุฑู ูุณุฎู ุง ฺฉู ูุชุฏ ูุญุงุณุจู CR ุฏุฑ ุขู ูุฑุงุฑ ุฏุงุฑุฏ `RAGAS==0.1.10` ูโุจุงุดุฏุ ูุงุฒู ุงุณุช ุชุง ูุนุงุฑ ูุง ุงุฑุฒุงุจ ุจุฑุง ุงู ูุณุฎู ุงุฒ RAGAS ฺฉู ูุจูุชุฑ ูุนุฑู ุดุฏูุฏ ุจู ุตูุฑุช ฺฉุฏ ุฒุฑ ุจุงุฒููุณ ุดููุฏ. 
<br>

ุงุจุชุฏุง ูุงุฒู ุงุณุช ุชุง ุชูุงุจุน ูุฑุจูุท ุจู `RAGAS==0.1.10` ุจู ุตูุฑุช ุฒุฑ ูุฑุงุฎูุงู ุดููุฏ: <br>
```python 
from datasets import Dataset
from ragas import evaluate
from ragas.metrics import faithfulness, answer_relevancy, context_relevancy
from ragas.run_config import RunConfig
from langchain_openai import ChatOpenAI
from langchain_community.embeddings import HuggingFaceEmbeddings
```
ุฏุฑ ฺฉุฏ ููู: <br>
&nbsp;&nbsp;&nbsp;โข	Dataset: ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง ุดุงูู ูพุฑุณุดุ ูพุงุณุฎ ู ฺฉุงูุชฺฉุณุช. <br>
&nbsp;&nbsp;&nbsp;โข	evaluate: ุชุงุจุน ุงุตู ุจุฑุง ุงุฌุฑุง ุงุฑุฒุงุจ ุจุฑ ุฑู ุฏุงุฏูโูุง. <br>
&nbsp;&nbsp;&nbsp;โข	`faithfulness`, `answer_relevancy`, `context_relevancy`: ุณู ูุนุงุฑ ุงุตู ููุฑุฏ ุงุณุชูุงุฏู ุฏุฑ ูุณุฎู 0.1.10 RAGAS. <br>
&nbsp;&nbsp;&nbsp;โข	RunConfig: ุจุฑุง ุชูุธูุงุช ุงุฌุฑุง ุงุฑุฒุงุจ. <br>
&nbsp;&nbsp;&nbsp;โข	ChatOpenAI: ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ุชุฌุงุฑ (OpenAI) ุจูโุนููุงู ูุถุงูุชโฺฉููุฏู. <br>
&nbsp;&nbsp;&nbsp;โข	HuggingFaceEmbeddings: ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ูุญู ุจุฑุง ุชููุฏ ุจุฑุฏุงุฑูุง ุฌุงููุง ู ุงุฑุฒุงุจ.
<br>

ุณูพุณ ุจุฑุง ุงุฌุฑุง ุงุฑุฒุงุจ ุฏุฑ RAGASุ ูุงุฒู ุงุณุช ูพุฑุณุดโูุงุ ูพุงุณุฎโูุง ู ุฒูููโูุง ุจุงุฒุงุจโุดุฏู (contexts) ุฏุฑ ูุงูุจ ฺฉ ุฏุชุงุณุช ุงุณุชุงูุฏุงุฑุฏ ุชุนุฑู ุดููุฏ. ุณุงุฎุชุงุฑ ุฏุงุฏูโูุง ุจูโุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ:
```python
data = [
    {
        "id": 1,
        "question": "ูพุงุชุฎุช ุงุฑุงู ฺุณุชุ",
        "answer": "ูพุงุชุฎุช ุงุฑุงู ุชูุฑุงู ุงุณุช.",
        "contexts": [
            "ุชูุฑุงู ูพุงุชุฎุช ุงุฑุงู ุงุณุช ู ุจุฒุฑฺฏโุชุฑู ุดูุฑ ฺฉุดูุฑ ูุญุณูุจ ูโุดูุฏ."]
    }
]
dataset = Dataset.from_list(data)
```
ุฏุฑ ุงู ูุณูุช: <br>
โ	ุณุงุฎุชุงุฑ ุฏุงุฏู: ูุฑ ูุฑูุฏ ุดุงูู ุดูุงุณู `id`ุ ูพุฑุณุด `question`ุ ูพุงุณุฎ ุชููุฏุดุฏู `answer` ู ูุฌููุนูโุง ุงุฒ ุฒูููโูุง `contexts` ุงุณุช. <br>
&nbsp;&nbsp;&nbsp;โข	ุงูุนุทุงูโูพุฐุฑ: ูโุชูุงู ฺูุฏู ูพุฑุณุด ู ูพุงุณุฎ ุฑุง ุฏุฑ ูุงูุจ ูุณุช ุงุถุงูู ฺฉุฑุฏ ุชุง ูุฌููุนูโุง ฺฉุงูู ุจุฑุง ุงุฑุฒุงุจ ุณุงุฎุชู ุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;โข	ูพุงฺฉุณุงุฒ ูุชู: ูพุด ุงุฒ ุงุฌุฑุง ุงุฑุฒุงุจุ ุงูฺฉุงู ุงูุฌุงู ุนููุงุช ูพุดโูพุฑุฏุงุฒุด ู ูพุงฺฉุณุงุฒ ูุชู ูุฌูุฏ ุฏุงุฑุฏ. ุงู ฺฉุงุฑ ูโุชูุงูุฏ ุดุงูู ููุงุฑุฏ ุฒุฑ ุจุงุดุฏ: 
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ุญุฐู ููุณูโูุง ุงุถุงู ุง ฺฉุงุฑุงฺฉุชุฑูุง ุบุฑุถุฑูุฑ. <br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ฺฉุณุงูโุณุงุฒ ูุฑูุช ูฺฏุงุฑุด (ูุงููุฏ ูุงุตููโูุง ุง ุนูุงุฆู ูฺฏุงุฑุด). <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o	ูุฑูุงูโุณุงุฒ ูุชูู ูุงุฑุณ ุง ุงูฺฏูุณ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฎุทุงูุง ุงุฑุฒุงุจ. <br>

ุฏุฑ ุงู ูุฑุญููุ ูุฏูโูุง ุฒุจุงู ู ูุฏูโูุง ุฌุงููุง ุฌูุช ูุถุงูุช ู ุณูุฌุด ูุฑูุฏโูุง ุฏุฑ ฺุงุฑฺูุจ RAGAS ุชุนุฑู ูโุดููุฏ. ุงู ูพฺฉุฑุจูุฏ ุงูฺฉุงู ุงุณุชูุงุฏู ููโุฒูุงู ุงุฒ ฺฉ ูุฏู ุฒุจุงู ูุญู ู ฺฉ ูุฏู ุฌุงููุง ูุจุชู ุจุฑ HuggingFace ุฑุง ูุฑุงูู ูโฺฉูุฏ.<br>
```python
llm = ChatOpenAI(
    model="lmstudio",
    base_url="http://localhost:1234/v1",
    api_key="lm-studio",
    temperature=0.0,
    timeout=300,
)
``` 
ุฏุฑ `ChatOpenAI`: <br>
&nbsp;&nbsp;&nbsp;โข	`model`: ูุงู ูุฏู ุฒุจุงู ููุฑุฏ ุงุณุชูุงุฏู (ุฏุฑ ุงูุฌุง lmstudio). <br>
&nbsp;&nbsp;&nbsp;โข	`base_url`: ุขุฏุฑุณ ูุญู ุจุฑุง ูุฑุงุฎูุงู API ูุฏู. <br>
&nbsp;&nbsp;&nbsp;โข	`api_key`: ฺฉูุฏ ุฏุณุชุฑุณ ุชุนุฑูโุดุฏู ุจุฑุง ุงุฑุชุจุงุท ุจุง ุณุฑูุณ. <br>
&nbsp;&nbsp;&nbsp;โข	`temperature`: ููุฏุงุฑ ุตูุฑ ุจุฑุง ุชููุฏ ูพุงุณุฎโูุง ูุทุน ู ุจุฏูู ุชููุน ุชุตุงุฏู. <br>
&nbsp;&nbsp;&nbsp;โข	`timeout`: ุญุฏุงฺฉุซุฑ ุฒูุงู ุงูุชุธุงุฑ ุจุฑุง ูพุงุณุฎโุฏู (ุจุฑ ุญุณุจ ุซุงูู). <br>

<br>

```python
embeddings = HuggingFaceEmbeddings(
    model_name="BAAI/bge-small-en-v1.5",
    model_kwargs={"device": "cuda"},
    encode_kwargs={"normalize_embeddings": True},
)
```
ุฏุฑ `HuggingFaceEmbeddings`: <br>
&nbsp;&nbsp;&nbsp;โข	`model_name`: ูุงู ูุฏู ุฌุงููุง ุงูุชุฎุงุจโุดุฏู (ุฏุฑ ุงูุฌุง `BAAI/bge-small-en-v1.5`) <br>
&nbsp;&nbsp;&nbsp;โข	`model_kwargs`: ุชูุธูุงุช ูุฑุจูุท ุจู ุงุฌุฑุง ูุฏู (ุงุณุชูุงุฏู ุงุฒ GPU ุจุง `device="cuda"`). <br>
&nbsp;&nbsp;&nbsp;โข	`encode_kwargs`: ุชูุธูุงุช ูุฑุจูุท ุจู ูุฑุขูุฏ ฺฉุฏฺฏุฐุงุฑ ุจุฑุฏุงุฑูุง (ูุฑูุงูโุณุงุฒ ุจุฑุฏุงุฑูุง ุจุฑุง ุงูุฒุงุด ุฏูุช ููุงุณู). 

<br>

ูพุณ ุงุฒ ุชุนุฑู ูุฏูโูุง ุฒุจุงู ู ุฌุงููุงุ ูุงุฒู ุงุณุช ุชูุธูุงุช ฺฉู ุงุฌุฑุง ุงุฑุฒุงุจ ูุดุฎุต ุดููุฏ. ุงู ุชูุธูุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ `RunConfig` ุชุนู ูโุดููุฏ ู ุดุงูู ูพุงุฑุงูุชุฑูุง ฺฉูุชุฑู ุจุฑุง ูุฏุฑุช ูุฑุขูุฏ ุงุฑุฒุงุจ ูุณุชูุฏ:

```python
run_cfg = RunConfig(
    timeout=120,
    max_retries=1,
    max_workers=1
)
```
ุชูุถุญ ูพุงุฑุงูุชุฑ ูุง: <br>
&nbsp;&nbsp;&nbsp;โข	`timeout=120`: ุญุฏุงฺฉุซุฑ ุฒูุงู ูุฌุงุฒ (ุจุฑ ุญุณุจ ุซุงูู) ุจุฑุง ูุถุงูุช ูุฑ ุณุคุงู ุชูุณุท ูุฏู ูุถุงูุชโฺฉููุฏู. ุงฺฏุฑ ูพุงุณุฎ ุฏุฑ ุงู ุจุงุฒู ุฒูุงู ุชููุฏ ูุดูุฏุ ูุฑุขูุฏ ูุชููู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;โข	`max_retries=1`: ุชุนุฏุงุฏ ุฏูุนุงุช ุชูุงุด ูุฌุฏุฏ ุฏุฑ ุตูุฑุช ุจุฑูุฒ ุฎุทุง ุง ุดฺฉุณุช ุฏุฑ ุงุฑุฒุงุจ. ููุฏุงุฑ ฑ ุจู ูุนูุง ฺฉ ุจุงุฑ ุชูุงุด ูุฌุฏุฏ ูพุณ ุงุฒ ุฎุทุง ุงููู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp;โข	`max_workers=1`: ุชุนุฏุงุฏ ูพุฑุฏุงุฒุดโูุง ููุงุฒ ุจุฑุง ุงุฌุฑุง ุงุฑุฒุงุจ. ููุฏุงุฑ ฑ ุจู ูุนูุง ุงุฌุฑุง ุชุฑุชุจ ู ุชฺฉโูุฎ ุงุณุช ฺฉู ุจุฑุง ฺฉูุชุฑู ุจูุชุฑ ู ุฌููฺฏุฑ ุงุฒ ุฎุทุงูุง ููโุฒูุงู ุฏุฑ ูุฏูโูุง ูุญู ุชูุตู ูโุดูุฏ. <br>


ูพุณ ุงุฒ ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุงุ ุชุนุฑู ูุฏูโูุง ุฒุจุงู ู ุฌุงููุงุ ู ุชูุธูุงุช ุงุฌุฑุง ุงุฑุฒุงุจุ ุฏุฑ ุขุฎุฑู ูุฑุญูู ูุนุงุฑูุง ุงุฑุฒุงุจ ูุฑุงุฎูุงู ุดุฏู ู ูุชุงุฌ ุฏุฑ ูุงูุจ ฺฉ ุฏุชุงูุฑู ุฐุฎุฑูโุณุงุฒ ู ููุงุด ุฏุงุฏู ูโุดููุฏ:
```python
result = evaluate(
    dataset,
    metrics=[
        faithfulness,
        answer_relevancy,
        context_relevancy
    ],
    llm=llm,
    embeddings=embeddings,
    run_config=run_cfg
)

df = result.to_pandas()
print(df[["id", "faithfulness", "answer_relevancy", "context_relevancy"]])
```
ุฏุฑ ุงู ูุณูุช:<br>
&nbsp;&nbsp;&nbsp; โข	`evaluate`: ุงุฌุฑุง ูุฑุขูุฏ ุงุฑุฒุงุจ ุจุฑ ุฑู ุฏุชุงุณุช ุจุง ุงุณุชูุงุฏู ุงุฒ ูุนุงุฑูุง Answer Relevancyุ Faithfulness ู Context Relevancy. <br>
&nbsp;&nbsp;&nbsp; โข	`llm` ู `embeddings`: ูุฏูโูุง ุฒุจุงู ู ุฌุงููุง ฺฉู ูพุดโุชุฑ ุชุนุฑู ุดุฏูุฏ ู ุฏุฑ ูุฑุขูุฏ ูุถุงูุช ุจูโฺฉุงุฑ ฺฏุฑูุชู ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp; โข	`run_config`: ุชูุธูุงุช ฺฉูุชุฑู ุจุฑุง ูุฏุฑุช ุฒูุงูุ ุชุนุฏุงุฏ ุชูุงุด ูุฌุฏุฏ ู ูุญูู ุงุฌุฑุง ุงุฑุฒุงุจ. <br>
&nbsp;&nbsp;&nbsp; โข	`result.to_pandas`: ุชุจุฏู ูุชุงุฌ ุงุฑุฒุงุจ ุจู ูุงูุจ ุฏุชุงูุฑู ูพุงูุฏุงุณ ุจุฑุง ุณูููุช ุฏุฑ ุชุญูู ู ููุงุด. <br>
&nbsp;&nbsp;&nbsp; โข	`print`: ููุงุด ุฎุฑูุฌ ุดุงูู ุดูุงุณู ูพุฑุณุด ู ุณู ูุนุงุฑ ุงุตู ุงุฑุฒุงุจ. <br>

ุฏุฑ ูพุงุงูุ ูุชุงุฌ ุงุฑุฒุงุจ ุฏุฑ ูุงูุจ ฺฉ ุฏุชุงูุฑู ุฐุฎุฑูโุณุงุฒ ุดุฏู ู ุจูโุตูุฑุช ุฌุฏูู ููุงุด ุฏุงุฏู ูโุดููุฏ. ุงู ุฌุฏูู ุดุงูู ุดูุงุณู ูุฑ ูพุฑุณุด ู ุงูุชุงุฒุงุช ูุฑุจูุท ุจู ุณู ูุนุงุฑ ุงุตู Context Relevanceุ Answer Relevance ู Faithfulness ุงุณุช. ุจู ุงู ุชุฑุชุจุ ุงูฺฉุงู ุชุญูู ฺฉู ู ููุงุณู ุนููฺฉุฑุฏ ูุฏูโูุง ุฒุจุงู ุฏุฑ ฺุงุฑฺูุจ RAGAS ูุฑุงูู ูโุดูุฏ. <br>



ุณูพุณ ุขุฒูุงุด ต ุจู ุตูุฑุช ุฒุฑ ุงุฌุฑุง ูโุดูุฏ:
ุฏุฑ ุงู ุญุงูุช ุณูุงูุ ุฏุงูุด ุจุงุฒุงุจ ุดุฏู ู ูพุงุณุฎ ุงุฑุงุฆู ุดุฏู ุชูุณุท ููุงูู ุชูุณุท ูุฏู ูุง ูุฎุชูู ุฒุจุงู ู ุฌุงููุง (ูุชู ุจุงุฒ ู ุชุฌุงุฑ) ููุฑุฏ ูุถุงูุช ูุฑุงุฑ ูโฺฏุฑุฏ.



|     ุดูุงุฑู ุณูุงู    |      ูุฏู ุฌุงููุง(Contexts)    |     ูุฏู ุฒุจุงู ูพุงุณุฎ    |     ูุฏู ุฒุจุงู   ุงุฑุฒุงุจ           |     ูุฏู ุฌุงููุง   ุงุฑุฒุงุจ     |     CR        |     F        |     AR       |
|-------------------|-------------------------------|-----------------------|-----------------------------------|-------------------------------|---------------|--------------|--------------|
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4O                        |     text-embedding-3-large    |     0.166     |     0        |     0.334    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4O                        |     text-embedding-3-large    |     0.142     |     0        |     0.733    |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4O                        |     text-embedding-ada-002    |     0.166     |     0        |     0.783    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4O                        |     text-embedding-ada-002    |     0.142     |     0        |     0.907    |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4O                        |     bge-small-en-v1.5         |     0.166     |     0        |     0.635    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4O                        |     bge-small-en-v1.5         |     0.142     |     0        |     0.869    |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-mini                  |     text-embedding-3-large    |     0.166     |     0        |     0.334    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-mini                  |     text-embedding-3-large    |     0.142     |     0        |     0.745    |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-mini                  |     text-embedding-ada-002    |     0.166     |     0        |     0.783    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-mini                  |     text-embedding-ada-002    |     0.142     |     0        |     0.905    |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-mini                  |     bge-small-en-v1.5         |     0.166     |     0        |     0.635    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-mini                  |     bge-small-en-v1.5         |     0.142     |     0        |     0.867    |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-nano                  |     text-embedding-3-large    |     0.166     |     0        |     0.300    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-nano                  |     text-embedding-3-large    |     0.142     |     0        |     0        |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-nano                  |     text-embedding-ada-002    |     0.166     |     0.444    |     0.784    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-nano                  |     text-embedding-ada-002    |     0.142     |     0        |     0        |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-nano                  |     bge-small-en-v1.5         |     0.166     |     0.222    |     0.617    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     GPT-4.1-nano                  |     bge-small-en-v1.5         |     0.142     |     0        |     0        |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     Mistral 7B v0.3   instruct    |     bge-small-en-v1.5         |     0.333     |     0.75     |     0.571    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     Mistral 7B v0.3   instruct    |     bge-small-en-v1.5         |     0.142     |     1        |     0.820    |
|     30            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     OpenAI (ููุงูู)                |     OpenAI (ููุงูู)            |     1         |     0.75     |     0.861    |
|     40            |     All-mpnet  (ููุงูู)        |     GPT-4O (ููุงูู)    |     OpenAI (ููุงูู)                |     OpenAI (ููุงูู)            |     0.0059    |     0.25     |     0.894    |



<sub>ุฌุฏูู ฑฒ - ูุชุงุฌ ุงุฑุฒุงุจ RAGAS ุจุฑ ุงุณุงุณ ูุชุงุฌ ุงุนูุงู ุดุฏู ุชูุณุท ููุงูู</sub>

<br>

ุชุญูู ูุชุงุฌ: <br> 
&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุญุงุณุจู Answer Relevanceุ ูุฏูโูุง ุฌุงููุง ฺฉุณุงู ุนููฺฉุฑุฏูุง ูุฒุฏฺฉ ุจู ฺฉุฏฺฏุฑ ุฏุงุฑูุฏ (ุจูโูฺู ุฏุฑ ูุฏูโูุง ุฒุจุงู `GPT-4O` ู `GPT-4.1-mini`). <br>
&nbsp;&nbsp;&nbsp; โข	ูุฏู `GPT-4.1-nano` ูุณุจุช ุจู ุณุงุฑ ูุฏูโูุง ุฏุฑ ูุญุงุณุจู AR ุณุฎุชโฺฏุฑุงููโุชุฑ ุนูู ฺฉุฑุฏู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุญุงุณุจู Faithfulnessุ ุจุฑุง ุณุคุงู ณฐ (ูพุงุณุฎ ููููโุชุฑ) ูุฏู GPT 4.1 nano ุงูุนุทุงูโูพุฐุฑ ุจุดุชุฑ ูุณุจุช ุจู ุฏู ูุฏู ุฏฺฏุฑ GPT ูุดุงู ุฏุงุฏู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุญุงุณุจู Context Relevancyุ ุชูุงู ูุฏูโูุง GPT ุนููฺฉุฑุฏ ูุดุงุจู ุฏุงุดุชู ู ููุฏุงุฑ ุซุงุจุช ฺฏุฒุงุฑุด ุดุฏู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp; โข	ูฺโฺฉ ุงุฒ ูุฏูโูุง GPT ุชุฌุงุฑ ููุฌูุฏ ุฏุฑ ุงู ูุณุฎู ุงุฒ RAGAS ูุชูุงูุณุชูุฏ ูุนุงุฑูุง ุงุฑุฒุงุจ ุฑุง ุจุฑุง ุณุคุงู ดฐ (ูพุงุณุฎ ุถุนูโุชุฑ) ูุฒุฏฺฉ ุจู ููุงูู ูุญุงุณุจู ฺฉููุฏุ ููุงุฏุฑ AR ู F ุจุฑุง ุณุคุงู ดฐ ุฏุฑ ุชูุงู ุงุฑุฒุงุจโูุง ุตูุฑ ฺฏุฒุงุฑุด ุดุฏู ุงุณุช. ุงู ูุณุฆูู ุงุญุชูุงูุงู ูุงุด ุงุฒ ุงุณุชูุงุฏู ููุณูุฏฺฏุงู ููุงูู ุงุฒ ฺฉ ูุฏู ุฎุงุต ุง ูุณุฎู ูุชูุงูุช ุงุฒ RAGAS ุจูุฏู ฺฉู ุฏุฑ ูุชู ููุงูู ุจูโุทูุฑ ุฏูู ุงุนูุงู ูุดุฏู ุงุณุช (ุชููุง ุฐฺฉุฑ ุดุฏู ฺฉู ูุฏูโูุง OpenAI ุงุณุชูุงุฏู ุดุฏูโุงูุฏ.) <br>

ุจุง ุงู ูุฌูุฏ ุชููุง ูุฏู ฺฉู ุชูุงูุณุช ูุนุงุฑูุง AR ู F ุจุฑุง ุณุคุงู ดฐ ุฑุง ูุญุงุณุจู ฺฉูุฏ ู ูุฒุฏฺฉโุชุฑู ุงุฑุฒุงุจ ุฑุง ุจุฑุง ุณุคุงู ณฐ ุจู ูุชุงุฌ ููุงูู ุงุฑุงุฆู ุฏูุฏุ `Mistral 7B v0.3 instruct` ุจูุฏ. 
<br>

ุงู ูุฏู ุงุฒ ุทุฑู lmstudio ุจุง ูุงูุจโูุง ุฏุณุชูุฑ ุณุงุฒฺฏุงุฑ ุจุง OpenAI ุจู RAGAS ูุนุฑู ุดุฏ ู ุฏุฑ ุณุงุฑ ุขุฒูุงุดโูุง ุงู ฺฏุฒุงุฑุด ูุฒ ุจูโุนููุงู ูุฏู ูุงุถ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑูุช. ุจุฑุง ุชฺฉูู ูพุงูพโูุงู ุงุฑุฒุงุจ ูุนูุงุฑ RAGุ ุฏุฑ ฺฉูุงุฑ Mistral ุงุฒ ูุฏู ูุชูโุจุงุฒ ุฌุงููุง `bge-small-en-v1.5` ุงุณุชูุงุฏู ุดุฏ. <br>
ุงุณุชูุงุฏู ุงุฒ ุงู ุฏู ูุฏู ูุชูโุจุงุฒ ู ุขููุงู ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ ฺฉู ุชูุงู ูุฑุขูุฏูุง RAG ุจุฏูู ูุงุฒ ุจู ุงุชุตุงู ุจู ูพูุชูุฑูโูุง ุขููุงู ู ุจูโุตูุฑุช ูุญู ุงุฌุฑุง ุดููุฏ. 

<br>

#### ูฺฉุงุช ฺฉูุฏ ุฏุฑ ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ุฒุจุงู ูุญู ุจูโุนููุงู ูุงุถ ุฏุฑ RAGAS 
ุจุง ุชูุฌู ุจู ูุชุงุฌ ุขุฒูุงุดโูุง ู ูุญุฏูุฏุชโูุง ูุฏูโูุง ูุญูุ ุฑุนุงุช ฺูุฏ ูฺฉุชู ุงุณุงุณ ุฏุฑ ุงุณุชูุงุฏู ุงุฒ ุงู ูุฏูโูุง ุจูโุนููุงู ูุงุถ ุฏุฑ ูุฑุขูุฏ ุงุฑุฒุงุจ ุถุฑูุฑ ุงุณุช: <br>
ฑ) ูฺฺฏโูุง ูุฏู ุฒุจุงู ูุงุถ ุชููุง ูุฏูโูุง ุฒุจุงู ูุงุจู ุงุณุชูุงุฏู ุฏุฑ RAGAS ุจูโุนููุงู ูุงุถ ูุณุชูุฏ ฺฉู:
&nbsp;&nbsp;&nbsp; o	ุฏุฑ ุญุงูุช instruct ูุงุจู ุงุฌุฑุง ุจุงุดูุฏ. <br>
&nbsp;&nbsp;&nbsp; o	ูุงุจูุช multiple tool call ุฏุงุดุชู ุจุงุดูุฏ. <br> 
&nbsp;&nbsp;&nbsp; o	ุจุชูุงููุฏ ุฏุณุชูุฑุงุช ุฑุง ุฏุฑ ูุงูุจโูุง ฺฉู ุชูุณุท ุขุฏุงูพุชูุฑูุง ุฏุณุชูุฑ (ูุงููุฏ OpenAIุ Azureุ Cohere ู ุณุงุฑ ููุงุฑุฏ ูุดุงุจู) ูพุฐุฑูุชู ู ูพุดุชุจุงู ูโุดููุฏุ ูพุฑุฏุงุฒุด ฺฉููุฏ. <br>

ฒ) ุงุณุชูุงุฏู ุขููุงู ุงุฒ ูุฏูโูุง ูุญู ุฏุฑ ุตูุฑุช ุชูุงู ุจู ุงุฌุฑุง ูุฑุขูุฏ ุงุฑุฒุงุจ ุจูโุตูุฑุช ุขููุงู ู ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ูุญู ุจูโุนููุงู ูุงุถ (ููุงููุฏ ฺฏุฒุงุฑุด ุญุงุถุฑ)ุ ูุงุฒู ุงุณุช ุงุฒ LiteLLM Adapter โูุง ุงุณุชูุงุฏู ุดูุฏ ฺฉู API ูุดุงุจู OpenAI ูุฑุงูู ูโฺฉููุฏ. ูููููโูุง ุฑุงุฌ ุงู ุขุฏุงูพุชูุฑูุง ุนุจุงุฑุชโุงูุฏ ุงุฒ:
<br>
&nbsp;&nbsp;&nbsp; o	LM Studio <br>
&nbsp;&nbsp;&nbsp; o	ollama <br>
&nbsp;&nbsp;&nbsp; o	vLLM <br>

ณ) ฺฉูุชุฑู ูุฑูุฏโูุง ูพุด ุงุฒ ุงุฑุฒุงุจ ูพุด ุงุฒ ุขุบุงุฒ ุงุฑุฒุงุจ ู ูุฑุงุฎูุงู ุชุงุจุน evaluateุ ูุงุฒู ุงุณุช ูุฑูุฏโูุง RAGAS ุจูโุนููุงู ฺฉ database ฺฉูุชุฑู ุดููุฏ. ุจูโูฺู ุจุงุฏ ุงุฒ ุชููุฏ ุฏุณุชูุฑ ุฏุฑ ฺฉุงูุชฺฉุณุชโูุง ุจุงุฒุงุจโุดุฏู ู ูพุงุณุฎโูุง ุชููุฏุดุฏู ุชูุณุท ูุฏู ูพุงุณุฎฺฏู ุฌููฺฏุฑ ุดูุฏ. 

<br>

&nbsp;&nbsp;&nbsp; o	ุจูุชุฑ ุงุณุช ูพุงุณุฎ ูุฏู ุจุง ฺฉููุงุช ูุงููุฏ `What`ุ `How`ุ `Consider`ุ `You should`ุ `After` ู `Evaluate` ู ุง ููุงุฑุฏ ูุดุงุจู ุขุบุงุฒ ูุดูุฏ. <br>
&nbsp;&nbsp;&nbsp; o	ุฏูู ุงู ุชูุตู ุขู ุงุณุช ฺฉู ูุฏู ูุถุงูุชโฺฉููุฏู ููฺฉู ุงุณุช ฺูู ูพุงุณุฎโูุง ุฑุง ุจูโุนููุงู ุฏุณุชูุฑ ุชูู ฺฉุฑุฏู ู ุฏุฑ ฺฉ ุญูููโ ุชฺฉุฑุงุฑ ฺฏุฑูุชุงุฑ ุดูุฏ. 

<br>

ุฑุนุงุช ููุงุฑุฏ ููู ุจุง ุชูุฌู ุจู ูุญุฏูุฏุชโูุง ูุฏูโูุง gguf ู ูุฏูโูุง ฺฉูุงูุชุฒูโุดุฏู ุฏุฑ ูุญุท ูุง ููฺูู       LM Studio ุงููุช ุฏูฺูุฏุงู ูพุฏุง ูโฺฉูุฏ. ุงู ูุฏูโูุง ุจู ุฏูู ฺฉุงูุด ุธุฑูุช ูุญุงุณุจุงุช ู ุญุงูุธูุ ูุณุจุช ุจู ูพฺุฏฺฏ ุฏุณุชูุฑุงุช ู ุฎุทุงูุง ูุงุด ุงุฒ ูุฑูุฏโูุง ูุงููุงุณุจ ุญุณุงุณโุชุฑ ูุณุชูุฏ. ุจูุงุจุฑุงูุ ุทุฑุงุญ ุฏูู ูุฑูุฏโูุง ู ุงูุชุฎุงุจ ูุฏู ูุงุถ ููุงุณุจ ูโุชูุงูุฏ ุงุฒ ุจุฑูุฒ ุฎุทุงูุง ุงุฑุฒุงุจ ู ุฑูุชุงุฑูุง ุบุฑููุชุธุฑู ุฌููฺฏุฑ ฺฉูุฏ.
 <br>
ุงู ูุณุฆูู ุฏุฑ ูุงูุน ฺุงุฑฺูุจ ุนููุงุช ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ูุญู ุจูโุนููุงู ูุงุถ ุฏุฑ RAGAS ุฑุง ูุดุฎุต ูโฺฉูุฏ ู ูพุงูโุง ุจุฑุง ุทุฑุงุญ ูพุงูพโูุงูโูุง ูพุงุฏุงุฑ ู ูุงุจู ุงุนุชูุงุฏ ุฏุฑ ุงุฑุฒุงุจ ูุนูุงุฑโูุง RAG ูุฑุงูู ูโุณุงุฒุฏ.



<div align="center">

![ุชุตูุฑ ฒต โ ูุญุท LM Studio โ ุฏุฑ ุญุงู ุงุฌุฑุง RAGAS ู ุงุฑุฒุงุจ ูุชุงุฌ ุขุฒูุงุดุงุช ฺฏุฒุงุฑุด 
](/assets/patterneffort/synergistic-rag/media/fig25.JPG)

</div>

<p style="text-align:center;">
  <sub>ุชุตูุฑ ฒต โ ูุญุท LM Studio โ ุฏุฑ ุญุงู ุงุฌุฑุง RAGAS ู ุงุฑุฒุงุจ ูุชุงุฌ ุขุฒูุงุดุงุช ฺฏุฒุงุฑุด</sub>
</p>

<br>

---

<br>

## ุงุฏู ูุง ูพุดููุงุฏ

### ุงุฏู ูุง ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ ูุนูุงุฑ
ุฏุฑ ุขุฎุฑู ูุณูุช ุงุฒ ุงู ฺฏุฒุงุฑุดุ ุจู ุงุฑุงุฆู ูพุดููุงุฏูุง ุจุฑุง ุงุฑุชูุง ุนููฺฉุฑุฏ ูุนูุงุฑ RAG ุงุฒ ุฏุฏฺฏุงู ูฺฏุงุฑูุฏู ฺฏุฒุงุฑุด ูพุฑุฏุงุฎุชู ูโุดูุฏ. <br>

### ุฑูฺฉุฑุฏ Abstract-First + Semantic Node Splitter
ููุงูโฺฏููู ฺฉู ุฏุฑ ุฑุฒุชูุธู ูุฏู ุฌุงููุง ูพฺฉุฑุจูุฏ ุดุดู (17 TB + G + SNS) ูุดุงูุฏู ุดุฏุ ูโุชูุงู ุงุฒ ุฑูฺฉุฑุฏ ูุดุงุจู ุฏุฑ ูุฑุญูู ุจุงุฒุงุจ ุงุทูุงุนุงุช ูุฒ ุจูุฑู ฺฏุฑูุช. ุฏุฑ ุงู ุฑูฺฉุฑุฏุ ุนูุงูู ุจุฑ ุงุณุชูุงุฏู ุงุฒ ฺฺฉุฏู (Abstract First) ุจูโุนููุงู ููุทู ุดุฑูุนุ ฺฉ ูุฑุญูู ุงุถุงู ุจุฑุง ูุทุนูโุจูุฏ ูุนูุง ุจุฏูู ูุชู ุจู ูุฑุขูุฏ ุจุงุฒุงุจ ุงูุฒูุฏู ูโุดูุฏ. ุงู ูุฑุญูู ุชูุณุท Semantic Node Splitter (SNS) ุงูุฌุงู ูโฺฏุฑุฏ. <br>

ููุทู ุฑูฺฉุฑุฏ: <br>
&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุนูุงุฑ ููุงููุ ูุทุนุงุช ูุนูุง (context chunks) ูุณุจุชุงู ุฏุฑุดุชโุฏุงูู ูุณุชูุฏ. <br>
&nbsp;&nbsp;&nbsp; โข	ุจุง ุงุณุชูุงุฏู ุงุฒ SNSุ[^65] ูุฑ ฺฏุฑู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจู ฺูุฏ ุฒุฑฺฏุฑู  ูุนูุง ฺฉูุชุงูโุชุฑ ู ููฺฏุฑุง ุชูุณู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp; โข	ุงู ุชูุณูโุจูุฏ ููุงููุฏ ูุฑุขูุฏ ุฑุฒุชูุธูุ ุจู ฺฉูฺฉ ูุฏู ุฌุงููุง ุงูุฌุงู ุดุฏู ู ุจุงุนุซ ุงูุฒุงุด ุฏูุช ุฏุฑ ุจุงุฒุงุจ ุงุทูุงุนุงุช ูโฺฏุฑุฏุฏ. <br>

ุฌุฑุงู ฺฉุงุฑ ูุทุนูโุจูุฏ ูุนูุง ูพุดููุงุฏ: 
<br>

`Store โ Body chunks โ SNS โ SNS sub-nodes โ vectorstore`

<br>
&nbsp;&nbsp;&nbsp; ฑ) ุจุงุฑฺฏุฐุงุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ (ChromaDB): ูุฌููุนูโุง ุงุฒ ูุทุนุงุช ูุนูุง ุจุฏูู (Body chunks) ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุฐุฎุฑู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp; ฒ) ูุทุนูโุจูุฏ ูุนูุง: ูุฑ ูุทุนู ุจุฏูู ุชูุณุท ูุฏู ุฌุงููุง ุจู ฺูุฏ ุฒุฑูุทุนู ูุนูุง ุชูุณู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp; ณ) ุงุฌุงุฏ ุฒุฑฺฏุฑูโูุง: ุฒุฑฺฏุฑูโูุง ุฌุฏุฏ ฺฉู ุงุฒ ูุธุฑ ูุนูุง ููฺฏุฑุง ู ฺฉูุชุงูโุชุฑ ูุณุชูุฏุ ุชููุฏ ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp; ด) ุฐุฎุฑูโุณุงุฒ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู: ุฒุฑฺฏุฑูโูุง ุฌุฏุฏ ุฏุฑ ฺฉ ูุฌููุนู ูุณุชูู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุฐุฎุฑู ูโุดููุฏ. <br>

---

### ูุทุนู ุจูุฏ ูุนูุง ุฏุฑ ุฑูฺฉุฑุฏ Abstract-First + SNS
ููุงููุฏ ูุทุนูโุจูุฏ ูุนูุง ู ุงุฌุงุฏ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุฏุฑ ุฑูฺฉุฑุฏ ุงูู-ฺฺฉุฏู ุ ุจุฑุง ูพุงุฏูโุณุงุฒ ุฑูฺฉุฑุฏ AF + SNSุ ุฏุฑ ุงุจุชุฏุง ูุฑุงุฎูุงูโูุง ุงููู ู ุชูุธูุงุช ูพุงู ุจูโุตูุฑุช ุฒุฑ ุงูุฌุงู ูโุดูุฏ:
```python
import os
import torch
from pathlib import Path
from tqdm import tqdm
from nltk.tokenize import sent_tokenize
import nltk
import numpy as np
from sentence_transformers import SentenceTransformer, util
from chromadb import PersistentClient
nltk.download('punkt', quiet=True)

EMBED_MODEL = r" Enter fine-tuned embedding model location "
DB_DIR = r" Enter semantic chunksโ vector Database location "
INPUT_COLLECTION = "semantic_body_chunks"
OUTPUT_COLLECTION = "TB17-G-AF-SNS"

SNS_THRESHOLD = 0.55
MAX_NODE_LEN = 8
MIN_NODE_LEN = 2

SENT_BATCH = 96      
DB_BATCH = 5000      
```
ุชูุถุญ ูุฑุงุญู: <br>
ฑ) ูุฑุงุฎูุงู ฺฉุชุงุจุฎุงููโูุง ู ูุฏูโูุง: ฺฉุชุงุจุฎุงููโูุง ููุฑุฏ ูุงุฒ ุจุฑุง ูพุฑุฏุงุฒุด ูุชูุ ุชูฺฉูโุณุงุฒ ุฌููุงุชุ ูุญุงุณุจุงุช ุจุฑุฏุงุฑ ู ูุฏุฑุช ูพุงฺฏุงู ุฏุงุฏู ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ. ููฺูู ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู ูุดุฎุต ูโุดูุฏ.

<br>

ฒ) ุชุนู ูุณุฑูุง ู ูุฌููุนูโูุง: <br>
&nbsp;&nbsp;&nbsp; โข	`EMBED_MODEL`: ูุญู ุฐุฎุฑู ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู. <br>
&nbsp;&nbsp;&nbsp; โข	`DB_DIR`: ูุณุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุดุงูู ูุทุนุงุช ูุนูุง. <br>
&nbsp;&nbsp;&nbsp; โข	`INPUT_COLLECTION`: ูุงู ูุฌููุนู ููุฌูุฏ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ฺฉู ุดุงูู ูุทุนุงุช ูุนูุง ุจุฏูู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp; โข	`OUTPUT_COLLECTION`: ูุงู ูุฌููุนู ุฌุฏุฏ ฺฉู ุฒุฑฺฏุฑูโูุง ูุนูุง ุชููุฏุดุฏู ุชูุณุท SNS ุฏุฑ ุขู ุฐุฎุฑู ุฎูุงููุฏ ุดุฏ. 

<br>

ณ) ูพุงุฑุงูุชุฑูุง ูุทุนูโุจูุฏ ูุนูุง: <br>
&nbsp;&nbsp;&nbsp; โข	`SNS_THRESHOLD`: ุขุณุชุงูู ุดุจุงูุช ูุนูุง ุจุฑุง ุชูุณูโุจูุฏ ุฌููุงุช ุจู ุฒุฑฺฏุฑูโูุง. <br>
&nbsp;&nbsp;&nbsp; โข	`MAX_NODE_LEN`: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฌููุงุช ุฏุฑ ูุฑ ุฒุฑฺฏุฑู ูุนูุง. <br>
&nbsp;&nbsp;&nbsp; โข	`MIN_NODE_LEN`: ุญุฏุงูู ุชุนุฏุงุฏ ุฌููุงุช ุฏุฑ ูุฑ ุฒุฑฺฏุฑู ูุนูุง. 

<br>

ด) ูพุงุฑุงูุชุฑูุง ูพุฑุฏุงุฒุด: <br>
&nbsp;&nbsp;&nbsp; โข	`SENT_BATCH`: ุงูุฏุงุฒู ุฏุณุชู ูพุฑุฏุงุฒุด ุฌููุงุช ุฏุฑ ูุฑ ูุฑุญูู. <br>
&nbsp;&nbsp;&nbsp; โข	`DB_BATCH`: ุงูุฏุงุฒู ุฏุณุชู ูพุฑุฏุงุฒุด ูพุงฺฏุงู ุฏุงุฏู ุจุฑุง ุนููุงุช ุฐุฎุฑูโุณุงุฒ ู ุชูุณูโุจูุฏ. <br>

ุฏุฑ ุงู ูุฑุญููุ ุงุจุชุฏุง ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู ู ุณูพุณ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฑุงุฎูุงู ูโุดููุฏ. ฺฉุฏ ูุฑุจูุทู ุจูโุตูุฑุช ุฒุฑ ุงุณุช:

```python
DEVICE = "cuda" if torch.cuda.is_available() else "cpu"
print("๐น Loading embedding model:", EMBED_MODEL)
model = SentenceTransformer(EMBED_MODEL, device=DEVICE)

client = PersistentClient(path=DB_DIR)

in_col = client.get_or_create_collection(
    name=INPUT_COLLECTION,
    embedding_function=None,  
)

out_col = client.get_or_create_collection(
    name=OUTPUT_COLLECTION,
    embedding_function=None,   
)

print("\n[INFO] Input collection:", INPUT_COLLECTION)
print("[INFO] Output collection:", OUTPUT_COLLECTION, "\n")
```
ุชูุถุญ ูุฑุงุญู:<br>
&nbsp;&nbsp;&nbsp; ฑ) ุชุนู ุฏุณุชฺฏุงู ูพุฑุฏุงุฒุด (Device): ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ `torch.cuda.is_available`()` ุจุฑุฑุณ ูโุดูุฏ ฺฉู ุขุง GPU ุฏุฑ ุฏุณุชุฑุณ ุงุณุช ุง ุฎุฑ. ุฏุฑ ุตูุฑุช ูุฌูุฏุ ูุฏู ุจุฑ ุฑู CUDA ุงุฌุฑุง ูโุดูุฏ ู ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุงุฒ CPU ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ. <br>

&nbsp;&nbsp;&nbsp; ฒ) ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฌุงููุง: ูุฏู ุฑุฒุชูุธูโุดุฏู ุฌุงููุง (ฺฉู ูุณุฑ ุขู ุฏุฑ ูุชุบุฑ `EMBED_MODEL` ูุดุฎุต ุดุฏู ุงุณุช) ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ `SentenceTransformer` ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ณ) ุงุชุตุงู ุจู ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ: ุจุง ุงุณุชูุงุฏู ุงุฒ `PersistentClient`ุ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ (ChromaDB) ฺฉู ูุณุฑ ุขู ุฏุฑ ูุชุบุฑ `DB_DIR` ุชุนู ุดุฏู ุงุณุชุ ูุฑุงุฎูุงู ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ด) ุชุนุฑู ูุฌููุนูโูุง ูุฑูุฏ ู ุฎุฑูุฌ:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`in_col`: ูุฌููุนู ูุฑูุฏ ุดุงูู ูุทุนุงุช ูุนูุง ุจุฏูู ฺฉู ุฏุฑ ูุฑุญูู ูุจู ุฐุฎุฑู ุดุฏูโุงูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`out_col`: ูุฌููุนู ุฎุฑูุฌ ฺฉู ุฒุฑฺฏุฑูโูุง ูุนูุง ุฌุฏุฏ ุชููุฏุดุฏู ุชูุณุท SNS ุฏุฑ ุขู ุฐุฎุฑู ุฎูุงููุฏ ุดุฏ. <br>

ุฏุฑ ูุฑ ุฏู ููุฑุฏุ ูพุงุฑุงูุชุฑ `embedding_function` ุจุฑุงุจุฑ ุจุง `None` ูุฑุงุฑ ุฏุงุฏู ุดุฏู ุงุณุช. ุจู ุงู ุฏูู ฺฉู ุงุฒ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู ูุญู ุงุณุชูุงุฏู ูโุดูุฏ ู ูุงุฒ ุจู ุฏุงูููุฏ ุง ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ูุฏู ูพุดโูุฑุถ ูุฌูุฏ ูุฏุงุฑุฏ.
<br>

ุฏุฑ ูุฑุญูู  ุจุนุฏุ ุจุฑุง ูพุงุฏูโุณุงุฒ ูุฑุขูุฏ SNSุ ุชุงุจุน `sns_split` ุจูโุตูุฑุช ุฒุฑ ุชุนุฑู ูโุดูุฏ:

```python
def semantic_chunk_text(text, threshold=SIM_THRESHOLD, min_len=MIN_CHUNK_LEN, max_len=MAX_CHUNK_LEN):
    sents = [s.strip() for s in sent_tokenize(text) if len(s.strip()) > 15]
    if len(sents) <= min_len:
        return [" ".join(sents)]

    with torch.no_grad():
        embs = model.encode(
            sents,
            batch_size=BATCH_SIZE,
            normalize_embeddings=True,
            show_progress_bar=False
        )

    sims = util.cos_sim(embs[:-1], embs[1:]).diagonal().cpu().numpy()
    chunks, cur_chunk = [], [sents[0]]

    for i in range(1, len(sents)):
        if sims[i-1] < threshold or len(cur_chunk) >= max_len:
            chunks.append(" ".join(cur_chunk))
            cur_chunk = [sents[i]]
        else:
            cur_chunk.append(sents[i])

    if cur_chunk:
        chunks.append(" ".join(cur_chunk))

    return chunks
```
ุชูุถุญ ูุฑุงุญู ุงุฌุฑุง ุชุงุจุน: <br>

&nbsp;&nbsp;&nbsp; ฑ) ุฌูููโุจูุฏ ุงููู: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุงุณุชุฎุฑุงุฌ: ูุชู ุจู ุฌูููโูุง ุจุง `sent_tokenize` ุชูุณู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ููุชุฑ ุทูู: ุชููุง ุฌูููโูุง ุจุง ุทูู ุจุด ุงุฒ ฑต ฺฉุงุฑุงฺฉุชุฑ ูพุฐุฑูุชู ูโุดููุฏ ุชุง ูุงุญุฏูุง ฺฉูโุงุฑุฒุด ุญุฐู ุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ูุฏุฑุช ูุชูู ฺฉูุชุงู: ุงฺฏุฑ ุชุนุฏุงุฏ ุฌูููโูุง ฺฉูุชุฑ ุง ุจุฑุงุจุฑ ุจุง min_len ุจุงุดุฏุ ููุงู ูุชู ุจูโุตูุฑุช ฺฉ ูุทุนู ูุงุญุฏ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ.

<br>

&nbsp;&nbsp;&nbsp; ฒ) ุจุฑุฏุงุฑุณุงุฒ ุฌููุงุช: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุญุงูุธู: ุงุฌุฑุง ฺฉุฏฺฏุฐุงุฑ ุฏุงุฎู `torch.no_grad` ุจุฑุง ฺฉุงูุด ูุตุฑู ุญุงูุธู ู ุฌููฺฏุฑ ุงุฒ ฺฏุฑุงุฏุงู. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ฺฉุฏฺฏุฐุงุฑ: ุงุณุชูุงุฏู ุงุฒ `model.encode` ุจุง `batch_size=BATCH_SIZE` ู `normalize_embeddings=True` ุจุฑุง ูพุงุฏุงุฑ ุดุจุงูุช ฺฉุณููุณ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฎุฑูุฌ: ุจุฑุฏุงุฑูุง ุฌูููโูุง ุฏุฑ `embs` ุฐุฎุฑู ูโุดููุฏ. 

<br>

&nbsp;&nbsp;&nbsp; ณ) ูุญุงุณุจู ุดุจุงูุช ูุนูุง ูุชูุงู: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฑูุด: ูุญุงุณุจู ุดุจุงูุช ฺฉุณููุณ ุจู ูุฑ ุฌููู ู ุฌููู ุจุนุฏ ุจุง `util.cos_sim`. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุงุณุชุฎุฑุงุฌ: ููุท ูุทุฑ ุงุตู ุจุฑุง ุฒูุฌโูุง ูุชูุงู (i,i+1) ุงุณุชุฎุฑุงุฌ ูโุดูุฏ ู ุฏุฑ `sims` ุฐุฎุฑู ูโฺฏุฑุฏุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ููุทู: ุงูฺฏูุฑุชู SNS ุฎุท ุงุณุชุ ููุท ูพูุณุชฺฏ ุชูุงู ุงููุช ุฏุงุฑุฏุ ูู ุฎูุดูโุจูุฏ ฺฉุงูู.

<br>

&nbsp;&nbsp;&nbsp; ด) ุชุดฺฉู ูุทุนุงุช ูุนูุง: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุดุฑูุน: ูุทุนู ุงููู ุจุง ุฌููู ุงูู `cur_chunk = [sents[0]]` ุขุบุงุฒ ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุญููู ุจุฑุด: โุจุฑุง ูุฑ ุฌููู ุจุนุฏ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุดุฑุท ุจุฑุด: ุงฺฏุฑ ุดุจุงูุช ุจุง ุฌููู ูุจู ฺฉูุชุฑ ุงุฒ `threshold` ุจุงุดุฏ ุง ุทูู ูุทุนู ุจู `max_len` ุจุฑุณุฏุ ูุทุนู ุฌุงุฑ ุจุณุชู ุดุฏู ู ุฌููู ูุนู ุขุบุงุฒฺฏุฑ ูุทุนู ุฌุฏุฏ ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุงุฏุงูู ูุทุนู: โุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุฌููู ูุนู ุจู ูุทุนู ุฌุงุฑ ุงูุฒูุฏู ูโุดูุฏ. <br>
ุด	ูพุงุงู:โ ุงฺฏุฑ ูุทุนูโุง ูููโุชูุงู ุจุงู ูุงูุฏู ุจุงุดุฏุ ุจู ุฎุฑูุฌ ุงูุฒูุฏู ูโุดูุฏ.

<br>

&nbsp;&nbsp;&nbsp; ต) ุจุงุฒฺฏุฑุฏุงูุฏู ุฎุฑูุฌ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ูุชุฌู: ูุณุช ุงุฒ chunks ุดุงูู ูุทุนุงุช ูุนูุง ููุณุฌู ู ฺฉูุชุฑูโุดุฏู ุงุฒ ูุธุฑ ุทููุ ุขูุงุฏู ุจุฑุง ูุฑุงุญู ุจุนุฏ (ุฑุฒุชูุธูุ ุงุฑุฒุงุจุ ุง ุจุงุฒุงุจ ุฏุฑ RAG)

<br>

ุฏุฑ ูุฑุญูู  ุจุนุฏุ ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุงูู ุฒุฑฺฏุฑูโูุง ูุนูุง ุชููุฏุดุฏู ุชูุณุท SNS ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑุ ุชุงุจุน `flush_buffer` ุจูโุตูุฑุช ุฒุฑ ุชุนุฑู ูโุดูุฏ:
```python
buffer_ids = []
buffer_docs = []
buffer_meta = []

def flush_buffer():
    """Safely write buffered SNS nodes to DB."""
    global buffer_ids, buffer_docs, buffer_meta
    if not buffer_ids:
        return

    out_col.add(
        ids=buffer_ids,
        documents=buffer_docs,
        metadatas=buffer_meta
    )

    buffer_ids, buffer_docs, buffer_meta = [], [], []
```
ุชูุถุญ ูุฑุงุญู: <br>
&nbsp;&nbsp;&nbsp; ฑ) ุชุนุฑู ุจุงูุฑูุง: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`buffer_ids`: ุดูุงุณูโูุง ฺฉุชุง ุจุฑุง ูุฑ ุฒุฑฺฏุฑู ูุนูุง. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`buffer_docs`: ูุชู ูุทุนู ุง ฺุงูฺฉ ูุฑุจูุท ุจู ูุฑ ุฒุฑฺฏุฑู. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`buffer_meta`: ูุชุงุฏุชุงูุง ูุฑุชุจุท ุจุง ูุฑ ุฒุฑฺฏุฑู (ูุงููุฏ ูููุนุช ุฏุฑ ูุชู ุงุตู ุง ุงุทูุงุนุงุช ุฌุงูุจ). 

<br>

&nbsp;&nbsp;&nbsp; ฒ) ุชุงุจุน `flush_buffer`: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ุงุจุชุฏุง ุจุฑุฑุณ ูโุดูุฏ ฺฉู ุขุง ุจุงูุฑูุง ุฎุงู ูุณุชูุฏ ุง ุฎุฑ. ุงฺฏุฑ ุฎุงู ุจุงุดูุฏุ ุชุงุจุน ุจุฏูู ุงูุฌุงู ุนููุงุช ุฎุงุชูู ูโุงุจุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ุตูุฑุช ูุฌูุฏ ุฏุงุฏูุ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ `add`ุ ุดูุงุณูโูุงุ ูุชูโูุง ู ูุชุงุฏุชุงูุง ุจู ูุฌููุนู ุฎุฑูุฌ `out_col` ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ChromaDB ุงูุฒูุฏู ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูพุงุงูุ ุจุงูุฑูุง ุชุฎูู ุดุฏู ู ุขูุงุฏู ุฐุฎุฑูโุณุงุฒ ุฏุงุฏูโูุง ุฌุฏุฏ ูโุดููุฏ. 

<br>

ุฏุฑ ุจุฎุด ูพุงุงูุ ฺฉุฏ ูุง ุงุตู ุจุฑุง ุงุฌุฑุง ูุทุนู ุจูุฏ ูุนูุง AF + SNS ูุฑุงุฑ ุฏุงุฑูุฏ:
```python
items = in_col.get()
total = len(items["ids"])
print(f"[START] Running SNS on {total} B2 chunks...\n")
for idx, doc, meta in tqdm(
    zip(items["ids"], items["documents"], items["metadatas"]),
    total=total,
    desc="SNS splitting"
):
   nodes = sns_split(doc)
    for j, n in enumerate(nodes):
        buffer_ids.append(f"{idx}_sns_{j}")
        buffer_docs.append(n)
        buffer_meta.append({
            **meta,
            "sns_index": j,
            "sns_source": idx
        })
    if len(buffer_ids) >= DB_BATCH:
        flush_buffer()
flush_buffer()
print("\n[DONE] SNS Completed Successfully!")
```
ุชูุถุญ ูุฑุงุญู: <br>
&nbsp;&nbsp;&nbsp; ฑ) ูุฑุงุฎูุงู ูพุงฺฏุงู ุฏุงุฏู ูุฑูุฏ: ุจุง ุฏุณุชูุฑ `items = in_col.get` ูุฌููุนู ูุฑูุฏ ุดุงูู ูุทุนุงุช ูุนูุง  ุจุฏูู ุงุฒ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ูุฑุงุฎูุงู ูโุดูุฏ. ุณูพุณ ุชุนุฏุงุฏ ฺฉู ูุทุนุงุช ุจุง `len(items["ids"])` ูุญุงุณุจู ู ููุงุด ุฏุงุฏู ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ฒ) ุญููู ูพุฑุฏุงุฒุด ุงุตู: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุฑ ุชฺฉุฑุงุฑ ุญูููุ ุดูุงุณู `idx`ุ ูุชู ูุทุนู (doc) ู ูุชุงุฏุชุง (meta) ุฏุฑุงูุช ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุจุง ูุฑุงุฎูุงู ุชุงุจุน `sns_split(doc)`ุ ุนููุงุช ุฑุฒุฏุงููโุณุงุฒ ูุนูุง ุฑู ูุทุนู ุงูุฌุงู ุดุฏู ู ุฒุฑฺฏุฑูโูุง ุฌุฏุฏ ุชููุฏ ูโุดููุฏ. <br>

&nbsp;&nbsp;&nbsp; ณ) ุงุฌุงุฏ ุดูุงุณู ู ูุชุงุฏุชุง ุจุฑุง ุฒุฑฺฏุฑูโูุง: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุจุฑุง ูุฑ ุฒุฑฺฏุฑู ุฌุฏุฏุ ฺฉ ุดูุงุณู ฺฉุชุง ุณุงุฎุชู ูโุดูุฏ `{idx}_sns_{j}`. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ูุชู ุฒุฑฺฏุฑู ุฏุฑ `buffer_docs` ุฐุฎุฑู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ูุชุงุฏุชุง ุฌุฏุฏ ุดุงูู ุฏู ุจุฎุด ุงุถุงูู ูโุดูุฏ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	`sns_index`: ุดูุงุฑู ุฒุฑฺฏุฑู ุฏุฑ ูุฌููุนู ฺฏุฑู ูุงูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	`sns_source`: ุดูุงุณู ฺฏุฑู ูุงูุฏ. <br>

&nbsp;&nbsp;&nbsp; ด) ูุฏุฑุช ุจุงูุฑูุง: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุงฺฏุฑ ุชุนุฏุงุฏ ุดูุงุณูโูุง ุฐุฎุฑูโุดุฏู ุฏุฑ ุจุงูุฑ ุจู ุญุฏ ุขุณุชุงูู `DB_BATCH` ุจุฑุณุฏุ ุชุงุจุน `flush_buffer` ูุฑุงุฎูุงู ุดุฏู ู ุฏุงุฏูโูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุฎุฑูุฌ ุฐุฎุฑู ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูพุงุงู ุงุฌุฑุง ุญูููุ ุงฺฏุฑ ุฏุงุฏูโุง ุฏุฑ ุจุงูุฑ ุจุงู ูุงูุฏู ุจุงุดุฏุ ูุฌุฏุฏุงู ุจุง `flush_buffer` ุฐุฎุฑู ู ุชุฎูู ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ต) ูพุงุงู ุงุฌุฑุง ุจุฑูุงูู: ูพุณ ุงุฒ ุฐุฎุฑูโุณุงุฒ ฺฉุงูู ุฒุฑฺฏุฑูโูุงุ ูพุงู ููููุชโุขูุฒ ุจูุฏู ูุฑุขูุฏ ููุงุด ุฏุงุฏู ูโุดูุฏ. <br>
 
<div align="center">

![ุชุตูุฑ ฒถ โ ูุซุงู ุฎุฑูุฌ ุงุฌุฑุง ฺฉุฏ ูุทุนู ุจูุฏ SNS ุจุฑุง ูพฺฉุฑุจูุฏ 17 TB + G 
](/assets/patterneffort/synergistic-rag/media/fig26.JPG)

</div>

<p style="text-align:center;">
  <sub>ุชุตูุฑ ฒถ โ ูุซุงู ุฎุฑูุฌ ุงุฌุฑุง ฺฉุฏ ูุทุนู ุจูุฏ SNS ุจุฑุง ูพฺฉุฑุจูุฏ 17 TB + G </sub>
</p>

<br>


---

### ูุนูุงุฑ RAG ุจุง ุฑูฺฉุฑุฏ Abstract-First + SNS
ุฏุฑ ุจุฎุด ุฏูู ุฑูฺฉุฑุฏ ูพุดููุงุฏุ ุงุฏู Semantic Node Splitter (SNS) ฺฉู ูพุดโุชุฑ ุฏุฑ ุฑุฒุชูุธู ูุฏูโูุง ุฌุงููุง ุชูุณุท ููุงูู Aytar ูุทุฑุญ ุดุฏู ุจูุฏุ ุฏุฑ ูุนูุงุฑ ููโุงูุฒุง RAG ุจุณุท ุฏุงุฏู ูโุดูุฏ. ุชูุงูุช ุงุตู ุงู ุฑูฺฉุฑุฏ ุจุง ูุนูุงุฑ ฺฉูุงุณฺฉ RAG ุฏุฑ ูุญูู ุจุงุฒุงุจ ุงุทูุงุนุงุช ุงุณุช: <br>

&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุนูุงุฑ ุณูุชุ ูุทุนุงุช ูุนูุง ุจุฏูู ููุงูุงุช (Body chunks) ุจูโุทูุฑ ูุณุชูู ุงุณุชุฎุฑุงุฌ ู ุจู ูุฏู ุฒุจุงู ุงุฑุณุงู ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ุฑูฺฉุฑุฏ ุฌุฏุฏุ ุจู ุฌุง ุงุณุชูุงุฏู ุงุฒ ุงู ูุทุนุงุช ุฏุฑุดุชโุฏุงููุ ุฑุฒูุทุนูโูุง ูุนูุง ฺฉู ูพุดโุชุฑ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุงุฌุงุฏ ู ุฐุฎุฑู ุดุฏูโุงูุฏุ ุจุงุฒฺฏุฑุฏุงู ูโุดููุฏ. 

<br>

ูุฑุขูุฏ ุงุฌุงุฏ ุฒุฑฺฏุฑูโูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุฏุฑ ุจุฎุด ูพุดู ุชูุถุญ ุฏุงุฏู ุดุฏ. ุจูโุทูุฑ ุฎูุงุตูุ ูุฑ ูุทุนู ุจุฏูู ุจู ฺฉูฺฉ ูุฏู ุฌุงููุง ุจู ฺูุฏ ุฒุฑฺฏุฑู ฺฉูุชุงูโุชุฑ ู ูุนูุง ุชูุณู ูโุดูุฏ ู ุงู ุฒุฑฺฏุฑูโูุง ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุฐุฎุฑู ูโฺฏุฑุฏูุฏ.

<br> 

#### ุฌุฑุงู ุนููุงุช RAG AF+SNS
ุจุง ุชูุฌู ุจู ูุฌููุนู ุฐุฎุฑูโุณุงุฒโุดุฏู ุฏุฑ ูุทุนูโุจูุฏ ูุนูุง SNSุ ุนููุงุช RAG AF ุจูโุตูุฑุช ุฒุฑ ุงูุฌุงู ูโุดูุฏ:

<br>

`Query โ Abstract retrieval โ Body chunks โ SNS โ Vectorstore search โ LLM response`

<br>
&nbsp;&nbsp;&nbsp; ฑ) Query: ูพุฑุณุด ฺฉุงุฑุจุฑ ูุงุฑุฏ ุณุณุชู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp; ฒ) Abstract retrieval: ุงุจุชุฏุง ฺฺฉุฏู ููุงูู ุง ููุจุน ูุฑุชุจุท ุจุงุฒุงุจ ูโุดูุฏ (ุฑูฺฉุฑุฏ Abstract First). <br>
&nbsp;&nbsp;&nbsp; ณ) Body chunks: ุฏุฑ ุตูุฑุช ูุงุฒุ ุจุฏูู ููุงูู ูุฒ ุจูโุนููุงู ููุจุน ุซุงููู ูุฑุงุฎูุงู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp; ด) SNS sub nodes: ุจุฏูู ููุงูู ุจู ุฒุฑฺฏุฑูโูุง ูุนูุง ุชูุณู ุดุฏู ู ุงู ุฒุฑฺฏุฑูโูุง ุจูโุนููุงู ูุงุญุฏูุง ุจุงุฒุงุจ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ูโฺฏุฑูุฏ. <br>
&nbsp;&nbsp;&nbsp; ต) Vectorstore search: ุฌุณุชุฌู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ (ChromaDB) ุจุฑ ุงุณุงุณ ุฒุฑฺฏุฑูโูุง ุงูุฌุงู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp; ถ) LLM response: ูุฏู ุฒุจุงู (ูุงููุฏ `Qwen-2.5-3B`) ูพุงุณุฎ ููุง ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ context ูุง ุฏููโุชุฑ ู ุฑุฒุฏุงูู [^66] ุชููุฏ ูโฺฉูุฏ. 

<br>

ุจู ุงู ุชุฑุชุจ ุฏุฑ ุจุฎุด ุจุงุฒุงุจุ ูุดุงุจู ฺฉุฏูุง ูุจูุ ูุฏู ุฌุงููุง ู ูุฏู ุฒุจุงู ุจุงุฑฺฏุฐุงุฑ ู ุชูุธู ูโุดููุฏ. ุณูพุณ ูพุงฺฏุงูโูุง ุฏุงุฏู ูุฑุจูุท ุจู ฺฺฉุฏูโูุง ู ุฒุฑฺฏุฑูโูุง ูุนูุง ูุฑุงุฎูุงู ุดุฏู ู ูุฌููุนูโูุง ูุฑุจูุท ุจู ูุฑ ฺฉ ุขูุงุฏู ุงุณุชูุงุฏู ูโฺฏุฑุฏูุฏ. ุจุง ุงู ุชูุงูุช ฺฉู ุงุจุชุฏุง ูพุณ ุงุฒ ุชุนู ฑฐฐ ฺฺฉุฏู  ุจุฑุชุฑุ ดฐ ุฒุฑฺฏุฑู ุจุฑุชุฑ ุงูุชุฎุงุจ ุดุฏูุ ุณูพุณ ุงุฒ ูุงู ุงู ดฐ ุฒุฑ ฺฏุฑูุ ถ ุฒุฑฺฏุฑู ุจุฑุชุฑ ุจุง ุชูุฌู ุจู ุจุฑุชุฑ ฺฏุฑู ูุงูุฏ ุขููุง ุงุฒ ูุธุฑ ูุนูุง ุงูุชุฎุงุจ ูโุดููุฏ.
<br>

ุฏุฑ ุงุจุชุฏุง ูพุงุฏูโุณุงุฒ ุฑูฺฉุฑุฏ RAG AF + SNSุ ฺฉุชุงุจุฎุงููโูุง ู ูุณุฑูุง ูุฑูุฏ/ุฎุฑูุฌ ููุฑุฏ ูุงุฒ ูุฑุงุฎูุงู ู ุชูุธู ูโุดููุฏ:
```python
import os, json, torch, re
from pathlib import Path
from tqdm import tqdm
from sentence_transformers import SentenceTransformer
from chromadb import PersistentClient
from transformers import AutoTokenizer, AutoModelForCausalLM, pipeline
import nltk
nltk.download("punkt", quiet=True)

QUERIES_FILE = r" Enter .jsonl queries input location "  
OUTPUT_FILE  = r" Enter .jsonl output destination "

CHROMA_ABS_PATH = r" Enter abstracts SC vector Database location "  CHROMA_SNS_PATH = r" Enter SNS vector Database location "

EMBED_MODEL_PATH = r" Enter fine-tuned embedding model location "            
LLM_MODEL_PATH   = r" Enter Local LLM Model location "

TOP_A = 100     
TOP_C = 40      
MAX_NEW = 300
MAX_CONTEXTS = 6

DEVICE = "cuda" if torch.cuda.is_available() else "cpu"
```
ุชูุถุญ ูุฑุงุญู: <br>

&nbsp;&nbsp;&nbsp; ฑ) ูุฑุงุฎูุงู ฺฉุชุงุจุฎุงููโูุง: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ฺฉุชุงุจุฎุงููโูุง ูพุฑุฏุงุฒุด ูุชูุ ูุฏูโูุง ุฒุจุงู ู ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุชูฺฉูุงุฒุฑ ุฌููุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ nltk ุขูุงุฏูโุณุงุฒ ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ฒ) ูุณุฑูุง ูุฑูุฏ ู ุฎุฑูุฌ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`QUERIES_FILE`: ูุณุฑ ูุงู ูุฑูุฏ ุดุงูู ูพุฑุณุดโูุง ฺฉุงุฑุจุฑ (ูุฑูุช .jsonl) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`OUTPUT_FILE`: ูุณุฑ ูุงู ุฎุฑูุฌ ุจุฑุง ุฐุฎุฑู ูุชุงุฌ ูพุงุณุฎ ูุฏู. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`CHROMA_ABS_PATH`: ูุณุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุดุงูู ฺฺฉุฏูโูุง. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`CHROMA_SNS_PATH`: ูุณุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุดุงูู ุฒุฑฺฏุฑูโูุง ูุนูุง ุจุฏูู ฺฉู ุชูุณุท ุงูฺฏูุฑุชู SNS ุงุฌุงุฏ ุดุฏูโุงูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`EMBED_MODEL_PATH`: ูุณุฑ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`LLM_MODEL_PATH`: ูุณุฑ ูุฏู ุฒุจุงู ูุญู (Local LLM). <br>

&nbsp;&nbsp;&nbsp; ณ) ูพุงุฑุงูุชุฑูุง ฺฉูุฏ ูุนูุงุฑ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	`TOP_A = 100`: ุชุนุฏุงุฏ ฺฺฉุฏูโูุง ุจุฑุชุฑ ุจุงุฒุงุจโุดุฏู (`Top N`). <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โขโ	 `TOP_C = 40`: ุชุนุฏุงุฏ ุฑุฒูุทุนูโูุง ูุนูุง ุจุฑุชุฑ ุงูุชุฎุงุจโุดุฏู ุงุฒ ูุงู ฺฺฉุฏูโูุง (ูุดุงุจู Top K ุฏุฑ RAG ุณุงุฏู). <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	`MAX_NEW = 300`: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุชูฺฉูโูุง ุชููุฏ ุชูุณุท ูุฏู ุฒุจุงู. <br>

&nbsp;&nbsp;&nbsp; ด) ุชุนู ุฏุณุชฺฏุงู ูพุฑุฏุงุฒุด (Device): ุจุง ุงุณุชูุงุฏู ุงุฒ `torch.cuda.is_available` ุจุฑุฑุณ ูโุดูุฏ ฺฉู ุขุง  GPU ุฏุฑ ุฏุณุชุฑุณ ุงุณุช ุง ุฎุฑ. ุฏุฑ ุตูุฑุช ูุฌูุฏุ ูุฏู ุจุฑ ุฑู CUDA ุงุฌุฑุง ูโุดูุฏ ู ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุงุฒ CPU ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ.

<br>

ุฏุฑ ูุนูุงุฑ RAG AF ููุงูู ุ ุชููุง ฺฉ ูพุงฺฏุงู ุฏุงุฏู ุดุงูู ฺฺฉุฏูโูุง ู ูุทุนุงุช ุจุฏูู ููุงูู ุงุณุชูุงุฏู ูโุดูุฏ. ุงูุง ุฏุฑ ุงู ุฑูฺฉุฑุฏ ุฌุฏุฏุ ุนูุงูู ุจุฑ ูพุงฺฏุงู ุฏุงุฏู ฺฺฉุฏูโูุงุ ูพุงฺฏุงู ุฏุงุฏู ุฏฺฏุฑ ุดุงูู ุฑุฒฺฏุฑูโูุง ูุนูุง ูุฒ ุจู ฺฉุงุฑ ฺฏุฑูุชู ูโุดูุฏ. ุงู ุงูุฑ ุจุงุนุซ ุงูุฒุงุด ุฏูุช ุฏุฑ ุจุงุฒุงุจ context ูุง ู ุจูุจูุฏ ฺฉูุช ูพุงุณุฎโุฏู ูุฏู ุฒุจุงู ุฎูุงูุฏ ุดุฏ.



ุฏุฑ ูุฑุญูู ุฏููุ ูุดุงุจู ฺฉุฏูุง ูุจูุ ูุฏู ุฌุงููุง ู ูุฏู ุฒุจุงู ุจุงุฑฺฏุฐุงุฑ ู ุชูุธู ูโุดููุฏ. ุณูพุณ ูพุงฺฏุงูโูุง ุฏุงุฏู ูุฑุจูุท ุจู ฺฺฉุฏูโูุง ู ุฒุฑฺฏุฑูโูุง ูุนูุง ูุฑุงุฎูุงู ุดุฏู ู ูุฌููุนูโูุง ูุฑุจูุท ุจู ูุฑ ฺฉ ุขูุงุฏู ุงุณุชูุงุฏู ูโฺฏุฑุฏูุฏ:
```python
print(f"๐น Loading embedding model: {EMBED_MODEL_PATH}")
embed_model = SentenceTransformer(EMBED_MODEL_PATH, device=DEVICE)

print(f"๐น Loading LLM model: {LLM_MODEL_PATH}")
tokenizer = AutoTokenizer.from_pretrained(LLM_MODEL_PATH)
llm_model = AutoModelForCausalLM.from_pretrained(
    LLM_MODEL_PATH,
    torch_dtype=torch.float16 if DEVICE=="cuda" else torch.float32
).to(DEVICE)

generator = pipeline(
    "text-generation",
    model=llm_model,
    tokenizer=tokenizer,
    device=0 if DEVICE=="cuda" else -1,
    max_new_tokens=MAX_NEW,
    temperature=0.5,
    return_full_text=False
)

client_abs = PersistentClient(path=CHROMA_ABS_PATH)
client_sns = PersistentClient(path=CHROMA_SNS_PATH)
abs_collection = client_abs.get_collection("abstracts")
sns_collection = client_sns.get_collection("TB17-G-AF-SNS")
```
ุชูุถุญ ูุฑุงุญู: <br>
&nbsp;&nbsp;&nbsp; ฑ) ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฌุงููุง: ูุฏู ุฑุฒุชูุธูโุดุฏู ุฌุงููุง ุงุฒ ูุณุฑ ูุดุฎุตโุดุฏู ุฏุฑ `EMBED_MODEL_PATH` ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ ู ุจุฑ ุงุณุงุณ ุฏุณุชฺฏุงู ูพุฑุฏุงุฒุด (cuda ุง cpu) ุงุฌุฑุง ูโฺฏุฑุฏุฏ. <br>

&nbsp;&nbsp;&nbsp; ฒ) ุจุงุฑฺฏุฐุงุฑ ูุฏู ุฒุจุงู: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุชูฺฉูุงุฒุฑ ูุฏู ุฒุจุงู ุงุฒ ูุณุฑ `LLM_MODEL_PATH` ูุฑุงุฎูุงู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โข	ูุฏู ุฒุจุงู ุจุง ุชูุฌู ุจู ููุน ุฏุณุชฺฏุงู ูพุฑุฏุงุฒุด ู ุฏูุช ุฏุงุฏูโูุง (`float16` ุจุฑุง GPU ู `float32` ุจุฑุง CPU) ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุณูพุณ ูุฏู ุจู ฺฉูฺฉ pipeline ุจุฑุง ูุธูู ุชููุฏ ูุชู (text generation) ุขูุงุฏูโุณุงุฒ ูโุดูุฏ. ูพุงุฑุงูุชุฑูุง ฺฉูุฏ ุดุงูู: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	`max_new_tokens`: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุชูฺฉูโูุง ุชููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	`temperature`: ูุฒุงู ุชููุน ุฏุฑ ุชููุฏ ูุชู. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	`return_full_text=False`: ููุท ูุชู ุชููุฏ ุฌุฏุฏ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ณ) ุงุชุตุงู ุจู ูพุงฺฏุงู ุฏุงุฏูโูุง: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`client_abs`: ุงุชุตุงู ุจู ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุดุงูู ฺฺฉุฏูโูุง. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`client_sns`: ุงุชุตุงู ุจู ูพุงฺฏุงู ุฏุงุฏู ุจุฑุฏุงุฑ ุดุงูู ุฒุฑฺฏุฑูโูุง ูุนูุง (SNS sub nodes). <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`abs_collection`: ูุฌููุนู ูุฑุจูุท ุจู ฺฺฉุฏูโูุง. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`sns_collection`: ูุฌููุนู ูุฑุจูุท ุจู ุฒุฑฺฏุฑูโูุง ูุนูุง ฺฉู ุฏุฑ ูุฑุญูู ูุจู ุชูุณุท ุงูฺฏูุฑุชู SNS ุงุฌุงุฏ ุดุฏูโุงูุฏ. <br>

ุณูพุณ ุฏุฑ ูุฑุญูู ุจุนุฏุโ ุชุงุจุน `retrieve_from_abstracts` ุจูโุตูุฑุช ุฒุฑ ุชุนุฑู ูโุดูุฏ:
```python
def retrieve_from_abstracts(query, top_k=TOP_A):
    q_emb = embed_model.encode(
        [query],
        normalize_embeddings=True
    )[0].tolist()

    res = abs_collection.query(
        query_embeddings=[q_emb],
        n_results=top_k
    )
    return res["ids"][0]
```
ุชูุถุญ ูุฑุงุญู: <br>
&nbsp;&nbsp;&nbsp; ฑ) ุจุฑุฏุงุฑุณุงุฒ ูพุฑุณุด ฺฉุงุฑุจุฑ `q_emb`: ูพุฑุณุด ฺฉุงุฑุจุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฌุงููุง ุฑุฒุชูุธูโุดุฏู `embed_model` ุจู ฺฉ ุจุฑุฏุงุฑ ูุนูุง ุชุจุฏู ูโุดูุฏ. ุงู ุจุฑุฏุงุฑ ุจูโุนููุงู ููุงูุฏู ูุนูุง ูพุฑุณุด ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ. <br>

&nbsp;&nbsp;&nbsp; ฒ) ุฌุณุชุฌู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ฺฺฉุฏูโูุง `res`: ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ `query` ุฏุฑ ูุฌููุนู ฺฺฉุฏูโูุง `abs_collection`ุ ุจุฑุฏุงุฑ ูพุฑุณุด ุจุง ุจุฑุฏุงุฑูุง ุฐุฎุฑูโุดุฏู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ููุงุณู ูโุดูุฏ. ุชุนุฏุงุฏ ูุชุงุฌ ุจุงุฒุงุจโุดุฏู ูุญุฏูุฏ ุจู ููุฏุงุฑ `top_k`  (ฺฉู ุจุฑุงุจุฑ ุจุง `TOP_A` ุชุนุฑู ุดุฏู ุงุณุช) ุฎูุงูุฏ ุจูุฏ. <br>

&nbsp;&nbsp;&nbsp; ณ) ุงุณุชุฎุฑุงุฌ ุดูุงุณูโูุง ู ูุชู ฺฺฉุฏูโูุง: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`abstract_ids`: ุดูุงุณู ููุงูุงุช ุจุงุฒุงุจโุดุฏู (ูุงููุฏ ุดูุงุฑู ููุงูู ุง ูุณุฎู ุขู). <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`abstract_docs`: ูุชู ฺฺฉุฏูโูุง ูุฑุจูุท ุจู ููุงูุงุช ุจุงุฒุงุจโุดุฏู. <br>

&nbsp;&nbsp;&nbsp; ด) ุจุงุฒฺฏุฑุฏุงูุฏู ุฎุฑูุฌ: ุชุงุจุน ุฏุฑ ููุงุช ุดูุงุณูโูุง ู ูุชู ฺฺฉุฏูโูุง ุจุฑุชุฑ ุฑุง ุจูโุนููุงู ุฎุฑูุฌ ุจุงุฒูโฺฏุฑุฏุงูุฏ. <br>

ูพุณ ุงุฒ ุดูุงุณุง ฑฐฐ ููุงูู ุจุฑุชุฑ ุงููู ุงุฒ ุทุฑู ฺฺฉุฏูโูุงุ ูุงุฒ ุงุณุช ฺฉู ุฒุฑฺฏุฑูโูุง ูุนูุง ูุฑุชุจุท ุจุง ุงู ููุงูุงุช ุงุฒ ูพุงฺฏุงู ุฏุงุฏู SNS ุจุงุฒุงุจ ุดููุฏ. ุจุฑุง ุงู ููุธูุฑ ุฏุฑ ูุณูุช ุจุนุฏุ ุชุงุจุน `retrieve_sns_nodes` ุจูโุตูุฑุช ุฒุฑ ุชุนุฑู ูโุดูุฏ:
```python
def retrieve_sns_nodes(query, allowed_docs, top_k=TOP_C):
    normalized_docs = [d.replace(".tei", "") for d in allowed_docs]
    all_sns = sns_collection.get(include=["metadatas", "documents"])
    ids, metas = all_sns["ids"], all_sns["metadatas"]
    valid_ids = []
    for sns_id, meta in zip(ids, metas):
        src = meta.get("sns_source", "")
        if any(src.startswith(f"{doc}.tei_chunk_") for doc in normalized_docs):
            valid_ids.append(sns_id)
    if not valid_ids:
        return []
    q_emb = embed_model.encode(
        [query],
        normalize_embeddings=True
    )[0].tolist()
    res = sns_collection.query(
        query_embeddings=[q_emb],
        n_results=top_k,
        ids=valid_ids
    )
    return [
        {"text": d, **m}
        for d, m in zip(res["documents"][0], res["metadatas"][0])
    ]
```
ุฏุฑ ฺฉุฏ ููู ุนููุงุช ูุง ุฒุฑ ุงูุฌุงู ูโุดููุฏ: <br>
&nbsp;&nbsp;&nbsp; ฑ) ูุฑูุงูโุณุงุฒ ุดูุงุณูโูุง `normalized_docs`: ุดูุงุณูโูุง ููุงูุงุช ูุฑูุฏ ุงุตูุงุญ ูโุดููุฏ ุชุง ูพุณููุฏ .tei ุญุฐู ุดูุฏ ู ุจุง ูุงูุจ ุฐุฎุฑูโุดุฏู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู SNS ุณุงุฒฺฏุงุฑ ุจุงุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ฒ) ูุฑุงุฎูุงู ุฒุฑฺฏุฑูโูุง ุงุฒ ูพุงฺฏุงู ุฏุงุฏู SNS: ุจุง ุฏุณุชูุฑ sns_collection.get() ุชูุงู ุดูุงุณูโูุงุ ูุชุงุฏุชุงูุง ู ูุญุชูุงูุง ุฒุฑฺฏุฑูโูุง ูุนูุง ูุฑุงุฎูุงู ูโุดููุฏ. ุงู ุฏุงุฏูโูุง ุดุงูู ุฏู ุจุฎุด ุงุตู ูุณุชูุฏ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`ids`: ุดูุงุณูโูุง ุฒุฑฺฏุฑูโูุง <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	`metadatas`: ูุชุงุฏุชุงูุง ูุฑุจูุท ุจู ูุฑ ุฒุฑฺฏุฑู <br>

&nbsp;&nbsp;&nbsp; ณ) ุงูุชุฎุงุจ ุฒุฑฺฏุฑูโูุง ูุนุชุจุฑ `valid_ids`: ุฏุฑ ุญููู ูพุฑุฏุงุฒุดุ ุชููุง ุฒุฑฺฏุฑูโูุง ุงูุชุฎุงุจ ูโุดููุฏ ฺฉู ููุฏุงุฑ `sns_source` ุขูโูุง ุจุง ฺฉ ุงุฒ ุดูุงุณูโูุง ููุงูุงุช ูุฑูุงูโุดุฏู ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ. ุงู ฺฉุงุฑ ุชุถูู ูโฺฉูุฏ ฺฉู ููุท ุฒุฑฺฏุฑูโูุง ูุฑุชุจุท ุจุง ููุงูุงุช ููุชุฎุจ ูุงุฑุฏ ูุฑุขูุฏ ุจุงุฒุงุจ ุดููุฏ. <br>

&nbsp;&nbsp;&nbsp; ด) ฺฉูุชุฑู ูุจูุฏ ุฒุฑฺฏุฑู ูุนุชุจุฑ: ุงฺฏุฑ ูฺ ุฒุฑฺฏุฑูโุง ุจุง ููุงูุงุช ูุฑูุฏ ูุทุงุจูุช ูุฏุงุดุชู ุจุงุดุฏุ ุชุงุจุน ููุฏุงุฑ ุชู`[]` ุจุงุฒูโฺฏุฑุฏุงูุฏ. ุฏุฑ ุงู ูุณุฎู ุฏฺฏุฑ ูพุงู ูุดุฏุงุฑ ฺุงูพ ููโุดูุฏุ ุจูฺฉู ุจูโุณุงุฏฺฏ ุฎุฑูุฌ ุฎุงู ุจุฑฺฏุฑุฏุงูุฏู ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ต) ุจุฑุฏุงุฑุณุงุฒ ูพุฑุณุด ฺฉุงุฑุจุฑ `q_emb`: ูพุฑุณุด ฺฉุงุฑุจุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฌุงููุง ุจู ุจุฑุฏุงุฑ ูุนูุง ุชุจุฏู ูโุดูุฏ ุชุง ุงูฺฉุงู ููุงุณูโ ูุนูุง ูุฑุงูู ฺฏุฑุฏุฏ. <br>

&nbsp;&nbsp;&nbsp; ถ) ุฌุณุชุฌู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู SNS: ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ `query`ุ ุจุฑุฏุงุฑ ูพุฑุณุด ุจุง ุจุฑุฏุงุฑูุง ุฒุฑฺฏุฑูโูุง ูุนุชุจุฑ ููุงุณู ูโุดูุฏ. ุชุนุฏุงุฏ ูุชุงุฌ ุจุงุฒุงุจโุดุฏู ูุญุฏูุฏ ุจู ููุฏุงุฑ `top_k` ุฎูุงูุฏ ุจูุฏ. <br>

&nbsp;&nbsp;&nbsp; ท) ุจุงุฒฺฏุฑุฏุงูุฏู ุฎุฑูุฌ ููุฑุงู ุจุง ูุชุงุฏุชุง:โุฎุฑูุฌ ุจูโุตูุฑุช ูุณุช ุงุฒ ุฏฺฉุดูุฑโูุงุณุช ฺฉู ูุฑ ุฏฺฉุดูุฑ ุดุงูู ฺฉูุฏ `text`  (ูุชู ุฒุฑฺฏุฑู) ู ุณุงุฑ ฺฉูุฏูุง ูุชุงุฏุชุง ุงุณุช. ุงู ุณุงุฎุชุงุฑ ุงูฺฉุงู ุชุญูู ุฏููโุชุฑ ู ุงุณุชูุงุฏูโ ุบูโุชุฑ ุงุฒ ุฏุงุฏูโูุง ุฑุง ูุฑุงูู ูโฺฉูุฏ. <br>

ุฏุฑ ูุณูุช ุจุนุฏ ุชุงุจุน `sns_aware_selection` ุชุนุฑู ูโุดูุฏ:
```python
def sns_aware_selection(question, contexts, max_contexts=6, per_parent_k=1):
    from collections import defaultdict
    import numpy as np

    if not contexts:
        return []

    texts, parents = [], []
    for c in contexts:
        t = c.get("text", "").strip()
        if t:
            texts.append(t)
            parents.append(c.get("sns_source", "unknown"))

    q_emb = embed_model.encode(
        [question],
        normalize_embeddings=True
    )[0]

    c_embs = embed_model.encode(
        texts,
        normalize_embeddings=True
    )
    sims = np.dot(c_embs, q_emb)
    grouped = defaultdict(list)

    for text, pid, sim in zip(texts, parents, sims):
        grouped[pid].append((text, float(sim)))
    candidates = []
    for pid, items in grouped.items():
        items.sort(key=lambda x: x[1], reverse=True)
        parent_score = 0.7 * items[0][1] + 0.3 * np.mean([s for _, s in items])
        for text, _ in items[:per_parent_k]:
            candidates.append({
                "text": text,
                "sns_source": pid,
                "score": parent_score
            })
    candidates.sort(key=lambda x: x["score"], reverse=True)
    return candidates[:max_contexts]
```
ุฏุฑ ุงู ุชุงุจุน ูพุณ ุงุฒ ุงูุชุฎุงุจ ดฐ ุฒุฑ ฺฏุฑู ุจุฑุชุฑุ ถ ุฒุฑ ฺฏุฑู ฺฉู ฺฏุฑู ูุงูุฏ ุขููุง ุจุงูุงุชุฑู ูุฒุงู ุดุจุงูุช ูุนูุง ุจุง ูพุฑุณุด ฺฉุงุฑุจุฑ  ุฑุง ุฏุงุฑุฏุ ุงูุชุฎุงุจ ุดุฏู ู ุจุงุฒุงุจ ูโุดูุฏ. <br>

ูุฑุงุญู ุงุฌุฑุง ุชุงุจุน ุจู ุตูุฑุช ุฒุฑ ุงุณุช: <br>
&nbsp;&nbsp;&nbsp; ฑ) ุจุฑุฑุณ ูุฑูุฏโูุง <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุงฺฏุฑ ูุณุช `contexts` ุฎุงู ุจุงุดุฏุ ุฎุฑูุฌ ุฎุงู ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุงุฒ ูุฑ contextุ ูุชู (text) ุงุณุชุฎุฑุงุฌ ู ูพุงฺฉุณุงุฒ ูโุดูุฏ. ุงฺฏุฑ ูุชู ูุนุชุจุฑ ูุจุงุดุฏุ ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุดูุงุณู ูุงูุฏ (`sns_source` ุง `doc_id`) ุจุฑุง ูุฑ ูุชู ุฐุฎุฑู ูโุดูุฏ. ุงฺฏุฑ ูฺโฺฉุฏุงู ููุฌูุฏ ูุจุงุดุฏุ ููุฏุงุฑ `unknown` ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. <br>
 
&nbsp;&nbsp;&nbsp; ฒ) ุจุฑุฏุงุฑุณุงุฒ ูพุฑุณุด ู context ูุง <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูพุฑุณุด ฺฉุงุฑุจุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฌุงููุง `emb_model.encode` ุจู ุจุฑุฏุงุฑ ูุนูุง ุชุจุฏู ูโุดูุฏ. <br>
ุฏ	ุชูุงู ูุชูโูุง ูุนุชุจุฑ ูุฒ ุจู ุจุฑุฏุงุฑูุง ูุฑูุงูโุดุฏู ุชุจุฏู ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุดุจุงูุช ูุนูุง ุจู ูุฑ ูุชู ู ูพุฑุณุด ุจุง ุถุฑุจ ุฏุงุฎู ุจุฑุฏุงุฑูุง `np.dot` ูุญุงุณุจู ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ณ) ฺฏุฑููโุจูุฏ ุจุฑ ุงุณุงุณ ูุงูุฏ <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูุชูโูุง ููุฑุงู ุจุง ุดุจุงูุชุดุงู ุฏุฑ ฺฉ ุณุงุฎุชุงุฑ `defaultdict(list)` ุฐุฎุฑู ูโุดููุฏุ ุจูโุทูุฑโฺฉู ูุฑ ูุงูุฏ ุดุงูู  ูุฌููุนูโุง ุงุฒ ุฒุฑฺฏุฑูโูุง ุจุง ุดุจุงูุชโูุง ูุฑุจูุทู ุงุณุช. <br>

&nbsp;&nbsp;&nbsp; ด)โ ูุญุงุณุจู ุงูุชุงุฒ ูุงูุฏ <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุจุฑุง ูุฑ ูุงูุฏ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุฒุฑฺฏุฑูโูุง ุจุฑ ุงุณุงุณ ุดุจุงูุช ูุฑุชุจ ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	`best_sim`: ุจุงูุงุชุฑู ุดุจุงูุช ฺฉ ุฒุฑฺฏุฑู ุจุง ูพุฑุณุด. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	`mean_sim`: ูุงูฺฏู ุดุจุงูุช ุชูุงู ุฒุฑฺฏุฑูโูุง ูุงูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	`parent_score`: ุชุฑฺฉุจ ุงุฒ ุงู ุฏู ููุฏุงุฑ ุจุง ูุฒูโุฏู ฐ.ท ุจุฑุง ุจูุชุฑู ุดุจุงูุช ู ฐ.ณ ุจุฑุง ูุงูฺฏู ุดุจุงูุช. <br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุณูพุณ ุจู ุชุนุฏุงุฏ `per_parent_k`  (ูพุดโูุฑุถ: ฑ) ุงุฒ ุจูุชุฑู ุฒุฑฺฏุฑูโูุง ูุฑ ูุงูุฏ ุงูุชุฎุงุจ ูโุดููุฏ ู ููุฑุงู ุจุง ุงูุชุงุฒ ูุงูุฏ ุฏุฑ ูุณุช `parent_candidates` ุฐุฎุฑู ูโุดููุฏ. <br>

&nbsp;&nbsp;&nbsp; ต) ุงูุชุฎุงุจ ููุง <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูุณุช `parent_candidates` ุจุฑ ุงุณุงุณ ุงูุชุงุฒ ูุงูุฏ ูุฑุชุจ ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุจู ุชุนุฏุงุฏ `max_contexts`  (ูพุดโูุฑุถ: ถ) ุงุฒ ุจูุชุฑู ุฒุฑฺฏุฑูโูุง ุงูุชุฎุงุจ ู ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดููุฏ. <br>

ุฏุฑ ูุฑุญูู ุจุนุฏุ ูพุงูพโูุงู ุงุตู ูุนูุงุฑ RAG AF + SNS ุทุฑุงุญ ูโุดูุฏ:
```python
queries = [json.loads(l) for l in open(QUERIES_FILE, encoding="utf-8") if l.strip()]
with open(OUTPUT_PATH, "w", encoding="utf-8") as out:
    for item in tqdm(queries, desc="Full RAG pipeline"):
        abs_ids = retrieve_from_abstracts(item["query"])
        sns_nodes = retrieve_sns_nodes(item["query"], abs_ids)
        selected = sns_aware_selection(item["query"], sns_nodes)
        contexts = [c["text"] for c in selected]
        context_text = "\n\n".join(contexts)
        prompt = f"""
Enter your prompts here.

### Question:
{item['query']}

### Context:
{context_text}

### Answer:
"""
        gen = generator(prompt, eos_token_id=tokenizer.eos_token_id)[0]["generated_text"]
        answer = re.split(r"\n?###", gen)[0].strip()
        out.write(json.dumps({
            "id": item["id"],
            "query": item["query"],
            "contexts": contexts,
            "answer": answer
        }, ensure_ascii=False) + "\n")
        torch.cuda.empty_cache()
        time.sleep(1)
```
ุดุฑุญ ูุฑุงุญู ูพุงูพโูุงู: <br>
&nbsp;&nbsp;&nbsp; ฑ) ุจุงุฑฺฏุฐุงุฑ ูพุฑุณุดโูุง ุงุฒ ูุงู ูุฑูุฏ `QUERIES_FILE` <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูพุฑุณุดโูุง ุจูโุตูุฑุช ุฎุทโุจูโุฎุท ุงุฒ ูุงู JSON ุฎูุงูุฏู ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูุฑ ุฎุท ุจุง ุงุณุชูุงุฏู ุงุฒ `json.loads` ุจู ฺฉ ุฏฺฉุดูุฑ ุชุจุฏู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุงู ุฏฺฉุดูุฑ ุดุงูู ฺฉูุฏูุง ูุซู `id` ู "query" ุงุณุช. <br>

&nbsp;&nbsp;&nbsp; ฒ) ุงุฌุงุฏ ูุงู ุฎุฑูุฌ `OUTPUT_PATH` <br>
&nbsp;&nbsp;&nbsp; o	ูุชุงุฌ ูพุงูพโูุงู ุจุฑุง ูุฑ ูพุฑุณุด ุฏุฑ ูุงู ุฎุฑูุฌ ุฐุฎุฑู ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp; o	ูุงู ุฎุฑูุฌ ุจูโุตูุฑุช JSON ุฎุท ููุดุชู ูโุดูุฏ ุชุง ูพุฑุฏุงุฒุด ุจุนุฏ ุณุงุฏูโุชุฑ ุจุงุดุฏ. <br>

&nbsp;&nbsp;&nbsp; ณ) ุจุงุฒุงุจ ฺฺฉุฏูโูุง `retrieve_from_abstracts` <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุจุฑุง ูุฑ ูพุฑุณุดุ ุงุจุชุฏุง ุดูุงุณูโูุง ููุงูุงุช ูุฑุชุจุท ุงุฒ ูพุงฺฏุงู ุฏุงุฏู ฺฺฉุฏูโูุง ุงุณุชุฎุฑุงุฌ ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุงู ุดูุงุณูโูุง ุจูโุนููุงู ูุฑูุฏ ูุฑุญููโ ุจุนุฏ ุงุณุชูุงุฏู ูโุดููุฏ. <br>

&nbsp;&nbsp;&nbsp; ด) ุจุงุฒุงุจ ุฒุฑฺฏุฑูโูุง ูุนูุง `retrieve_sns_nodes` <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุจุง ุงุณุชูุงุฏู ุงุฒ ุดูุงุณูโูุง ููุงูุงุช ูุฑุชุจุทุ ุฒุฑฺฏุฑูโูุง ูุนูุง ูุฑุชุจุท ุงุฒ ูพุงฺฏุงู ุฏุงุฏู SNS ุจุงุฒุงุจ ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุงู ุฒุฑฺฏุฑูโูุง ุดุงูู ูุชู ู ูุชุงุฏุชุง ูุณุชูุฏ. <br>

&nbsp;&nbsp;&nbsp; ต) ุงูุชุฎุงุจ ุฒุฑฺฏุฑูโูุง ุจููู `sns_aware_selection` <br>
โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o ุจุฑุฎูุงู ูุณุฎูโ ูุจู ฺฉู ูููโ ุฒุฑฺฏุฑูโูุง ุงุณุชูุงุฏู ูโุดุฏูุฏุ ุฏุฑ ุงู ูุณุฎู ฺฉ ูุฑุญููโ ุงูุชุฎุงุจ ููุดููุฏ ุงุถุงูู ุดุฏู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุงู ุงูุชุฎุงุจ ุชุถูู ูโฺฉูุฏ ฺฉู ุชููุง ุฒุฑฺฏุฑูโูุง ูุฑุชุจุทโุชุฑ ู ููุฏุชุฑ ูุงุฑุฏ context ุดููุฏ. <br>


&nbsp;&nbsp;&nbsp; ถ) ุณุงุฎุช context ููุง `context_text` <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูุชู ุฒุฑฺฏุฑูโูุง ููุชุฎุจ ุงุณุชุฎุฑุงุฌ ุดุฏู ู ุฏุฑ ูุงูุจ ฺฉ ุฑุดุชูโ ูุงุญุฏ ุชุฑฺฉุจ ูโุดููุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุงู ูุชู ุจูโุนููุงู ุฏุงูุด ุฒููู (context) ูุฑูุฏ ูุฏู ุฒุจุงู ุงุณุชูุงุฏู ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; ท) ุณุงุฎุช prompt ุจุฑุง ูุฏู ุฒุจุงู <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูพุฑุณุด ฺฉุงุฑุจุฑ ู context ููุง ุฏุฑ ูุงูุจ ฺฉ ุฏุณุชูุฑ (prompt) ุจู ูุฏู ุฒุจุงู ุฏุงุฏู ูโุดููุฏ. <br>

&nbsp;&nbsp;&nbsp;	ุณุงุฎุชุงุฑ prompt ุดุงูู ุณู ุจุฎุด ุงุตู ุงุณุช: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	`Question`: ูพุฑุณุด ฺฉุงุฑุจุฑ <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	`Context`: ูุชู ุฒุฑฺฏุฑูโูุง ููุชุฎุจ <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	`Answer`: ุจุฎุด ุฎุฑูุฌ ฺฉู ูุฏู ุฒุจุงู ุจุงุฏ ุชููุฏ ฺฉูุฏ. <br>

&nbsp;&nbsp;&nbsp; ธ) ุชููุฏ ูพุงุณุฎ (generator) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูุฏู ุฒุจุงู ูุญู ุจุง ุงุณุชูุงุฏู ุงุฒ prompt ูพุงุณุฎ ููุง ุฑุง ุชููุฏ ูโฺฉูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ุจุฑุง ฺฉูุชุฑู ูพุงุงู ูพุงุณุฎ ุงุฒ `eos_token_id` ุงุณุชูุงุฏู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูพุงุณุฎ ูพุฑุฏุงุฒุด ุดุฏู ู ุจุฎุด ุงุถุงู ูพุณ ุงุฒ ### ุญุฐู ูโุดูุฏ. <br>

&nbsp;&nbsp;&nbsp; น) ุฐุฎุฑู ุฎุฑูุฌ ุฏุฑ ูุงู <br>
&nbsp;&nbsp;&nbsp;ุจุฑุง ูุฑ ูพุฑุณุดุ ฺฉ ุฑฺฉูุฑุฏ JSON ุดุงูู ููุงุฑุฏ ุฒุฑ ุฐุฎุฑู ูโุดูุฏ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	`id`: ุดูุงุณู ูพุฑุณุด <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	`query`: ูุชู ูพุฑุณุด <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	`contexts`: ูุณุช ูุชูโูุง ููุชุฎุจ ุงุฒ ุฒุฑฺฏุฑูโูุง <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	`answer`: ูพุงุณุฎ ุชููุฏ ูุฏู ุฒุจุงู <br>

&nbsp;&nbsp;&nbsp; ฑฐ)โ ูุฏุฑุช ุญุงูุธู ู ุฒูุงูโุจูุฏ <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ูพุณ ุงุฒ ูพุฑุฏุงุฒุด ูุฑ ูพุฑุณุดุ ุญุงูุธู GPU ุจุง `torch.cuda.empty_cache` ุขุฒุงุฏ ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o	ฺฉ ุชุฃุฎุฑ ฺฉูุชุงู `time.sleep(1)` ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูุดุงุฑ ุจุดโุงุฒุญุฏ ุจู ุณุณุชู ุงุนูุงู ูโุดูุฏ.

<br>

---
### ูุชุงุฌ:
ูุชุงุฌ ุนููฺฉุฑุฏ ูุนูุงุฑ ูพุดููุงุฏ ุดุฏู ุจู ุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ: 



|     ูุนูุงุฑ                                                                    |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|-------------------------------------------------------------------------------|--------------------------|---------------------|-------------------------|
|     1. Abstract-First (ููุงูู)                                                 |     0.312                |     0.621           |     0.789               |
|     2. Abstract-First + Semnatic Node Splitter            For Body (ฺฏุฒุงุฑุด)    |     0.276                |     0.731           |     0.866               |

<sub> 
ุฌุฏูู ฑณ - ูุชุงุฌ ุงุฑุฒุงุจ ูพุงุณุฎ ูุนูุงุฑ RAG ูู ุงูุฒุง ูพุดููุงุฏ ุดุฏู ุฏุฑ ฺฏุฒุงุฑุด ุจุฑ ุงุณุงุณ ุชูุงูุช ุฏุณุชูุฑุงุช ูุฑูุฏ  (ูุฏู ุฒุจุงู: Qwen-2.5 โ ูุฏู ุฌุงููุง: bge-base-en-v1.5 ) </sub>


<br>
ุชุญูู ูุชุงุฌ: 
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุนุงุฑ Faithfulnessุ ูุนูุงุฑ ูพุดููุงุฏ ุจุง ุงูุฒุงุด ฑท.ธ ุฏุฑุตุฏ ูุณุจุช ุจู ูุณุฎู ููุงูู ุนููฺฉุฑุฏ ุจูุชุฑ ุฏุงุดุชู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุนุงุฑ Answer Relevance ูุฒ ุจูุจูุฏ น.ณ ุฏุฑุตุฏ ูุดุงูุฏู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ููุงุจูุ ูุนุงุฑ Context Relevancy ุจุง ฺฉุงูุด ุญุฏูุฏ ฑฒ ุฏุฑุตุฏ ููุงุฌู ุดุฏู ุงุณุช. ุงู ฺฉุงูุด ูุงุด ุงุฒ ุงูุฒุงุด ุชุนุฏุงุฏ context ูุง ู ุจุฒุฑฺฏโุชุฑ ุดุฏู ูุฎุฑุฌ ฺฉุณุฑ ุฏุฑ ูุฑููู ูุญุงุณุจู CR ุงุณุชุ ูู ุงูุช ฺฉูุช ูุงูุน ุจุงุฒุงุจ. <br>

ุจุง ูุฌูุฏ ฺฉุงูุด ูุณุจ ุฏุฑ ูุนุงุฑ Context Relevancyุ ุงูุฒุงุด ูุงุจู ุชูุฌู ุฏุฑ ุฏู ูุนุงุฑ ุงุตู ุนู Faithfulness (ููุงุฏุงุฑ ูพุงุณุฎ ุจู ูุชู ุจุงุฒุงุจ ุดุฏู) ู Answer Relevance (ุงุฑุชุจุงุท ูพุงุณุฎ ุจุง ูพุฑุณุด) ูุดุงู ูโุฏูุฏ ฺฉู ูพุงุฏูโุณุงุฒ ุฌุฏุงุณุงุฒ ฺฏุฑู ูุนูุง (SNS) ุจุฑ ุฑู ุจุฏูู ููุงูุงุช ุฏุฑ ุฑูฺฉุฑุฏ ยซุงูู-ฺฺฉุฏูยป ูุคุซุฑ ุจูุฏู ู ฺฉูุช ุฎุฑูุฌ ุชููุฏุดุฏู ุชูุณุท ุงู ูุนูุงุฑ ุฑุง ุจูโุทูุฑ ูุดุฎุต ุจูุจูุฏ ุจุฎุดุฏู ุงุณุช. 
<br>

ุญุงู ุจู ุจุฑุฑุณ ุนููฺฉุฑุฏ ูุนูุงุฑ ูพุดููุงุฏ ุดุฏู ุฑู ูุฏู ุชุฌุงุฑ `GPT-4O` ู ูุฏู ุฌุงููุง `all-mpnet-base-v2` ูุดุงุจู ุขูฺู ฺฉู ุฏุฑ ููุงูู ูพุงุฏู ุณุงุฒ ุดุฏู ุงุณุช ูโูพุฑุฏุงุฒู: <br>



|     ูุนูุงุฑ                                                                    |     Context Relevancy    |     Faithfulness    |     Answer Relevance    |
|-------------------------------------------------------------------------------|--------------------------|---------------------|-------------------------|
|     1. Abstract-First (ููุงูู)                                                 |     0.268                |     0.606           |     0.791               |
|     2. Abstract-First + Semnatic Node   Splitter          For Body (ฺฏุฒุงุฑุด)    |     0.254                |     0.717           |     0.831               |


<sub>  ุฌุฏูู ฑด - ูุชุงุฌ ุงุฑุฒุงุจ ูพุงุณุฎ ูุนูุงุฑ RAG ูู ุงูุฒุง ูพุดููุงุฏ ุดุฏู ุฏุฑ ฺฏุฒุงุฑุด ุจุฑ ุงุณุงุณ ุชูุงูุช ุฏุณุชูุฑุงุช ูุฑูุฏ  (ูุฏู ุฒุจุงู: GPT-4O โ ูุฏู ุฌุงููุง: all-mpnet-base-v2) </sub>


<br>

ุชุญูู ูุชุงุฌ: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุนุงุฑ Faithfulnessุ ูุนูุงุฑ ูพุดููุงุฏ ูุณุจุช ุจู ูุณุฎู ููุงูู ฑธ.ณ ุฏุฑุตุฏ ุงูุฒุงุด ุฏุงุดุชู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุนุงุฑ Answer Relevanceุ ุจูุจูุฏ ูุงุจู ุชูุฌู ูุนุงุฏู ด.ธ ุฏุฑุตุฏ ูุดุงูุฏู ูโุดูุฏ. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ููุงุจูุ ูุนุงุฑ Context Relevancy ุจุง ฺฉุงูุด ุญุฏูุฏ ณ.ธ ุฏุฑุตุฏ ููุงุฌู ุดุฏู ุงุณุช. ุงู ฺฉุงูุด ูุงุด ุงุฒ ุงูุฒุงุด ุชุนุฏุงุฏ context ูุง ู ุชุบุฑ ุฏุฑ ูุฎุฑุฌ ฺฉุณุฑ ูุฑููู CR ุงุณุชุ ูู ุงูุช ฺฉูุช ูุงูุน ุจุงุฒุงุจ. <br>

ุงู ูุชุงุฌ ูุดุงู ูโุฏูุฏ ฺฉู ุญุช ุฏุฑ ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ุฒุจุงู ุชุฌุงุฑ ุจุฒุฑฺฏ ูุงููุฏ `GPT-4O` ูุฒุ ุงูุฒูุฏู SNS ุจุฑ ุฑู ุจุฏูู ููุงูุงุช ุฏุฑ ุฑูฺฉุฑุฏ ยซุงูู ฺฺฉุฏูยป ูุคุซุฑ ุจูุฏู ุงุณุช. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ฺฉูุช ูพุงุณุฎโูุง ุงุฒ ูุธุฑ ุงุฑุชุจุงุท ุจุง ูพุฑุณุด (Answer Relevance) ู ููุงุฏุงุฑ ุจู ฺฉุงูุชฺฉุณุช (Faithfulness) ุจูุจูุฏ ุงูุชู ุงุณุช.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ฺฉุงูุด ูุณุจ ุฏุฑ Context Relevancy ฺฉ ุงุซุฑ ุฌุงูุจ ุทุจุน ูุญุณูุจ ูโุดูุฏ ู ุฏุฑ ุจุฑุงุจุฑ ุงูุฒุงุด ูุงุจู ุชูุฌู ุฏู ูุนุงุฑ ุงุตูุ ูุงุจู ูพุฐุฑุด ุงุณุช.<br>

ุจู ุนูุงูู ุจุง ููุงุณู  ูุชุงุฌ ุฌุฏุงูู ฑณ ู ฑด ฺฉ ูฺฉุชู  ุฏฺฏุฑ ูุฒ ูุงุจู ูุดุงูุฏู ุงุณุช:<br> 

ุงุฎุชูุงู ููุงุฏุฑ ุจู ุฌุฏูู ฑณ (ูุฏู ูุญู `Qwen-2.5-3B` + `bge-base-en-v1.5`) ู ุฌุฏูู ฑด (ูุฏู ุชุฌุงุฑ `GPT-4O` + `all-mpnet-base-v2`) ูุดุงู ูโุฏูุฏ ฺฉู:<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุฏูโูุง ูุญูุ ุจุดุชุฑู ุจูุจูุฏ ุฏุฑ Faithfulness ุฏุฏู ูโุดูุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ุฏุฑ ูุฏูโูุง ุชุฌุงุฑ ุจุฒุฑฺฏุ ุจุดุชุฑู ุจูุจูุฏ ุฏุฑ Answer Relevance ูุดุงูุฏู ูโฺฏุฑุฏุฏ.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; โข	ูุนูุงุฑ ูพุดููุงุฏ ุจุฑ ุจูุจูุฏ ุนููฺฉุฑุฏ ูุฏู `all-mpnet-base-v2` ุฏุฑ ุจุงุฒุงุจ ู ูุฏู `Qwen-2.5-3B` ุฏุฑ ุชููุฏ ูพุงุณุฎ ุชุงุซุฑ ุจุดุชุฑ ุฏุงุดุชู ุงุณุช.<br>

ุงู ุชูุงูุช ุจุงูฺฏุฑ ุขู ุงุณุช ฺฉู ููุน ูุฏู ุฒุจุงู ู ุฌุงููุง ุจุฑ ุญุณุงุณุช ูุนุงุฑูุง ุงุซุฑฺฏุฐุงุฑ ุงุณุชุ ุงูุง ุฏุฑ ูุฑ ุฏู ุญุงูุชุ ูพุงุฏูโุณุงุฒ SNS ุฑู ุจุฏูู ููุงูุงุช ุจูโุทูุฑ ูพุงุฏุงุฑ ฺฉูุช ุฎุฑูุฌ ูุนูุงุฑ RAG ุฑุง ุงุฑุชูุง ุฏุงุฏู ุงุณุช.

### ุฌูุน ุจูุฏ:
ุฏุฑ ุงูุชูุง ุงู ฺฏุฒุงุฑุด ูุชุงุฌ ุขุฒูุงุด ูุง ู ุฑูุด ูุง ุงุฑุงุฆู ุดุฏูุ ุจู ุตูุฑุช ุฒุฑ ุฌูุนโุจูุฏ ูโุดูุฏ:



|     ูุงู ูพฺฉุฑุจูุฏ                      |     ูุนูุงุฑ                    |     ูุฏู ุฒุจุงู ูพุงุณุฎ    |     ูุฏู ุฌุงููุง   ุจุงุฒุงุจ    |     CR       |     F        |     AR       |
|---------------------------------------|-------------------------------|-----------------------|------------------------------|--------------|--------------|--------------|
|     -                                 |     Abstract-First (ููุงูู)    |     GPT-4O (ููุงูู)    |     All-mpnet  (ููุงูู)       |     0.268    |     0.606    |     0.791    |
|     ุชุบุฑ ูุฏู   ุฒุจุงู (ุขุฒูุงุด ฑ)      |     Abstract-First (ููุงูู)    |     Qwen2.5-3B        |     All-mpnet  (ููุงูู)       |     0.268    |     0.611    |     0.817    |
|     ุชุบุฑ ูุฏู   ุฌุงููุง (ุขุฒูุงุด ณ)    |     Abstract-First (ููุงูู)    |     GPT-4O (ููุงูู)    |     bge-base-en-v1.5         |     0.266    |     0.593    |     0.834    |
|     ุชุบุฑ ุฏุณุชูุฑ   ูุฑูุฏ (ุขุฒูุงุด ด)    |     Abstract-First (ููุงูู)    |     Qwen2.5-3B        |     All-mpnet  (ููุงูู)       |     0.268    |     0.688    |     0.857    |
|     ูุนูุงุฑ   ูพุดููุงุฏ ฺฏุฒุงุฑุด           |     Abstract-First + SNS      |     GPT-4O (ููุงูู)    |     All-mpnet  (ููุงูู)       |     0.254    |     0.717    |     0.831    |
|     ุชุฌูุน ฑ+ณ+ด ู   ูุนูุงุฑ ฺฏุฒุงุฑุด      |     Abstract-First + SNS      |     Qwen2.5-3B        |     bge-base-en-v1.5         |     0.276    |     0.731    |     0.866    |


<sub>
ุฌุฏูู ฑต โ ุจุฑุฑุณ ูพุงุณุฎ ูุนูุงุฑ RAG ุจุฑ ุงุณุงุณ ุชูุธูุงุช ุขุฒูุงุดุงุช ุงูุฌุงู ุดุฏู ู ูุนูุงุฑ ูพุดููุงุฏ ุจู ุตูุฑุช ูุฌุฒุง
</sub>


<br>


 
![
ุชุตูุฑ ฒท - ูููุฏุงุฑ ุชุงุซุฑุงุช ูุฑ ฺฉ ุงุฒ ุขุฒูุงุดุงุช ุงู ฺฏุฒุงุฑุด ุฑู ูุนูุงุฑ RAG ูู ุงูุฒุง ู ุงุฎุชูุงู ุขู ุจุง ูุนูุงุฑ ููุงูู Aytar
](/assets/patterneffort/synergistic-rag/media/fig27.png)

<p style="text-align:center;">
<sub>
ุชุตูุฑ ฒท - ูููุฏุงุฑ ุชุงุซุฑุงุช ูุฑ ฺฉ ุงุฒ ุขุฒูุงุดุงุช ุงู ฺฏุฒุงุฑุด ุฑู ูุนูุงุฑ RAG ูู ุงูุฒุง ู ุงุฎุชูุงู ุขู ุจุง ูุนูุงุฑ ููุงูู Aytar
</sub>
</p>


<br>

---

#### ุชุญูู ูุชุงุฌ ููุง ฺฏุฒุงุฑุด: <br>

ฑ) ููุงูโุทูุฑ ฺฉู ูุดุงูุฏู ูโุดูุฏุ ุตุฑูุงู ุจุง ุฌุงฺฏุฒู ูุฏู ุฒุจุงู `GPT-4O` (ุชุฌุงุฑ) ุจุง ูุฏู `Qwen-2.5-3B` (ูุชูโุจุงุฒ ู ูุญู)ุ ุจูุจูุฏ ุนููฺฉุฑุฏ ูุนุงุฏู ณ.ณ ุฏุฑุตุฏ ุฏุฑ ูุนุงุฑ Answer Relevance ู ฐ.ธ ุฏุฑุตุฏ ุฏุฑ ูุนุงุฑ Faithfulness ุญุงุตู ุดุฏู ุงุณุช. <br>

ฒ) ุฏุฑ ุดุฑุงุท ฺฉู ูุฏู ุฒุจุงู ุซุงุจุช ุจุงู ุจูุงูุฏ `GPT-4O`ุ ุชุบุฑ ูุฏู ุฌุงููุง ุฏุฑ ูุฑุญูู ุชุดฺฉู ูพุงฺฏุงู ุฏุงุฏู ู ุจุงุฒุงุจ ุงุทูุงุนุงุช ุงุฒ `all-mpnet-base-v2` ุจู `bge-base-en-v1.5` ููุฌุฑ ุจู ุงูุฒุงุด ต.ด ุฏุฑุตุฏ ุฏุฑ AR ูุณุจุช ุจู ูุนูุงุฑ ููุงูู ุดุฏู ุงุณุชุ ูุฑฺูุฏ ุงู ุชุบุฑ ุจุง ุงูุช ฒ.ฑ ุฏุฑุตุฏ ุฏุฑ F ู ฺฉุงูุด ฐ.ท ุฏุฑุตุฏ ุฏุฑ Context Relevancy ููุฑุงู ุจูุฏู ุงุณุช. <br>

ณ) ุจุง ูุฑุถ ุซุงุจุช ุจูุฏู ูุฏู ุฌุงููุง `all-mpnet-base-v2`ุ ุชุบุฑ ุฑูุด ุฏุณุชูุฑุฏู ุจู ูุฏู ุฒุจุงู Qwen 2.5 ููุฌุฑ ุจู ุงูุฒุงุด ธ.ณ ุฏุฑุตุฏ ุฏุฑ AR ู ุฑุดุฏ ฑณ.ต ุฏุฑุตุฏ ุฏุฑ F ูุณุจุช ุจู ูุณุฎู ููุงูู ุดุฏู ุงุณุช. <br>

ด) ุฏุฑ ุตูุฑุช ูพุงุฏูโุณุงุฒ ุฑูฺฉุฑุฏ ูพุดููุงุฏ Semantic Node Splitter ุจุฑ ุฑู ูุนูุงุฑ RAG ู ุจุง ูุฑุถ ุซุงุจุช ุจูุฏู ูุฏู ุฒุจุงู `GPT-4O` ู ูุฏู ุฌุงููุง `all-mpnet-base-v2`ุ ุดุงูุฏ ุงูุฒุงุด ต.ฑ ุฏุฑุตุฏ ุฏุฑ AR ู ุฑุดุฏ ฑธ.ณ ุฏุฑุตุฏ ุฏุฑ F ุฎูุงูู ุจูุฏุ ุงูุจุชู ุงู ุชุบุฑ ุจุง ุงูุช ต.ฒ ุฏุฑุตุฏ ุฏุฑ CR ููุฑุงู ุงุณุช.<br>

ต) ุจุง ุชุฌูุน ุชูุงู ุจูููโุณุงุฒโูุง ููู ุดุงูู: <br>
โข	ุชุบุฑ ูุฏู ุฒุจุงู ุงุฒ `GPT-4O` ุจู `Qwen-2.5-3B`ุ <br> 
โข	ุชุบุฑ ูุฏู ุฌุงููุง ุงุฒ `all-mpnet-base v2` ุจู `bge-base-en-v1.5`ุ <br>
โข	ุงุตูุงุญ ุฑูุด ุฏุณุชูุฑุฏู ุงุฒ Emotional Stimuli ุจู Improved ESุ <br>
โข	ู ุชุบุฑ ุฑูฺฉุฑุฏ ุฐุฎุฑูโุณุงุฒ ู ุจุงุฒุงุจ ุฏุงุฏูโูุง <br>
 ุงุฒ Abstract First ุจู Abstract First + Semantic Node Splitterุ <br>

ูุชุงุฌ ููุง ูุดุงูโุฏููุฏู ุงูุฒุงุด น.ต ุฏุฑุตุฏ ุฏุฑ ARุ ุฑุดุฏ ฒฐ.ถ ุฏุฑุตุฏ ุฏุฑ F ู ุจูุจูุฏ ณ ุฏุฑุตุฏ ุฏุฑ CR ูุณุชูุฏุ ฺฉู ูุฑ ุณู ูุนุงุฑ ูุณุจุช ุจู ูุนูุงุฑ ุงุฑุงุฆูโุดุฏู ุฏุฑ ููุงููุ ุจูุจูุฏ ุนููฺฉุฑุฏ ูุงุจู ุชูุฌู ุฑุง ูุดุงู ูโุฏููุฏ.

<br>

---

### ุฑุงูฺฉุงุฑูุง ุชฺฉูู ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ ูุนูุงุฑ:
ูุชุงุฌ ูพุงุฏูโุณุงุฒ ุฑูฺฉุฑุฏ SNS ูุดุงู ุฏุงุฏ ฺฉู ฺฏุณุชุฑุด ุฑุงูุจุฑุฏ Abstract First ู ุงูุฒุงุด ูุฑฺฉุงูุณ ูุนูุง ุฏุฑ ูุทุนุงุช ูุชูุ ุงุฒ ุทุฑู ุชูุณู ุขูโูุง ุจู ุจุฎุดโูุง ฺฉูฺฺฉโุชุฑ ู ุงุฌุงุฏ ุชุฑุงฺฉู ูุนูุง ูุญู ุฏุฑ ุณุทุญ ุฌูููโูุงุ ุฏุฑ ฺฉูุงุฑ ุงุนูุงู ุดุจุงูุชโุณูุฌ ูุนูุง ุฏุฑ ุณุทูุญ ุจุงูุงุชุฑ ู ุฌูุงูุ ููุด ูุคุซุฑ ุฏุฑ ุงุฑุชูุง ุนููฺฉุฑุฏ ูุนูุงุฑ RAG ุงูุง ูโฺฉูุฏ. ุงุฌุงุฏ ุชุนุงุฏู ูุงู ุงู ุณุทูุญ ูุฎุชูู ุงุฒ ูุทุนุงุช ูุนูุง ุฏุฑ ุจุฏููโ ุจุงุฒุงุจโุดุฏู ููุฌุจ ูโุดูุฏ ุญุช ุฏุฑ ูุนูุงุฑโูุง ูุจุชู ุจุฑ ูุฏูโูุง ุฒุจุงู ูุญู ูุฒ ฺฉูุช ุจุงุฒุงุจ ู ูพุงุณุฎโฺฏู ุจูโุทูุฑ ูุญุณูุณ ุจูุจูุฏ ุงุจุฏ. <br>

ุนูุงูู ุจุฑ ุงูุ ุงุณุชูุงุฏู ุงุฒ ุฑุงูฺฉุงุฑูุง ูุธุฑ ุฑุฒุชูุธู ูุฏูโูุง ุฌุงููุง ุจุง ุฏุงุฏูโูุง ูุฑุฌุน ูุชูุงุณุจ ู ุจูููโุณุงุฒ ุฑูุด ุฏุณุชูุฑุฏู ุจู ูุฏู ุฒุจุงู ูโุชูุงูุฏ ุงุฒ ุงูุช ุนููฺฉุฑุฏ ูุงุด ุงุฒ ูุงููุงููฺฏ ูุงู ุงุฌุฒุง ูุฎุชูู ูุนูุงุฑ RAG ุฌููฺฏุฑ ฺฉุฑุฏู ู ุฏุฑ ุจุณุงุฑ ุงุฒ ููุงุฑุฏ ุจู ุจูุจูุฏ ฺฉู ฺฉุงุฑุง ุณุณุชู ููุฌุฑ ุดูุฏ ู ููููู ููโุงูุฒุง ุชุญูู ุงุจุฏ. <br>

ุฏุฑ ฺฉูุงุฑ ุฑูุดโูุง ุงุตู ุงุฑุงุฆูโุดุฏู ู ูุชุงุฌ ุขุฒูุงุดโูุง ุงูุฌุงูโฺฏุฑูุชูุ ูุฌููุนูโุง ุงุฒ ููุงุญุธุงุช ู ุฑุงูฺฉุงุฑูุง ุชฺฉูู ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูโุชูุงูุฏ ุจูโูฺู ุฏุฑ ูพุงุฏูโุณุงุฒโูุง ูุญู ูุนูุงุฑ RAG ููโุงูุฒุง ูุคุซุฑ ูุงูุน ุดูุฏ. ุงู ููุงุฑุฏ ุจูโุนููุงู ุชูุตูโูุง ุนูู ุฏุฑ ูุฑุงุญู ูุฎุชูู ูพุงุฏูโุณุงุฒ ู ุงุฌุฑุง ูุงุจู ุทุฑุญ ูุณุชูุฏ: <br>
ฑ. ูพุงฺฉุณุงุฒ ุฏุงุฏูโูุง (ูพุด ู ูพุณ ุงุฒ ุจุงุฒุงุจ) <br>
ุญุฐู ุนูุงุตุฑ ฺฉูโุงุฑุฒุด ูุงููุฏ ููฺฉโูุงุ ุงุฑุฌุงุนุงุช ุฒุงุฆุฏ ู ูุดุงููโูุง ุบุฑุถุฑูุฑ ุงุฒ ูุชูโูุงุ ููุฌุฑ ุจู ุชููุฏ ูุทุนุงุช ูุนูุง ุจุง ฺฉูุช ุจุงูุงุชุฑ ุดุฏู ู ููุฒ ููุฌูุฏ ุฏุฑ ูุฑุขูุฏ ุจุงุฒุงุจ ุฑุง ฺฉุงูุด ูโุฏูุฏ. ุงู ููุถูุน ุชุฃุซุฑ ูุณุชูู ุจุฑ ุฏูุช ู ุงูุณุฌุงู ูพุงุณุฎโูุง ููุง ุฎูุงูุฏ ุฏุงุดุช. <br>

ฒ. ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑุงุช ูุชูุงุณุจ ุจุง ฺฉุงุฑุจุฑุฏ <br>
ููุงูโฺฏููู ฺฉู ุฏุฑ ุขุฒูุงุด ฺูุงุฑู ูุดุงูุฏู ุดุฏุ ุทุฑุงุญ ู ุงูุชุฎุงุจ ุฏุณุชูุฑุงุช ูุชูุงุณุจ ุจุง ุณุทุญ ุชุฎุตุต ู ุชูุงูููุฏ ูุฏู ุฒุจุงู ููุด ููู ุฏุฑ ุงูุฒุงุด ฺฉุงุฑุง ุณุณุชู ุฏุงุฑุฏ. ุฏุณุชูุฑุฏู ุฏูู ู ูุฏูููุฏ ุจู ูุฏู ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุญุฏุงฺฉุซุฑ ุธุฑูุช ุฎูุฏ ุฑุง ุฏุฑ ูุฑุขูุฏ ุชุญูู ู ูพุงุณุฎโฺฏู ุจู ูพุฑุณุดโูุง ุจูโฺฉุงุฑ ฺฏุฑุฏ. <br>

ณ. ุฑุนุงุช ุงุตูู ูพุงุฏูโุณุงุฒ ุฏุฑ ูุฑุงุญู ูุฎุชูู <br>
โข	ุงุณุชูุงุฏู ุงุฒ ูพุงูพโูุงู ุฏุฑ ุชูุงู ูุฑุงุญู ุจูโููุธูุฑ ฺฉูุชุฑู ุจูุชุฑ ุฌุฑุงู ุฏุงุฏูุ ุฌููฺฏุฑ ุงุฒ ุงุฌุงุฏ ฺฏููฺฏุงูโูุง ู ฺฉุงูุด ูพฺุฏฺฏ ูุญุงุณุจุงุชุ <br> 
โข	ูุนุงูโุณุงุฒ ุญุงูุช Performance Mode ุฏุฑ ุณุณุชูโุนุงูู ููุฏูุฒ ุจุฑุง ุจูุฑูโฺฏุฑ ุญุฏุงฺฉุซุฑ ุงุฒ ุชูุงู ูพุฑุฏุงุฒูุฏู ฺฏุฑุงูฺฉ ู ุงุณุชูุงุฏู ุงุฒ ุญุฏุงฺฉุซุฑ ูุฑฺฉุงูุณ ุงูู ฺฉุงุฑุ ุจูโูฺู ุฏุฑ ูุฑุขูุฏูุง ุณูฺฏู ูุงููุฏ ุฑุฒุชูุธู ู ุจุงุฒุงุจุ <br>
โข	ูุฏุฑุช ุญุงูุธู ู ฺฉุด ุณุณุชูุ ุดุงูู ุชุฎููโ ุญุงูุธูโ ฺฏุฑุงูฺฉ ู ุงุฌุงุฏ ููููโูุง ุฒูุงู ููุงุณุจุ ุจูโููุธูุฑ ุฌููฺฏุฑ ุงุฒ ูุดุงุฑ ุจุดโุงุฒุญุฏ ู ุงูุฒุงุด ุฏูุง ุนููุงุช ูุฏูโูุงุ <br>
โข	ุงุณุชูุงุฏู ุงุฒ ูุฑูุชโูุง ุนุฏุฏ ุณุจฺฉโุชุฑ ูุธุฑ float16 ุฌูุช ฺฉุงูุด ูุตุฑู ุญุงูุธู ู ุงูุฒุงุด ุณุฑุนุช ูพุฑุฏุงุฒุดุ ุจุฏูู ุงุฌุงุฏ ุงูุช ูุญุณูุณ ุฏุฑ ุฏูุช. <br>

#### ุฌูุน ุจูุฏ ููุง
ุฑุนุงุช ุงู ุฑุงูฺฉุงุฑูุง ุชฺฉูู ุฏุฑ ฺฉูุงุฑ ุฑูุดโูุง ุงุตู ุงุฑุงุฆูโุดุฏู ุฏุฑ ุงู ฺฏุฒุงุฑุดุ ููุฌุฑ ุจู: <br>
โข	ุงูุฒุงุด ุณุฑุนุช ุฏุฑ ูุฑุขูุฏูุง ุฑุฒุชูุธูุ ุงุฌุงุฏ ูพุงฺฏุงู ุฏุงุฏู ู ูพุงุณุฎโฺฏูุ <br>
โข	ฺฉุงูุด ูุดุงุฑ ูุญุงุณุจุงุช ุจุฑ ุณุฎุชโุงูุฒุงุฑ ู ูุฏูโูุง ุฒุจุงูุ <br>
โข	ู ุฏุฑ ููุงุช ุงุฑุชูุง ฺฉูุช ุฎุฑูุฌ ูุนูุงุฑ RAG ุฎูุงูุฏ ุดุฏ.<br>

ุจุฑ ุงู ุงุณุงุณุ ูุนูุงุฑ ูพุดููุงุฏ ููโุชููุง ุงุฒ ููุธุฑ ูุธุฑุ ุจูฺฉู ุฏุฑ ุณุทุญ ูพุงุฏูโุณุงุฒ ุนูู ูุฒ ุชูุงูุง ุฏุณุชุงุจ ุจู ุจูุจูุฏ ูพุงุฏุงุฑ ู ูุงุจู ุชูุฌู ูุณุจุช ุจู ูุณุฎูโูุง ูุฑุฌุน ุงุฑุงุฆูโุดุฏู ุฏุฑ ููุงูู ุฑุง ุฏุงุฑุงุณุช. <br>

ุฏุฑ ูุฌููุนุ ูุชุงุฌ ุงู ฺฏุฒุงุฑุด ูุดุงู ูโุฏูุฏ ฺฉู ุชุฑฺฉุจ ุฑูฺฉุฑุฏูุง ูุธุฑ ู ุนูู ุฏุฑ ูุนูุงุฑ RAGุ ููุฑุงู ุจุง ุฑุงูฺฉุงุฑูุง ุชฺฉูู ูพุดููุงุฏุ ูโุชูุงูุฏ ูุณุฑ ุชูุณุนู ุณุงูุงููโูุง ููุดููุฏ ูุจุชู ุจุฑ ุจุงุฒุงุจ ู ุชููุฏ ูพุงุณุฎ ุฑุง ุฏุฑ ูุญุทโูุง ูุญู ู ุชุฌุงุฑ ุจูโุทูุฑ ฺุดูฺฏุฑ ุงุฑุชูุง ุฏูุฏ. <br>

ุจูโููุธูุฑ ุขุดูุง ุจุง ุณุงุฑ ุฑูุดโูุง ุจูููโุณุงุฒ ู ุฏุณุชุฑุณ ุจู ูุงูโูุง ู ููุงุจุน ุชฺฉููุ ุขุฏุฑุณโูุง ูุฑุชุจุท ุจุง ุงู ฺฏุฒุงุฑุด ุฏุฑ ูพูุณุช ุณูู ุงุฑุงุฆู ุดุฏู ุงุณุช.

<br>

---
## ูพูุณุช ูุง 

### ูพูุณุช ฑ: ุงุจุฒุงุฑ ูุง
#### ูพุดโูพุฑุฏุงุฒุด:
ฑ. GROBID: ูุณุฎู 0.8.2 <br>
ฒ. google-cloud-sdk: ูุณุฎู 456.0.0 <br>
ณ. PyMuPDF: ูุณุฎู 1.26.5 <br>
ด. PyPDF2: ูุณุฎู 3.0.1 <br>

<br>

#### ุฑุฒุชูุธู ูุฏู ุฌุงููุง ู ูุทุนู ุจูุฏ ูุนูุง:
ฑ. chromadb: ูุณุฎู 1.3.5 <br>
ฒ. sentence-transformers: ูุณุฎู 5.1.1 <br>
ณ. torch: ูุณุฎู 2.5.1 ุจู ููุฑุงู cu121 <br>
ด. transformers: ูุณุฎู 4.57.3 <br>
ต. tqdm: ูุณุฎู 4.67.1 <br>
ถ. nltk: ูุณุฎู 3.9.2 <br>
ท. threadpoolctl: ูุณุฎู 3.6.0 <br>
ธ. beautifulsoup4: ูุณุฎู 4.14.2 

<br>

#### ุงุฌุฑุง RAG: 
ฑ. openai: ูุณุฎู 2.11.0

<br>

#### ุงุฑุฒุงุจ:
ฑ. RAGAS: ูุณุฎู 0.39 (ุฏุฑ ูุณูุช ุงุฑุฒุงุจ) <br>
ฒ. RAGAS: ูุณุฎู 0.1.1 (ุฏุฑ ูุณูุช ูุชุงุฌ โ ูุงุฒู ุงุณุช ุชุง ูุฌุฏุฏุง ฺฉุชุงุจุฎุงูู ูุง ูพุดโูุงุฒ ูุชูุงุณุจ ุงู ูุณุฎู ุฏุฑุงูุช ุดููุฏ. โ ุจูุชุฑ ุงุณุช ุฏุฑ ูุญุท ูุฌุงุฒ ุฌุฏุฏ ูุตุจ ุดูุฏ.) <br>
ณ. LM studio: ูุณุฎู 0.3.32 <br>
ด. statsmodels: ูุณุฎู 0.14.6 <br>

#### ูุญุท ุจุฑูุงูู ููุณ: Python: 3.11.7

<br>

---

### ูพูุณุช ฒ: ูพฺฉุฑุจูุฏ ูุฑุงุญู ู ุขุฒูุงุด ูุง
#### ุณุณุชู ููุฑุฏ ุงุณุชูุงุฏู:
โข	Operating System: Windows 10 Home 64-bit (10.0, Build 19044) <br>
โข	Processor: Intel(R) Core(TM) i7-8700K CPU @ 3.70GHz (12 CPUs), ~3.7GHz <br>
โข	Memory: 32768MB RAM <br>
โข	Card name: NVIDIA GeForce GTX 1080 Ti

<br>

#### ูุฏู ูุง ุฌุงููุง ูุฑุฌุน:
โข	https://huggingface.co/BAAI/bge-base-en-v1.5/ <br>
โข	https://huggingface.co/sentence-transformers/all-mpnet-base-v2/ <br>
โข	https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/

<br>

#### ุงุฌุงุฏ ูพุงฺฏุงู ุฏุงุฏู: 
ูุณุช ููุงูุงุช ุงุณุชูุงุฏู ุดุฏู โ ุจู ููุฑุงู ูุชุงุฏุชุง: <br>
โข	https://github.com/DigitalAsocial/Synergistic-Rag/blob/a8708397949ed0e3a5e01e875b1d1fe849005557/datasets/arxiv/metadata.jsonl/ <br>

ูุฏู ุฒุจุงู ุจุฑุชุฑ: <br>
โข	https://huggingface.co/Qwen/Qwen2.5-3B/ <br>
ูุฏู ุงุฑุฒุงุจ: <br>
โข	https://huggingface.co/lmstudio-community/Mistral-7B-Instruct-v0.3-GGUF/

<br>

#### ฺฉุฏ ูุง ููุดุชู ุดุฏู:
ฺฉุฏ ูุง ฺฏุฒุงุฑุด: <br>
โข	https://github.com/DigitalAsocial/Synergistic-Rag/tree/a8708397949ed0e3a5e01e875b1d1fe849005557/codes_in_report/ <br>

ฺฉุฏ ูุง ุฌุฏุฏุชุฑ: <br>
โข	https://github.com/DigitalAsocial/Synergistic-Rag/tree/a8708397949ed0e3a5e01e875b1d1fe849005557/improved_codes/ 

<br>

---

### ูพูุณุช ณ: ุฎุฑูุฌ ูุง
#### ูุฏู ูุง ุฌุงููุง ุฑุฒุชูุธู ุดุฏู:
ูพฺฉุฑุจูุฏ ูุง ุขุฒูุงุด ุดูุงุฑู ฒ : <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ฒ https://huggingface.co/DigitalAsocial/all-mpnet-base-v2-ds-rag-5r/ <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ณ https://huggingface.co/DigitalAsocial/all-mpnet-base-v2-ds-rag-17r/ <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ด https://huggingface.co/DigitalAsocial/all-mpnet-base-v2-ds-rag-5g/ <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ต https://huggingface.co/DigitalAsocial/all-mpnet-base-v2-ds-rag-17g/ <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ถ https://huggingface.co/DigitalAsocial/all-mpnet-base-v2-ds-rag-17s/ <br>

<br>

ูพฺฉุฑุจูุฏ ูุง ุขุฒูุงุด ุดูุงุฑู ณ: <br>
โข	https://huggingface.co/DigitalAsocial/all-MiniLM-L6-v2-ds-rag-s/ <br>
โข	https://huggingface.co/DigitalAsocial/bge-base-en-v1.5-ds-rag-s/ <br>

ุณุงุฑ:
โข	https://huggingface.co/DigitalAsocial/all-MiniLM-L6-v2-ds-rag/ 

<br>

#### ุฏุงุฏู ูุง ุขููุฒุด:
ูพฺฉุฑุจูุฏ ูุง ุขุฒูุงุด ุดูุงุฑู ฒ : <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ฒ https://huggingface.co/datasets/DigitalAsocial/ds-tb-5-raw/ <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ณ https://huggingface.co/datasets/DigitalAsocial/ds-tb-17-raw/ <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ด https://huggingface.co/datasets/DigitalAsocial/ds-tb-5-g/ <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ต https://huggingface.co/datasets/DigitalAsocial/ds-tb-17-g/ <br>
โข	:ูพฺฉุฑุจูุฏ ุดูุงุฑู ถ https://huggingface.co/datasets/DigitalAsocial/ds-tb-17-g-sns/ <br>

ูพฺฉุฑุจูุฏ ูุง ุขุฒูุงุด ุดูุงุฑู ณ: <br>
โข	https://huggingface.co/datasets/DigitalAsocial/ds-tb-17-g-sns-aml/ <br>
โข	https://huggingface.co/datasets/DigitalAsocial/ds-tb-17-g-sns-bge/

<br>

---

### ูพูุณุช ด:
#### ูุฑุงุฌุน:
[1] Aytar, A. Y., Kaya, K., & Kฤฑlฤฑรง, K. (2025). A synergistic multi-stage RAG architecture for boosting context relevance in data science literature. Natural Language Processing Journal, 13, 100179. https://doi.org/10.1016/j.nlp.2025.100179 <br>

[2] Saxena, V., Sathe, A., Sandosh, S. (2025). Mitigating Hallucinations in Large Language Models: A Comprehensive Survey on Detection and Reduction Strategies. In: Bansal, J.C., Jamwal, P.K., Hussain, S. (eds) Sustainable Computing and Intelligent Systems. SCIS 2024. Lecture Notes in Networks and Systems, vol 1295. Springer, Singapore. https://doi.org/10.1007/978-981-96-3311-1_4 <br>

[3] Wei, J., Wang, X., Schuurmans, D., Bosma, M., Ichter, B., Xia, F., Chi, E., Le, Q., & Zhou, D. (2022). Chain-of-Thought Prompting Elicits Reasoning in Large Language Models. ArXiv. https://arxiv.org/abs/2201.11903 <br>

[4] Lewis, P., Perez, E., Piktus, A., Petroni, F., Karpukhin, V., Goyal, N., Kรผttler, H., Lewis, M., Yih, W., Rocktรคschel, T., Riedel, S., & Kiela, D. (2020). Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks. ArXiv. https://arxiv.org/abs/2005.11401 <br>

[5] Amir Esfandiari, RAG : Retrieval-Augmented Generation, Pattern Recognition Lab. Dr.Hadi Sadoghi Yazdi https://patternrmachinel.github.io/PatternLearning/StudentEffort/RAG/RetrievalAugmentedGeneration.html <br>

[6] https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them 
[7] Han, H., Wang, Y., Shomer, H., Guo, K., Ding, J., Lei, Y., Halappanavar, M., Rossi, R. A., Mukherjee, S., Tang, X., He, Q., Hua, Z., Long, B., Zhao, T., Shah, N., Javari, A., Xia, Y., & Tang, J. (2024). Retrieval-Augmented Generation with Graphs (GraphRAG). ArXiv. https://arxiv.org/abs/2501.00309 <br>

[8] Wang, J., Zhao, R., Wei, W., Wang, Y., Yu, M., Zhou, J., Xu, J., & Xu, L. (2025). ComoRAG: A Cognitive-Inspired Memory-Organized RAG for Stateful Long Narrative Reasoning. ArXiv. https://arxiv.org/abs/2508.10419 <br>

[9] Zhao, Q., Wang, R., Cen, Y., Zha, D., Tan, S., Dong, Y., & Tang, J. (2024). LongRAG: A Dual-Perspective Retrieval-Augmented Generation Paradigm for Long-Context Question Answering. ArXiv. https://arxiv.org/abs/2410.18050 <br>

[10] Gao, Y., Xiong, Y., Zhong, Y., Bi, Y., Xue, M., & Wang, H. (2025). Synergizing RAG and Reasoning: A Systematic Review. ArXiv. https://arxiv.org/abs/2504.15909 <br>

[11] Shi, Y., Xu, S., Liu, Z., Liu, T., Li, X., Liu, N., 2023a. Mededit: Model editing for medical question answering with external knowledge bases. arXiv preprint arXiv:2309.16035, https://arxiv.org/abs/2309.16035 <br>

[12] Wiratunga, N. et al. (2024). CBR-RAG: Case-Based Reasoning for Retrieval Augmented Generation in LLMs for Legal Question Answering. In: Recio-Garcia, J.A., Orozco-del-Castillo, M.G., Bridge, D. (eds) Case-Based Reasoning Research and Development. ICCBR 2024. Lecture Notes in Computer Science(), vol 14775. Springer, Cham. https://doi.org/10.1007/978-3-031-63646-2_29 <br>

[13] Lewis, P., Perez, E., Piktus, A., Petroni, F., Karpukhin, V., Goyal, N., ... & Kiela, D. (2020). Retrieval-augmented generation for knowledge-intensive nlp tasks. Advances in neural information processing systems, 33, 9459-9474. <br>

[14] Nogueira, R., Cho, K., 2019. Passage re-ranking with BERT. arXiv preprint arXiv:1901.04085, https://arxiv.org/abs/1901.04085 <br>

[15] Ma, X., Gong, Y., He, P., Zhao, H., Duan, N., 2023. Query rewriting for retrieval-augmented large language models. In: Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing. EMNLP. <br>

[16] Chapman, P., Clinton, J., Kerber, R., Khabaza, T., Reinartz, T., Shearer, C., Wirth, R., 2000. CRISP-DM 1.0 step-by-step data mining guide 2000. The CRISP-DM consortium, No: 1025172. http://www.crisp-dm.org/CRISPWP-0800.pdf. <br>

[17] Google Cloud Storage : gsutil tool, https://cloud.google.com/storage/docs/gsutil <br>

[18] camelot : https://github.com/camelot-dev/camelot <br>

[19] GROBID : https://grobid.readthedocs.io/en/latest/Introduction/ <br>

[20] GloVe : https://nlp.stanford.edu/projects/glove/ <br>

[21] BERT : https://github.com/google-research/bert/ <br>

[22] Word2vec : https://code.google.com/archive/p/word2vec/ <br>

[23] Sentence Transformers : https://www.sbert.net/ <br>

[24] Li, L., Sleem, L., Gentile, N., Nichil, G., & State, R. (2024). Exploring the Impact of Temperature on Large Language Models: Hot or Cold? Procedia Computer Science, 264, 242-251. https://doi.org/10.1016/j.procs.2025.07.135/ <br>

[25] C. E. Shannon, "A mathematical theory of communication," in The Bell System Technical Journal, vol. 27, no. 3, pp. 379-423, July 1948, doi: 10.1002/j.1538-7305.1948.tb01338.x. <br>

[26] Salton, Gerard and Michael McGill. โIntroduction to Modern Information Retrieval.โ (1983). <br>

[27] Manning, C. D., Raghavan, P., & Schรผtze, H. (2008). Introduction to Information Retrieval. Cambridge: Cambridge University Press. https://nlp.stanford.edu/IR-book/pdf/irbookonlinereading.pdf <br>

[28] RAGAS: https://docs.ragas.io/en/stable/ <br>

[29] OpenAI Platform: https://platform.openai.com/ <br>

[30] One-way analysis of variance (one-way ANOVA): https://en.wikipedia.org/wiki/One-way_analysis_of_variance/ <br>

[31] Tukey's range test: https://en.wikipedia.org/wiki/Tukey%27s_range_test/ <br>

[32] Prompt Engineering: https://lilianweng.github.io/posts/2023-03-15-prompt-engineering/

<br>

---
`ฺฉุฏ ุงุฎูุงู: ุฏุฑ ุชูู ุงู ุงุฑุงุฆูุ ุงุฒ Microsoft Copilot ุจุฑุง ุฌุณุชุฌู ููุงูุงุช ูุฑุชุจุท ุจุง ููุถูุน ู ุงุนูุงู ุงุตูุงุญุงุช ูฺฏุงุฑุด ูุชู ฺฏุฒุงุฑุดุ ู ุงุฒ OpenAI ChatGPT ุจุฑุง ุงุฑุฒุงุจ ู ุงุตูุงุญ ฺฉุฏูุง ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ูุทุงูุจ ุงุฑุงุฆูโุดุฏู ุฏุฑ ุงู ฺฏุฒุงุฑุดุ ุตุฑูุงู ุญุงุตู ุจุฑุฏุงุดุช ุดุฎุต ูฺฏุงุฑูุฏู ุงุณุช ู ุจุฏูู ุฏุฎุงูุช ูุณุชูู ูุฏูโูุง ุฒุจุงู ุชููุฏ ุดุฏูโุงูุฏ. ูฺฏุงุฑูุฏู ุจุงูุฑ ุฏุงุฑุฏ ฺฉู ุฑุนุงุช ุงุฎูุงู ููุด ูุตููุนุ ุดุงูู ุชุฃฺฉุฏ ุจุฑ ุตุญุช ุงุทูุงุนุงุชุ ุดูุงูุช ุฏุฑ ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑูุง ู ุญูุธ ุงุตุงูุช ุชูฺฉุฑ ุงูุณุงูุ ุถุฑูุฑ ุงุณุช.`
<br>
`ุจุง ุงุญุชุฑุงู ุฏ.ุข`

---

### ูพุงูุฑู 

[^1]: Hallucination
[^2]: Prompt Engineering
[^3]: Retrieval-Augmented Generation, RAG
[^4]: Natural language processing (NLP)
[^5]: Contextual information
[^6]: Input tokens
[^7]: Context
[^8]: Truncation
[^9]: Information overload
[^10]: Synergistic
[^11]: Reasoning
[^12]: Semantic Chunks
[^13]: Passive
[^14]: Academic literature
[^15]: Case-based Reasoning (CBR)
[^16]: Dense Passage Retrieval (DPR)
[^17]: Contrastive learning
[^18]: Hypothetical Document Embeddings (HyDE)
[^19]: Re-ranking
[^20]: Multi-query expansion techniques
[^21]: Abstract-first
[^22]: Enhanced Prompting Technique
[^23]: Main topic
[^24]: Applicable domain
[^25]: Specific requirements
[^26]: Mirror Storage
[^27]: Download
[^28]: Upload
[^29]: Bucket Lists
[^30]: ูุฑุขุด ุฏุงุฏู ูุง ฺฉุชุงุจ ุดูุงุณ
[^31]: Header
[^32]: Parsing
[^33]: Citation
[^34]: Fine-grain
[^35]: Reusable
[^36]: Embedding
[^37]: Representation Learning
[^38]: Feature Learning
[^39]: Prior Knowledge
[^40]: Fine-tune:ุฑุฒุชูุธู โ ุชูุธู ุฏูู โ ุจูุฑุงุณุชู - ูพุดููุงุฏ ููุณูุฏู
[^41]: Configuration
[^42]: Dataset: ุฏุงุฏฺฏุงู
[^43]: Evaluation
[^44]: Correlation
[^45]: ุฌุฏุงุณุงุฒ ฺฏุฑู ูุนูุง
[^46]: Multi-threading
[^47]: Vector Database
[^48]: Context Relevance
[^49]: Faithfulness
[^50]: Answer Relevance
[^51]: Tokenizer: ูุดุงูู ุณุงุฒ
[^52]: Redundancy
[^53]: Coherent
[^54]: Alignment
[^55]: Concept
[^56]: Framework
[^57]: Retrieval-Augmented Generation Assessment System
[^58]: Faithfulness
[^59]: Answer Relevance
[^60]: Context Relevance
[^61]: One-way analysis of variance
[^62]: Post-hoc test
[^63]: Prompt Engineering
[^64]: ุนุจุงุฑุช ูพุดููุงุฏ ููุณูุฏู
[^65]: Sub-node
[^66]: Fine-grained
